<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
	<script src="http://code.jquery.com/jquery-1.11.0.min.js" type="text/javascript"></script>
	<script src="./proofs-toggle.js" type="text/javascript"></script>
	<style>
		div.proofcomment {
			font-style: italic;
		}
	</style>
	<title>Documentation</title>
</head>
<body>
<div id="page">
<div id="main">
<h1 class="libtitle">Library UniMath.PAdics.z_mod_p</h1>

<div class="code">
</div>

<div class="doc">
*Integers mod p 
<div class="paragraph"> </div>

 By Alvaro Pelayo, Vladimir Voevodsky and Michael A. Warren 
<div class="paragraph"> </div>

 December 2011 
<div class="paragraph"> </div>

 made compatible with the current UniMath library by Ralph Matthes in October 2017 
<div class="paragraph"> </div>

 Imports 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.PAdics.lemmas</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.NumberSystems.Integers</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.Foundations.Preamble</span>.<br/>

<br/>
<span class="id" title="keyword">Unset</span> <span class="id" title="var">Kernel</span> <span class="id" title="var">Term</span> <span class="id" title="var">Sharing</span>. </div>

<div class="doc">
for quicker proof-checking, approx. by factor 10 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">hz_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab698"></a><h1 class="section">I. Divisibility and the division algorithm</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hzdiv0</span> : <span class="id" title="var">hz</span> -&gt; <span class="id" title="var">hz</span> -&gt; <span class="id" title="var">hz</span> -&gt; <span class="id" title="var">UU</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span> =&gt; <span class="id" title="var">n</span> * <span class="id" title="var">k</span> = <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hzdiv</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">hz</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> =&gt; ∃ <span class="id" title="var">k</span> : <span class="id" title="var">hz</span>, <span class="id" title="var">hzdiv0</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzdivisrefl</span> : <span class="id" title="var">isrefl</span> <span class="id" title="var">hzdiv</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">red</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">total2tohexists</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzmultr1</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzdivistrans</span> : <span class="id" title="var">istrans</span> <span class="id" title="var">hzdiv</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k</span> <span class="id" title="var">f</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">q</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> <span class="id" title="var">g</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>, <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">k</span> * <span class="id" title="var">l</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzmultassoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzdivlinearcombleft</span> ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">f</span> : <span class="id" title="var">a</span> = <span class="id" title="var">b</span> + <span class="id" title="var">c</span> )<br/>
&nbsp;&nbsp;( <span class="id" title="var">x</span> : <span class="id" title="var">hzdiv</span> <span class="id" title="var">d</span> <span class="id" title="var">a</span> ) ( <span class="id" title="var">y</span> : <span class="id" title="var">hzdiv</span> <span class="id" title="var">d</span> <span class="id" title="var">b</span> ) : <span class="id" title="var">hzdiv</span> <span class="id" title="var">d</span> <span class="id" title="var">c</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">x'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">y'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x'</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k</span> <span class="id" title="var">g</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">y'</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> <span class="id" title="var">h</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">k</span> + - <span class="id" title="var">l</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzldistr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringrmultminus</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( ( <span class="id" title="var">a</span> + ( - ( <span class="id" title="var">d</span> * <span class="id" title="var">l</span> ) ) )%<span class="id" title="var">hz</span> = <span class="id" title="var">c</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzplusrcan</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">b</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusassoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzlminus</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusr0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzpluscomm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzdivlinearcombright</span> ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">f</span> : <span class="id" title="var">a</span> = <span class="id" title="var">b</span> + <span class="id" title="var">c</span> )<br/>
&nbsp;&nbsp;( <span class="id" title="var">x</span>: <span class="id" title="var">hzdiv</span> <span class="id" title="var">d</span> <span class="id" title="var">b</span> ) ( <span class="id" title="var">y</span> : <span class="id" title="var">hzdiv</span> <span class="id" title="var">d</span> <span class="id" title="var">c</span> ) : <span class="id" title="var">hzdiv</span> <span class="id" title="var">d</span> <span class="id" title="var">a</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">x'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">y'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x'</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k</span> <span class="id" title="var">g</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">y'</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> <span class="id" title="var">h</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">k</span> + <span class="id" title="var">l</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzldistr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( (<span class="id" title="var">d</span> * <span class="id" title="var">k</span> + <span class="id" title="var">d</span> * <span class="id" title="var">l</span>)%<span class="id" title="var">hz</span> = <span class="id" title="var">a</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">g</span>, <span class="id" title="var">h</span>, <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">divalgorithmnonneg</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) ( <span class="id" title="var">m</span> : <span class="id" title="var">nat</span> ) ( <span class="id" title="var">p</span> : <span class="id" title="var">hzlth</span> 0 ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) ) :<br/>
&nbsp;&nbsp;∑ <span class="id" title="var">qr</span> : <span class="id" title="var">hz</span> × <span class="id" title="var">hz</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> = ( ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) * ( <span class="id" title="var">pr1</span> <span class="id" title="var">qr</span> ) ) + ( <span class="id" title="var">pr2</span> <span class="id" title="var">qr</span> )  ×<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzleh</span> 0 ( <span class="id" title="var">pr2</span> <span class="id" title="var">qr</span> ) × <span class="id" title="var">hzlth</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">qr</span> ) ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">dirprodpair</span> 0 0 ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringrunax1</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringmultx0</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nattohzand0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( 0 = 0%<span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">isreflhzleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">q'</span> := <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">IHn</span> <span class="id" title="var">p</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">r'</span> := <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">IHn</span> <span class="id" title="var">p</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">f</span> := <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">IHn</span> <span class="id" title="var">p</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzleh</span> ( <span class="id" title="var">r'</span> + 1 ) ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">p'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzlth</span> ( <span class="id" title="var">r'</span> + 1 ) ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> + 1 ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">p''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthandplusr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">IHn</span> <span class="id" title="var">p</span> ) ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthsntoleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">choice</span> := <span class="id" title="var">hzlehchoice</span> ( <span class="id" title="var">r'</span> + 1 ) ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">p'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">choice</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k</span> | <span class="id" title="var">h</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">dirprodpair</span> <span class="id" title="var">q'</span> ( <span class="id" title="var">r'</span> + 1 ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">nattohzandS</span> <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzpluscomm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> * <span class="id" title="var">q'</span> + <span class="id" title="var">r'</span> + 1 = <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> * <span class="id" title="var">q'</span> + ( <span class="id" title="var">r'</span> + 1 ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ringassoc1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">istranshzleh</span> 0 <span class="id" title="var">r'</span> ( <span class="id" title="var">r'</span> + 1 ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">IHn</span> <span class="id" title="var">p</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthtoleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthnsn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">dirprodpair</span> ( <span class="id" title="var">q'</span> + 1 ) 0 ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">nattohzandS</span> <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzpluscomm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> * <span class="id" title="var">q'</span> + <span class="id" title="var">r'</span> + 1 = <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> * ( <span class="id" title="var">q'</span> + 1 ) + 0 ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusassoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringldistr</span> <span class="id" title="var">_</span> <span class="id" title="var">q'</span> <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">ringrunax2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusr0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> <span class="id" title="var">isreflhzleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Lemma</span> <span class="id" title="var">testlemma1</span> : <span class="id" title="var">hzneq</span> 0 1.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">change</span> 0 <span class="id" title="keyword">with</span> ( <span class="id" title="var">nattohz</span> 0%<span class="id" title="var">nat</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">nattohzand1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nattohzandneq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">isirreflnatlth</span> 1 ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">natlth</span> 0 1 ) <span class="id" title="keyword">as</span> <span class="id" title="var">i</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">natlthnsn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">f</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Lemma</span> <span class="id" title="var">testlemma2</span> : <span class="id" title="var">hzneq</span> 0 ( 1 + 1 ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">change</span> 0 <span class="id" title="keyword">with</span> ( <span class="id" title="var">nattohz</span> 0%<span class="id" title="var">nat</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">nattohzand1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">nattohzandplus</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nattohzandneq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">natneq</span> ( 1 + 1 ) 0 ) <span class="id" title="keyword">as</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">natgthtoneq</span> ( 1 + 1 ) 0 ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">natneq</span> ( 1 + 1 ) 2 ) <span class="id" title="keyword">as</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Lemma</span> <span class="id" title="var">testlemma21</span> : <span class="id" title="var">hzlth</span> 0 ( <span class="id" title="var">nattohz</span> 2 ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">change</span> 0 <span class="id" title="keyword">with</span> ( <span class="id" title="var">nattohz</span> 0%<span class="id" title="var">nat</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nattohzandlth</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">istransnatlth</span> <span class="id" title="var">_</span> 1 ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natlthnsn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natlthnsn</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Lemma</span> <span class="id" title="var">testlemma3</span> : <span class="id" title="var">hzlth</span> 0 ( <span class="id" title="var">nattohz</span> 3 ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">istranshzlth</span> <span class="id" title="var">_</span> ( <span class="id" title="var">nattohz</span> 2 ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">testlemma21</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> 0 <span class="id" title="keyword">with</span> ( <span class="id" title="var">nattohz</span> 0%<span class="id" title="var">nat</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nattohzandlth</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natlthnsn</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">testlemma9</span> : <span class="id" title="var">hzlth</span> 0 ( <span class="id" title="var">nattohz</span> 9 ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">istranshzlth</span> <span class="id" title="var">_</span> ( <span class="id" title="var">nattohz</span> 3 ) ).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">testlemma3</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">istranshzlth</span> <span class="id" title="var">_</span> ( <span class="id" title="var">nattohz</span> 6 ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">testlemma3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">testlemma3</span>.<br/>
</div>

<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">divalgorithmexists</span> ( <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">p</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">m</span> ) :<br/>
&nbsp;&nbsp;∑ <span class="id" title="var">qr</span> : <span class="id" title="var">hz</span> × <span class="id" title="var">hz</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">n</span> = <span class="id" title="var">m</span> * ( <span class="id" title="var">pr1</span> <span class="id" title="var">qr</span> ) + <span class="id" title="var">pr2</span> <span class="id" title="var">qr</span> ×<br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzleh</span> 0 ( <span class="id" title="var">pr2</span> <span class="id" title="var">qr</span> ) ×<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzlth</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">qr</span> ) ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">hzlthorgeh</span> <span class="id" title="var">n</span> 0 ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">n_neg</span> | <span class="id" title="var">n_nonneg</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> ( <span class="id" title="var">hzlthorgeh</span> <span class="id" title="var">m</span> 0 ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">m_neg</span> | <span class="id" title="var">m_nonneg</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">n'</span> := <span class="id" title="var">hzabsval</span> <span class="id" title="var">n</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">m'</span> := <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m'</span> = ( - <span class="id" title="var">m</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzabsvallth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( - - <span class="id" title="var">n</span> = - ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n'</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">f0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzabsvallth0</span> <span class="id" title="var">n_neg</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzabsvallth0</span> <span class="id" title="var">n_neg</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">n'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzabsvallth0</span> <span class="id" title="var">n_neg</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzlth</span> 0 ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m'</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">p'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzlth</span> 0 ( - <span class="id" title="var">m</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzlth0andminus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">a</span> := <span class="id" title="var">divalgorithmnonneg</span> <span class="id" title="var">n'</span> <span class="id" title="var">m'</span> <span class="id" title="var">p'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">q</span> := <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">a</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">r</span> := <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">a</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">Q</span> := <span class="id" title="var">q</span> + 1 ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">R</span> := - <span class="id" title="var">m</span> - <span class="id" title="var">r</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">hzlehchoice</span> 0 <span class="id" title="var">r</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">a</span> ) ) )) <span class="id" title="keyword">as</span> [ <span class="id" title="var">less</span> | <span class="id" title="var">equal</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">dirprodpair</span> <span class="id" title="var">Q</span> <span class="id" title="var">R</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">pathsinv0</span>( <span class="id" title="var">ringminusminus</span> <span class="id" title="var">hz</span> <span class="id" title="var">n</span>) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( - <span class="id" title="var">nattohz</span> <span class="id" title="var">n'</span> = ( <span class="id" title="var">m</span> * <span class="id" title="var">Q</span> + <span class="id" title="var">R</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">f1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">unfold</span> <span class="id" title="var">Q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">pr1</span> ( ( <span class="id" title="var">pr2</span> <span class="id" title="var">a</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">a</span> ) ) <span class="id" title="keyword">with</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">a</span> ) ) <span class="id" title="keyword">with</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzaddinvplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">ringlmultminus</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">ringminusminus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringldistr</span> <span class="id" title="var">_</span> <span class="id" title="var">q</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultr1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( ( <span class="id" title="var">m</span> * <span class="id" title="var">q</span> ) + - <span class="id" title="var">r</span> = ( <span class="id" title="var">m</span> * <span class="id" title="var">q</span> + <span class="id" title="var">m</span> ) + ( - <span class="id" title="var">m</span> + - <span class="id" title="var">r</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusassoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzplusassoc</span> <span class="id" title="var">m</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">m</span> + - <span class="id" title="var">m</span> ) <span class="id" title="keyword">with</span> ( <span class="id" title="var">m</span> - <span class="id" title="var">m</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzrminus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusl0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ( <span class="id" title="var">pathscomp0</span> <span class="id" title="var">f0</span> <span class="id" title="var">f1</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">unfold</span> <span class="id" title="var">R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzlth</span> <span class="id" title="var">r</span> ( - <span class="id" title="var">m</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzabsvalleh0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">a</span> ) ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthtoleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzlminus</span> <span class="id" title="var">m</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">dirprodpair</span> <span class="id" title="var">Q</span> ( - <span class="id" title="var">m</span> - <span class="id" title="var">r</span> ) ) ) <span class="id" title="keyword">with</span> ( - <span class="id" title="var">m</span> - <span class="id" title="var">r</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzlehandplusl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthtoleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">ringminusminus</span> <span class="id" title="var">hz</span> <span class="id" title="var">m</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthminusswap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">unfold</span> <span class="id" title="var">R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">m'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalleh0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">change</span> ( <span class="id" title="var">hzlth</span> ( - <span class="id" title="var">m</span> + - <span class="id" title="var">r</span> ) ( - <span class="id" title="var">m</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzlth</span> ( - <span class="id" title="var">m</span> - <span class="id" title="var">r</span> ) ( - <span class="id" title="var">m</span> + 0 ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthandplusl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzgth0andminus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">less</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( - <span class="id" title="var">m</span> + 0 = ( - <span class="id" title="var">m</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">f'</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">hzplusr0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ( <span class="id" title="var">transportf</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzlth</span> ( - <span class="id" title="var">m</span> + - <span class="id" title="var">r</span> ) <span class="id" title="var">x</span> ) <span class="id" title="var">f'</span> <span class="id" title="var">u</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthtoleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">dirprodpair</span> <span class="id" title="var">q</span> 0 ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">ringminusminus</span> <span class="id" title="var">hz</span> <span class="id" title="var">n</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( - <span class="id" title="var">nattohz</span> <span class="id" title="var">n'</span> = <span class="id" title="var">m</span> * <span class="id" title="var">q</span> + 0 ) <span class="id" title="keyword">as</span> <span class="id" title="var">f1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">a</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">pr1</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">a</span> ) ) <span class="id" title="keyword">with</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">a</span> ) ) <span class="id" title="keyword">with</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusr0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">pathsinv0</span> <span class="id" title="var">equal</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusr0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( - ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m'</span> * <span class="id" title="var">q</span> ) = - ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m'</span> ) * <span class="id" title="var">q</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">f2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ringlmultminus</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">m'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalleh0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">maponpaths</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">x</span> * <span class="id" title="var">q</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ringminusminus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthtoleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ( <span class="id" title="var">pathscomp0</span> <span class="id" title="var">f0</span> <span class="id" title="var">f1</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">change</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">dirprodpair</span> <span class="id" title="var">q</span> 0 ) ) <span class="id" title="keyword">with</span> 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isreflhzleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">dirprodpair</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> ) ) <span class="id" title="keyword">with</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">a</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> ( <span class="id" title="var">hzgehchoice</span> <span class="id" title="var">m</span> 0 <span class="id" title="var">m_nonneg</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">h</span> | <span class="id" title="var">k</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzlth</span> 0 ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">p'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalgth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">a</span> := <span class="id" title="var">divalgorithmnonneg</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) <span class="id" title="var">p'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">q'</span> := <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">a</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">r'</span> := <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">a</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">n</span> = - - <span class="id" title="var">n</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">f0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ringminusminus</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( - - <span class="id" title="var">n</span> = - ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">n</span> ) ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">f1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzabsvalleh0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthtoleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">hzlehchoice</span> 0 <span class="id" title="var">r'</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">a</span> ) ) ) ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">less</span> | <span class="id" title="var">equal</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">dirprodpair</span> ( - <span class="id" title="var">q'</span> - 1 ) ( <span class="id" title="var">m</span> - <span class="id" title="var">r'</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">change</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">dirprodpair</span> ( - <span class="id" title="var">q'</span> - 1 ) ( <span class="id" title="var">m</span> - <span class="id" title="var">r'</span> ) ) ) <span class="id" title="keyword">with</span> ( - <span class="id" title="var">q'</span> - 1 ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">dirprodpair</span> ( - <span class="id" title="var">q'</span> - 1 ) ( <span class="id" title="var">m</span> - <span class="id" title="var">r'</span> ) ) ) <span class="id" title="keyword">with</span> ( <span class="id" title="var">m</span> - <span class="id" title="var">r'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( - <span class="id" title="var">q'</span> - 1 ) <span class="id" title="keyword">with</span> ( - <span class="id" title="var">q'</span> + ( - 1%<span class="id" title="var">hz</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzldistr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( - <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">n</span> ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">m</span> * ( - <span class="id" title="var">q'</span> ) + <span class="id" title="var">m</span> * ( - 1%<span class="id" title="var">hz</span> ) ) + ( <span class="id" title="var">m</span> - <span class="id" title="var">r'</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">f2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">a</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">a</span> ) ) <span class="id" title="keyword">with</span> <span class="id" title="var">q'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">a</span> ) ) <span class="id" title="keyword">with</span> <span class="id" title="var">r'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalgth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzaddinvplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringrmultminus</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzplusassoc</span> <span class="id" title="var">_</span> ( <span class="id" title="var">m</span> * ( - 1%<span class="id" title="var">hz</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">maponpaths</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; - ( <span class="id" title="var">m</span> * <span class="id" title="var">q'</span> ) + <span class="id" title="var">x</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( - <span class="id" title="var">m</span> + ( <span class="id" title="var">m</span> - <span class="id" title="var">r'</span> ) = <span class="id" title="var">m</span> * ( - 1%<span class="id" title="var">hz</span> ) + ( <span class="id" title="var">m</span> - <span class="id" title="var">r'</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">f3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">maponpaths</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">x</span> + ( <span class="id" title="var">m</span> - <span class="id" title="var">r'</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">m</span> * ( - 1%<span class="id" title="var">hz</span> ) = - ( <span class="id" title="var">m</span> * 1%<span class="id" title="var">hz</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">f30</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">ringrmultminus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( - ( <span class="id" title="var">m</span> * 1 ) = - <span class="id" title="var">m</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">f31</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultr1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f30</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( - <span class="id" title="var">r'</span> = - <span class="id" title="var">m</span> + ( <span class="id" title="var">m</span> - <span class="id" title="var">r'</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">f4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">change</span> ( - <span class="id" title="var">r'</span> = -<span class="id" title="var">m</span> + ( <span class="id" title="var">m</span> + - <span class="id" title="var">r'</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzplusassoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzlminus</span>, <span class="id" title="var">hzplusl0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f0</span>, <span class="id" title="var">f1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">change</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">dirprodpair</span> ( - <span class="id" title="var">q'</span> - 1 ) ( <span class="id" title="var">m</span> - <span class="id" title="var">r'</span> ) ) ) <span class="id" title="keyword">with</span> ( <span class="id" title="var">m</span> - <span class="id" title="var">r'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthtoleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzrminus</span> <span class="id" title="var">r'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthandplusr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzabsvalgeh0</span> <span class="id" title="var">m_nonneg</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">a</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzabsvalgeh0</span> <span class="id" title="var">m_nonneg</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzlth</span> ( <span class="id" title="var">m</span> - <span class="id" title="var">r'</span> ) ( <span class="id" title="var">m</span> + 0 ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthandplusl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzgth0andminus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">less</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusr0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">dirprodpair</span> ( - <span class="id" title="var">q'</span> ) 0 ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">change</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">dirprodpair</span> ( - <span class="id" title="var">q'</span> ) 0 ) ) <span class="id" title="keyword">with</span> ( - <span class="id" title="var">q'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">dirprodpair</span> ( - <span class="id" title="var">q'</span> ) 0 ) ) <span class="id" title="keyword">with</span> 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( - <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">n</span> ) = <span class="id" title="var">m</span> * - <span class="id" title="var">q'</span> + 0 ) <span class="id" title="keyword">as</span> <span class="id" title="var">f2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusr0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">a</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">a</span> ) ) <span class="id" title="keyword">with</span> <span class="id" title="var">q'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">a</span> ) ) <span class="id" title="keyword">with</span> <span class="id" title="var">r'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusr0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalgeh0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ringrmultminus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f0</span>, <span class="id" title="var">f1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">apply</span> <span class="id" title="var">isreflhzleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">rewrite</span> <span class="id" title="var">equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">a</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">k</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">set</span> ( <span class="id" title="var">choice2</span> := <span class="id" title="var">hzlthorgeh</span> <span class="id" title="var">m</span> 0 ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">choice2</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">m_neg</span> | <span class="id" title="var">m_nonneg</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzlth</span> 0 ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">p'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvallth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">ringminusminus</span> <span class="id" title="var">hz</span> <span class="id" title="var">m</span> ) <span class="id" title="tactic">in</span> <span class="id" title="var">m_neg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">d</span>:= <span class="id" title="var">hzlth0andminus</span> <span class="id" title="var">m_neg</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">ringminusminus</span> <span class="id" title="tactic">in</span> <span class="id" title="var">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">a</span> := <span class="id" title="var">divalgorithmnonneg</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) <span class="id" title="var">p'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">q'</span> := <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">a</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">r'</span> := <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">a</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">dirprodpair</span> ( - <span class="id" title="var">q'</span> ) <span class="id" title="var">r'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzabsvalgeh0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">a</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">a</span> ) ) <span class="id" title="keyword">with</span> <span class="id" title="var">q'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">a</span> ) ) <span class="id" title="keyword">with</span> <span class="id" title="var">r'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">dirprodpair</span> ( - <span class="id" title="var">q'</span> ) <span class="id" title="var">r'</span> ) ) <span class="id" title="keyword">with</span> ( - <span class="id" title="var">q'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">dirprodpair</span> ( - <span class="id" title="var">q'</span> ) <span class="id" title="var">r'</span> ) ) <span class="id" title="keyword">with</span> <span class="id" title="var">r'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalleh0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">maponpaths</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">x</span> + <span class="id" title="var">r'</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( - <span class="id" title="var">m</span> * <span class="id" title="var">q'</span> = - ( <span class="id" title="var">m</span> * <span class="id" title="var">q'</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">f0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">ringlmultminus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( - ( <span class="id" title="var">m</span> * <span class="id" title="var">q'</span> ) = <span class="id" title="var">m</span> * ( - <span class="id" title="var">q'</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">f1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ringrmultminus</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ( <span class="id" title="var">pathscomp0</span> <span class="id" title="var">f0</span> <span class="id" title="var">f1</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthtoleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> (<span class="id" title="var">pr1</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">a</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">a</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzlth</span> 0 ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">p'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalgeh0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">destruct</span> ( <span class="id" title="var">hzneqchoice</span> 0 <span class="id" title="var">m</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> | <span class="id" title="var">r</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">isirreflhzgth</span> 0 ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzgthgehtrans</span> 0 <span class="id" title="var">m</span> 0 ); <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">a</span> := <span class="id" title="var">divalgorithmnonneg</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) <span class="id" title="var">p'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">q'</span> := <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">a</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">r'</span> := <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">a</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">dirprodpair</span> <span class="id" title="var">q'</span> <span class="id" title="var">r'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzabsvalgeh0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">a</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">a</span> ) ) <span class="id" title="keyword">with</span> <span class="id" title="var">q'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">a</span> ) ) <span class="id" title="keyword">with</span> <span class="id" title="var">r'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">dirprodpair</span> <span class="id" title="var">q'</span> <span class="id" title="var">r'</span> ) ) <span class="id" title="keyword">with</span> <span class="id" title="var">q'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">dirprodpair</span> <span class="id" title="var">q'</span> <span class="id" title="var">r'</span> ) ) <span class="id" title="keyword">with</span> <span class="id" title="var">r'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalgeh0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">a</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">a</span> ) ) ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzdivhzabsval</span> ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">p</span> : <span class="id" title="var">hzdiv</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">natleh</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">a</span> ) ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">b</span> ) ∨ <span class="id" title="var">hzabsval</span> <span class="id" title="var">b</span> = 0%<span class="id" title="var">nat</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">p</span> <span class="id" title="var">P</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k</span> <span class="id" title="var">f</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natdivleh</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">k</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalandmult</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">divalgorithm</span> ( <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">p</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">m</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">iscontr</span> ( ∑ <span class="id" title="var">qr</span> : <span class="id" title="var">hz</span> × <span class="id" title="var">hz</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">n</span> = ( <span class="id" title="var">m</span> * ( <span class="id" title="var">pr1</span> <span class="id" title="var">qr</span> ) ) + ( <span class="id" title="var">pr2</span> <span class="id" title="var">qr</span> ) ×<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzleh</span> 0 ( <span class="id" title="var">pr2</span> <span class="id" title="var">qr</span> ) ×<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzlth</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">qr</span> ) ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) ) ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">divalgorithmexists</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">p</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">qr'</span> <span class="id" title="var">t'</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">qr'</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">q'</span> <span class="id" title="var">r'</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">t'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t'</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">f'</span> <span class="id" title="var">p2p2t</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p2p2t</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">p1p2p2t</span> <span class="id" title="var">p2p2p2t</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">divalgorithmexists</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">qr</span> <span class="id" title="var">v</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">qr</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">q</span> <span class="id" title="var">r</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">v</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">f</span> <span class="id" title="var">p2p2dae</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p2p2dae</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">p1p2p2dae</span> <span class="id" title="var">p2p2p2dae</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p1p2p2dae</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p2p2p2dae</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">r'</span> = <span class="id" title="var">r</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;{ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">m</span> * ( <span class="id" title="var">q</span> - <span class="id" title="var">q'</span> ) = ( <span class="id" title="var">r'</span> - <span class="id" title="var">r</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">h0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">change</span> ( <span class="id" title="var">q</span> - <span class="id" title="var">q'</span> ) <span class="id" title="keyword">with</span> ( <span class="id" title="var">q</span> + - <span class="id" title="var">q'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzldistr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzplusr0</span> ( <span class="id" title="var">r'</span> - <span class="id" title="var">r</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzrminus</span> ( <span class="id" title="var">m</span> * <span class="id" title="var">q'</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">r'</span> - <span class="id" title="var">r</span> ) <span class="id" title="keyword">with</span> ( <span class="id" title="var">r'</span> + ( - <span class="id" title="var">r</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzplusassoc</span> <span class="id" title="var">r'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( ( <span class="id" title="var">m</span> * <span class="id" title="var">q'</span> ) - ( <span class="id" title="var">m</span> * <span class="id" title="var">q'</span> ) ) <span class="id" title="keyword">with</span> ( ( <span class="id" title="var">m</span> * <span class="id" title="var">q'</span> ) + ( - ( <span class="id" title="var">m</span> * <span class="id" title="var">q'</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzplusassoc</span> ( - <span class="id" title="var">r</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzpluscomm</span> ( -<span class="id" title="var">r</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzplusassoc</span> <span class="id" title="var">r'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzplusassoc</span> <span class="id" title="var">r'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzpluscomm</span> <span class="id" title="var">r'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">f'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzplusassoc</span> ( <span class="id" title="var">m</span> * <span class="id" title="var">q</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">r</span> + - <span class="id" title="var">r</span> ) <span class="id" title="keyword">with</span> ( <span class="id" title="var">r</span> - <span class="id" title="var">r</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzrminus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusr0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringrmultminus</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">m</span> * <span class="id" title="var">q</span> + - ( <span class="id" title="var">m</span> * <span class="id" title="var">q'</span> ) ) <span class="id" title="keyword">with</span> ( ( <span class="id" title="var">m</span> * <span class="id" title="var">q</span> + - ( <span class="id" title="var">m</span> * <span class="id" title="var">q'</span> ) )%<span class="id" title="tactic">ring</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">natleh</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) ( <span class="id" title="var">hzabsval</span> ( <span class="id" title="var">r'</span> - <span class="id" title="var">r</span> ) ) ∨<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzabsval</span> ( <span class="id" title="var">r'</span> - <span class="id" title="var">r</span> ) = 0%<span class="id" title="var">nat</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzdivhzabsval</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">P</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">q</span> - <span class="id" title="var">q'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">isaprop</span> ( <span class="id" title="var">r'</span> = <span class="id" title="var">r</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">P</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">isasethz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">v</span> ( <span class="id" title="var">hProppair</span> ( <span class="id" title="var">r'</span> = <span class="id" title="var">r</span> ) <span class="id" title="var">P</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span> <span class="id" title="keyword">as</span> [ <span class="id" title="tactic">left</span> | <span class="id" title="tactic">right</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzlth</span> ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> ( <span class="id" title="var">r'</span> - <span class="id" title="var">r</span> ) ) ) ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> ( <span class="id" title="var">hzgthorleh</span> <span class="id" title="var">r'</span> <span class="id" title="var">r</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">greater</span> | <span class="id" title="var">lesseq</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzlth</span> 0 ( <span class="id" title="var">r'</span> - <span class="id" title="var">r</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzrminus</span> <span class="id" title="var">r</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthandplusr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalgth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthminus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">exact</span> <span class="id" title="var">p2p2p2t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">exact</span> <span class="id" title="var">p2p2p2dae</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">exact</span> <span class="id" title="var">p1p2p2dae</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> ( <span class="id" title="var">hzlehchoice</span> <span class="id" title="var">r'</span> <span class="id" title="var">r</span> <span class="id" title="var">lesseq</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">less</span> | <span class="id" title="var">equal</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalandminuspos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalgth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthminus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">exact</span> <span class="id" title="var">p2p2p2dae</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">exact</span> <span class="id" title="var">p2p2p2t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**  <span class="id" title="tactic">exact</span> <span class="id" title="var">p1p2p2t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthminusequiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">exact</span> <span class="id" title="var">p1p2p2t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">exact</span> <span class="id" title="var">p1p2p2dae</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <span class="id" title="var">equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzrminus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsval0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nattohzand0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ≠ 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzabsvalneq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">Q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Q</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">lemmas.hzabsvalneq0</span>. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">isirreflhzlth</span> ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzlehlthtrans</span> <span class="id" title="var">_</span> ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> ( <span class="id" title="var">r'</span> - <span class="id" title="var">r</span> ) ) ) <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">nattohzandleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> ( <span class="id" title="var">r'</span> = <span class="id" title="var">r</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">assert</span> ( <span class="id" title="var">r'</span> - <span class="id" title="var">r</span> = 0 ) <span class="id" title="keyword">as</span> <span class="id" title="var">i0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzabsvaleq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzplusl0</span> <span class="id" title="var">r</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzplusr0</span> <span class="id" title="var">r'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">r'</span> + ( <span class="id" title="var">r</span> - <span class="id" title="var">r</span> ) = ( 0 + <span class="id" title="var">r</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">i00</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">change</span> ( <span class="id" title="var">r</span> - <span class="id" title="var">r</span> ) <span class="id" title="keyword">with</span> ( <span class="id" title="var">r</span> + - <span class="id" title="var">r</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzpluscomm</span> <span class="id" title="var">_</span> ( - <span class="id" title="var">r</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzplusassoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">maponpaths</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">_</span> =&gt; <span class="id" title="var">x</span> + <span class="id" title="var">r</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">i0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ( <span class="id" title="var">transportf</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">_</span> =&gt; ( <span class="id" title="var">r'</span> + <span class="id" title="var">x</span> = ( 0 + <span class="id" title="var">r</span> ) ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( ( <span class="id" title="var">hzrminus</span> <span class="id" title="var">r</span> ) ) <span class="id" title="var">i00</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">q'</span> = <span class="id" title="var">q</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;{ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">h</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzmultlcan</span> <span class="id" title="var">q'</span> <span class="id" title="var">q</span> <span class="id" title="var">m</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">i</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzplusrcan</span> ( <span class="id" title="var">m</span> * <span class="id" title="var">q'</span> ) ( <span class="id" title="var">m</span> * <span class="id" title="var">q</span> ) <span class="id" title="var">r</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">f'</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">dirprodpair</span> <span class="id" title="var">q'</span> <span class="id" title="var">r'</span> = ( <span class="id" title="var">dirprodpair</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">j</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsdirprod</span>; <span class="id" title="tactic">assumption</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathintotalfiber</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">p0</span> := <span class="id" title="var">j</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">iscontr</span> ( <span class="id" title="var">n</span> = <span class="id" title="var">m</span> * <span class="id" title="var">q</span> + <span class="id" title="var">r</span> ×<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzleh</span> 0 <span class="id" title="var">r</span> ×<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzlth</span> <span class="id" title="var">r</span> ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) ) ) ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">contract</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">change</span> <span class="id" title="var">iscontr</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">isofhlevel</span> 0 ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isofhleveldirprod</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isasethz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isofhleveldirprod</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">p1p2p2dae</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">p2p2p2dae</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzlth</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">proofirrelevancecontr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hzquotientmod</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) : <span class="id" title="var">hz</span> -&gt; <span class="id" title="var">hz</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> : <span class="id" title="var">hz</span> =&gt; <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">divalgorithmexists</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ) ).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hzremaindermod</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) : <span class="id" title="var">hz</span> -&gt; <span class="id" title="var">hz</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> : <span class="id" title="var">hz</span> =&gt; <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">divalgorithmexists</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ) ).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hzdivequationmod</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) ( <span class="id" title="var">n</span> : <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">n</span> = <span class="id" title="var">p</span> * ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> ) + ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> ) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">pr1</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">divalgorithmexists</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ) ).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hzleh0remaindermod</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) ( <span class="id" title="var">n</span> : <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzleh</span> 0 ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> ) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">pr1</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">divalgorithmexists</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ) ) ).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hzlthremaindermodmod</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) ( <span class="id" title="var">n</span> : <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzlth</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">p</span> ) ) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">pr2</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">divalgorithmexists</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ) ) ).<br/>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab699"></a><h1 class="section">II. QUOTIENTS AND REMAINDERS</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isaprime</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) : <span class="id" title="var">UU</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">hzlth</span> 1 <span class="id" title="var">p</span> ×<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">hz</span>, <span class="id" title="var">hzdiv</span> <span class="id" title="var">m</span> <span class="id" title="var">p</span> -&gt; <span class="id" title="var">m</span> = 1 ∨ <span class="id" title="var">m</span> = <span class="id" title="var">p</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isapropisaprime</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isaprop</span> ( <span class="id" title="var">isaprime</span> <span class="id" title="var">p</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isofhleveldirprod</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzlth</span> 1 <span class="id" title="var">p</span> ).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">impredfun</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">m</span> = 1 ∨ <span class="id" title="var">m</span> = <span class="id" title="var">p</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isaprimetoneq0</span> { <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> } ( <span class="id" title="var">x</span> : <span class="id" title="var">isaprime</span> <span class="id" title="var">p</span> ) : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">isirreflhzlth</span> 0 ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">istranshzlth</span> <span class="id" title="var">_</span> 1 <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthnsn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">x</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrtest</span> ( <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">m</span> ) ( <span class="id" title="var">a</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> : <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">a</span> = ( <span class="id" title="var">m</span> * <span class="id" title="var">q</span> ) + <span class="id" title="var">r</span> ×<br/>
&nbsp;&nbsp;( <span class="id" title="var">hzleh</span> 0 <span class="id" title="var">r</span> × <span class="id" title="var">hzlth</span> <span class="id" title="var">r</span> ( <span class="id" title="var">nattohz</span> (<span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) ) ) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">q</span> = <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> × <span class="id" title="var">r</span> = <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">d</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">k</span> := <span class="id" title="var">tpair</span> ( <span class="id" title="var">P</span> := ( <span class="id" title="keyword">fun</span> <span class="id" title="var">qr</span> : <span class="id" title="var">hz</span> × <span class="id" title="var">hz</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> = <span class="id" title="var">m</span> * ( <span class="id" title="var">pr1</span> <span class="id" title="var">qr</span> ) + <span class="id" title="var">pr2</span> <span class="id" title="var">qr</span> ×<br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzleh</span> 0 ( <span class="id" title="var">pr2</span> <span class="id" title="var">qr</span> ) × <span class="id" title="var">hzlth</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">qr</span> ) ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) ) ) ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">dirprodpair</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> ) <span class="id" title="var">d</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">k</span> = <span class="id" title="var">pr1</span> ( <span class="id" title="var">divalgorithm</span> <span class="id" title="var">a</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">divalgorithm</span> <span class="id" title="var">a</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">change</span> <span class="id" title="var">q</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">k</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">change</span> <span class="id" title="var">r</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">k</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hzqrtestq</span> ( <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">m</span> ) ( <span class="id" title="var">a</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> : <span class="id" title="var">hz</span> )<br/>
&nbsp;&nbsp;( <span class="id" title="var">d</span> : <span class="id" title="var">a</span> = ( <span class="id" title="var">m</span> * <span class="id" title="var">q</span> ) + <span class="id" title="var">r</span> ×<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzleh</span> 0 <span class="id" title="var">r</span> × <span class="id" title="var">hzlth</span> <span class="id" title="var">r</span> ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) ) ) ) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">pr1</span> ( <span class="id" title="var">hzqrtest</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">d</span> ).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hzqrtestr</span> ( <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">m</span> ) ( <span class="id" title="var">a</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> : <span class="id" title="var">hz</span> )<br/>
&nbsp;&nbsp;( <span class="id" title="var">d</span> : <span class="id" title="var">a</span> = ( <span class="id" title="var">m</span> * <span class="id" title="var">q</span> ) + <span class="id" title="var">r</span> ×<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzleh</span> 0 <span class="id" title="var">r</span> × <span class="id" title="var">hzlth</span> <span class="id" title="var">r</span> ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) ) ) ) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">pr2</span> ( <span class="id" title="var">hzqrtest</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">d</span> ).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrand0eq</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) : 0 = ( <span class="id" title="var">p</span> * 0 ) + 0.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultx0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusl0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrand0ineq</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzleh</span> 0 0  × <span class="id" title="var">hzlth</span> 0 ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">p</span> ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isreflhzleh</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">lemmas.hzabsvalneq0</span>. &nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrand0q</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) : <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> 0 = 0.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrtestq</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> 0 0 0 ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrand0eq</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrand0ineq</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrand0r</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) : <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> 0 = 0.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrtestr</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> 0 0 0 ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrand0eq</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrand0ineq</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrand1eq</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="keyword">is</span> : <span class="id" title="var">isaprime</span> <span class="id" title="var">p</span> ) : 1 = ( ( <span class="id" title="var">p</span> * 0 ) + 1 ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultx0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusl0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrand1ineq</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="keyword">is</span> : <span class="id" title="var">isaprime</span> <span class="id" title="var">p</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzleh</span> 0 1 × <span class="id" title="var">hzlth</span> 1 ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">p</span> ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthtoleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthnsn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalgth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="keyword">is</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">istranshzgth</span> <span class="id" title="var">_</span> 1 <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="keyword">is</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzgthsnn</span> 0 ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrand1q</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="keyword">is</span> : <span class="id" title="var">isaprime</span> <span class="id" title="var">p</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) 1 = 0.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrtestq</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) 1 0 1 ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrand1eq</span> <span class="id" title="var">p</span> <span class="id" title="keyword">is</span> ).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrand1ineq</span> <span class="id" title="var">p</span> <span class="id" title="keyword">is</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrand1r</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="keyword">is</span> : <span class="id" title="var">isaprime</span> <span class="id" title="var">p</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) 1 = 1.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrtestr</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) 1 0 1 ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrand1eq</span> <span class="id" title="var">p</span> <span class="id" title="keyword">is</span> ).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrand1ineq</span> <span class="id" title="var">p</span> <span class="id" title="keyword">is</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrandselfeq</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) : <span class="id" title="var">p</span> = ( <span class="id" title="var">p</span> * 1 + 0 ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultr1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusr0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrandselfineq</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzleh</span> 0 0 × <span class="id" title="var">hzlth</span> 0 ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">p</span> ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isreflhzleh</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">lemmas.hzabsvalneq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrandselfq</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) : <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">p</span> = 1.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrtestq</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">p</span> 1 0 ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrandselfeq</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrandselfineq</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrandselfr</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) : <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">p</span> = 0.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrtestr</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">p</span> 1 0 ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrandselfeq</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrandselfineq</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrandpluseq</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) ( <span class="id" title="var">a</span> <span class="id" title="var">c</span> : <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;( <span class="id" title="var">a</span> + <span class="id" title="var">c</span> ) =<br/>
&nbsp;&nbsp;( ( <span class="id" title="var">p</span> * ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> + <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">c</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> + <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">c</span> ) ) ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ( ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> ) + ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">c</span> ) ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2! <span class="id" title="var">hzldistr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusassoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzdivequationmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> + <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">c</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusassoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzpluscomm</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzplusassoc</span> ( <span class="id" title="var">p</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">c</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzdivequationmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">c</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzpluscomm</span> <span class="id" title="var">c</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzplusassoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzdivequationmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrandplusineq</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) ( <span class="id" title="var">a</span> <span class="id" title="var">c</span> : <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzleh</span> 0 ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">c</span> ) ) ×<br/>
&nbsp;&nbsp;<span class="id" title="var">hzlth</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">c</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">p</span> ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzleh0remaindermod</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthremaindermodmod</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzremaindermodandplus</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) ( <span class="id" title="var">a</span> <span class="id" title="var">c</span> : <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> + <span class="id" title="var">c</span> ) =<br/>
&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> + <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">c</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrtest</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> + <span class="id" title="var">c</span> ) <span class="id" title="var">_</span> <span class="id" title="var">_</span> ( <span class="id" title="var">dirprodpair</span> ( <span class="id" title="var">hzqrandpluseq</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> <span class="id" title="var">c</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzqrandplusineq</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> <span class="id" title="var">c</span> ) ) ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzquotientmodandplus</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) ( <span class="id" title="var">a</span> <span class="id" title="var">c</span> : <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> + <span class="id" title="var">c</span> ) =<br/>
&nbsp;&nbsp;( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> + <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">c</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> + <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">c</span> ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrtest</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> + <span class="id" title="var">c</span> ) <span class="id" title="var">_</span> <span class="id" title="var">_</span> ( <span class="id" title="var">dirprodpair</span> ( <span class="id" title="var">hzqrandpluseq</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> <span class="id" title="var">c</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzqrandplusineq</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> <span class="id" title="var">c</span> ) ) ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrandtimeseq</span> ( <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">m</span> ) ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) =<br/>
&nbsp;&nbsp;( ( <span class="id" title="var">m</span> * ( ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ) <span class="id" title="var">a</span> * ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ) <span class="id" title="var">b</span> * <span class="id" title="var">m</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) * ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> ) * ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> * <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) ) ) ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> * <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 3! <span class="id" title="var">hzldistr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzplusassoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> * <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzdivequationmod</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzmultassoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">m</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzmultassoc</span> <span class="id" title="var">m</span> <span class="id" title="var">_</span> ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> * <span class="id" title="var">m</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzmultcomm</span> <span class="id" title="var">_</span> <span class="id" title="var">m</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( ((<span class="id" title="var">m</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> * (<span class="id" title="var">m</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span>))%<span class="id" title="var">hz</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">m</span> * (<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span>)%<span class="id" title="var">hz</span>)%<span class="id" title="tactic">ring</span> ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">m</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> * (<span class="id" title="var">m</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span>)) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">m</span> * (<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span>) )%<span class="id" title="var">hz</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(((<span class="id" title="var">m</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> * (<span class="id" title="var">m</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">m</span> * (<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span>))%<span class="id" title="var">hz</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">m</span> * (<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span>)%<span class="id" title="var">hz</span>)%<span class="id" title="tactic">ring</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> * <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span>) ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(((<span class="id" title="var">m</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> * (<span class="id" title="var">m</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">m</span> * (<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span>)) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">m</span> * (<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span>))%<span class="id" title="var">hz</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> * <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span>) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzplusassoc</span> ( <span class="id" title="var">m</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">m</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) ) <span class="id" title="var">_</span> <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzpluscomm</span> ( <span class="id" title="var">m</span> * ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">m</span> * ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzmultassoc</span> <span class="id" title="var">m</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> ) ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzmultcomm</span> <span class="id" title="var">m</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzmultassoc</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> ) <span class="id" title="var">m</span> ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzplusassoc</span> ( <span class="id" title="var">m</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> * ( <span class="id" title="var">m</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> * ( <span class="id" title="var">m</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) ) <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzrdistr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzdivequationmod</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusassoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzmultcomm</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzmultassoc</span> <span class="id" title="var">m</span> ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> ) ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzrdistr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzdivequationmod</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzldistr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzdivequationmod</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrandtimesineq</span> ( <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">m</span> ) ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzleh</span> 0 ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) ) ×<br/>
&nbsp;&nbsp;<span class="id" title="var">hzlth</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzleh0remaindermod</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthremaindermodmod</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzquotientmodandtimes</span> ( <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">m</span> ) ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) =<br/>
&nbsp;&nbsp;( ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ) <span class="id" title="var">a</span> * ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ) <span class="id" title="var">b</span> * <span class="id" title="var">m</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) * ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> ) * ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> * <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrtestq</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) <span class="id" title="var">_</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> * <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzqrandtimeseq</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzqrandtimesineq</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzremaindermodandtimes</span> ( <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">m</span> ) ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) =<br/>
&nbsp;&nbsp;( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> * <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrtestr</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ) <span class="id" title="var">a</span> * ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ) <span class="id" title="var">b</span> * <span class="id" title="var">m</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) * ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> ) * ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) ) ) <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzqrandtimeseq</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzqrandtimesineq</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrandremaindereq</span> ( <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="keyword">is</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">m</span> ) ( <span class="id" title="var">n</span> : <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">n</span> =<br/>
&nbsp;&nbsp;( ( <span class="id" title="var">m</span> * ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">dirprodpair</span> 0 ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">n</span> ) ) ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">pr2</span> ( <span class="id" title="var">dirprodpair</span> (@<span class="id" title="var">ringunel1</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">n</span> ) ) ) ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultx0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusl0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrandremainderineq</span> ( <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="keyword">is</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">m</span> ) ( <span class="id" title="var">n</span> : <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzleh</span> ( @<span class="id" title="var">ringunel1</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">n</span> ) ×<br/>
&nbsp;&nbsp;<span class="id" title="var">hzlth</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzleh0remaindermod</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthremaindermodmod</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzremaindermoditerated</span> ( <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="keyword">is</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">m</span> ) ( <span class="id" title="var">n</span> : <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">n</span> ) = ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">n</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrtestr</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">n</span> ) 0 ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzqrandremaindereq</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzqrandremainderineq</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrandremainderq</span> ( <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="keyword">is</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">m</span> ) ( <span class="id" title="var">n</span> : <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;0 = <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">n</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrtestq</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">n</span> ) 0 ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzqrandremaindereq</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzqrandremainderineq</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab700"></a><h1 class="section">III. THE EUCLIDEAN ALGORITHM</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">iscommonhzdiv</span> ( <span class="id" title="var">k</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">hzdiv</span> <span class="id" title="var">k</span> <span class="id" title="var">n</span> × <span class="id" title="var">hzdiv</span> <span class="id" title="var">k</span> <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isapropiscommonhzdiv</span> ( <span class="id" title="var">k</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) : <span class="id" title="var">isaprop</span> ( <span class="id" title="var">iscommonhzdiv</span> <span class="id" title="var">k</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">isaprop</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isofhleveldirprod</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzdiv</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzdiv</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hzgcd</span> ( <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) : <span class="id" title="var">UU</span> :=<br/>
&nbsp;&nbsp;∑ <span class="id" title="var">k</span> : <span class="id" title="var">hz</span>, <span class="id" title="var">iscommonhzdiv</span> <span class="id" title="var">k</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> ×<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> : <span class="id" title="var">hz</span>, <span class="id" title="var">iscommonhzdiv</span> <span class="id" title="var">l</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">hzleh</span> <span class="id" title="var">l</span> <span class="id" title="var">k</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isaprophzgcd0</span> ( <span class="id" title="var">k</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isaprop</span> ( <span class="id" title="var">iscommonhzdiv</span> <span class="id" title="var">k</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> ×<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> : <span class="id" title="var">hz</span>, <span class="id" title="var">iscommonhzdiv</span> <span class="id" title="var">l</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">hzleh</span> <span class="id" title="var">l</span> <span class="id" title="var">k</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isofhleveldirprod</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isapropiscommonhzdiv</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">impredfun</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzleh</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isaprophzgcd</span> ( <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) : <span class="id" title="var">isaprop</span> ( <span class="id" title="var">hzgcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">isofhlevel</span> 2 ( <span class="id" title="var">hzgcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">aux</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">isofhleveltotal2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isasethz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hlevelntosn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isofhleveldirprod</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">isapropiscommonhzdiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">impredfun</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzleh</span> <span class="id" title="var">t</span> <span class="id" title="var">x</span> ).<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">k</span> = <span class="id" title="var">l</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k</span> <span class="id" title="var">pq</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">pq</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">p</span> <span class="id" title="var">q</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> <span class="id" title="var">pq</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">pq</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">p'</span> <span class="id" title="var">q'</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">k</span> = <span class="id" title="var">l</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">f0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">isantisymmhzleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">q'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathintotalfiber</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">p0</span> := <span class="id" title="var">f0</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">isaprop</span> ( <span class="id" title="var">iscommonhzdiv</span> <span class="id" title="var">l</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> ×<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> : <span class="id" title="var">hz</span>, <span class="id" title="var">iscommonhzdiv</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">hzleh</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="keyword">is</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">isofhleveldirprod</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isapropiscommonhzdiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">impredfun</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzleh</span> <span class="id" title="var">t</span> <span class="id" title="var">l</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="keyword">is</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k</span> <span class="id" title="var">pq</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">pq</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">p</span> <span class="id" title="var">q</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> <span class="id" title="var">pq</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">pq</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">p'</span> <span class="id" title="var">q'</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">aux</span>.<br/>
</div>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzdivandmultl</span> ( <span class="id" title="var">a</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">p</span> : <span class="id" title="var">hzdiv</span> <span class="id" title="var">d</span> <span class="id" title="var">a</span> ) : <span class="id" title="var">hzdiv</span> <span class="id" title="var">d</span> ( <span class="id" title="var">c</span> * <span class="id" title="var">a</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k</span> <span class="id" title="var">f</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">c</span> * <span class="id" title="var">k</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzmultcomm</span> <span class="id" title="var">d</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultassoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzmultcomm</span> <span class="id" title="var">k</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzdivandmultr</span> ( <span class="id" title="var">a</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">p</span> : <span class="id" title="var">hzdiv</span> <span class="id" title="var">d</span> <span class="id" title="var">a</span> ) : <span class="id" title="var">hzdiv</span> <span class="id" title="var">d</span> ( <span class="id" title="var">a</span> * <span class="id" title="var">c</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultcomm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzdivandmultl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzdivandminus</span> ( <span class="id" title="var">a</span> <span class="id" title="var">d</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">p</span> : <span class="id" title="var">hzdiv</span> <span class="id" title="var">d</span> <span class="id" title="var">a</span> ) : <span class="id" title="var">hzdiv</span> <span class="id" title="var">d</span> ( - <span class="id" title="var">a</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k</span> <span class="id" title="var">f</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( - <span class="id" title="var">k</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringrmultminus</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">natgcd</span> ( <span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) : ( <span class="id" title="var">natneq</span> 0%<span class="id" title="var">nat</span> <span class="id" title="var">n</span> ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">natleh</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzgcd</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">E</span> := ( <span class="id" title="keyword">fun</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span> =&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">natneq</span> 0%<span class="id" title="var">nat</span> <span class="id" title="var">n</span> ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">natleh</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">hzgcd</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) ) ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">E</span> <span class="id" title="var">x</span> ) <span class="id" title="keyword">as</span> <span class="id" title="keyword">goal</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">stronginduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">x0</span> <span class="id" title="var">x1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">unfold</span> <span class="id" title="var">iscommonhzdiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultr1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultx0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nattohzand0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">l</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">t0</span> <span class="id" title="var">t1</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">hzgthorleh</span> <span class="id" title="var">l</span> 0 ) <span class="id" title="keyword">as</span> [ <span class="id" title="tactic">left</span> | <span class="id" title="tactic">right</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzabsvalgth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> <span class="id" title="var">nattohzandleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">t0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">t0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t2</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k</span> <span class="id" title="var">t2</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">t2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">natleh</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">l</span> ) <span class="id" title="var">n</span> ⨿ ( <span class="id" title="var">n</span> = 0%<span class="id" title="var">nat</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">C</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">natdivleh</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">l</span> ) <span class="id" title="var">n</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">k</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">isinclisinj</span> <span class="id" title="var">isinclnattohz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nattohzandmult</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2! <span class="id" title="var">hzabsvalgeh0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzgeh</span> ( <span class="id" title="var">l</span> * <span class="id" title="var">k</span> ) ( <span class="id" title="var">l</span> * 0 ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultx0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">t2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> 0 <span class="id" title="keyword">with</span> ( <span class="id" title="var">nattohz</span> 0%<span class="id" title="var">nat</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nattohzandgeh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">x1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzgehandmultlinv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">l</span> ); <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzgthtogeh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">C</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">C0</span> | <span class="id" title="var">C1</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">C1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">x0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">x0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> ( <span class="id" title="var">istranshzleh</span> <span class="id" title="var">_</span> 0 <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> 0 <span class="id" title="keyword">with</span> ( <span class="id" title="var">nattohz</span> 0%<span class="id" title="var">nat</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nattohzandleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">m</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzlth</span> 0 ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">p'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">change</span> 0 <span class="id" title="keyword">with</span> ( <span class="id" title="var">nattohz</span> 0%<span class="id" title="var">nat</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nattohzandlth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natneq0togth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">a</span> := <span class="id" title="var">divalgorithmnonneg</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">p'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">qr</span> <span class="id" title="var">a</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">qr</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">quot</span> <span class="id" title="var">rem</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">f</span> <span class="id" title="var">a</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">a</span> <span class="id" title="var">b</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">natlth</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">rem</span> ) <span class="id" title="var">m</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">p''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzabsvalandnattohz</span> <span class="id" title="var">m</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nattohzandlthinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2! <span class="id" title="var">hzabsvalgeh0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzgthtogeh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzgthgehtrans</span> <span class="id" title="var">_</span> <span class="id" title="var">rem</span> ); <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">natleh</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">rem</span> ) <span class="id" title="var">n</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">i''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">natlthtoleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nattohzandlthinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalgeh0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzlthlehtrans</span> <span class="id" title="var">_</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">nattohzandleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">natneq</span> 0%<span class="id" title="var">nat</span> <span class="id" title="var">m</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">p'''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">issymm_natneq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">q</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">rem</span> ) <span class="id" title="var">p''</span> <span class="id" title="var">m</span> <span class="id" title="var">p'''</span> ( <span class="id" title="var">natlthtoleh</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">p''</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [ <span class="id" title="var">rr</span> <span class="id" title="var">c</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">c0</span> <span class="id" title="var">c1</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">rr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzdivlinearcombright</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> * <span class="id" title="var">quot</span> ) <span class="id" title="var">rem</span> <span class="id" title="var">rr</span> <span class="id" title="var">f</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzdivandmultr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">c0</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalgeh0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">c0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">c0</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exact</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">c0</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">l</span> <span class="id" title="var">o</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">c1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exact</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">o</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalgeh0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzdivlinearcombleft</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> * <span class="id" title="var">quot</span> ) <span class="id" title="var">rem</span> <span class="id" title="var">l</span> <span class="id" title="var">f</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">exact</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">o</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzdivandmultr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">o</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzgcdandminusl</span> ( <span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">hz</span> ) : <span class="id" title="var">hzgcd</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> = <span class="id" title="var">hzgcd</span> ( - <span class="id" title="var">m</span> ) <span class="id" title="var">n</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hProppair</span> ( <span class="id" title="var">hzgcd</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">isaprophzgcd</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= ( <span class="id" title="var">hProppair</span> ( <span class="id" title="var">hzgcd</span> ( - <span class="id" title="var">m</span> ) <span class="id" title="var">n</span> ) ( <span class="id" title="var">isaprophzgcd</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ) ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">hPropUnivalence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">a</span> <span class="id" title="var">i</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">i0</span> <span class="id" title="var">i1</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">i0</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">j0</span> <span class="id" title="var">j1</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">j0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k</span> <span class="id" title="var">f</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( - <span class="id" title="var">k</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringrmultminus</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">l</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">i1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">f</span> )).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k</span> <span class="id" title="var">g</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( - <span class="id" title="var">k</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringrmultminus</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">ringminusminus</span> <span class="id" title="var">hz</span> <span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exact</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">f</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">a</span> <span class="id" title="var">i</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">i0</span> <span class="id" title="var">i1</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">i0</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">j0</span> <span class="id" title="var">j1</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">j0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k</span> <span class="id" title="var">f</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( - <span class="id" title="var">k</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringrmultminus</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">ringminusminus</span> <span class="id" title="var">hz</span> <span class="id" title="var">m</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">l</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">i1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">f</span> )).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k</span> <span class="id" title="var">g</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( - <span class="id" title="var">k</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">ringrmultminus</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exact</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">f</span> ).<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pathintotalpr1</span> <span class="id" title="var">x</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzgcdsymm</span> ( <span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">hz</span> ) : <span class="id" title="var">hzgcd</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> = <span class="id" title="var">hzgcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hProppair</span> ( <span class="id" title="var">hzgcd</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">isaprophzgcd</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hProppair</span> ( <span class="id" title="var">hzgcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> ) ( <span class="id" title="var">isaprophzgcd</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ) ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">hPropUnivalence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">a</span> <span class="id" title="var">i</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">i0</span> <span class="id" title="var">i1</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">i0</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">j0</span> <span class="id" title="var">j1</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">l</span> <span class="id" title="var">o</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">i1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exact</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">o</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exact</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">o</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">a</span> <span class="id" title="var">i</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">i0</span> <span class="id" title="var">i1</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">i0</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">j0</span> <span class="id" title="var">j1</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">l</span> <span class="id" title="var">o</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">i1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exact</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">o</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exact</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">o</span> ).<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pathintotalpr1</span> <span class="id" title="var">x</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzgcdandminusr</span> ( <span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">hz</span> ) : <span class="id" title="var">hzgcd</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> = <span class="id" title="var">hzgcd</span> <span class="id" title="var">m</span> ( - <span class="id" title="var">n</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2! ( <span class="id" title="var">hzgcdsymm</span> <span class="id" title="var">m</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzgcdandminusl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">euclidean</span> ( <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">i</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">n</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">p</span> : <span class="id" title="var">natleh</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">n</span> ) ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzgcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">natneq</span> 0%<span class="id" title="var">nat</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">n</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;{ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">issymm_natneq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzabsvalneq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">x</span> <span class="id" title="tactic">in</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">a</span> := <span class="id" title="var">natgcd</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">n</span> ) <span class="id" title="var">j</span> <span class="id" title="var">p</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">hzlthorgeh</span> 0 <span class="id" title="var">n</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">left_n</span> | <span class="id" title="var">right_n</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> ( <span class="id" title="var">hzlthorgeh</span> 0 <span class="id" title="var">m</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">left_m</span> | <span class="id" title="var">right_m</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> 2! ( <span class="id" title="var">hzabsvalgth0</span> ) <span class="id" title="tactic">in</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalgth0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalleh0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzgcdandminusr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> ( <span class="id" title="var">hzlthorgeh</span> 0 <span class="id" title="var">m</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">left_m</span> | <span class="id" title="var">right_m</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzabsvalgth0</span> <span class="id" title="var">left_m</span> ) <span class="id" title="tactic">in</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalleh0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzgcdandminusl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> 2! <span class="id" title="var">hzabsvalleh0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzgcdandminusl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzgcdandminusr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">euclideanalgorithm</span> ( <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">i</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">n</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">iscontr</span> ( <span class="id" title="var">hzgcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">natgthorleh</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">n</span> ) ) <span class="id" title="keyword">as</span> [ <span class="id" title="tactic">left</span> | <span class="id" title="tactic">right</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">m</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">i'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">negnatlthn0</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">f</span> <span class="id" title="tactic">in</span> <span class="id" title="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsval0</span> <span class="id" title="tactic">in</span> <span class="id" title="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">a</span> := <span class="id" title="var">euclidean</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">i'</span> ( <span class="id" title="var">natlthtoleh</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="tactic">left</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzgcdsymm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isaprophzgcd</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">euclidean</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> <span class="id" title="tactic">right</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isaprophzgcd</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">gcd</span> ( <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">i</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">n</span> ) : <span class="id" title="var">hz</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">pr1</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">euclideanalgorithm</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> ) ).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">gcdiscommondiv</span> ( <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">i</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">n</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">iscommonhzdiv</span> (<span class="id" title="var">gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span>) <span class="id" title="var">n</span> <span class="id" title="var">m</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">pr1</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">euclideanalgorithm</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> ) ) ).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">gcdisgreatest</span> ( <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">i</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">n</span> ):<br/>
&nbsp;&nbsp;∏ <span class="id" title="var">l</span> : <span class="id" title="var">hz</span>, <span class="id" title="var">iscommonhzdiv</span> <span class="id" title="var">l</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> → <span class="id" title="var">hzleh</span> <span class="id" title="var">l</span> (<span class="id" title="var">gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">pr2</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">euclideanalgorithm</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> ) ) ).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzdivand0</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">hz</span> ) : <span class="id" title="var">hzdiv</span> <span class="id" title="var">n</span> 0.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> 0.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzmultx0</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nozerodiv</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">i</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">n</span> ) : <span class="id" title="var">neg</span> ( <span class="id" title="var">hzdiv</span> 0 <span class="id" title="var">n</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzneq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">i</span>. &nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">p</span> ( <span class="id" title="var">hProppair</span> ( 0 = <span class="id" title="var">n</span> ) ( <span class="id" title="var">isasethz</span> 0 <span class="id" title="var">n</span> ) ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k</span> <span class="id" title="var">f</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzmult0x</span> ) <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab701"></a><h1 class="section">IV. Bezout's lemma and the commutative ring Z/pZ</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">commonhzdivsignswap</span> ( <span class="id" title="var">k</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">p</span> : <span class="id" title="var">iscommonhzdiv</span> <span class="id" title="var">k</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">iscommonhzdiv</span> ( - <span class="id" title="var">k</span> ) <span class="id" title="var">n</span> <span class="id" title="var">m</span> .<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">p0</span> <span class="id" title="var">p1</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">p0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> <span class="id" title="var">f</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( - <span class="id" title="var">l</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">k</span> * <span class="id" title="var">l</span> ) <span class="id" title="keyword">with</span> ( <span class="id" title="var">k</span> * <span class="id" title="var">l</span> )%<span class="id" title="tactic">ring</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">ringmultminusminus</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">p1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> <span class="id" title="var">f</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( - <span class="id" title="var">l</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">k</span> * <span class="id" title="var">l</span> ) <span class="id" title="keyword">with</span> ( <span class="id" title="var">k</span> * <span class="id" title="var">l</span> )%<span class="id" title="tactic">ring</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">ringmultminusminus</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gcdneq0</span> ( <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">i</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">n</span> ) : <span class="id" title="var">hzneq</span> 0 ( <span class="id" title="var">gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">nozerodiv</span> <span class="id" title="var">n</span> ).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">gcdiscommondiv</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> ) ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gcdpositive</span> ( <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">i</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">n</span> ) : <span class="id" title="var">hzlth</span> 0 ( <span class="id" title="var">gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">hzneqchoice</span> 0 ( <span class="id" title="var">gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">gcdneq0</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> ) ) <span class="id" title="keyword">as</span> [ <span class="id" title="tactic">left</span> | <span class="id" title="tactic">right</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzleh</span> ( - ( <span class="id" title="var">gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> ) ) ( <span class="id" title="var">gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">i0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">gcdisgreatest</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">commonhzdivsignswap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ( <span class="id" title="var">gcdiscommondiv</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">isirreflhzlth</span> 0 ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">istranshzlth</span> <span class="id" title="var">_</span> ( - ( <span class="id" title="var">gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> ) ) <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzlth0andminus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzlehlthtrans</span> <span class="id" title="var">_</span> ( <span class="id" title="var">gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> ) <span class="id" title="var">_</span> ); <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gcdanddiv</span> ( <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">i</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">n</span> ) ( <span class="id" title="var">p</span> : <span class="id" title="var">hzdiv</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> ) :<br/>
&nbsp;&nbsp;( <span class="id" title="var">gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> = <span class="id" title="var">n</span> )  ⨿ ( <span class="id" title="var">gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> = - <span class="id" title="var">n</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">hzneqchoice</span> 0 <span class="id" title="var">n</span> <span class="id" title="var">i</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="tactic">left</span> | <span class="id" title="tactic">right</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isantisymmhzleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzdivhzabsval</span> ( <span class="id" title="var">gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> ) <span class="id" title="var">n</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">gcdiscommondiv</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> ) ) )).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">c'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">c'</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">c0</span> | <span class="id" title="var">c1</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzabsvalgeh0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzabsvallth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> <span class="id" title="var">nattohzandleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzgthtogeh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">gcdpositive</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">n</span> = 0 ) <span class="id" title="keyword">as</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvaleq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzneq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">i</span>. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">gcdisgreatest</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">commonhzdivsignswap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">hzdivisrefl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isantisymmhzleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzdivhzabsval</span> ( <span class="id" title="var">gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> ) <span class="id" title="var">n</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">gcdiscommondiv</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> ) ) )).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">c'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">c'</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">c0</span> | <span class="id" title="var">c1</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzabsvalgth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">assert</span> ( <span class="id" title="var">n</span> = <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">n</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzabsvalgth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzleh</span> ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> ( <span class="id" title="var">gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> ) ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">n</span> ) ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">nattohzandleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ( <span class="id" title="var">transportf</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzleh</span> ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> ( <span class="id" title="var">gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> ) ) ) <span class="id" title="var">x</span> ) ( <span class="id" title="var">pathsinv0</span> <span class="id" title="var">f</span> ) <span class="id" title="var">j</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> <span class="id" title="var">gcdpositive</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzneq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">i</span>. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvaleq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">gcdisgreatest</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">hzdivisrefl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gcdand0</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">i</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">n</span> ) :<br/>
&nbsp;&nbsp;( <span class="id" title="var">gcd</span> <span class="id" title="var">n</span> 0 <span class="id" title="var">i</span> = <span class="id" title="var">n</span> ) ⨿ ( <span class="id" title="var">gcd</span> <span class="id" title="var">n</span> 0 <span class="id" title="var">i</span> = - <span class="id" title="var">n</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">gcdanddiv</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzdivand0</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">natbezoutstrong</span> ( <span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) ( <span class="id" title="var">i</span> : <span class="id" title="var">hzneq</span> 0 ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ) :<br/>
&nbsp;&nbsp;∑ <span class="id" title="var">ab</span> : <span class="id" title="var">hz</span> × <span class="id" title="var">hz</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">gcd</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">i</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr1</span> <span class="id" title="var">ab</span> * <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> + <span class="id" title="var">pr2</span> <span class="id" title="var">ab</span> * <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">E</span> := ( <span class="id" title="keyword">fun</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span> =&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">i</span> : <span class="id" title="var">hzneq</span> 0 ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∑ <span class="id" title="var">ab</span> : <span class="id" title="var">hz</span> × <span class="id" title="var">hz</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">gcd</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">i</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr1</span> <span class="id" title="var">ab</span> * <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> + <span class="id" title="var">pr2</span> <span class="id" title="var">ab</span> * <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">E</span> <span class="id" title="var">x</span> ) <span class="id" title="keyword">as</span> <span class="id" title="keyword">goal</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">stronginduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">dirprodpair</span> 1 0 ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nattohzand0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">gcdand0</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) <span class="id" title="var">i</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="tactic">left</span> | <span class="id" title="tactic">right</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultl1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusr0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">isirreflhzlth</span> ( <span class="id" title="var">gcd</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) 0 <span class="id" title="var">i</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">istranshzlth</span> <span class="id" title="var">_</span> 0 <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <span class="id" title="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzgth0andminus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> 0 <span class="id" title="keyword">with</span> ( <span class="id" title="var">nattohz</span> 0%<span class="id" title="var">nat</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nattohzandgth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natneq0togth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">natneq_iff_neq</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)). &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzneq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">i</span>. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">gcdpositive</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzneq</span> 0 ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">aux</span> := <span class="id" title="var">pr2</span> (<span class="id" title="var">natneq_iff_neq</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">x</span>). &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">aux</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzabsvalandnattohz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> 0%<span class="id" title="var">nat</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">hzabsval</span> ( <span class="id" title="var">nattohz</span> 0%<span class="id" title="var">nat</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">r</span> := <span class="id" title="var">hzremaindermod</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">p</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">q</span> := <span class="id" title="var">hzquotientmod</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">p</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">natlth</span> (<span class="id" title="var">hzabsval</span> <span class="id" title="var">r</span> ) <span class="id" title="var">m</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">p'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzabsvalandnattohz</span> <span class="id" title="var">m</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzabsvalandlth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> ( <span class="id" title="var">hzleh0remaindermod</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">p</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">unfold</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzabsvalgeh0</span> ( <span class="id" title="var">hzleh0remaindermod</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">p</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nattohzandlth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">natlth</span> ( <span class="id" title="var">hzabsval</span> ( <span class="id" title="var">hzremaindermod</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">p</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzabsval</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">ii</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzabsvalandlth</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exact</span> ( <span class="id" title="var">hzleh0remaindermod</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">p</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assert</span> ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) ) = <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzabsvalandnattohz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ( <span class="id" title="var">transportf</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzlth</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzremaindermod</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">p</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ) <span class="id" title="var">x</span> ) <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzlthremaindermodmod</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">p</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ( <span class="id" title="var">transportf</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">natlth</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzabsval</span> ( <span class="id" title="var">hzremaindermod</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">p</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzabsvalandnattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">ii</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">c</span> := <span class="id" title="var">y</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">r</span> ) <span class="id" title="var">p'</span> <span class="id" title="var">m</span> <span class="id" title="var">p</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">ab</span> <span class="id" title="var">f</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ab</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">a</span> <span class="id" title="var">b</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">dirprodpair</span> <span class="id" title="var">b</span> ( <span class="id" title="var">a</span> - <span class="id" title="var">b</span> * <span class="id" title="var">q</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">gcd</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">r</span> ) ) <span class="id" title="var">p</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">gcd</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">i</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">isantisymmhzleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">gcdisgreatest</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">i</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzdivlinearcombright</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> * <span class="id" title="var">hzquotientmod</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">p</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ) <span class="id" title="var">r</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">exact</span> ( <span class="id" title="var">hzdivequationmod</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">p</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzdivandmultr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">gcdiscommondiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">unfold</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzabsvalgeh0</span> ( <span class="id" title="var">hzleh0remaindermod</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">p</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ) ) .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">gcdiscommondiv</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzremaindermod</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">p</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ) <span class="id" title="var">p</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">gcdiscommondiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">gcdisgreatest</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">gcdiscommondiv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzdivlinearcombleft</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">p</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ) ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">r</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">unfold</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzabsvalgeh0</span> ( <span class="id" title="var">hzleh0remaindermod</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">p</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ( <span class="id" title="var">hzdivequationmod</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">p</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> <span class="id" title="var">gcdiscommondiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzdivandmultr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">gcdiscommondiv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">r</span> ) = ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span>  - ( <span class="id" title="var">q</span> * <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzdivequationmod</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">p</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">hzquotientmod</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">p</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ) <span class="id" title="keyword">with</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">hzremaindermod</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">p</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ) <span class="id" title="keyword">with</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzpluscomm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">r</span> + <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> * <span class="id" title="var">q</span> - <span class="id" title="var">q</span> * <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( ( <span class="id" title="var">r</span> + <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> * <span class="id" title="var">q</span> ) + ( - ( <span class="id" title="var">q</span> * <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultcomm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusassoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">intermediate_path</span> (<span class="id" title="var">r</span> + 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusr0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzabsvalgeh0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzleh0remaindermod</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) <span class="id" title="var">p</span> ( <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">hzrminus</span> (<span class="id" title="var">q</span> * <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( (<span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> - <span class="id" title="var">q</span> * <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span>) ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( (<span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> + ( - ( <span class="id" title="var">q</span> * <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span>) ) ) ) <span class="id" title="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringldistr</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzplusassoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzpluscomm</span> ( <span class="id" title="var">a</span> * <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">ringrmultminus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzmultassoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">ringlmultminus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusassoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">ringrdistr</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">b</span> * <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span> + (<span class="id" title="var">a</span> - <span class="id" title="var">b</span> * <span class="id" title="var">q</span>) * <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">b</span> * <span class="id" title="var">nattohz</span> <span class="id" title="var">n</span>)%<span class="id" title="tactic">ring</span> + ((<span class="id" title="var">a</span> + - (<span class="id" title="var">b</span> * <span class="id" title="var">q</span>)%<span class="id" title="var">hz</span>) * <span class="id" title="var">nattohz</span> <span class="id" title="var">m</span>)%<span class="id" title="tactic">ring</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="keyword">goal</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">divandhzabsval</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">hz</span> ) : <span class="id" title="var">hzdiv</span> <span class="id" title="var">n</span> ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">n</span> ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">hzlthorgeh</span> 0 <span class="id" title="var">n</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="tactic">left</span> | <span class="id" title="tactic">right</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultr1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalgth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( - 1%<span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringrmultminus</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultr1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalleh0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bezoutstrong</span> ( <span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">i</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">n</span> ) :<br/>
&nbsp;&nbsp;∑ <span class="id" title="var">ab</span> : <span class="id" title="var">hz</span> × <span class="id" title="var">hz</span>, <span class="id" title="var">gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> = <span class="id" title="var">pr1</span> <span class="id" title="var">ab</span>  * <span class="id" title="var">n</span> + <span class="id" title="var">pr2</span> <span class="id" title="var">ab</span>  * <span class="id" title="var">m</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzneq</span> 0 ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">n</span> ) ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">i'</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzneq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">i</span>. &nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">hzneqchoice</span> 0 <span class="id" title="var">n</span> <span class="id" title="var">i</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="tactic">left</span> | <span class="id" title="tactic">right</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvallth0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">ringminusminus</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> 0 <span class="id" title="keyword">with</span> ( - - 0 ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalgth0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">c</span> := (<span class="id" title="var">natbezoutstrong</span> (<span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span>) (<span class="id" title="var">hzabsval</span> <span class="id" title="var">n</span>) <span class="id" title="var">i'</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">ab</span> <span class="id" title="var">f</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ab</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">a</span> <span class="id" title="var">b</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">gcd</span> ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">n</span> ) ) ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) ) <span class="id" title="var">i'</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> ( <span class="id" title="var">hzneqchoice</span> 0 <span class="id" title="var">n</span> <span class="id" title="var">i</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">left_n</span> | <span class="id" title="var">right_n</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isantisymmhzleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">gcdisgreatest</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvallth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzdivandminus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">gcdiscommondiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">destruct</span> ( <span class="id" title="var">hzlthorgeh</span> 0 <span class="id" title="var">m</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">left_m</span> | <span class="id" title="var">right_m</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalgth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">gcdiscommondiv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalleh0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzdivandminus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">gcdiscommondiv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">gcdisgreatest</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzdivistrans</span> <span class="id" title="var">_</span> ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">n</span> ) ) <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> <span class="id" title="var">gcdiscommondiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvallth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">ringminusminus</span> <span class="id" title="var">hz</span> <span class="id" title="var">n</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzdivandminus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringminusminus</span> <span class="id" title="var">hz</span> <span class="id" title="var">n</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzdivisrefl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzdivistrans</span> <span class="id" title="var">_</span> ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) ) <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">gcdiscommondiv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">destruct</span> ( <span class="id" title="var">hzlthorgeh</span> 0 <span class="id" title="var">m</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">left_m</span> | <span class="id" title="var">right_m</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalgth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">apply</span> <span class="id" title="var">hzdivisrefl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalleh0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">ringminusminus</span> <span class="id" title="var">hz</span> <span class="id" title="var">m</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzdivandminus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringminusminus</span> <span class="id" title="var">hz</span> <span class="id" title="var">m</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzdivisrefl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isantisymmhzleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">gcdisgreatest</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalgth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> <span class="id" title="var">gcdiscommondiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzdivistrans</span> <span class="id" title="var">_</span> ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) ) <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">destruct</span> ( <span class="id" title="var">hzlthorgeh</span> 0 <span class="id" title="var">m</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">left_m</span> | <span class="id" title="var">right_m</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalgth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">gcdiscommondiv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalleh0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">apply</span> <span class="id" title="var">hzdivandminus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">gcdiscommondiv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzdivisrefl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">gcdisgreatest</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzdivistrans</span> <span class="id" title="var">_</span> ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">n</span> ) ) <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> <span class="id" title="var">gcdiscommondiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalgth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzdivisrefl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzdivistrans</span> <span class="id" title="var">_</span> ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) ) <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">gcdiscommondiv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">destruct</span> ( <span class="id" title="var">hzlthorgeh</span> 0 <span class="id" title="var">m</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">left_m</span> | <span class="id" title="var">right_m</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalgth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">apply</span> <span class="id" title="var">hzdivisrefl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalleh0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">ringminusminus</span> <span class="id" title="var">hz</span> <span class="id" title="var">m</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzdivandminus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringminusminus</span> <span class="id" title="var">hz</span> <span class="id" title="var">m</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzdivisrefl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">hzneqchoice</span> 0 <span class="id" title="var">n</span> <span class="id" title="var">i</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">left_n</span> | <span class="id" title="var">right_n</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> ( <span class="id" title="var">hzlthorgeh</span> 0 <span class="id" title="var">m</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">left_m</span> | <span class="id" title="var">right_m</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">dirprodpair</span> ( - <span class="id" title="var">a</span> ) <span class="id" title="var">b</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( - <span class="id" title="var">a</span> * <span class="id" title="var">n</span> + <span class="id" title="var">b</span> * <span class="id" title="var">m</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">a</span> * <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">n</span> ) + <span class="id" title="var">b</span> * <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvallth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalgth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringlmultminus</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">ringrmultminus</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">dirprodpair</span> ( - <span class="id" title="var">a</span> ) ( - <span class="id" title="var">b</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2! ( <span class="id" title="var">ringlmultminus</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- 2! ( <span class="id" title="var">ringrmultminus</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzabsvallth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzabsvalleh0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> ( <span class="id" title="var">hzlthorgeh</span> 0 <span class="id" title="var">m</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">left_m</span> | <span class="id" title="var">right_m</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">dirprodpair</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2! <span class="id" title="var">hzabsvalgth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">dirprodpair</span> <span class="id" title="var">a</span> ( - <span class="id" title="var">b</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalgth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalleh0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringrmultminus</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">ringlmultminus</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab702"></a><h1 class="section">V. Z/nZ</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzmodisaprop</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) ( <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isaprop</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> = <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isasethz</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hzmod</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) : <span class="id" title="var">hrel</span> <span class="id" title="var">hz</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ( <span class="id" title="var">hProppair</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> = <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzmodisaprop</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> ) ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzmodisrefl</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) : <span class="id" title="var">isrefl</span> ( <span class="id" title="var">hzmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">isrefl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzmod</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> = <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">a</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzmodissymm</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) : <span class="id" title="var">issymm</span> ( <span class="id" title="var">hzmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">issymm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzmod</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> = <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">exact</span> ( <span class="id" title="var">pathsinv0</span> <span class="id" title="var">v</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">a</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzmodistrans</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) : <span class="id" title="var">istrans</span> ( <span class="id" title="var">hzmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">istrans</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzmod</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzmod</span> <span class="id" title="tactic">in</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzmod</span> <span class="id" title="tactic">in</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> = <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">k</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">exact</span> ( <span class="id" title="var">pathscomp0</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">a</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzmodiseqrel</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) : <span class="id" title="var">iseqrel</span> ( <span class="id" title="var">hzmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">iseqrelconstr</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> ( <span class="id" title="var">hzmodistrans</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> ( <span class="id" title="var">hzmodisrefl</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> ( <span class="id" title="var">hzmodissymm</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzmodcompatmultl</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> : <span class="id" title="var">hz</span>, <span class="id" title="var">hzmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> -&gt; <span class="id" title="var">hzmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ( <span class="id" title="var">c</span> * <span class="id" title="var">a</span> ) ( <span class="id" title="var">c</span> * <span class="id" title="var">b</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzmod</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> (<span class="id" title="var">c</span> * <span class="id" title="var">a</span>) = <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> (<span class="id" title="var">c</span> * <span class="id" title="var">b</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermodandtimes</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzremaindermodandtimes</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzmodcompatmultr</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) :<br/>
<span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> : <span class="id" title="var">hz</span>, <span class="id" title="var">hzmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> -&gt; <span class="id" title="var">hzmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> * <span class="id" title="var">c</span> ) ( <span class="id" title="var">b</span> * <span class="id" title="var">c</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultcomm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzmultcomm</span> <span class="id" title="var">b</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzmodcompatmultl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzmodcompatplusl</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> : <span class="id" title="var">hz</span>, <span class="id" title="var">hzmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> -&gt; <span class="id" title="var">hzmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ( <span class="id" title="var">c</span> + <span class="id" title="var">a</span> ) ( <span class="id" title="var">c</span> + <span class="id" title="var">b</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzmod</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ( <span class="id" title="var">c</span> + <span class="id" title="var">a</span> ) = <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ( <span class="id" title="var">c</span> + <span class="id" title="var">b</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermodandplus</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzremaindermodandplus</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzmodcompatplusr</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> : <span class="id" title="var">hz</span>, <span class="id" title="var">hzmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> -&gt; <span class="id" title="var">hzmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> + <span class="id" title="var">c</span> ) ( <span class="id" title="var">b</span> + <span class="id" title="var">c</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzpluscomm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzpluscomm</span> <span class="id" title="var">b</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzmodcompatplusl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzmodisringeqrel</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) : <span class="id" title="var">ringeqrel</span> ( <span class="id" title="var">X</span> := <span class="id" title="var">hz</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">tpair</span> ( <span class="id" title="var">hzmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ) ( <span class="id" title="var">hzmodiseqrel</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzmodcompatplusl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzmodcompatplusr</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzmodcompatmultl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzmodcompatmultr</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hzmodp</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">commringquot</span> ( <span class="id" title="var">hzmodisringeqrel</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isdeceqhzmodp</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) : <span class="id" title="var">isdeceq</span> ( <span class="id" title="var">hzmodp</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">isdeceqsetquot</span> ( <span class="id" title="var">hzmodisringeqrel</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">isdecprop</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> ( <span class="id" title="var">isdeceqhz</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> | <span class="id" title="var">r</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">unfold</span> <span class="id" title="var">hzmodisringeqrel</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">ii1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">isasethz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">unfold</span> <span class="id" title="var">hzmodisringeqrel</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">ii2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">isasethz</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">acommring_hzmod</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) : <span class="id" title="var">acommring</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">hzmodp</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">tpair</span> <span class="id" title="var">_</span> ( <span class="id" title="var">deceqtoneqapart</span> ( <span class="id" title="var">isdeceqhzmodp</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ) ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzremaindermodanddiv</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) ( <span class="id" title="var">a</span> : <span class="id" title="var">hz</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">y</span> : <span class="id" title="var">hzdiv</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span> ) : <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> = 0.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">isaprop</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> = 0 ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">v</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">isasethz</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">y</span> ( <span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> <span class="id" title="var">v</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k</span> <span class="id" title="var">f</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">a</span> = <span class="id" title="var">p</span> * <span class="id" title="var">k</span> + 0 ) <span class="id" title="keyword">as</span> <span class="id" title="var">f'</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusr0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">e</span> := <span class="id" title="var">tpair</span> ( <span class="id" title="var">P</span> := (<span class="id" title="keyword">fun</span> <span class="id" title="var">qr</span> : <span class="id" title="var">hz</span> × <span class="id" title="var">hz</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> = <span class="id" title="var">p</span> * <span class="id" title="var">pr1</span> <span class="id" title="var">qr</span> + <span class="id" title="var">pr2</span> <span class="id" title="var">qr</span> ×<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzleh</span> 0 (<span class="id" title="var">pr2</span> <span class="id" title="var">qr</span>) ×<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzlth</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">qr</span>) (<span class="id" title="var">nattohz</span> (<span class="id" title="var">hzabsval</span> <span class="id" title="var">p</span>)))) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">dirprodpair</span> <span class="id" title="var">k</span> 0 ) (<span class="id" title="var">dirprodpair</span> <span class="id" title="var">f'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">dirprodpair</span> ( <span class="id" title="var">isreflhzleh</span> 0 ) ( <span class="id" title="var">lemmas.hzabsvalneq0</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ) ) ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">e</span> = <span class="id" title="var">pr1</span> ( <span class="id" title="var">divalgorithm</span> <span class="id" title="var">a</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">s</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">divalgorithm</span> <span class="id" title="var">a</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">w</span> := <span class="id" title="var">pathintotalpr1</span> ( <span class="id" title="var">pathsinv0</span> <span class="id" title="var">s</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzremaindermod</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">maponpaths</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">z</span> : <span class="id" title="var">hz</span> × <span class="id" title="var">hz</span> =&gt; <span class="id" title="var">pr2</span> <span class="id" title="var">z</span> ) <span class="id" title="var">w</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gcdandprime</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) ( <span class="id" title="var">y</span> : <span class="id" title="var">isaprime</span> <span class="id" title="var">p</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">a</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">q</span> : <span class="id" title="var">neg</span> ( <span class="id" title="var">hzmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> 0 ) ) : <span class="id" title="var">gcd</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> = 1.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">isaprop</span> ( <span class="id" title="var">gcd</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> = 1) ) <span class="id" title="keyword">as</span> <span class="id" title="keyword">is</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">isasethz</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">y</span> ( <span class="id" title="var">gcd</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">pr1</span> ( <span class="id" title="var">gcdiscommondiv</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> ) ) (<span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> <span class="id" title="keyword">is</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">t0</span> | <span class="id" title="var">t1</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">t0</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> = 0 ) <span class="id" title="keyword">as</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzdiv</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">t1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">gcdiscommondiv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermodanddiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrand0r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzremaindermodandmultl</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ( <span class="id" title="var">p</span> * <span class="id" title="var">a</span> + <span class="id" title="var">b</span> ) = <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">p</span> * <span class="id" title="var">a</span> + <span class="id" title="var">b</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">p</span> * ( <span class="id" title="var">a</span> + <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) + <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzldistr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusassoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzdivequationmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermodandplus</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermodandtimes</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrandselfr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmult0x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrand0r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusl0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermoditerated</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzmodprimeinv</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">p</span> ) ( <span class="id" title="var">y</span> : <span class="id" title="var">isaprime</span> <span class="id" title="var">p</span> )<br/>
&nbsp;&nbsp;( <span class="id" title="var">a</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">q</span> : <span class="id" title="var">neg</span> ( <span class="id" title="var">hzmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> 0 ) ) :<br/>
&nbsp;&nbsp;∑ <span class="id" title="var">v</span> : <span class="id" title="var">hz</span>, <span class="id" title="var">hzmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> * <span class="id" title="var">v</span> ) 1 × <span class="id" title="var">hzmod</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ( <span class="id" title="var">v</span> * <span class="id" title="var">a</span> ) 1.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">bezoutstrong</span> <span class="id" title="var">a</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ) ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( 1 = <span class="id" title="var">pr1</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">bezoutstrong</span> <span class="id" title="var">a</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span>)) * <span class="id" title="var">p</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr2</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">bezoutstrong</span> <span class="id" title="var">a</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span>)) * <span class="id" title="var">a</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">f'</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">assert</span> ( 1 = <span class="id" title="var">gcd</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">f''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">gcdandprime</span>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">bezoutstrong</span> <span class="id" title="var">a</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ).<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">f'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzmultcomm</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">bezoutstrong</span> <span class="id" title="var">a</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> ) ) ) <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermodandmultl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultcomm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">f'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermodandplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzremaindermodandtimes</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">_</span> <span class="id" title="var">p</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrandselfr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultx0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrand0r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusl0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermoditerated</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">quotientringsumdecom</span> ( <span class="id" title="var">X</span> : <span class="id" title="var">commring</span> ) ( <span class="id" title="var">R</span> : <span class="id" title="var">ringeqrel</span> ( <span class="id" title="var">X</span> := <span class="id" title="var">X</span> ) ) ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">X</span> ) :<br/>
&nbsp;&nbsp;@<span class="id" title="var">op2</span> ( <span class="id" title="var">commringquot</span> <span class="id" title="var">R</span> ) ( <span class="id" title="var">setquotpr</span> <span class="id" title="var">R</span> <span class="id" title="var">a</span> ) ( <span class="id" title="var">setquotpr</span> <span class="id" title="var">R</span> <span class="id" title="var">b</span> ) =<br/>
&nbsp;&nbsp;( <span class="id" title="var">setquotpr</span> <span class="id" title="var">R</span> ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> )%<span class="id" title="tactic">ring</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ahzmod</span> ( <span class="id" title="var">p</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">y</span> : <span class="id" title="var">isaprime</span> <span class="id" title="var">p</span> ) : <span class="id" title="var">afld</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">acommring_hzmod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">isirreflhzlth</span> 0 ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzlth</span> 0 1 ) <span class="id" title="keyword">as</span> <span class="id" title="var">i</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthnsn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( 1%<span class="id" title="tactic">ring</span> ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">setquotpr</span> ( <span class="id" title="var">hzmodisringeqrel</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ) ) 1%<span class="id" title="var">hz</span> ) <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( 0%<span class="id" title="tactic">ring</span> ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">setquotpr</span> ( <span class="id" title="var">hzmodisringeqrel</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ) ) 0%<span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzmodisringeqrel</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ) 1%<span class="id" title="var">hz</span> 0%<span class="id" title="var">hz</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">o</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">setquotprpathsandR</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzmodisringeqrel</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ) ) 1%<span class="id" title="var">hz</span> 0%<span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzmodisringeqrel</span> <span class="id" title="tactic">in</span> <span class="id" title="var">o</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">o</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ) 0 = 0 ) <span class="id" title="keyword">as</span> <span class="id" title="var">o'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrand0r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">o'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">o</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ) 1 = 1 ) <span class="id" title="keyword">as</span> <span class="id" title="var">o''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzlth</span> 1 <span class="id" title="var">p</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">v</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>  <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrand1r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">o''</span> <span class="id" title="tactic">in</span> <span class="id" title="var">o</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzlth</span> 0 1 ) <span class="id" title="keyword">as</span> <span class="id" title="var">o'''</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthnsn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">o</span> <span class="id" title="tactic">in</span> <span class="id" title="var">o'''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> ( <span class="id" title="keyword">forall</span> <span class="id" title="var">x0</span> : <span class="id" title="var">acommring_hzmod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isaprop</span> ( ( <span class="id" title="var">x0</span> # 0)%<span class="id" title="tactic">ring</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">multinvpair</span> ( <span class="id" title="var">acommring_hzmod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ) ) <span class="id" title="var">x0</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">int</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isapropmultinvpair</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">setquotunivprop</span> <span class="id" title="var">_</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x0</span> =&gt; <span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> ( <span class="id" title="var">int</span> <span class="id" title="var">x0</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">neg</span> ( <span class="id" title="var">hzmod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ) <span class="id" title="var">a</span> 0 ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">q'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzmod</span> <span class="id" title="tactic">in</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( 0%<span class="id" title="tactic">ring</span> ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">setquotpr</span> ( <span class="id" title="var">hzmodisringeqrel</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ) ) 0%<span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">iscompsetquotpr</span> ( <span class="id" title="var">hzmodisringeqrel</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">setquotpr</span> ( <span class="id" title="var">hzmodisringeqrel</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">pr1</span> ( <span class="id" title="var">hzmodprimeinv</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ) <span class="id" title="var">y</span> <span class="id" title="var">a</span> <span class="id" title="var">q'</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">quotientringsumdecom</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">hzmodisringeqrel</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> 1%<span class="id" title="var">multmonoid</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">setquotpr</span> ( <span class="id" title="var">hzmodisringeqrel</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ) ) 1%<span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">iscompsetquotpr</span> ( <span class="id" title="var">hzmodisringeqrel</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">bezoutstrong</span> <span class="id" title="var">a</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ))) * <span class="id" title="var">a</span>)%<span class="id" title="tactic">ring</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pr2</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">bezoutstrong</span> <span class="id" title="var">a</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ))) * <span class="id" title="var">a</span>)%<span class="id" title="var">hz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ( ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">hzmodprimeinv</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ) <span class="id" title="var">y</span> <span class="id" title="var">a</span> <span class="id" title="var">q'</span> ) ) )).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">quotientringsumdecom</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">hzmodisringeqrel</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> 1%<span class="id" title="var">multmonoid</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">setquotpr</span> ( <span class="id" title="var">hzmodisringeqrel</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ) ) 1%<span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">iscompsetquotpr</span> ( <span class="id" title="var">hzmodisringeqrel</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">a</span> * <span class="id" title="var">pr2</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">bezoutstrong</span> <span class="id" title="var">a</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ))))%<span class="id" title="tactic">ring</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">a</span> * <span class="id" title="var">pr2</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">bezoutstrong</span> <span class="id" title="var">a</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ))))%<span class="id" title="var">hz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ( ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">hzmodprimeinv</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="var">y</span> ) <span class="id" title="var">y</span> <span class="id" title="var">a</span> <span class="id" title="var">q'</span> ) ) )).<br/>
</div>

<br/>
<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">hz_scope</span>.<br/>
</div>

<div class="doc">
END OF FILE 
</div>
<div class="code">
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>