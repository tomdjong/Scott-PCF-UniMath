<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
	<script src="http://code.jquery.com/jquery-1.11.0.min.js" type="text/javascript"></script>
	<script src="./proofs-toggle.js" type="text/javascript"></script>
	<style>
		div.proofcomment {
			font-style: italic;
		}
	</style>
	<title>Documentation</title>
</head>
<body>
<div id="page">
<div id="main">
<h1 class="libtitle">Library UniMath.SubstitutionSystems.MonadsFromSubstitutionSystems</h1>

<div class="code">
</div>

<div class="doc">
**********************************************************

<div class="paragraph"> </div>

Benedikt Ahrens, Ralph Matthes

<div class="paragraph"> </div>

SubstitutionSystems

<div class="paragraph"> </div>

2015

<div class="paragraph"> </div>


<div class="paragraph"> </div>

 **********************************************************

<div class="paragraph"> </div>

Contents :

<div class="paragraph"> </div>

<ul class="doclist">
<li> Construction of a monad from a substitution system

</li>
<li> Proof that morphism of hss gives morphism of monads

</li>
<li> Bundling that into a functor

</li>
<li> Proof that the functor is faithful

</li>
</ul>

<div class="paragraph"> </div>


<div class="paragraph"> </div>


</div>
<div class="code">

<br/>
<span class="id" title="keyword">Unset</span> <span class="id" title="var">Kernel</span> <span class="id" title="var">Term</span> <span class="id" title="var">Sharing</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.Foundations.PartD</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.MoreFoundations.Tactics</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.CategoryTheory.Core.Categories</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.CategoryTheory.Core.Functors</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.CategoryTheory.Core.NaturalTransformations</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.CategoryTheory.FunctorCategory</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.CategoryTheory.whiskering</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.CategoryTheory.Monads.Monads</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.CategoryTheory.FunctorAlgebras</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.CategoryTheory.limits.bincoproducts</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.CategoryTheory.PointedFunctors</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.CategoryTheory.PrecategoryBinProduct</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.CategoryTheory.HorizontalComposition</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.CategoryTheory.PointedFunctorsComposition</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.CategoryTheory.EndofunctorsMonoidal</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">cat</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.SubstitutionSystems.Signatures</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.SubstitutionSystems.SubstitutionSystems</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.SubstitutionSystems.Notation</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">subsys</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">monad_from_hss</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab1995"></a><h2 class="section">Some variables and assumptions</h2>

<div class="paragraph"> </div>

 Assume having a precategory <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#C"><span class="id" title="variable">C</span></a></span> whose hom-types are sets 
</div>
<div class="code">
<span class="id" title="keyword">Variable</span> <span class="id" title="var">C</span> : <span class="id" title="var">precategory</span>.<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">hs</span> : <span class="id" title="var">has_homsets</span> <span class="id" title="var">C</span>.<br/>

<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">CP</span> : <span class="id" title="var">BinCoproducts</span> <span class="id" title="var">C</span>.<br/>

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Notation</span> "'EndC'":= ([<span class="id" title="var">C</span>, <span class="id" title="var">C</span>, <span class="id" title="var">hs</span>]) .<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">hsEndC</span> : <span class="id" title="var">has_homsets</span> <span class="id" title="var">EndC</span> := <span class="id" title="var">functor_category_has_homsets</span> <span class="id" title="var">C</span> <span class="id" title="var">C</span> <span class="id" title="var">hs</span>.<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">CPEndC</span> : <span class="id" title="var">BinCoproducts</span> <span class="id" title="var">EndC</span> := <span class="id" title="var">BinCoproducts_functor_precat</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">CP</span> <span class="id" title="var">hs</span>.<br/>

<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">H</span> : <span class="id" title="var">Signature</span> <span class="id" title="var">C</span> <span class="id" title="var">hs</span> <span class="id" title="var">C</span> <span class="id" title="var">hs</span>.<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">θ</span> := <span class="id" title="var">theta</span> <span class="id" title="var">H</span>.<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">θ_strength1_int</span> := <span class="id" title="var">Sig_strength_law1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">θ_strength2_int</span> := <span class="id" title="var">Sig_strength_law2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>.<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">Id_H</span><br/>
: <span class="id" title="var">functor</span> <span class="id" title="var">EndC</span> <span class="id" title="var">EndC</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">BinCoproduct_of_functors</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">CPEndC</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">constant_functor</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">functor_identity</span> <span class="id" title="var">_</span> : <span class="id" title="var">EndC</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">H</span>.<br/>

<br/>
</div>

<div class="doc">
The precategory of pointed endofunctors on <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#C"><span class="id" title="variable">C</span></a></span> 
</div>
<div class="code">
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Notation</span> "'Ptd'" := (<span class="id" title="var">precategory_Ptd</span> <span class="id" title="var">C</span> <span class="id" title="var">hs</span>).<br/>
</div>

<div class="doc">
The category of endofunctors on <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#C"><span class="id" title="variable">C</span></a></span> 
</div>
<div class="code">
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Notation</span> "'EndC'":= ([<span class="id" title="var">C</span>, <span class="id" title="var">C</span>, <span class="id" title="var">hs</span>]) .<br/>
</div>

<div class="doc">
The product of two precategories 
<div class="paragraph"> </div>

<a name="lab1996"></a><h2 class="section">Definition of algebra structure <span class="inlinecode">τ</span> of a pointed functor</h2>

<div class="paragraph"> </div>

<a name="lab1997"></a><h2 class="section">Derivation of the monad laws from a heterogeneous substitution system</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">mu_from_fbracket</span>.<br/>

<br/>
</div>

<div class="doc">
We assume given a hss <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#T"><span class="id" title="variable">T</span></a></span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">T</span> : <span class="id" title="var">hss</span> <span class="id" title="var">CP</span> <span class="id" title="var">H</span>.<br/>

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Notation</span> "'p' T" := (<span class="id" title="var">ptd_from_alg</span> <span class="id" title="var">T</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 3).<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Notation</span> "f ⊕ g" := (<span class="id" title="var">BinCoproductOfArrows</span> <span class="id" title="var">_</span> (<span class="id" title="var">CPEndC</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ) (<span class="id" title="var">CPEndC</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ) <span class="id" title="var">f</span> <span class="id" title="var">g</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">μ_0</span> : <span class="id" title="var">functor_identity</span> <span class="id" title="var">C</span> ⟹ <span class="id" title="var">functor_data_from_functor</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> `<span class="id" title="var">T</span> := <span class="id" title="var">η</span> <span class="id" title="var">T</span>. 
<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">μ_0_ptd</span> : <span class="id" title="var">id_Ptd</span> <span class="id" title="var">C</span> <span class="id" title="var">hs</span> --&gt; <span class="id" title="var">p</span> <span class="id" title="var">T</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">μ_0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">c</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">id_left</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">μ_1</span> : <span class="id" title="var">functor_composite</span> (<span class="id" title="var">U</span> (<span class="id" title="var">id_Ptd</span> <span class="id" title="var">C</span> <span class="id" title="var">hs</span>)) (`<span class="id" title="var">T</span>) ⟹ <span class="id" title="var">functor_data_from_functor</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> `<span class="id" title="var">T</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">fbracket</span> <span class="id" title="var">_</span> <span class="id" title="var">μ_0_ptd</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">μ_1_identity</span> : <span class="id" title="var">μ_1</span> = <span class="id" title="var">identity</span> `<span class="id" title="var">T</span> .<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">fbracket_unique</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_trans_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">id_right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_trans_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">c</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">id_right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H'</span>:= <span class="id" title="var">θ_Strength1_int_implies_θ_Strength1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">θ_strength1_int</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">red</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H2</span> := <span class="id" title="var">H'</span> (`<span class="id" title="var">T</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H3</span> := <span class="id" title="var">nat_trans_eq_pointwise</span> <span class="id" title="var">H2</span> <span class="id" title="var">c</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">intermediate_path</span> (<span class="id" title="var">identity</span> <span class="id" title="var">_</span> · <span class="id" title="var">pr1</span> (τ <span class="id" title="var">T</span>) <span class="id" title="var">c</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">cancel_postcomposition</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">id_left</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">μ_1_identity'</span> : ∏ <span class="id" title="var">c</span> : <span class="id" title="var">C</span>, <span class="id" title="var">μ_1</span> <span class="id" title="var">c</span> = <span class="id" title="var">identity</span> <span class="id" title="var">_</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HA</span>:= <span class="id" title="var">nat_trans_eq_pointwise</span> <span class="id" title="var">μ_1_identity</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">HA</span>.<br/>
</div>

<br/>

<br/>

<br/>

<br/>
</div>

<div class="doc">
This is the multiplication of the monad to be constructed 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">μ_2</span> : <span class="id" title="var">functor_composite</span> (`<span class="id" title="var">T</span>) (`<span class="id" title="var">T</span>) ⟹ <span class="id" title="var">pr1</span> (`<span class="id" title="var">T</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="var">fbracket</span> <span class="id" title="var">T</span> (<span class="id" title="var">identity</span> <span class="id" title="var">_</span> ).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">functor_with_mu_from_hss</span> : <span class="id" title="var">functor_with_μ</span> <span class="id" title="var">C</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (`<span class="id" title="var">T</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">μ_2</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Monad_data_from_hss</span> : <span class="id" title="var">Monad_data</span> <span class="id" title="var">C</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">functor_with_mu_from_hss</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">μ_0</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab1998"></a><h3 class="section">Proof of the first monad law</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Monad_law_1_from_hss</span> :<br/>
&nbsp;&nbsp;∏ <span class="id" title="var">c</span> : <span class="id" title="var">C</span>, <span class="id" title="var">μ_0</span> (<span class="id" title="var">pr1</span> (`<span class="id" title="var">T</span>) <span class="id" title="var">c</span>)· <span class="id" title="var">μ_2</span> <span class="id" title="var">c</span> = <span class="id" title="var">identity</span> ((<span class="id" title="var">pr1</span> (`<span class="id" title="var">T</span>)) <span class="id" title="var">c</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">μ_2</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">μ_0</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">H'</span>:=<span class="id" title="var">fbracket_η</span> <span class="id" title="var">T</span> (<span class="id" title="var">identity</span> <span class="id" title="var">_</span>) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">H2</span>:= <span class="id" title="var">nat_trans_eq_weq</span> <span class="id" title="var">hs</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H'</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H2</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab1999"></a><h3 class="section">Proof of the second monad law</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Monad_law_2_from_hss</span>:<br/>
&nbsp;&nbsp;∏ <span class="id" title="var">c</span> : <span class="id" title="var">C</span>, # (<span class="id" title="var">pr1</span> (`<span class="id" title="var">T</span>)) (<span class="id" title="var">μ_0</span> <span class="id" title="var">c</span>)· <span class="id" title="var">μ_2</span> <span class="id" title="var">c</span> = <span class="id" title="var">identity</span> ((<span class="id" title="var">pr1</span> (`<span class="id" title="var">T</span>)) <span class="id" title="var">c</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">intermediate_path</span> (<span class="id" title="var">μ_1</span> <span class="id" title="var">c</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">μ_1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H'</span>:= @<span class="id" title="var">fbracket_unique_target_pointwise</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>  <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">T</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H1</span>:= <span class="id" title="var">H'</span>  <span class="id" title="var">_</span> <span class="id" title="var">μ_0_ptd</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">x</span>:= <span class="id" title="var">post_whisker</span> <span class="id" title="var">μ_0</span> (`<span class="id" title="var">T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">EndC</span> ⟦ `<span class="id" title="var">T</span> • <span class="id" title="var">functor_identity</span> <span class="id" title="var">_</span>  , `<span class="id" title="var">T</span> • `<span class="id" title="var">T</span> ⟧).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">x'</span>:= <span class="id" title="var">x</span> · <span class="id" title="var">μ_2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H2</span> := <span class="id" title="var">H1</span> <span class="id" title="var">x'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H2</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">x'</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">x'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">H'</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_trans_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H'</span>:=<span class="id" title="var">nat_trans_ax</span> (<span class="id" title="var">η</span> <span class="id" title="var">T</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H'</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H'</span>:= <span class="id" title="var">fbracket_η</span> <span class="id" title="var">T</span> (<span class="id" title="var">identity</span> <span class="id" title="var">_</span> )).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">μ_2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H2</span> := <span class="id" title="var">nat_trans_eq_weq</span> <span class="id" title="var">hs</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">id_right</span>. &nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">functor_comp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_trans_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">horcomp_id_postwhisker</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">intermediate_path</span> ( # (<span class="id" title="var">pr1</span> (<span class="id" title="var">H</span> ( (` <span class="id" title="var">T</span>)))) (<span class="id" title="var">μ_0</span> <span class="id" title="var">c</span>)· <span class="id" title="var">pr1</span> (<span class="id" title="var">θ</span> ((`<span class="id" title="var">T</span>) ⊗ (<span class="id" title="var">p</span> <span class="id" title="var">T</span>))) <span class="id" title="var">c</span> ·<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr1</span> (# <span class="id" title="var">H</span> <span class="id" title="var">μ_2</span>) <span class="id" title="var">c</span> · <span class="id" title="var">pr1</span> (τ <span class="id" title="var">T</span>) <span class="id" title="var">c</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">unfold</span> <span class="id" title="var">tau_from_alg</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">cancel_postcomposition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">cancel_postcomposition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">cancel_postcomposition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H'</span>:=<span class="id" title="var">θ_nat_2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span> <span class="id" title="var">θ</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H2</span> := <span class="id" title="var">H'</span> (`<span class="id" title="var">T</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">μ_0_ptd</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H3</span>:= <span class="id" title="var">nat_trans_eq_weq</span> <span class="id" title="var">hs</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H2</span> <span class="id" title="var">c</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">id_left</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (!<span class="id" title="var">H3</span>). &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assert</span> (<span class="id" title="var">H'</span>:= <span class="id" title="var">fbracket_</span>τ <span class="id" title="var">T</span> (<span class="id" title="var">identity</span> <span class="id" title="var">_</span> )).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">μ_2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H2</span>:= <span class="id" title="var">nat_trans_eq_weq</span> <span class="id" title="var">hs</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H'</span> <span class="id" title="var">c</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">intermediate_path</span> (  # (<span class="id" title="var">pr1</span> (<span class="id" title="var">H</span> (` <span class="id" title="var">T</span>))) (<span class="id" title="var">μ_0</span> <span class="id" title="var">c</span>)·<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pr1</span> (τ <span class="id" title="var">T</span>) (<span class="id" title="var">pr1</span> (`<span class="id" title="var">T</span>) <span class="id" title="var">c</span>)· <span class="id" title="var">pr1</span> (<span class="id" title="var">fbracket</span> <span class="id" title="var">T</span> (<span class="id" title="var">identity</span> (<span class="id" title="var">p</span> <span class="id" title="var">T</span>))) <span class="id" title="var">c</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H2</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H2</span>. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">clear</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">cancel_postcomposition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">pathscomp0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">nat_trans_ax</span> (τ <span class="id" title="var">T</span>) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">cancel_postcomposition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">id_right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">μ_1_identity'</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">T_squared</span></span> is <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#T"><span class="id" title="variable">T</span></a>∙<a class="idref" href="UniMath.Foundations.Preamble.html#T"><span class="id" title="variable">T</span></a>,</span> <span class="inlinecode"><span class="id" title="var">η</span>∙<span class="id" title="var">η</span></span>, that is, the selfcomposition of <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#T"><span class="id" title="variable">T</span></a></span> as a pointed functor 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">T_squared</span> : <span class="id" title="var">Ptd</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">ptd_composite</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">p</span> <span class="id" title="var">T</span>) (<span class="id" title="var">p</span> <span class="id" title="var">T</span>)).<br/>
</div>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">μ_2</span></span> is not just a natural transformation from <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#T"><span class="id" title="variable">T</span></a>∙<a class="idref" href="UniMath.Foundations.Preamble.html#T"><span class="id" title="variable">T</span></a></span> to <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#T"><span class="id" title="variable">T</span></a></span>, but also compatible with
    the pointed structure given by <span class="inlinecode"><span class="id" title="var">η</span></span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">μ_2_is_ptd_mor</span> :<br/>
&nbsp;&nbsp;∏ <span class="id" title="var">c</span> : <span class="id" title="var">C</span>, (<span class="id" title="var">ptd_pt</span> <span class="id" title="var">C</span> <span class="id" title="var">T_squared</span>) <span class="id" title="var">c</span>· <span class="id" title="var">μ_2</span> <span class="id" title="var">c</span> = <span class="id" title="var">pr1</span> (<span class="id" title="var">η</span> <span class="id" title="var">T</span>) <span class="id" title="var">c</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">μ_2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">T_squared</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H'</span>:=<span class="id" title="var">Monad_law_2_from_hss</span> <span class="id" title="var">c</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">intermediate_path</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">η</span> <span class="id" title="var">T</span>) <span class="id" title="var">c</span> · <span class="id" title="var">identity</span> <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">eta_from_alg</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">id_right</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">μ_2_ptd</span> : <span class="id" title="var">T_squared</span> --&gt; <span class="id" title="var">p</span> <span class="id" title="var">T</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">μ_2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">is_ptd_mor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">μ_2_is_ptd_mor</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">μ_3</span> : <span class="id" title="var">EndC</span> ⟦ <span class="id" title="var">U</span> <span class="id" title="var">T_squared</span> • `<span class="id" title="var">T</span>,  `<span class="id" title="var">T</span>⟧ := <span class="id" title="var">fbracket</span> <span class="id" title="var">T</span> <span class="id" title="var">μ_2_ptd</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab2000"></a><h3 class="section">Proof of the third monad law via transitivity</h3>
 We show that both sides are equal to <span class="inlinecode"><span class="id" title="var">μ_3</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">fbracket</span></span> <span class="inlinecode"><span class="id" title="var">μ_2</span></span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">μ_3_T_μ_2_μ_2</span> : <span class="id" title="var">μ_3</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(`<span class="id" title="var">T</span> ∘ <span class="id" title="var">μ_2</span> : <span class="id" title="var">EndC</span> ⟦ `<span class="id" title="var">T</span> • <span class="id" title="var">_</span>  , `<span class="id" title="var">T</span> • `<span class="id" title="var">T</span> ⟧ ) · <span class="id" title="var">μ_2</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">fbracket_unique</span> <span class="id" title="var">T</span>  <span class="id" title="var">μ_2_ptd</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_trans_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H2</span> := <span class="id" title="var">nat_trans_ax</span> (<span class="id" title="var">η</span> <span class="id" title="var">T</span>)); <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H2</span> ; <span class="id" title="tactic">clear</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">intermediate_path</span> (<span class="id" title="var">μ_2</span> <span class="id" title="var">c</span> · <span class="id" title="var">identity</span> <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>, <span class="id" title="var">id_right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> <span class="id" title="var">pathscomp0</span>. 2: <span class="id" title="tactic">apply</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Monad_law_1_from_hss</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">functor_comp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H1</span> := <span class="id" title="var">θ_nat_2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span> <span class="id" title="var">θ</span> (`<span class="id" title="var">T</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">μ_2_ptd</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |[<span class="id" title="var">H1</span> : ?<span class="id" title="var">g</span> = <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> · <span class="id" title="var">_</span> · ?<span class="id" title="var">f</span> · ?<span class="id" title="var">h</span> = <span class="id" title="var">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">intermediate_path</span> (<span class="id" title="var">g</span> · <span class="id" title="var">f</span> · <span class="id" title="var">h</span>) <span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">cancel_postcomposition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">cancel_postcomposition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">pathscomp0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H3</span>:=<span class="id" title="var">horcomp_id_postwhisker</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H4</span> := <span class="id" title="var">H3</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">hs</span> <span class="id" title="var">hs</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">μ_2</span> (`<span class="id" title="var">T</span>)); <span class="id" title="tactic">clear</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">clear</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_trans_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">c</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">id_left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H2</span> := <span class="id" title="var">fbracket_</span>τ <span class="id" title="var">T</span>  (<span class="id" title="var">identity</span> <span class="id" title="var">_</span> )).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H3</span>:= <span class="id" title="var">nat_trans_eq_pointwise</span> <span class="id" title="var">H2</span> <span class="id" title="var">c</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |[<span class="id" title="var">H3</span> : <span class="id" title="var">_</span> = ?<span class="id" title="var">f</span> |- ?<span class="id" title="var">e</span> · <span class="id" title="var">_</span> · <span class="id" title="var">_</span> · <span class="id" title="var">_</span>  = <span class="id" title="var">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">intermediate_path</span> (<span class="id" title="var">e</span> · <span class="id" title="var">f</span>) <span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">eapply</span> <span class="id" title="var">pathscomp0</span>. <span class="id" title="tactic">apply</span> (!<span class="id" title="var">assoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">pathscomp0</span>. <span class="id" title="tactic">apply</span> (!<span class="id" title="var">assoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">pathscomp0</span>. 2: <span class="id" title="tactic">apply</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">clear</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">cancel_postcomposition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H1</span> := <span class="id" title="var">nat_trans_ax</span> (τ <span class="id" title="var">T</span> )).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">tau_from_alg</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">pathscomp0</span>; [ | <span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>]; <span class="id" title="tactic">clear</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>, <span class="id" title="var">assoc</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Notation</span> "'T•T²'" := (<span class="id" title="var">functor_compose</span> <span class="id" title="var">hs</span> <span class="id" title="var">hs</span> (<span class="id" title="var">functor_composite</span> (`<span class="id" title="var">T</span>) (`<span class="id" title="var">T</span>)) (`<span class="id" title="var">T</span>) : [<span class="id" title="var">C</span>, <span class="id" title="var">C</span>, <span class="id" title="var">hs</span>]).<br/>

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Notation</span> "'T²∙T'" := (@<span class="id" title="var">functor_composite</span> <span class="id" title="var">C</span> <span class="id" title="var">C</span> <span class="id" title="var">C</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">functor_composite</span> <span class="id" title="var">C</span> <span class="id" title="var">C</span> <span class="id" title="var">C</span> (`<span class="id" title="var">T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(` <span class="id" title="var">T</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(` <span class="id" title="var">T</span>) : <span class="id" title="var">functor</span> <span class="id" title="var">C</span> <span class="id" title="var">C</span>).<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">μ_3_μ_2_T_μ_2</span> :  (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id" title="var">compose</span> (<span class="id" title="var">functor_precategory</span> <span class="id" title="var">C</span> <span class="id" title="var">C</span> <span class="id" title="var">hs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="id" title="var">T</span>²∙<span class="id" title="var">T</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">μ_2</span> •• `<span class="id" title="var">T</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ) <span class="id" title="var">μ_2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="id" title="var">T</span>•<span class="id" title="var">T</span>² --&gt; `<span class="id" title="var">T</span>) = <span class="id" title="var">μ_3</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">fbracket_unique</span>  <span class="id" title="var">T</span> <span class="id" title="var">μ_2_ptd</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_trans_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">transitivity</span> (<span class="id" title="var">identity</span> <span class="id" title="var">_</span> · <span class="id" title="var">μ_2</span> <span class="id" title="var">c</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>, <span class="id" title="var">id_left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> <span class="id" title="var">pathscomp0</span>; [ | <span class="id" title="tactic">apply</span> (!<span class="id" title="var">assoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ) ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">cancel_postcomposition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H1</span> := <span class="id" title="var">Monad_law_1_from_hss</span> (<span class="id" title="var">pr1</span> (`<span class="id" title="var">T</span>) <span class="id" title="var">c</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (!<span class="id" title="var">H1</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">set</span> (<span class="id" title="var">B</span>:= τ <span class="id" title="var">T</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> | [|- <span class="id" title="var">_</span> · # ?<span class="id" title="var">H</span> (?<span class="id" title="var">f</span> · <span class="id" title="var">_</span> ) · <span class="id" title="var">_</span> = <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">set</span> (<span class="id" title="var">F</span>:=<span class="id" title="var">f</span> :  <span class="id" title="var">T</span>•<span class="id" title="var">T</span>² --&gt; <span class="id" title="var">_</span> ) <span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H3</span>:= <span class="id" title="var">functor_comp</span> <span class="id" title="var">H</span> <span class="id" title="var">F</span> <span class="id" title="var">μ_2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">functor_compose</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">pathscomp0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">cancel_postcomposition</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_trans_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> | [ |- ?<span class="id" title="var">a</span> · <span class="id" title="var">_</span> · <span class="id" title="var">_</span> = <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">set</span> (<span class="id" title="var">Ac</span>:= <span class="id" title="var">a</span>) <span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">θ_target_ob</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">functor_compose</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HX</span>:=<span class="id" title="var">θ_nat_1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span> <span class="id" title="var">θ</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">μ_2</span>). &nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HX1</span>:= <span class="id" title="var">HX</span> (<span class="id" title="var">ptd_from_alg</span> <span class="id" title="var">T</span>)); <span class="id" title="tactic">clear</span> <span class="id" title="var">HX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HX1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HXX</span>:=<span class="id" title="var">nat_trans_eq_pointwise</span> <span class="id" title="var">HX1</span> <span class="id" title="var">c</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">HX1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HXX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">functor_id</span> ( <span class="id" title="var">H</span> (`<span class="id" title="var">T</span>))) <span class="id" title="tactic">in</span> <span class="id" title="var">HXX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">id_right</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HXX</span>. &nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |[<span class="id" title="var">HXX</span> : ?<span class="id" title="var">f</span> · ?<span class="id" title="var">h</span> = <span class="id" title="var">_</span> · <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> · (<span class="id" title="var">_</span> · ?<span class="id" title="var">x</span> ) · ?<span class="id" title="var">y</span> = <span class="id" title="var">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">intermediate_path</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">θ</span> ((`<span class="id" title="var">T</span>) ⊗ (<span class="id" title="var">ptd_from_alg</span> <span class="id" title="var">T</span>))) (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">T</span>)) <span class="id" title="var">c</span>)·<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span>  · <span class="id" title="var">h</span> · <span class="id" title="var">x</span>· <span class="id" title="var">y</span>) <span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">cancel_postcomposition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">cancel_postcomposition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">cancel_postcomposition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">Ac</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Ac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">pathscomp0</span>. 2: <span class="id" title="tactic">apply</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">pathscomp0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>. <span class="id" title="tactic">apply</span> (!<span class="id" title="var">HXX</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">HXX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Strength_2</span> : ∏ <span class="id" title="var">α</span> : <span class="id" title="var">functor_compose</span> <span class="id" title="var">hs</span> <span class="id" title="var">hs</span> (<span class="id" title="var">functor_composite</span> (`<span class="id" title="var">T</span>) (`<span class="id" title="var">T</span>))(`<span class="id" title="var">T</span>) --&gt; <span class="id" title="var">functor_composite</span> (` <span class="id" title="var">T</span>) (`<span class="id" title="var">T</span>),<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr1</span> (<span class="id" title="var">θ</span> (`<span class="id" title="var">T</span> ⊗ <span class="id" title="var">T_squared</span>)) <span class="id" title="var">c</span> · <span class="id" title="var">pr1</span> (# <span class="id" title="var">H</span> <span class="id" title="var">α</span>) <span class="id" title="var">c</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr1</span> (<span class="id" title="var">θ</span> ((`<span class="id" title="var">T</span>) ⊗ (<span class="id" title="var">ptd_from_alg</span> <span class="id" title="var">T</span>))) ((<span class="id" title="var">pr1</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">T</span>))) <span class="id" title="var">c</span>)·<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr1</span> (<span class="id" title="var">θ</span> (( ((`<span class="id" title="var">T</span>) • (`<span class="id" title="var">T</span>) : [<span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">hs</span>])) ⊗ (<span class="id" title="var">ptd_from_alg</span> <span class="id" title="var">T</span>))) <span class="id" title="var">c</span>·<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr1</span> (# <span class="id" title="var">H</span> (<span class="id" title="var">α</span> : <span class="id" title="var">functor_compose</span> <span class="id" title="var">hs</span> <span class="id" title="var">hs</span> (`<span class="id" title="var">T</span>) (<span class="id" title="var">functor_composite</span> (`<span class="id" title="var">T</span>) (` <span class="id" title="var">T</span>))--&gt; <span class="id" title="var">_</span>)) <span class="id" title="var">c</span>       ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ (<span class="id" title="tactic">intro</span> <span class="id" title="var">α</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HA</span> := <span class="id" title="var">θ_Strength2_int_implies_θ_Strength2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">θ_strength2_int</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HA'</span>:= <span class="id" title="var">HA</span> (`<span class="id" title="var">T</span>) (<span class="id" title="var">ptd_from_alg</span> <span class="id" title="var">T</span>) (<span class="id" title="var">ptd_from_alg</span> <span class="id" title="var">T</span>) <span class="id" title="var">_</span> <span class="id" title="var">α</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">HA</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HA2</span> := <span class="id" title="var">nat_trans_eq_pointwise</span> <span class="id" title="var">HA'</span> <span class="id" title="var">c</span> ); <span class="id" title="tactic">clear</span> <span class="id" title="var">HA'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HA2</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">HA2</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">pathscomp0</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">Strength_2</span> <span class="id" title="var">F</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">Strength_2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">pathscomp0</span>. <span class="id" title="tactic">apply</span> (!<span class="id" title="var">assoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |[ |- <span class="id" title="var">_</span> = ?<span class="id" title="var">pr1</span> (# ?<span class="id" title="var">G</span> ?<span class="id" title="var">g</span>) <span class="id" title="var">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">X</span> : <span class="id" title="var">F</span> = <span class="id" title="var">g</span>) <span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_trans_eq</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">F</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">functor_id</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>, <span class="id" title="var">id_right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">maponpaths</span> (<span class="id" title="var">λ</span> <span class="id" title="var">T</span>,  <span class="id" title="var">pr1</span> (# <span class="id" title="var">H</span> <span class="id" title="var">T</span>) <span class="id" title="var">c</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">clear</span> <span class="id" title="var">HXX</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Ac</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">F</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">B</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H4</span> := <span class="id" title="var">fbracket_</span>τ <span class="id" title="var">T</span>  (<span class="id" title="var">identity</span> <span class="id" title="var">_</span> )).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H5</span>:= <span class="id" title="var">nat_trans_eq_pointwise</span> <span class="id" title="var">H4</span> <span class="id" title="var">c</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">μ_2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |[ <span class="id" title="var">H5</span> : <span class="id" title="var">_</span> = ?<span class="id" title="var">e</span> |- ?<span class="id" title="var">a</span> · ?<span class="id" title="var">b</span> · <span class="id" title="var">_</span> · <span class="id" title="var">_</span> · <span class="id" title="var">_</span> = <span class="id" title="var">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">intermediate_path</span> (<span class="id" title="var">a</span> · <span class="id" title="var">b</span> · <span class="id" title="var">e</span>) <span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">assoc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H5</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">clear</span> <span class="id" title="var">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">cancel_postcomposition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HT</span> := <span class="id" title="var">fbracket_</span>τ <span class="id" title="var">T</span> (<span class="id" title="var">identity</span> <span class="id" title="var">_</span> )).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H6</span>:= <span class="id" title="var">nat_trans_eq_pointwise</span> <span class="id" title="var">HT</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">HT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">coproduct_nat_trans_in2_data</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">tau_from_alg</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">assoc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
</div>

<br/>
</div>

<div class="doc">
proving a variant of the third monad law with assoc iso explicitly inserted 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">third_monad_law_with_assoc</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">third_monad_law_from_hss</span> :<br/>
&nbsp;&nbsp;(`<span class="id" title="var">T</span> ∘ <span class="id" title="var">μ_2</span> : <span class="id" title="var">EndC</span> ⟦ <span class="id" title="var">functor_composite</span> (<span class="id" title="var">functor_composite</span> `<span class="id" title="var">T</span> `<span class="id" title="var">T</span>) `<span class="id" title="var">T</span> , `<span class="id" title="var">T</span> • `<span class="id" title="var">T</span> ⟧) · <span class="id" title="var">μ_2</span><br/>
&nbsp;&nbsp;=<br/>
&nbsp;&nbsp;(<span class="id" title="var">α_functor</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> : <span class="id" title="var">functor_compose</span> <span class="id" title="var">hs</span> <span class="id" title="var">hs</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>  --&gt; <span class="id" title="var">_</span>) · (<span class="id" title="var">μ_2</span> •• `<span class="id" title="var">T</span>) · <span class="id" title="var">μ_2</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">intermediate_path</span> <span class="id" title="var">μ_3</span>; [<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>, <span class="id" title="var">μ_3_T_μ_2_μ_2</span> | ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">fbracket_unique</span>  <span class="id" title="var">T</span>  <span class="id" title="var">μ_2_ptd</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_trans_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">intermediate_path</span> (<span class="id" title="var">identity</span> <span class="id" title="var">_</span> · <span class="id" title="var">μ_2</span> <span class="id" title="var">c</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>, <span class="id" title="var">id_left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">cancel_postcomposition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">id_left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H1</span> := <span class="id" title="var">Monad_law_1_from_hss</span> (<span class="id" title="var">pr1</span> (`<span class="id" title="var">T</span>) <span class="id" title="var">c</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (!<span class="id" title="var">H1</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">functor_comp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">functor_comp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">T_squared</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_trans_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HTT</span> := <span class="id" title="var">θ_strength2_int</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HX</span> := <span class="id" title="var">HTT</span> (`<span class="id" title="var">T</span>) (<span class="id" title="var">ptd_from_alg</span> <span class="id" title="var">T</span>) (<span class="id" title="var">ptd_from_alg</span> <span class="id" title="var">T</span>)); <span class="id" title="tactic">clear</span> <span class="id" title="var">HTT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HX'</span>:= <span class="id" title="var">nat_trans_eq_pointwise</span> <span class="id" title="var">HX</span> <span class="id" title="var">x</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">HX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HX'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> | [ <span class="id" title="var">H</span> : <span class="id" title="var">_</span>  = ?<span class="id" title="var">f</span> |- <span class="id" title="var">_</span> · <span class="id" title="var">_</span> · ?<span class="id" title="var">g</span> · ?<span class="id" title="var">h</span> · ?<span class="id" title="var">i</span> = <span class="id" title="var">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">intermediate_path</span> (<span class="id" title="var">f</span> · <span class="id" title="var">g</span> · <span class="id" title="var">h</span> · <span class="id" title="var">i</span>) <span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">cancel_postcomposition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">cancel_postcomposition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">cancel_postcomposition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">HX'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">clear</span> <span class="id" title="var">HX'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">id_left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">id_right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HX</span>:=<span class="id" title="var">θ_nat_1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span> <span class="id" title="var">θ</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">μ_2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HX1</span>:= <span class="id" title="var">HX</span> (<span class="id" title="var">ptd_from_alg</span> <span class="id" title="var">T</span>)); <span class="id" title="tactic">clear</span> <span class="id" title="var">HX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HX1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HXX</span>:=<span class="id" title="var">nat_trans_eq_pointwise</span> <span class="id" title="var">HX1</span> <span class="id" title="var">x</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">HX1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HXX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> | [ <span class="id" title="var">H</span> : ?<span class="id" title="var">x</span> = <span class="id" title="var">_</span> |- ?<span class="id" title="var">e</span> · <span class="id" title="var">_</span> · <span class="id" title="var">_</span> · ?<span class="id" title="var">f</span> · ?<span class="id" title="var">g</span> = <span class="id" title="var">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">intermediate_path</span> (<span class="id" title="var">e</span> · <span class="id" title="var">x</span> · <span class="id" title="var">f</span> · <span class="id" title="var">g</span>) <span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">cancel_postcomposition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">cancel_postcomposition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> | [ <span class="id" title="var">H</span> : <span class="id" title="var">_</span> = ?<span class="id" title="var">x</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="var">intermediate_path</span> <span class="id" title="var">x</span> <span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-  <span class="id" title="tactic">clear</span> <span class="id" title="var">HXX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> | [ |- <span class="id" title="var">_</span>  ?<span class="id" title="var">a</span> ?<span class="id" title="var">x</span> = <span class="id" title="var">_</span>  ?<span class="id" title="var">b</span> ?<span class="id" title="var">y</span> ] =&gt; <span class="id" title="tactic">assert</span> (<span class="id" title="var">TTT</span> : <span class="id" title="var">a</span> = <span class="id" title="var">b</span>) <span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> | [ |- <span class="id" title="var">_</span> ?<span class="id" title="var">a</span> = <span class="id" title="var">_</span> ?<span class="id" title="var">b</span> ] =&gt; <span class="id" title="tactic">assert</span> (<span class="id" title="var">TTTT</span> : <span class="id" title="var">a</span> = <span class="id" title="var">b</span>) <span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_trans_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">functor_id</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>, <span class="id" title="var">id_right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">TTTT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">nat_trans_eq_pointwise</span> <span class="id" title="var">TTT</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">assoc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HXX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (!<span class="id" title="var">HXX</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">clear</span> <span class="id" title="var">HXX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H4</span> := <span class="id" title="var">fbracket_</span>τ <span class="id" title="var">T</span> (<span class="id" title="var">identity</span> <span class="id" title="var">_</span> )).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H5</span>:= <span class="id" title="var">nat_trans_eq_pointwise</span> <span class="id" title="var">H4</span> <span class="id" title="var">x</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">μ_2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H5</span>; <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">assoc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">pathscomp0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">functor_id</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">id_left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">cancel_postcomposition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H4'</span>:= <span class="id" title="var">fbracket_</span>τ <span class="id" title="var">T</span> (<span class="id" title="var">identity</span> <span class="id" title="var">_</span> )).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H6</span>:= <span class="id" title="var">nat_trans_eq_pointwise</span> <span class="id" title="var">H4'</span> (<span class="id" title="var">pr1</span> `<span class="id" title="var">T</span> <span class="id" title="var">x</span>)); <span class="id" title="tactic">clear</span> <span class="id" title="var">H4'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">coproduct_nat_trans_in2_data</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H6</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">assoc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H6</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">third_monad_law_with_assoc</span>.<br/>

<br/>
<span class="id" title="keyword">Unset Printing All</span>.<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="keyword">Printing</span> <span class="id" title="var">Notations</span>.<br/>
<span class="id" title="keyword">Unset</span> <span class="id" title="keyword">Printing</span> <span class="id" title="keyword">Implicit</span>.<br/>

<br/>
</div>

<div class="doc">
Finally putting together all the preparatory results to obtain a monad 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Monad_laws_from_hss</span> : <span class="id" title="var">Monad_laws</span> <span class="id" title="var">Monad_data_from_hss</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">Monad_data_from_hss</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">Monad_law_1_from_hss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">Monad_law_2_from_hss</span>.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">Monad_data_from_hss</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">intermediate_path</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">μ_3</span> <span class="id" title="var">c</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">set</span> (<span class="id" title="var">H1</span> := <span class="id" title="var">μ_3_T_μ_2_μ_2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">H2</span> := <span class="id" title="var">nat_trans_eq_weq</span> <span class="id" title="var">hs</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>, <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">set</span> (<span class="id" title="var">H1</span> :=  <span class="id" title="var">μ_3_μ_2_T_μ_2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">H2</span> := <span class="id" title="var">nat_trans_eq_weq</span> <span class="id" title="var">hs</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>, <span class="id" title="var">H2</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Monad_from_hss</span> : <span class="id" title="var">Monad</span> <span class="id" title="var">C</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">Monad_data_from_hss</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">Monad_laws_from_hss</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">mu_from_fbracket</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab2001"></a><h2 class="section">A functor from hss to monads</h2>

<div class="paragraph"> </div>

 Objects are considered above, now morphisms 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Monad_Mor_laws_from_hssMor</span> (<span class="id" title="var">T</span> <span class="id" title="var">T'</span> : <span class="id" title="var">hss</span> <span class="id" title="var">CP</span> <span class="id" title="var">H</span>)(<span class="id" title="var">β</span> : <span class="id" title="var">hssMor</span> <span class="id" title="var">T</span> <span class="id" title="var">T'</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">Monad_Mor_laws</span> (<span class="id" title="var">T</span>:=<span class="id" title="var">Monad_from_hss</span> <span class="id" title="var">T</span>) (<span class="id" title="var">T'</span>:=<span class="id" title="var">Monad_from_hss</span> <span class="id" title="var">T'</span>) (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">β</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">μ_2</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">H'</span>:=<span class="id" title="var">isbracketMor_hssMor</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">β</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">isbracketMor</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">H2</span>:= <span class="id" title="var">H'</span> <span class="id" title="var">_</span> (<span class="id" title="var">identity</span> <span class="id" title="var">_</span> )).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">H3</span>:=(<span class="id" title="var">nat_trans_eq_weq</span> <span class="id" title="var">hs</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">id_left</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H3</span> <span class="id" title="var">H2</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">compute_fbracket</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">cancel_postcomposition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">μ_0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">H'</span>:=<span class="id" title="var">ptd_mor_commutes</span> <span class="id" title="var">_</span>  (<span class="id" title="var">ptd_from_alg_mor</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">β</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Monad_Mor_from_hssMor</span> {<span class="id" title="var">T</span> <span class="id" title="var">T'</span> : <span class="id" title="var">hss</span> <span class="id" title="var">CP</span> <span class="id" title="var">H</span>}(<span class="id" title="var">β</span> : <span class="id" title="var">hssMor</span> <span class="id" title="var">T</span> <span class="id" title="var">T'</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">Monad_Mor</span> (<span class="id" title="var">Monad_from_hss</span> <span class="id" title="var">T</span>) (<span class="id" title="var">Monad_from_hss</span> <span class="id" title="var">T'</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="var">tpair</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">Monad_Mor_laws_from_hssMor</span> <span class="id" title="var">T</span> <span class="id" title="var">T'</span> <span class="id" title="var">β</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hss_to_monad_functor_data</span> : <span class="id" title="var">functor_data</span> (<span class="id" title="var">hss_precategory</span> <span class="id" title="var">CP</span> <span class="id" title="var">H</span>) (<span class="id" title="var">precategory_Monad</span> <span class="id" title="var">C</span> <span class="id" title="var">hs</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">Monad_from_hss</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> @<span class="id" title="var">Monad_Mor_from_hssMor</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">is_functor_hss_to_monad</span> : <span class="id" title="var">is_functor</span> <span class="id" title="var">hss_to_monad_functor_data</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">invmap</span> (<span class="id" title="var">Monad_Mor_equiv</span> <span class="id" title="var">hs</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> )).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">invmap</span> (<span class="id" title="var">Monad_Mor_equiv</span> <span class="id" title="var">hs</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> )).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hss_to_monad_functor</span> : <span class="id" title="var">functor</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> := <span class="id" title="var">tpair</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">is_functor_hss_to_monad</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isaset_Monad_Mor</span> (<span class="id" title="var">T</span> <span class="id" title="var">T'</span> : <span class="id" title="var">Monad</span> <span class="id" title="var">C</span>) : <span class="id" title="var">isaset</span> (<span class="id" title="var">Monad_Mor</span> <span class="id" title="var">T</span> <span class="id" title="var">T'</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">β</span> <span class="id" title="var">β'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isofhlevelweqb</span> <span class="id" title="var">_</span> (<span class="id" title="var">Monad_Mor_equiv</span> <span class="id" title="var">hs</span>  <span class="id" title="var">_</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isaset_nat_trans</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hs</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hssMor_Monad_Mor_eq</span> {<span class="id" title="var">T</span> <span class="id" title="var">T'</span> : <span class="id" title="var">hss</span> <span class="id" title="var">CP</span> <span class="id" title="var">H</span>} (<span class="id" title="var">β</span> <span class="id" title="var">β'</span> : <span class="id" title="var">hssMor</span> <span class="id" title="var">T</span> <span class="id" title="var">T'</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">β</span> = <span class="id" title="var">β'</span> ≃ <span class="id" title="var">Monad_Mor_from_hssMor</span> <span class="id" title="var">β</span> = <span class="id" title="var">Monad_Mor_from_hssMor</span> <span class="id" title="var">β'</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">weqcomp</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">hssMor_eq</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">invweq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Monad_Mor_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hs</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab2002"></a><h3 class="section">The functor from hss to monads is faithful, i.e. forgets at most structure</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">faithful_hss_to_monad</span> : <span class="id" title="var">faithful</span> <span class="id" title="var">hss_to_monad_functor</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">faithful</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">T</span> <span class="id" title="var">T'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isinclbetweensets</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isaset_hssMor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isaset_Monad_Mor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">β</span> <span class="id" title="var">β'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">invmap</span> (<span class="id" title="var">hssMor_Monad_Mor_eq</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> )).<br/>
</div>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">monad_from_hss</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>