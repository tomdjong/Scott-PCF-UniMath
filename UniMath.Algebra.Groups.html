<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
	<script src="https://code./jquery.com/jquery-1.11.0.min.js" type="text/javascript"></script>
	<script src="./proofs-toggle.js" type="text/javascript"></script>
	<style>
		div.proofcomment {
			font-style: italic;
		}
	</style>
	<title>Documentation</title>
</head>
<body>
<div id="page">
<div id="main">
<h1 class="libtitle">Library UniMath.Algebra.Groups</h1>

<div class="code">
</div>

<div class="doc">
<a name="lab446"></a><h1 class="section">Algebra I. Part C. Groups, abelian groups. Vladimir Voevodsky. Aug. 2011 - .</h1>

<div class="paragraph"> </div>

<a name="lab447"></a><h2 class="section">Contents</h2>


<div class="paragraph"> </div>

<ul class="doclist">
<li> Groups
<ul class="doclist">
<li> Basic definitions

</li>
<li> Univalence for groups

</li>
<li> Computation lemmas for groups

</li>
<li> Relations on groups

</li>
<li> Subobjects

</li>
<li> Quotient objects

</li>
<li> Cosets

</li>
<li> Direct products

</li>
</ul>

</li>
<li> Abelian groups
<ul class="doclist">
<li> Basic definitions

</li>
<li> Univalence for abelian groups

</li>
<li> Subobjects

</li>
<li> Kernels

</li>
<li> Quotient objects

</li>
<li> Direct products

</li>
<li> Abelian group of fractions of an abelian unitary monoid

</li>
<li> Abelian group of fractions and abelian monoid of fractions

</li>
<li> Canonical homomorphism to the abelian group of fractions

</li>
<li> Abelian group of fractions in the case when all elements are
    cancelable

</li>
<li> Relations on the abelian group of fractions

</li>
<li> Relations and the canonical homomorphism to <span class="inlinecode"><span class="id" title="var">abgrdiff</span></span>

</li>
</ul>

</li>
</ul>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">UniMath.Algebra.BinaryOperations</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">UniMath.Algebra.Monoids</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.MoreFoundations.All</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab448"></a><h2 class="section">Groups</h2>

<div class="paragraph"> </div>

<a name="lab449"></a><h3 class="section">Basic definitions</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">gr</span> : <span class="id" title="var">UU</span> := <span class="id" title="var">total2</span> (<span class="id" title="var">λ</span> <span class="id" title="var">X</span> : <span class="id" title="var">setwithbinop</span>, <span class="id" title="var">isgrop</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">grpair</span> :<br/>
&nbsp;&nbsp;∏ (<span class="id" title="var">t</span> : <span class="id" title="var">setwithbinop</span>), (<span class="id" title="var">λ</span> <span class="id" title="var">X</span> : <span class="id" title="var">setwithbinop</span>, <span class="id" title="var">isgrop</span> <span class="id" title="var">op</span>) <span class="id" title="var">t</span> → ∑ <span class="id" title="var">X</span> : <span class="id" title="var">setwithbinop</span>, <span class="id" title="var">isgrop</span> <span class="id" title="var">op</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">tpair</span> (<span class="id" title="var">λ</span> <span class="id" title="var">X</span> : <span class="id" title="var">setwithbinop</span>, <span class="id" title="var">isgrop</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">grtomonoid</span> : <span class="id" title="var">gr</span> -&gt; <span class="id" title="var">monoid</span> := <span class="id" title="var">λ</span> <span class="id" title="var">X</span> : <span class="id" title="var">_</span>, <span class="id" title="var">monoidpair</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">X</span>) (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>)).<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">grtomonoid</span> : <span class="id" title="var">gr</span> &gt;-&gt; <span class="id" title="var">monoid</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">grinv</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">grlinvax</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) : <span class="id" title="var">islinv</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>) (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>) (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span>) := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>))).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">grrinvax</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) : <span class="id" title="var">isrinv</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>) (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>) (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span>) := <span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>))).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">gr_of_monoid</span> (<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>) (<span class="id" title="var">H</span> : <span class="id" title="var">invstruct</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>) (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>)) : <span class="id" title="var">gr</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">grpair</span> <span class="id" title="var">X</span> (<span class="id" title="var">mk_isgrop</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>) <span class="id" title="var">H</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">monoidfuninvtoinv</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">gr</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">f</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>) = <span class="id" title="var">grinv</span> <span class="id" title="var">Y</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">invmaponpathsweq</span> (<span class="id" title="var">weqpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">isweqrmultingr_is</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">Y</span>) (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">paths</span> (<span class="id" title="var">op</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">f</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>)) (<span class="id" title="var">pr1</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>)) (<span class="id" title="var">op</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">Y</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>)) (<span class="id" title="var">pr1</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">grlinvax</span> <span class="id" title="var">Y</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">f</span>) (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>) <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">grlinvax</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">f</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">grinv_path_from_op_path</span> {<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>} {<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">X</span>} (<span class="id" title="var">p</span> : (<span class="id" title="var">x</span> * <span class="id" title="var">y</span>)%<span class="id" title="var">multmonoid</span> = <span class="id" title="var">unel</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span> = <span class="id" title="var">y</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">lunax</span> <span class="id" title="var">X</span> <span class="id" title="var">y</span>), &lt;- (<span class="id" title="var">grlinvax</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>), <span class="id" title="var">assocax</span>, <span class="id" title="var">p</span>, <span class="id" title="var">runax</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab450"></a><h3 class="section">Construction of the trivial abmonoid consisting of one element given by unit.</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unitgr_isgrop</span> : <span class="id" title="var">isgrop</span> (@<span class="id" title="var">op</span> <span class="id" title="var">unitmonoid</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">mk_isgrop</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">unitmonoid_ismonoid</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">mk_invstruct</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">use</span> <span class="id" title="var">mk_isinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="var">use</span> <span class="id" title="var">isProofIrrelevantUnit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="var">use</span> <span class="id" title="var">isProofIrrelevantUnit</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unitgr</span> : <span class="id" title="var">gr</span> := <span class="id" title="var">grpair</span> <span class="id" title="var">unitmonoid</span> <span class="id" title="var">unitgr_isgrop</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">grfuntounit_ismonoidfun</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) : <span class="id" title="var">ismonoidfun</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, (<span class="id" title="var">unel</span> <span class="id" title="var">unitgr</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">mk_ismonoidfun</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">mk_isbinopfun</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>. <span class="id" title="var">use</span> <span class="id" title="var">isProofIrrelevantUnit</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">isProofIrrelevantUnit</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">grfuntounit</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">unitgr</span> := <span class="id" title="var">monoidfunconstr</span> (<span class="id" title="var">grfuntounit_ismonoidfun</span> <span class="id" title="var">X</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">grfunfromunit_ismonoidfun</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) : <span class="id" title="var">ismonoidfun</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">unitgr</span>, (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">mk_ismonoidfun</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">mk_isbinopfun</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>. <span class="id" title="var">use</span> <span class="id" title="var">pathsinv0</span>. <span class="id" title="var">use</span> (<span class="id" title="var">runax</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">grfunfromunit</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) : <span class="id" title="var">monoidfun</span> <span class="id" title="var">unitmonoid</span> <span class="id" title="var">X</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">monoidfunconstr</span> (<span class="id" title="var">monoidfunfromunit_ismonoidfun</span> <span class="id" title="var">X</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">unelgrfun_ismonoidfun</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">gr</span>) : <span class="id" title="var">ismonoidfun</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, (<span class="id" title="var">unel</span> <span class="id" title="var">Y</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">mk_ismonoidfun</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">mk_isbinopfun</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>. <span class="id" title="var">use</span> <span class="id" title="var">pathsinv0</span>. <span class="id" title="var">use</span> <span class="id" title="var">lunax</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unelgrfun</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">gr</span>) : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">monoidfunconstr</span> (<span class="id" title="var">unelgrfun_ismonoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab451"></a><h3 class="section">(X = Y) ≃ (monoidiso X Y)</h3>

   The idea is to use the composition

<div class="paragraph"> </div>

            (X = Y) ≃ (mk_gr' X = mk_gr' Y)
                    ≃ ((gr'_to_monoid (mk_gr' X)) = (gr'_to_monoid (mk_gr' Y)))
                    ≃ (monoidiso X Y).

<div class="paragraph"> </div>

   The reason why we use gr' is that then we can use univalence for monoids. See
   <span class="inlinecode"><span class="id" title="var">gr_univalence_weq3</span></span>.

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">gr'</span> : <span class="id" title="var">UU</span> :=<br/>
&nbsp;&nbsp;∑ <span class="id" title="var">g</span> : (∑ <span class="id" title="var">X</span> : <span class="id" title="var">setwithbinop</span>, <span class="id" title="var">ismonoidop</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>)), <span class="id" title="var">invstruct</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">g</span>)) (<span class="id" title="var">pr2</span> <span class="id" title="var">g</span>).<br/>

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">mk_gr'</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) : <span class="id" title="var">gr'</span> := <span class="id" title="var">tpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">tpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">X</span>) (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>))) (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>)).<br/>

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">gr'_to_monoid</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr'</span>) : <span class="id" title="var">monoid</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">X</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">gr_univalence_weq1</span> : <span class="id" title="var">gr</span> ≃ <span class="id" title="var">gr'</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">weqtotal2asstol</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">Z</span> : <span class="id" title="var">setwithbinop</span>, <span class="id" title="var">ismonoidop</span> (@<span class="id" title="var">op</span> <span class="id" title="var">Z</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> : (∑ (<span class="id" title="var">x</span> : <span class="id" title="var">setwithbinop</span>), <span class="id" title="var">ismonoidop</span> (@<span class="id" title="var">op</span> <span class="id" title="var">x</span>)) =&gt; <span class="id" title="var">invstruct</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">y</span>)) (<span class="id" title="var">pr2</span> <span class="id" title="var">y</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">gr_univalence_weq1'</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">gr</span>) : (<span class="id" title="var">X</span> = <span class="id" title="var">Y</span>) ≃ (<span class="id" title="var">mk_gr'</span> <span class="id" title="var">X</span> = <span class="id" title="var">mk_gr'</span> <span class="id" title="var">Y</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">weqpair</span> <span class="id" title="var">_</span> (@<span class="id" title="var">isweqmaponpaths</span> <span class="id" title="var">gr</span> <span class="id" title="var">gr'</span> <span class="id" title="var">gr_univalence_weq1</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">gr_univalence_weq2</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">gr</span>) :<br/>
&nbsp;&nbsp;((<span class="id" title="var">mk_gr'</span> <span class="id" title="var">X</span>) = (<span class="id" title="var">mk_gr'</span> <span class="id" title="var">Y</span>)) ≃ ((<span class="id" title="var">gr'_to_monoid</span> (<span class="id" title="var">mk_gr'</span> <span class="id" title="var">X</span>)) = (<span class="id" title="var">gr'_to_monoid</span> (<span class="id" title="var">mk_gr'</span> <span class="id" title="var">Y</span>))).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">subtypeInjectivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">w</span>. <span class="id" title="var">use</span> <span class="id" title="var">isapropinvstruct</span>.<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">gr_univalence_weq2</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">gr_univalence_weq3</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">gr</span>) :<br/>
&nbsp;&nbsp;((<span class="id" title="var">gr'_to_monoid</span> (<span class="id" title="var">mk_gr'</span> <span class="id" title="var">X</span>)) = (<span class="id" title="var">gr'_to_monoid</span> (<span class="id" title="var">mk_gr'</span> <span class="id" title="var">Y</span>))) ≃ (<span class="id" title="var">monoidiso</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">monoid_univalence</span> (<span class="id" title="var">gr'_to_monoid</span> (<span class="id" title="var">mk_gr'</span> <span class="id" title="var">X</span>)) (<span class="id" title="var">gr'_to_monoid</span> (<span class="id" title="var">mk_gr'</span> <span class="id" title="var">Y</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">gr_univalence_map</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">gr</span>) : (<span class="id" title="var">X</span> = <span class="id" title="var">Y</span>) -&gt; (<span class="id" title="var">monoidiso</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">idmonoidiso</span> <span class="id" title="var">X</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gr_univalence_isweq</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">gr</span>) : <span class="id" title="var">isweq</span> (<span class="id" title="var">gr_univalence_map</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">isweqhomot</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">weqcomp</span> (<span class="id" title="var">gr_univalence_weq1'</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">weqcomp</span> (<span class="id" title="var">gr_univalence_weq2</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) (<span class="id" title="var">gr_univalence_weq3</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>))).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">pathscomp0</span> <span class="id" title="var">weqcomp_to_funcomp_app</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">weqcomp_to_funcomp_app</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">weqproperty</span>.<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">gr_univalence_isweq</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">gr_univalence</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">gr</span>) : (<span class="id" title="var">X</span> = <span class="id" title="var">Y</span>) ≃ (<span class="id" title="var">monoidiso</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">weqpair</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">gr_univalence_map</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">gr_univalence_isweq</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">gr_univalence</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab452"></a><h3 class="section">Computation lemmas for groups</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">weqlmultingr</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) (<span class="id" title="var">x0</span> : <span class="id" title="var">X</span>) : <span class="id" title="var">pr1</span> <span class="id" title="var">X</span> ≃ <span class="id" title="var">pr1</span> <span class="id" title="var">X</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">weqpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">isweqlmultingr_is</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>) <span class="id" title="var">x0</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">weqrmultingr</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) (<span class="id" title="var">x0</span> : <span class="id" title="var">X</span>) : <span class="id" title="var">pr1</span> <span class="id" title="var">X</span> ≃ <span class="id" title="var">pr1</span> <span class="id" title="var">X</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">weqpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">isweqrmultingr_is</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>) <span class="id" title="var">x0</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">grlcan</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) {<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">X</span>} (<span class="id" title="var">c</span> : <span class="id" title="var">X</span>) (<span class="id" title="var">e</span> : <span class="id" title="var">paths</span> (<span class="id" title="var">op</span> <span class="id" title="var">c</span> <span class="id" title="var">a</span>) (<span class="id" title="var">op</span> <span class="id" title="var">c</span> <span class="id" title="var">b</span>)) : <span class="id" title="var">a</span> = <span class="id" title="var">b</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">apply</span> (<span class="id" title="var">invmaponpathsweq</span> (<span class="id" title="var">weqlmultingr</span> <span class="id" title="var">X</span> <span class="id" title="var">c</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">e</span>). </div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">grrcan</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) {<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">X</span>} (<span class="id" title="var">c</span> : <span class="id" title="var">X</span>) (<span class="id" title="var">e</span> : <span class="id" title="var">paths</span> (<span class="id" title="var">op</span> <span class="id" title="var">a</span> <span class="id" title="var">c</span>) (<span class="id" title="var">op</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>)) : <span class="id" title="var">a</span> = <span class="id" title="var">b</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">apply</span> (<span class="id" title="var">invmaponpathsweq</span> (<span class="id" title="var">weqrmultingr</span> <span class="id" title="var">X</span> <span class="id" title="var">c</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">e</span>). </div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">grinvunel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) : <span class="id" title="var">paths</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>)) (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">grrcan</span> <span class="id" title="var">X</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">grlinvax</span> <span class="id" title="var">X</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">runax</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">grinvinv</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) (<span class="id" title="var">a</span> : <span class="id" title="var">X</span>) : <span class="id" title="var">paths</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">a</span>)) <span class="id" title="var">a</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">grlcan</span> <span class="id" title="var">X</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">a</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">grlinvax</span> <span class="id" title="var">X</span> <span class="id" title="var">a</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">grrinvax</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">grinvmaponpathsinv</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) {<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">X</span>} (<span class="id" title="var">e</span> : <span class="id" title="var">paths</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">a</span>) (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">b</span>)) : <span class="id" title="var">a</span> = <span class="id" title="var">b</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">e'</span> := <span class="id" title="var">maponpaths</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>) <span class="id" title="var">e</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e'</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">grinvinv</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">e'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">grinvinv</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">e'</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">e'</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">grinvandmonoidfun</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">gr</span>) {<span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Y</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">ismonoidfun</span> <span class="id" title="var">f</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">paths</span> (<span class="id" title="var">f</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>)) (<span class="id" title="var">grinv</span> <span class="id" title="var">Y</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">grrcan</span> <span class="id" title="var">Y</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">pathsinv0</span> (<span class="id" title="var">pr1</span> <span class="id" title="keyword">is</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">grlinvax</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">grlinvax</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> <span class="id" title="keyword">is</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">grinvop</span> (<span class="id" title="var">Y</span> : <span class="id" title="var">gr</span>) :<br/>
&nbsp;&nbsp;∏ <span class="id" title="var">y1</span> <span class="id" title="var">y2</span> : <span class="id" title="var">Y</span>, <span class="id" title="var">grinv</span> <span class="id" title="var">Y</span> (@<span class="id" title="var">op</span> <span class="id" title="var">Y</span> <span class="id" title="var">y1</span> <span class="id" title="var">y2</span>) = @<span class="id" title="var">op</span> <span class="id" title="var">Y</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">Y</span> <span class="id" title="var">y2</span>) (<span class="id" title="var">grinv</span> <span class="id" title="var">Y</span> <span class="id" title="var">y1</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">y1</span> <span class="id" title="var">y2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">grrcan</span> <span class="id" title="var">Y</span> <span class="id" title="var">y1</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assocax</span> <span class="id" title="var">Y</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">grlinvax</span> <span class="id" title="var">Y</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">runax</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">grrcan</span> <span class="id" title="var">Y</span> <span class="id" title="var">y2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">grlinvax</span> <span class="id" title="var">Y</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assocax</span> <span class="id" title="var">Y</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">grlinvax</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab453"></a><h3 class="section">Relations on groups</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isinvbinophrelgr</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) {<span class="id" title="var">R</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">R</span>) : <span class="id" title="var">isinvbinophrel</span> <span class="id" title="var">R</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">is1</span> := <span class="id" title="var">pr1</span> <span class="id" title="keyword">is</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">is2</span> := <span class="id" title="var">pr2</span> <span class="id" title="keyword">is</span>). <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">set</span> (<span class="id" title="var">r'</span> := <span class="id" title="var">is1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">c</span>) <span class="id" title="var">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">clearbody</span> <span class="id" title="var">r'</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">pathsinv0</span> (<span class="id" title="var">assocax</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">r'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">pathsinv0</span> (<span class="id" title="var">assocax</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">b</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">r'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">grlinvax</span> <span class="id" title="var">X</span> <span class="id" title="var">c</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">r'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">lunax</span> <span class="id" title="var">X</span> <span class="id" title="var">a</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">r'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">lunax</span> <span class="id" title="var">X</span> <span class="id" title="var">b</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">r'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">r'</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">set</span> (<span class="id" title="var">r'</span> := <span class="id" title="var">is2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">c</span>) <span class="id" title="var">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">clearbody</span> <span class="id" title="var">r'</span>. <span class="id" title="tactic">rewrite</span> ((<span class="id" title="var">assocax</span> <span class="id" title="var">X</span> <span class="id" title="var">a</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">r'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ((<span class="id" title="var">assocax</span> <span class="id" title="var">X</span> <span class="id" title="var">b</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">r'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">grrinvax</span> <span class="id" title="var">X</span> <span class="id" title="var">c</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">r'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">runax</span> <span class="id" title="var">X</span> <span class="id" title="var">a</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">r'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">runax</span> <span class="id" title="var">X</span> <span class="id" title="var">b</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">r'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">r'</span>.<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">isinvbinophrelgr</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isbinophrelgr</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) {<span class="id" title="var">R</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isinvbinophrel</span> <span class="id" title="var">R</span>) : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">R</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">is1</span> := <span class="id" title="var">pr1</span> <span class="id" title="keyword">is</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">is2</span> := <span class="id" title="var">pr2</span> <span class="id" title="keyword">is</span>). <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">pathsinv0</span> (<span class="id" title="var">lunax</span> <span class="id" title="var">X</span> <span class="id" title="var">a</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">pathsinv0</span> (<span class="id" title="var">lunax</span> <span class="id" title="var">X</span> <span class="id" title="var">b</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">pathsinv0</span> (<span class="id" title="var">grlinvax</span> <span class="id" title="var">X</span> <span class="id" title="var">c</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assocax</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assocax</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">b</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">is1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">c</span>) <span class="id" title="var">r</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">pathsinv0</span> (<span class="id" title="var">runax</span> <span class="id" title="var">X</span> <span class="id" title="var">a</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">pathsinv0</span> (<span class="id" title="var">runax</span> <span class="id" title="var">X</span> <span class="id" title="var">b</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">pathsinv0</span> (<span class="id" title="var">grrinvax</span> <span class="id" title="var">X</span> <span class="id" title="var">c</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">pathsinv0</span> (<span class="id" title="var">assocax</span> <span class="id" title="var">X</span> <span class="id" title="var">a</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">pathsinv0</span> (<span class="id" title="var">assocax</span> <span class="id" title="var">X</span> <span class="id" title="var">b</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">is2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">c</span>) <span class="id" title="var">r</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">isbinophrelgr</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">grfromgtunel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) {<span class="id" title="var">R</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">R</span>) {<span class="id" title="var">x</span> : <span class="id" title="var">X</span>} (<span class="id" title="var">isg</span> : <span class="id" title="var">R</span> <span class="id" title="var">x</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>)) :<br/>
&nbsp;&nbsp;<span class="id" title="var">R</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>) (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">r</span> := (<span class="id" title="var">pr2</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>) <span class="id" title="var">isg</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">grrinvax</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">lunax</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">r</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">grtogtunel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) {<span class="id" title="var">R</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">R</span>) {<span class="id" title="var">x</span> : <span class="id" title="var">X</span>} (<span class="id" title="var">isg</span> : <span class="id" title="var">R</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>) (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>)) :<br/>
&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">x</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">r</span> := (<span class="id" title="var">pr2</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">x</span> <span class="id" title="var">isg</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">grlinvax</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">lunax</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">r</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">grfromltunel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) {<span class="id" title="var">R</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">R</span>) {<span class="id" title="var">x</span> : <span class="id" title="var">X</span>} (<span class="id" title="var">isg</span> : <span class="id" title="var">R</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>) <span class="id" title="var">x</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">R</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>) (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">r</span> := (<span class="id" title="var">pr1</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>) <span class="id" title="var">isg</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">grlinvax</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">runax</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">r</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">grtoltunel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) {<span class="id" title="var">R</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">R</span>) {<span class="id" title="var">x</span> : <span class="id" title="var">X</span>} (<span class="id" title="var">isg</span> : <span class="id" title="var">R</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>) (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>)) :<br/>
&nbsp;&nbsp;<span class="id" title="var">R</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>) <span class="id" title="var">x</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">r</span> := (<span class="id" title="var">pr1</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">x</span> <span class="id" title="var">isg</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">grrinvax</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">runax</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">r</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab454"></a><h3 class="section">Subobjects</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">issubgr</span> {<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">hsubtype</span> <span class="id" title="var">X</span>) : <span class="id" title="var">UU</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">dirprod</span> (<span class="id" title="var">issubmonoid</span> <span class="id" title="var">A</span>) (∏ <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, <span class="id" title="var">A</span> <span class="id" title="var">x</span> -&gt; <span class="id" title="var">A</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">issubgrpair</span> {<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>} {<span class="id" title="var">A</span> : <span class="id" title="var">hsubtype</span> <span class="id" title="var">X</span>} (<span class="id" title="var">H1</span> : <span class="id" title="var">issubmonoid</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">H2</span> : ∏ <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, <span class="id" title="var">A</span> <span class="id" title="var">x</span> -&gt; <span class="id" title="var">A</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>)) : <span class="id" title="var">issubgr</span> <span class="id" title="var">A</span> := <span class="id" title="var">dirprodpair</span> <span class="id" title="var">H1</span> <span class="id" title="var">H2</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isapropissubgr</span> {<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">hsubtype</span> <span class="id" title="var">X</span>) : <span class="id" title="var">isaprop</span> (<span class="id" title="var">issubgr</span> <span class="id" title="var">A</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isofhleveldirprod</span> 1).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isapropissubmonoid</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">A</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>))).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">subgr</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) : <span class="id" title="var">UU</span> := <span class="id" title="var">total2</span> (<span class="id" title="var">λ</span> <span class="id" title="var">A</span> : <span class="id" title="var">hsubtype</span> <span class="id" title="var">X</span>, <span class="id" title="var">issubgr</span> <span class="id" title="var">A</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">subgrpair</span> {<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>} :<br/>
&nbsp;&nbsp;∏ (<span class="id" title="var">t</span> : <span class="id" title="var">hsubtype</span> <span class="id" title="var">X</span>), (<span class="id" title="var">λ</span> <span class="id" title="var">A</span> : <span class="id" title="var">hsubtype</span> <span class="id" title="var">X</span>, <span class="id" title="var">issubgr</span> <span class="id" title="var">A</span>) <span class="id" title="var">t</span> → ∑ <span class="id" title="var">A</span> : <span class="id" title="var">hsubtype</span> <span class="id" title="var">X</span>, <span class="id" title="var">issubgr</span> <span class="id" title="var">A</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">tpair</span> (<span class="id" title="var">λ</span> <span class="id" title="var">A</span> : <span class="id" title="var">hsubtype</span> <span class="id" title="var">X</span>, <span class="id" title="var">issubgr</span> <span class="id" title="var">A</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">subgrconstr</span> {<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>} :<br/>
&nbsp;&nbsp;∏ (<span class="id" title="var">t</span> : <span class="id" title="var">hsubtype</span> <span class="id" title="var">X</span>), (<span class="id" title="var">λ</span> <span class="id" title="var">A</span> : <span class="id" title="var">hsubtype</span> <span class="id" title="var">X</span>, <span class="id" title="var">issubgr</span> <span class="id" title="var">A</span>) <span class="id" title="var">t</span> → ∑ <span class="id" title="var">A</span> : <span class="id" title="var">hsubtype</span> <span class="id" title="var">X</span>, <span class="id" title="var">issubgr</span> <span class="id" title="var">A</span> :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">subgrpair</span> <span class="id" title="var">X</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">subgrtosubmonoid</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) : <span class="id" title="var">subgr</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">λ</span> <span class="id" title="var">A</span> : <span class="id" title="var">_</span>, <span class="id" title="var">submonoidpair</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">A</span>) (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">A</span>)).<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">subgrtosubmonoid</span> : <span class="id" title="var">subgr</span> &gt;-&gt; <span class="id" title="var">submonoid</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">totalsubgr</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) : <span class="id" title="var">subgr</span> <span class="id" title="var">X</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (@<span class="id" title="var">totalsubtype</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">tt</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">trivialsubgr</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) : <span class="id" title="var">subgr</span> <span class="id" title="var">X</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">x</span> = @<span class="id" title="var">unel</span> <span class="id" title="var">X</span>)%<span class="id" title="tactic">set</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">pr2</span> (@<span class="id" title="var">trivialsubmonoid</span> <span class="id" title="var">X</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">eq_1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (!<span class="id" title="var">eq_1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">grinvunel</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isinvoncarrier</span> {<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">subgr</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isinv</span> (@<span class="id" title="var">op</span> <span class="id" title="var">A</span>) (<span class="id" title="var">unel</span> <span class="id" title="var">A</span>) (<span class="id" title="var">λ</span> <span class="id" title="var">a</span> : <span class="id" title="var">A</span>, <span class="id" title="var">carrierpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">a</span>)) (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">A</span>) (<span class="id" title="var">pr1</span> <span class="id" title="var">a</span>) (<span class="id" title="var">pr2</span> <span class="id" title="var">a</span>))).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">invmaponpathsincl</span> <span class="id" title="var">_</span> (<span class="id" title="var">isinclpr1carrier</span> <span class="id" title="var">A</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">grlinvax</span> <span class="id" title="var">X</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">a</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">invmaponpathsincl</span> <span class="id" title="var">_</span> (<span class="id" title="var">isinclpr1carrier</span> <span class="id" title="var">A</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">grrinvax</span> <span class="id" title="var">X</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">a</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isgrcarrier</span> {<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">subgr</span> <span class="id" title="var">X</span>) : <span class="id" title="var">isgrop</span> (@<span class="id" title="var">op</span> <span class="id" title="var">A</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">tpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">ismonoidcarrier</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">tpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">λ</span> <span class="id" title="var">a</span> : <span class="id" title="var">A</span>, <span class="id" title="var">carrierpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">a</span>)) (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">A</span>) (<span class="id" title="var">pr1</span> <span class="id" title="var">a</span>) (<span class="id" title="var">pr2</span> <span class="id" title="var">a</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">isinvoncarrier</span> <span class="id" title="var">A</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">carrierofasubgr</span> {<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">subgr</span> <span class="id" title="var">X</span>) : <span class="id" title="var">gr</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">A</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">isgrcarrier</span> <span class="id" title="var">A</span>). </div>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">carrierofasubgr</span> : <span class="id" title="var">subgr</span> &gt;-&gt; <span class="id" title="var">gr</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">intersection_subgr</span> : <span class="id" title="keyword">forall</span> {<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>} {<span class="id" title="var">I</span> : <span class="id" title="var">UU</span>} (<span class="id" title="var">S</span> : <span class="id" title="var">I</span> -&gt; <span class="id" title="var">hsubtype</span> <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">each_is_subgr</span> : ∏ <span class="id" title="var">i</span> : <span class="id" title="var">I</span>, <span class="id" title="var">issubgr</span> (<span class="id" title="var">S</span> <span class="id" title="var">i</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">issubgr</span> (<span class="id" title="var">subtype_intersection</span> <span class="id" title="var">S</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">issubgrpair</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">intersection_submonoid</span> <span class="id" title="var">S</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, (<span class="id" title="var">pr1</span> (<span class="id" title="var">each_is_subgr</span> <span class="id" title="var">i</span>)))).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> <span class="id" title="var">x_in_S</span> <span class="id" title="var">i</span>, <span class="id" title="var">pr2</span> (<span class="id" title="var">each_is_subgr</span> <span class="id" title="var">i</span>) <span class="id" title="var">x</span> (<span class="id" title="var">x_in_S</span> <span class="id" title="var">i</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">subgr_incl</span> {<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">subgr</span> <span class="id" title="var">X</span>) : <span class="id" title="var">monoidfun</span> <span class="id" title="var">A</span> <span class="id" title="var">X</span> :=<br/>
<span class="id" title="var">submonoid_incl</span> <span class="id" title="var">A</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab455"></a><h3 class="section">Quotient objects</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">grquotinvcomp</span> {<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">binopeqrel</span> <span class="id" title="var">X</span>) : <span class="id" title="var">iscomprelrelfun</span> <span class="id" title="var">R</span> <span class="id" title="var">R</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">R</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">R</span> <span class="id" title="var">isb</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">isc</span> := <span class="id" title="var">iscompbinoptransrel</span> <span class="id" title="var">_</span> (<span class="id" title="var">eqreltrans</span> <span class="id" title="var">_</span>) <span class="id" title="var">isb</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">iscomprelrelfun</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">R</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">R</span> <span class="id" title="var">iseq</span> ]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">iseq</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">ispo0</span> <span class="id" title="var">symm0</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ispo0</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">trans0</span> <span class="id" title="var">refl0</span> ]. <span class="id" title="tactic">unfold</span> <span class="id" title="var">isbinophrel</span> <span class="id" title="tactic">in</span> <span class="id" title="var">isb</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">r0</span> := <span class="id" title="var">isc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">isc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">refl0</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">x'</span>)) <span class="id" title="var">r</span>) (<span class="id" title="var">refl0</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">grlinvax</span> <span class="id" title="var">X</span> <span class="id" title="var">x'</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">r0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assocax</span> <span class="id" title="var">X</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">x'</span>) <span class="id" title="var">x</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">r0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">grrinvax</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">r0</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">lunax</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">r0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">runax</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">r0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">symm0</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">r0</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">grquotinvcomp</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">invongrquot</span> {<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">binopeqrel</span> <span class="id" title="var">X</span>) : <span class="id" title="var">setquot</span> <span class="id" title="var">R</span> -&gt; <span class="id" title="var">setquot</span> <span class="id" title="var">R</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">setquotfun</span> <span class="id" title="var">R</span> <span class="id" title="var">R</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span>) (<span class="id" title="var">grquotinvcomp</span> <span class="id" title="var">R</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isinvongrquot</span> {<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">binopeqrel</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isinv</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">setwithbinopquot</span> <span class="id" title="var">R</span>)) (<span class="id" title="var">setquotpr</span> <span class="id" title="var">R</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>)) (<span class="id" title="var">invongrquot</span> <span class="id" title="var">R</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">islinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">setquotunivprop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">setwithbinopquot</span> <span class="id" title="var">R</span>, <span class="id" title="var">eqset</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">op</span> (<span class="id" title="var">setwithbinopquot</span> <span class="id" title="var">R</span>) (<span class="id" title="var">invongrquot</span> <span class="id" title="var">R</span> <span class="id" title="var">x</span>) <span class="id" title="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">setquotpr</span> <span class="id" title="var">R</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (@<span class="id" title="var">maponpaths</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">setquotpr</span> <span class="id" title="var">R</span>) (@<span class="id" title="var">op</span> <span class="id" title="var">X</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>) <span class="id" title="var">x</span>) (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">grlinvax</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">isrinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">setquotunivprop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">setwithbinopquot</span> <span class="id" title="var">R</span>, <span class="id" title="var">eqset</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">op</span> (<span class="id" title="var">setwithbinopquot</span> <span class="id" title="var">R</span>) <span class="id" title="var">x</span> (<span class="id" title="var">invongrquot</span> <span class="id" title="var">R</span> <span class="id" title="var">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">setquotpr</span> <span class="id" title="var">R</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (@<span class="id" title="var">maponpaths</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">setquotpr</span> <span class="id" title="var">R</span>) (@<span class="id" title="var">op</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>)) (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">grrinvax</span> <span class="id" title="var">X</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">isinvongrquot</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isgrquot</span> {<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">binopeqrel</span> <span class="id" title="var">X</span>) : <span class="id" title="var">isgrop</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">setwithbinopquot</span> <span class="id" title="var">R</span>)) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">tpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">ismonoidquot</span> <span class="id" title="var">R</span>) (<span class="id" title="var">tpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">invongrquot</span> <span class="id" title="var">R</span>) (<span class="id" title="var">isinvongrquot</span> <span class="id" title="var">R</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">grquot</span> {<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">binopeqrel</span> <span class="id" title="var">X</span>) : <span class="id" title="var">gr</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">setwithbinopquot</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">isgrquot</span>. </div>

<br/>
</div>

<div class="doc">
<a name="lab456"></a><h3 class="section">Cosets</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">GrCosets</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">multmonoid</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Lemma</span> <span class="id" title="var">isaprop_mult_eq_r</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">X</span>) : <span class="id" title="var">isaprop</span> (∑ <span class="id" title="var">z</span> : <span class="id" title="var">X</span>, <span class="id" title="var">x</span> * <span class="id" title="var">z</span> = <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">invproofirrelevance</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">z1</span> <span class="id" title="var">z2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">x'</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (!<span class="id" title="var">lunax</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span> @ <span class="id" title="var">lunax</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">maponpaths</span> (<span class="id" title="var">λ</span> <span class="id" title="var">z</span>, <span class="id" title="var">z</span> * <span class="id" title="var">_</span>) (!<span class="id" title="var">grlinvax</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>) @ <span class="id" title="var">_</span> @<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">maponpaths</span> (<span class="id" title="var">λ</span> <span class="id" title="var">z</span>, <span class="id" title="var">z</span> * <span class="id" title="var">_</span>) (<span class="id" title="var">grlinvax</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">assocax</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span> @ !<span class="id" title="var">assocax</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">maponpaths</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">z1</span>) @ <span class="id" title="var">_</span> @ !<span class="id" title="var">maponpaths</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">z2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
</div>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Lemma</span> <span class="id" title="var">isaprop_mult_eq_l</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">X</span>) : <span class="id" title="var">isaprop</span> (∑ <span class="id" title="var">z</span> : <span class="id" title="var">X</span>, <span class="id" title="var">z</span> * <span class="id" title="var">x</span> = <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">invproofirrelevance</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">z1</span> <span class="id" title="var">z2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">x'</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (!<span class="id" title="var">runax</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span> @ <span class="id" title="var">runax</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">maponpaths</span> (<span class="id" title="var">λ</span> <span class="id" title="var">z</span>, <span class="id" title="var">_</span> * <span class="id" title="var">z</span>) (!<span class="id" title="var">grrinvax</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>) @ <span class="id" title="var">_</span> @<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">maponpaths</span> (<span class="id" title="var">λ</span> <span class="id" title="var">z</span>, <span class="id" title="var">_</span> * <span class="id" title="var">z</span>) (<span class="id" title="var">grrinvax</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (!<span class="id" title="var">assocax</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span> @ <span class="id" title="var">assocax</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">maponpaths</span> (<span class="id" title="var">λ</span> <span class="id" title="var">z</span>, <span class="id" title="var">z</span> * <span class="id" title="var">_</span>) (<span class="id" title="var">pr2</span> <span class="id" title="var">z1</span>) @ <span class="id" title="var">_</span> @ !<span class="id" title="var">maponpaths</span> (<span class="id" title="var">λ</span> <span class="id" title="var">z</span>, <span class="id" title="var">z</span> * <span class="id" title="var">_</span>) (<span class="id" title="var">pr2</span> <span class="id" title="var">z2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
</div>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<span class="id" title="var">Y</span> : <span class="id" title="var">subgr</span> <span class="id" title="var">X</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isaprop_in_same_left_coset</span> (<span class="id" title="var">x1</span> <span class="id" title="var">x2</span> : <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isaprop</span> (<span class="id" title="var">in_same_left_coset</span> <span class="id" title="var">Y</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">in_same_left_coset</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">invproofirrelevance</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">x'</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">x'</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">propproperty</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">p'</span> := (<span class="id" title="var">pr11</span> <span class="id" title="var">p</span>,, <span class="id" title="var">pr2</span> <span class="id" title="var">p</span>) : ∑ <span class="id" title="var">y</span> : <span class="id" title="var">X</span>, <span class="id" title="var">x1</span> * <span class="id" title="var">y</span> = <span class="id" title="var">x2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">q'</span> := (<span class="id" title="var">pr11</span> <span class="id" title="var">q</span>,, <span class="id" title="var">pr2</span> <span class="id" title="var">q</span>) : ∑ <span class="id" title="var">y</span> : <span class="id" title="var">X</span>, <span class="id" title="var">x1</span> * <span class="id" title="var">y</span> = <span class="id" title="var">x2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">maponpaths</span> <span class="id" title="var">pr1</span> (<span class="id" title="var">iscontrpr1</span> (<span class="id" title="var">isaprop_mult_eq_r</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">p'</span> <span class="id" title="var">q'</span>))).<br/>
</div>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isaprop_in_same_right_coset</span> (<span class="id" title="var">x1</span> <span class="id" title="var">x2</span> : <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isaprop</span> (<span class="id" title="var">in_same_right_coset</span> <span class="id" title="var">Y</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">invproofirrelevance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality'</span>; [|<span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality'</span>; [|<span class="id" title="tactic">apply</span> <span class="id" title="var">propproperty</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">p'</span> := (<span class="id" title="var">pr11</span> <span class="id" title="var">p</span>,, <span class="id" title="var">pr2</span> <span class="id" title="var">p</span>) : ∑ <span class="id" title="var">y</span> : <span class="id" title="var">X</span>, <span class="id" title="var">y</span> * <span class="id" title="var">x1</span> = <span class="id" title="var">x2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">q'</span> := (<span class="id" title="var">pr11</span> <span class="id" title="var">q</span>,, <span class="id" title="var">pr2</span> <span class="id" title="var">q</span>) : ∑ <span class="id" title="var">y</span> : <span class="id" title="var">X</span>, <span class="id" title="var">y</span> * <span class="id" title="var">x1</span> = <span class="id" title="var">x2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">maponpaths</span> <span class="id" title="var">pr1</span> (<span class="id" title="var">iscontrpr1</span> (<span class="id" title="var">isaprop_mult_eq_l</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">p'</span> <span class="id" title="var">q'</span>))).<br/>
</div>

<br/>
</div>

<div class="doc">
The property of being in the same coset defines an equivalence relation. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">in_same_left_coset_eqrel</span> : <span class="id" title="var">eqrel</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">eqrelpair</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">hProppair</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">in_same_left_coset</span> <span class="id" title="var">Y</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">isaprop_in_same_left_coset</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">iseqrelconstr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ </div>

<div class="doc">
Transitivity 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? ? ?; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">inxy</span> <span class="id" title="var">inyz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">in_same_left_coset</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">tpair</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exists</span> (<span class="id" title="var">pr11</span> <span class="id" title="var">inxy</span> * <span class="id" title="var">pr11</span> <span class="id" title="var">inyz</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> @ <span class="id" title="var">pr2</span> <span class="id" title="var">inyz</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> @ <span class="id" title="var">maponpaths</span> (<span class="id" title="var">λ</span> <span class="id" title="var">z</span>, <span class="id" title="var">z</span> * <span class="id" title="var">_</span>) (<span class="id" title="var">pr2</span> <span class="id" title="var">inxy</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>, <span class="id" title="var">assocax</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ </div>

<div class="doc">
Reflexivity 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">tpair</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exists</span> 1; <span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">runax</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ </div>

<div class="doc">
Symmetry 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">inxy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">tpair</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exists</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">inxy</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">inxy</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (!<span class="id" title="var">maponpaths</span> (<span class="id" title="var">λ</span> <span class="id" title="var">z</span>, <span class="id" title="var">z</span> * <span class="id" title="var">_</span>) (<span class="id" title="var">pr2</span> <span class="id" title="var">inxy</span>) @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">assocax</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">maponpaths</span> <span class="id" title="var">_</span> (<span class="id" title="var">grrinvax</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">runax</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
x₁ and x₂ are in the same Y-coset if and only if x₁⁻¹ * x₂ is in Y.
      (Proposition 4 in Dummit and Foote) 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">in_same_coset_test</span> (<span class="id" title="var">x1</span> <span class="id" title="var">x2</span> : <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Y</span> ((<span class="id" title="var">grinv</span> <span class="id" title="var">_</span> <span class="id" title="var">x1</span>) * <span class="id" title="var">x2</span>)) ≃ <span class="id" title="var">in_same_left_coset</span> <span class="id" title="var">Y</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">weqimplimpl</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">in_same_left_coset</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">yx1x2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> ((<span class="id" title="var">grinv</span> <span class="id" title="var">_</span> <span class="id" title="var">x1</span>) * <span class="id" title="var">x2</span>,, <span class="id" title="var">yx1x2</span>); <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (!<span class="id" title="var">assocax</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">maponpaths</span> (<span class="id" title="var">λ</span> <span class="id" title="var">z</span>, <span class="id" title="var">z</span> * <span class="id" title="var">_</span>) (<span class="id" title="var">grrinvax</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span>) @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">lunax</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">transportf</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">Y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">pr11</span> <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> @ <span class="id" title="var">maponpaths</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> @ <span class="id" title="var">assocax</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> @ !<span class="id" title="var">maponpaths</span> (<span class="id" title="var">λ</span> <span class="id" title="var">z</span>, <span class="id" title="var">z</span> * <span class="id" title="var">_</span>) (<span class="id" title="var">grlinvax</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>, <span class="id" title="var">lunax</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">propproperty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isaprop_in_same_left_coset</span>.<br/>
</div>
<span class="id" title="keyword">End</span> <span class="id" title="var">GrCosets</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab457"></a><h3 class="section">Direct products</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isgrdirprod</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">gr</span>) : <span class="id" title="var">isgrop</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">setwithbinopdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">ismonoiddirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">λ</span> <span class="id" title="var">xy</span> : <span class="id" title="var">_</span>, <span class="id" title="var">dirprodpair</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">X</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">xy</span>)) (<span class="id" title="var">grinv</span> <span class="id" title="var">Y</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xy</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">xy</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">xy</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">x</span> <span class="id" title="var">y</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">unel_is</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pathsdirprod</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">grlinvax</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>). <span class="id" title="tactic">apply</span> (<span class="id" title="var">grlinvax</span> <span class="id" title="var">Y</span> <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">xy</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">xy</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">x</span> <span class="id" title="var">y</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">unel_is</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pathsdirprod</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">grrinvax</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>). <span class="id" title="tactic">apply</span> (<span class="id" title="var">grrinvax</span> <span class="id" title="var">Y</span> <span class="id" title="var">y</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">grdirprod</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">gr</span>) : <span class="id" title="var">gr</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">setwithbinopdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">isgrdirprod</span>. </div>

<br/>
</div>

<div class="doc">
<a name="lab458"></a><h2 class="section">Abelian groups</h2>

<div class="paragraph"> </div>

<a name="lab459"></a><h3 class="section">Basic definitions</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgr</span> : <span class="id" title="var">UU</span> := <span class="id" title="var">total2</span> (<span class="id" title="var">λ</span> <span class="id" title="var">X</span> : <span class="id" title="var">setwithbinop</span>, <span class="id" title="var">isabgrop</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgrpair</span> (<span class="id" title="var">X</span> : <span class="id" title="var">setwithbinop</span>) (<span class="id" title="keyword">is</span> : <span class="id" title="var">isabgrop</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>)) : <span class="id" title="var">abgr</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">tpair</span> (<span class="id" title="var">λ</span> <span class="id" title="var">X</span> : <span class="id" title="var">setwithbinop</span>,  <span class="id" title="var">isabgrop</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>)) <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgrconstr</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">inv0</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span>) (<span class="id" title="keyword">is</span> : <span class="id" title="var">isinv</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>) (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>) <span class="id" title="var">inv0</span>) : <span class="id" title="var">abgr</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">abgrpair</span> <span class="id" title="var">X</span> (<span class="id" title="var">dirprodpair</span> (<span class="id" title="var">isgroppair</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>) (<span class="id" title="var">tpair</span> <span class="id" title="var">_</span> <span class="id" title="var">inv0</span> <span class="id" title="keyword">is</span>)) (<span class="id" title="var">commax</span> <span class="id" title="var">X</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgrtogr</span> : <span class="id" title="var">abgr</span> -&gt; <span class="id" title="var">gr</span> := <span class="id" title="var">λ</span> <span class="id" title="var">X</span> : <span class="id" title="var">_</span>, <span class="id" title="var">grpair</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">X</span>) (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>)).<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">abgrtogr</span> : <span class="id" title="var">abgr</span> &gt;-&gt; <span class="id" title="var">gr</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgrtoabmonoid</span> : <span class="id" title="var">abgr</span> -&gt; <span class="id" title="var">abmonoid</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">λ</span> <span class="id" title="var">X</span> : <span class="id" title="var">_</span>, <span class="id" title="var">abmonoidpair</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">X</span>) (<span class="id" title="var">dirprodpair</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>))) (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>))).<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">abgrtoabmonoid</span> : <span class="id" title="var">abgr</span> &gt;-&gt; <span class="id" title="var">abmonoid</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgr_of_gr</span> (<span class="id" title="var">X</span> : <span class="id" title="var">gr</span>) (<span class="id" title="var">H</span> : <span class="id" title="var">iscomm</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>)) : <span class="id" title="var">abgr</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">abgrpair</span> <span class="id" title="var">X</span> (<span class="id" title="var">mk_isabgrop</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>) <span class="id" title="var">H</span>).<br/>

<br/>
<span class="id" title="keyword">Delimit</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">abgr</span> <span class="id" title="keyword">with</span> <span class="id" title="var">abgr</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;x - y" := (<span class="id" title="var">op</span> <span class="id" title="var">x</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">_</span> <span class="id" title="var">y</span>)) : <span class="id" title="var">abgr</span>.<br/>
<span class="id" title="keyword">Notation</span>   &quot;- y" := (<span class="id" title="var">grinv</span> <span class="id" title="var">_</span> <span class="id" title="var">y</span>) : <span class="id" title="var">abgr</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab460"></a><h3 class="section">Construction of the trivial abgr consisting of one element given by unit.</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unitabgr_isabgrop</span> : <span class="id" title="var">isabgrop</span> (@<span class="id" title="var">op</span> <span class="id" title="var">unitabmonoid</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">mk_isabgrop</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">unitgr_isgrop</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">commax</span> <span class="id" title="var">unitabmonoid</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unitabgr</span> : <span class="id" title="var">abgr</span> := <span class="id" title="var">abgrpair</span> <span class="id" title="var">unitabmonoid</span> <span class="id" title="var">unitabgr_isabgrop</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">abgrfuntounit_ismonoidfun</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abgr</span>) : <span class="id" title="var">ismonoidfun</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, (<span class="id" title="var">unel</span> <span class="id" title="var">unitabgr</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">mk_ismonoidfun</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">mk_isbinopfun</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>. <span class="id" title="var">use</span> <span class="id" title="var">isProofIrrelevantUnit</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">isProofIrrelevantUnit</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgrfuntounit</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abgr</span>) : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">unitabgr</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">monoidfunconstr</span> (<span class="id" title="var">abgrfuntounit_ismonoidfun</span> <span class="id" title="var">X</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">abgrfunfromunit_ismonoidfun</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abgr</span>) : <span class="id" title="var">ismonoidfun</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">unitabgr</span>, (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">mk_ismonoidfun</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">mk_isbinopfun</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>. <span class="id" title="var">use</span> <span class="id" title="var">pathsinv0</span>. <span class="id" title="var">use</span> (<span class="id" title="var">runax</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgrfunfromunit</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abgr</span>) : <span class="id" title="var">monoidfun</span> <span class="id" title="var">unitabgr</span> <span class="id" title="var">X</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">monoidfunconstr</span> (<span class="id" title="var">abgrfunfromunit_ismonoidfun</span> <span class="id" title="var">X</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">unelabgrfun_ismonoidfun</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abgr</span>) : <span class="id" title="var">ismonoidfun</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, (<span class="id" title="var">unel</span> <span class="id" title="var">Y</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">mk_ismonoidfun</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">mk_isbinopfun</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>. <span class="id" title="var">use</span> <span class="id" title="var">pathsinv0</span>. <span class="id" title="var">use</span> <span class="id" title="var">lunax</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unelabgrfun</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abgr</span>) : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">monoidfunconstr</span> (<span class="id" title="var">unelgrfun_ismonoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab461"></a><h3 class="section">Abelian group structure on morphism between abelian groups</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgrshombinop_inv_ismonoidfun</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abgr</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">ismonoidfun</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, <span class="id" title="var">grinv</span> <span class="id" title="var">Y</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">mk_ismonoidfun</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">mk_isbinopfun</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">f</span>)). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">Y</span>)). <span class="id" title="var">use</span> (<span class="id" title="var">grinvop</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> (<span class="id" title="var">pathscomp0</span> (<span class="id" title="var">maponpaths</span> (<span class="id" title="var">λ</span> <span class="id" title="var">y</span> : <span class="id" title="var">Y</span>, <span class="id" title="var">grinv</span> <span class="id" title="var">Y</span> <span class="id" title="var">y</span>) (<span class="id" title="var">monoidfununel</span> <span class="id" title="var">f</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">grinvunel</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgrshombinop_inv</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abgr</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">monoidfunconstr</span> (<span class="id" title="var">abgrshombinop_inv_ismonoidfun</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgrshombinop_linvax</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abgr</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) :<br/>
&nbsp;&nbsp;@<span class="id" title="var">abmonoidshombinop</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> (<span class="id" title="var">abgrshombinop_inv</span> <span class="id" title="var">f</span>) <span class="id" title="var">f</span> = <span class="id" title="var">unelmonoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">monoidfun_paths</span>. <span class="id" title="var">use</span> <span class="id" title="var">funextfun</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="var">use</span> (@<span class="id" title="var">grlinvax</span> <span class="id" title="var">Y</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgrshombinop_rinvax</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abgr</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) :<br/>
&nbsp;&nbsp;@<span class="id" title="var">abmonoidshombinop</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">f</span> (<span class="id" title="var">abgrshombinop_inv</span> <span class="id" title="var">f</span>) = <span class="id" title="var">unelmonoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">monoidfun_paths</span>. <span class="id" title="var">use</span> <span class="id" title="var">funextfun</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="var">use</span> (<span class="id" title="var">grrinvax</span> <span class="id" title="var">Y</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">abgrshomabgr_isabgrop</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abgr</span>) :<br/>
&nbsp;&nbsp;@<span class="id" title="var">isabgrop</span> (<span class="id" title="var">abmonoidshomabmonoid</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) (<span class="id" title="var">λ</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>, @<span class="id" title="var">abmonoidshombinop</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">mk_isabgrop</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">mk_isgrop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">abmonoidshomabmonoid_ismonoidop</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">use</span> <span class="id" title="var">mk_invstruct</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">intros</span> <span class="id" title="var">f</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">abgrshombinop_inv</span> <span class="id" title="var">f</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">use</span> <span class="id" title="var">mk_isinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">f</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">abgrshombinop_linvax</span> <span class="id" title="var">f</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">f</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">abgrshombinop_rinvax</span> <span class="id" title="var">f</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">abmonoidshombinop_comm</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgrshomabgr</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abgr</span>) : <span class="id" title="var">abgr</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">abgrpair</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">abmonoidshomabmonoid</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">abgrshomabgr_isabgrop</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab462"></a><h3 class="section">(X = Y) ≃ (monoidiso X Y)</h3>

   The idea is to use the following composition

<div class="paragraph"> </div>

        (X = Y) ≃ (mk_abgr' X = mk_abgr' Y)
                ≃ (pr1 (mk_abgr' X) = pr1 (mk_abgr' Y))
                ≃ (monoidiso X Y)

<div class="paragraph"> </div>

    We use abgr' so that we can use univalence for groups, <span class="inlinecode"><span class="id" title="var">gr_univalence</span></span>. See
    <span class="inlinecode"><span class="id" title="var">abgr_univalence_weq3</span></span>.
 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">abgr'</span> : <span class="id" title="var">UU</span> :=<br/>
&nbsp;&nbsp;∑ <span class="id" title="var">g</span> : (∑ <span class="id" title="var">X</span> : <span class="id" title="var">setwithbinop</span>, <span class="id" title="var">isgrop</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>)), <span class="id" title="var">iscomm</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">g</span>)).<br/>

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">mk_abgr'</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abgr</span>) : <span class="id" title="var">abgr'</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">tpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">tpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">X</span>) (<span class="id" title="var">dirprod_pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>))) (<span class="id" title="var">dirprod_pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>)).<br/>

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">abgr_univalence_weq1</span> : <span class="id" title="var">abgr</span> ≃ <span class="id" title="var">abgr'</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">weqtotal2asstol</span> (<span class="id" title="var">λ</span> <span class="id" title="var">Z</span> : <span class="id" title="var">setwithbinop</span>, <span class="id" title="var">isgrop</span> (@<span class="id" title="var">op</span> <span class="id" title="var">Z</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> : (∑ <span class="id" title="var">x</span> : <span class="id" title="var">setwithbinop</span>, <span class="id" title="var">isgrop</span> (@<span class="id" title="var">op</span> <span class="id" title="var">x</span>)) =&gt; <span class="id" title="var">iscomm</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">y</span>))).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgr_univalence_weq1'</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abgr</span>) : (<span class="id" title="var">X</span> = <span class="id" title="var">Y</span>) ≃ (<span class="id" title="var">mk_abgr'</span> <span class="id" title="var">X</span> = <span class="id" title="var">mk_abgr'</span> <span class="id" title="var">Y</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">weqpair</span> <span class="id" title="var">_</span> (@<span class="id" title="var">isweqmaponpaths</span> <span class="id" title="var">abgr</span> <span class="id" title="var">abgr'</span> <span class="id" title="var">abgr_univalence_weq1</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgr_univalence_weq2</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abgr</span>) :<br/>
&nbsp;&nbsp;(<span class="id" title="var">mk_abgr'</span> <span class="id" title="var">X</span> = <span class="id" title="var">mk_abgr'</span> <span class="id" title="var">Y</span>) ≃ (<span class="id" title="var">pr1</span> (<span class="id" title="var">mk_abgr'</span> <span class="id" title="var">X</span>) = <span class="id" title="var">pr1</span> (<span class="id" title="var">mk_abgr'</span> <span class="id" title="var">Y</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">subtypeInjectivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">w</span>. <span class="id" title="var">use</span> <span class="id" title="var">isapropiscomm</span>.<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">abgr_univalence_weq2</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgr_univalence_weq3</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abgr</span>) :<br/>
&nbsp;&nbsp;(<span class="id" title="var">pr1</span> (<span class="id" title="var">mk_abgr'</span> <span class="id" title="var">X</span>) = <span class="id" title="var">pr1</span> (<span class="id" title="var">mk_abgr'</span> <span class="id" title="var">Y</span>)) ≃ (<span class="id" title="var">monoidiso</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">gr_univalence</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">mk_abgr'</span> <span class="id" title="var">X</span>)) (<span class="id" title="var">pr1</span> (<span class="id" title="var">mk_abgr'</span> <span class="id" title="var">Y</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgr_univalence_map</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abgr</span>) : (<span class="id" title="var">X</span> = <span class="id" title="var">Y</span>) -&gt; (<span class="id" title="var">monoidiso</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">idmonoidiso</span> <span class="id" title="var">X</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">abgr_univalence_isweq</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abgr</span>) : <span class="id" title="var">isweq</span> (<span class="id" title="var">abgr_univalence_map</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">isweqhomot</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">weqcomp</span> (<span class="id" title="var">abgr_univalence_weq1'</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">weqcomp</span> (<span class="id" title="var">abgr_univalence_weq2</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) (<span class="id" title="var">abgr_univalence_weq3</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>))).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">pathscomp0</span> <span class="id" title="var">weqcomp_to_funcomp_app</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">weqcomp_to_funcomp_app</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">weqproperty</span>.<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">abgr_univalence_isweq</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgr_univalence</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abgr</span>) : (<span class="id" title="var">X</span> = <span class="id" title="var">Y</span>) ≃ (<span class="id" title="var">monoidiso</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">weqpair</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">abgr_univalence_map</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">abgr_univalence_isweq</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">abgr_univalence</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab463"></a><h3 class="section">Subobjects</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">subabgr</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abgr</span>) := <span class="id" title="var">subgr</span> <span class="id" title="var">X</span>.<br/>
<span class="id" title="keyword">Identity</span> <span class="id" title="keyword">Coercion</span> <span class="id" title="var">id_subabgr</span> : <span class="id" title="var">subabgr</span> &gt;-&gt; <span class="id" title="var">subgr</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isabgrcarrier</span> {<span class="id" title="var">X</span> : <span class="id" title="var">abgr</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">subgr</span> <span class="id" title="var">X</span>) : <span class="id" title="var">isabgrop</span> (@<span class="id" title="var">op</span> <span class="id" title="var">A</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">isgrcarrier</span> <span class="id" title="var">A</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> (@<span class="id" title="var">isabmonoidcarrier</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">carrierofasubabgr</span> {<span class="id" title="var">X</span> : <span class="id" title="var">abgr</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">subabgr</span> <span class="id" title="var">X</span>) : <span class="id" title="var">abgr</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">A</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">isabgrcarrier</span>. </div>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">carrierofasubabgr</span> : <span class="id" title="var">subabgr</span> &gt;-&gt; <span class="id" title="var">abgr</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">subabgr_incl</span> {<span class="id" title="var">X</span> : <span class="id" title="var">abgr</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">subabgr</span> <span class="id" title="var">X</span>) : <span class="id" title="var">monoidfun</span> <span class="id" title="var">A</span> <span class="id" title="var">X</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">submonoid_incl</span> <span class="id" title="var">A</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgr_kernel_hsubtype</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">abgr</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) : <span class="id" title="var">hsubtype</span> <span class="id" title="var">A</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">monoid_kernel_hsubtype</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgr_image_hsubtype</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">abgr</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) : <span class="id" title="var">hsubtype</span> <span class="id" title="var">B</span> :=<br/>
&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">y</span> : <span class="id" title="var">B</span>, ∃ <span class="id" title="var">x</span> : <span class="id" title="var">A</span>, (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) = <span class="id" title="var">y</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab464"></a><h1 class="section">Kernels</h1>

    Let f : X -&gt; Y be a morphism of abelian groups. A kernel of f is given by the subgroup of X
    consisting of elements x such that <span class="inlinecode"><a class="idref" href="UniMath.Algebra.DCPO.html#leastupperbound.f"><span class="id" title="variable">f</span></a></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#x"><span class="id" title="variable">x</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">unel</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#Y"><span class="id" title="variable">Y</span></a></span>.
 
<div class="paragraph"> </div>

<a name="lab465"></a><h2 class="section">Kernel as abelian group</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgr_Kernel_subabgr_issubgr</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">abgr</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">issubgr</span> (<span class="id" title="var">abgr_kernel_hsubtype</span> <span class="id" title="var">f</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">issubgrpair</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">kernel_issubmonoid</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">grrcan</span> <span class="id" title="var">B</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pathscomp0</span> (! (<span class="id" title="var">binopfunisbinopfun</span> <span class="id" title="var">f</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">A</span> <span class="id" title="var">x</span>) <span class="id" title="var">x</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pathscomp0</span> (<span class="id" title="var">maponpaths</span> (<span class="id" title="var">λ</span> <span class="id" title="var">a</span> : <span class="id" title="var">A</span>, <span class="id" title="var">f</span> <span class="id" title="var">a</span>) (<span class="id" title="var">grlinvax</span> <span class="id" title="var">A</span> <span class="id" title="var">x</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pathscomp0</span> (<span class="id" title="var">monoidfununel</span> <span class="id" title="var">f</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pathscomp0</span> (<span class="id" title="var">lunax</span> <span class="id" title="var">B</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">a</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgr_Kernel_subabgr</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">abgr</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) : @<span class="id" title="var">subabgr</span> <span class="id" title="var">A</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">subgrconstr</span> (@<span class="id" title="var">abgr_kernel_hsubtype</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>) (<span class="id" title="var">abgr_Kernel_subabgr_issubgr</span> <span class="id" title="var">f</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab466"></a><h2 class="section">The inclusion Kernel f --&gt; X is a morphism of abelian groups</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgr_Kernel_monoidfun_ismonoidfun</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">abgr</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) :<br/>
&nbsp;&nbsp;@<span class="id" title="var">ismonoidfun</span> (<span class="id" title="var">abgr_Kernel_subabgr</span> <span class="id" title="var">f</span>) <span class="id" title="var">A</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">inclpair</span> (<span class="id" title="var">pr1carrier</span> (<span class="id" title="var">abgr_kernel_hsubtype</span> <span class="id" title="var">f</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">isinclpr1carrier</span> (<span class="id" title="var">abgr_kernel_hsubtype</span> <span class="id" title="var">f</span>))).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">mk_ismonoidfun</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">mk_isbinopfun</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>. <span class="id" title="var">use</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab467"></a><h2 class="section">Image of f is a subgroup</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgr_image_issubgr</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">abgr</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) : <span class="id" title="var">issubgr</span> (<span class="id" title="var">abgr_image_hsubtype</span> <span class="id" title="var">f</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">issubgrpair</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">issubmonoidpair</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">a'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">a</span>)). <span class="id" title="tactic">intros</span> <span class="id" title="var">ae</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">a'</span>)). <span class="id" title="tactic">intros</span> <span class="id" title="var">a'e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">hinhpr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">tpair</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exact</span> (@<span class="id" title="var">op</span> <span class="id" title="var">A</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">ae</span>) (<span class="id" title="var">pr1</span> <span class="id" title="var">a'e</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">use</span> (<span class="id" title="var">pathscomp0</span> (<span class="id" title="var">binopfunisbinopfun</span> <span class="id" title="var">f</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">ae</span>) (<span class="id" title="var">pr1</span> <span class="id" title="var">a'e</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">two_arg_paths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">ae</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">a'e</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">use</span> <span class="id" title="var">hinhpr</span>. <span class="id" title="var">use</span> <span class="id" title="var">tpair</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exact</span> (<span class="id" title="var">unel</span> <span class="id" title="var">A</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exact</span> (<span class="id" title="var">monoidfununel</span> <span class="id" title="var">f</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">b</span> <span class="id" title="var">b'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">b'</span>). <span class="id" title="tactic">intros</span> <span class="id" title="var">eb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">hinhpr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">tpair</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">A</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">eb</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">use</span> (<span class="id" title="var">pathscomp0</span> <span class="id" title="var">_</span> (<span class="id" title="var">maponpaths</span> (<span class="id" title="var">λ</span> <span class="id" title="var">bb</span> : <span class="id" title="var">B</span>, (<span class="id" title="var">grinv</span> <span class="id" title="var">B</span> <span class="id" title="var">bb</span>)) (<span class="id" title="var">pr2</span> <span class="id" title="var">eb</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">monoidfuninvtoinv</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgr_image</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">abgr</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) : @<span class="id" title="var">subabgr</span> <span class="id" title="var">B</span> :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">subgrconstr</span> <span class="id" title="var">B</span> (@<span class="id" title="var">abgr_image_hsubtype</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>) (<span class="id" title="var">abgr_image_issubgr</span> <span class="id" title="var">f</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab468"></a><h3 class="section">Quotient objects</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isabgrquot</span> {<span class="id" title="var">X</span> : <span class="id" title="var">abgr</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">binopeqrel</span> <span class="id" title="var">X</span>) : <span class="id" title="var">isabgrop</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">setwithbinopquot</span> <span class="id" title="var">R</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">isgrquot</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> (@<span class="id" title="var">isabmonoidquot</span> <span class="id" title="var">X</span> <span class="id" title="var">R</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgrquot</span> {<span class="id" title="var">X</span> : <span class="id" title="var">abgr</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">binopeqrel</span> <span class="id" title="var">X</span>) : <span class="id" title="var">abgr</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">setwithbinopquot</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">isabgrquot</span>. </div>

<br/>
</div>

<div class="doc">
<a name="lab469"></a><h3 class="section">Direct products</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isabgrdirprod</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abgr</span>) : <span class="id" title="var">isabgrop</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">setwithbinopdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">isgrdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">isabmonoiddirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgrdirprod</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abgr</span>) : <span class="id" title="var">abgr</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">setwithbinopdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isabgrdirprod</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab470"></a><h3 class="section">Abelian group of fractions of an abelian unitary monoid</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Fractions</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.Algebra.Monoids.AddNotation</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">addmonoid</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hrelabgrdiff</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">hrel</span> (<span class="id" title="var">X</span> × <span class="id" title="var">X</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">λ</span> <span class="id" title="var">xa1</span> <span class="id" title="var">xa2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hexists</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x0</span> : <span class="id" title="var">X</span>, <span class="id" title="var">paths</span> (((<span class="id" title="var">pr1</span> <span class="id" title="var">xa1</span>) + (<span class="id" title="var">pr2</span> <span class="id" title="var">xa2</span>)) + <span class="id" title="var">x0</span>) (((<span class="id" title="var">pr1</span> <span class="id" title="var">xa2</span>) + (<span class="id" title="var">pr2</span> <span class="id" title="var">xa1</span>)) + <span class="id" title="var">x0</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgrdiffphi</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">xa</span> : <span class="id" title="var">dirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">dirprod</span> <span class="id" title="var">X</span> (<span class="id" title="var">totalsubtype</span> <span class="id" title="var">X</span>) := <span class="id" title="var">dirprodpair</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">xa</span>) (<span class="id" title="var">carrierpair</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, <span class="id" title="var">htrue</span>) (<span class="id" title="var">pr2</span> <span class="id" title="var">xa</span>) <span class="id" title="var">tt</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hrelabgrdiff'</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">hrel</span> (<span class="id" title="var">X</span> × <span class="id" title="var">X</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">λ</span> <span class="id" title="var">xa1</span> <span class="id" title="var">xa2</span>, <span class="id" title="var">eqrelabmonoidfrac</span> <span class="id" title="var">X</span> (<span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>) (<span class="id" title="var">abgrdiffphi</span> <span class="id" title="var">X</span> <span class="id" title="var">xa1</span>) (<span class="id" title="var">abgrdiffphi</span> <span class="id" title="var">X</span> <span class="id" title="var">xa2</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">logeqhrelsabgrdiff</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">hrellogeq</span> (<span class="id" title="var">hrelabgrdiff'</span> <span class="id" title="var">X</span>) (<span class="id" title="var">hrelabgrdiff</span> <span class="id" title="var">X</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">split</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhfun</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">t2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">a0</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">t2</span>)). <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">a0</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">t2</span>). <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hinhfun</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">t2</span>. <span class="id" title="tactic">set</span> (<span class="id" title="var">x0</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">t2</span>). <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">tpair</span> <span class="id" title="var">_</span> <span class="id" title="var">x0</span> <span class="id" title="var">tt</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">t2</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iseqrelabgrdiff</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">iseqrel</span> (<span class="id" title="var">hrelabgrdiff</span> <span class="id" title="var">X</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">iseqrellogeqf</span> (<span class="id" title="var">logeqhrelsabgrdiff</span> <span class="id" title="var">X</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">iseqrelconstr</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">xx'</span> <span class="id" title="var">xx''</span> <span class="id" title="var">xx'''</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">eqreltrans</span> (<span class="id" title="var">eqrelabmonoidfrac</span> <span class="id" title="var">X</span> (<span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>)) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">xx</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">eqrelrefl</span> (<span class="id" title="var">eqrelabmonoidfrac</span> <span class="id" title="var">X</span> (<span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>)) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">xx</span> <span class="id" title="var">xx'</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">eqrelsymm</span> (<span class="id" title="var">eqrelabmonoidfrac</span> <span class="id" title="var">X</span> (<span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>)) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">r</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">iseqrelabgrdiff</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">eqrelabgrdiff</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) : @<span class="id" title="var">eqrel</span> (<span class="id" title="var">abmonoiddirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">X</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">eqrelpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">iseqrelabgrdiff</span> <span class="id" title="var">X</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isbinophrelabgrdiff</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) : @<span class="id" title="var">isbinophrel</span> (<span class="id" title="var">abmonoiddirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">X</span>) (<span class="id" title="var">hrelabgrdiff</span> <span class="id" title="var">X</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (@<span class="id" title="var">isbinophrellogeqf</span> (<span class="id" title="var">abmonoiddirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">X</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">logeqhrelsabgrdiff</span> <span class="id" title="var">X</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">isbinophrelabmonoidfrac</span> <span class="id" title="var">X</span> (<span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>)) <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">dirprodpair</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">c</span>) (<span class="id" title="var">carrierpair</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, <span class="id" title="var">htrue</span>) (<span class="id" title="var">pr2</span> <span class="id" title="var">c</span>) <span class="id" title="var">tt</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">r</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">isbinophrelabmonoidfrac</span> <span class="id" title="var">X</span> (<span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>)) <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">dirprodpair</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">c</span>) (<span class="id" title="var">carrierpair</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, <span class="id" title="var">htrue</span>) (<span class="id" title="var">pr2</span> <span class="id" title="var">c</span>) <span class="id" title="var">tt</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">r</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">isbinophrelabgrdiff</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">binopeqrelabgrdiff</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">binopeqrel</span> (<span class="id" title="var">abmonoiddirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">X</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">binopeqrelpair</span> (<span class="id" title="var">eqrelabgrdiff</span> <span class="id" title="var">X</span>) (<span class="id" title="var">isbinophrelabgrdiff</span> <span class="id" title="var">X</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgrdiffcarrier</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">abmonoid</span> := @<span class="id" title="var">abmonoidquot</span> (<span class="id" title="var">abmonoiddirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">binopeqrelabgrdiff</span> <span class="id" title="var">X</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgrdiffinvint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) :  <span class="id" title="var">dirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">dirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">X</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">λ</span> <span class="id" title="var">xs</span> : <span class="id" title="var">_</span>, <span class="id" title="var">dirprodpair</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xs</span>) (<span class="id" title="var">pr1</span> <span class="id" title="var">xs</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">abgrdiffinvcomp</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">iscomprelrelfun</span> (<span class="id" title="var">hrelabgrdiff</span> <span class="id" title="var">X</span>) (<span class="id" title="var">eqrelabgrdiff</span> <span class="id" title="var">X</span>) (<span class="id" title="var">abgrdiffinvint</span> <span class="id" title="var">X</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">iscomprelrelfun</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">eqrelabgrdiff</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">hrelabgrdiff</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">eqrelabmonoidfrac</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">hrelabmonoidfrac</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">xs</span> <span class="id" title="var">xs'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">hinhfun</span>). <span class="id" title="tactic">intro</span> <span class="id" title="var">tt0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">x</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">xs</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">s</span> := <span class="id" title="var">pr2</span> <span class="id" title="var">xs</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">x'</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">xs'</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">s'</span> := <span class="id" title="var">pr2</span> <span class="id" title="var">xs'</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">tt0</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">tt0</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">a</span> <span class="id" title="var">eq</span> ]. <span class="id" title="tactic">change</span> (<span class="id" title="var">paths</span> (<span class="id" title="var">s</span> + <span class="id" title="var">x'</span> + <span class="id" title="var">a</span>) (<span class="id" title="var">s'</span> + <span class="id" title="var">x</span> + <span class="id" title="var">a</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span>(<span class="id" title="var">e</span> := <span class="id" title="var">commax</span> <span class="id" title="var">X</span> <span class="id" title="var">s'</span> <span class="id" title="var">x</span>). <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">e</span> := <span class="id" title="var">commax</span> <span class="id" title="var">X</span> <span class="id" title="var">s</span> <span class="id" title="var">x'</span>). <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">eq</span>.<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">abgrdiffinvcomp</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgrdiffinv</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">abgrdiffcarrier</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">abgrdiffcarrier</span> <span class="id" title="var">X</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">setquotfun</span> (<span class="id" title="var">hrelabgrdiff</span> <span class="id" title="var">X</span>) (<span class="id" title="var">eqrelabgrdiff</span> <span class="id" title="var">X</span>) (<span class="id" title="var">abgrdiffinvint</span> <span class="id" title="var">X</span>) (<span class="id" title="var">abgrdiffinvcomp</span> <span class="id" title="var">X</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">abgrdiffisinv</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isinv</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">abgrdiffcarrier</span> <span class="id" title="var">X</span>)) (<span class="id" title="var">unel</span> (<span class="id" title="var">abgrdiffcarrier</span> <span class="id" title="var">X</span>)) (<span class="id" title="var">abgrdiffinv</span> <span class="id" title="var">X</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">R</span> := <span class="id" title="var">eqrelabgrdiff</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">isl</span> : <span class="id" title="var">islinv</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">abgrdiffcarrier</span> <span class="id" title="var">X</span>)) (<span class="id" title="var">unel</span> (<span class="id" title="var">abgrdiffcarrier</span> <span class="id" title="var">X</span>)) (<span class="id" title="var">abgrdiffinv</span> <span class="id" title="var">X</span>)).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">islinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">setquotunivprop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">abgrdiffcarrier</span> <span class="id" title="var">X</span>, <span class="id" title="var">eqset</span> (<span class="id" title="var">abgrdiffinv</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span> + <span class="id" title="var">x</span>) (<span class="id" title="var">unel</span> (<span class="id" title="var">abgrdiffcarrier</span> <span class="id" title="var">X</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">xs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">x</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">xs</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">s</span> := <span class="id" title="var">pr2</span> <span class="id" title="var">xs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">iscompsetquotpr</span> <span class="id" title="var">R</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">abmonoiddirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">X</span>) (<span class="id" title="var">abgrdiffinvint</span> <span class="id" title="var">X</span> <span class="id" title="var">xs</span>) <span class="id" title="var">xs</span>) (<span class="id" title="var">unel</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhpr</span>. <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">paths</span> (<span class="id" title="var">s</span> + <span class="id" title="var">x</span> + (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>) + (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>)) ((<span class="id" title="var">unel</span> <span class="id" title="var">X</span>) + (<span class="id" title="var">x</span> + <span class="id" title="var">s</span>) + (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">commax</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>). <span class="id" title="tactic">destruct</span> (<span class="id" title="var">commax</span> <span class="id" title="var">X</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>) (<span class="id" title="var">x</span> + <span class="id" title="var">s</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">dirprodpair</span> <span class="id" title="var">isl</span> (<span class="id" title="var">weqlinvrinv</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">abgrdiffcarrier</span> <span class="id" title="var">X</span>)) (<span class="id" title="var">commax</span> (<span class="id" title="var">abgrdiffcarrier</span> <span class="id" title="var">X</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">unel</span> (<span class="id" title="var">abgrdiffcarrier</span> <span class="id" title="var">X</span>)) (<span class="id" title="var">abgrdiffinv</span> <span class="id" title="var">X</span>) <span class="id" title="var">isl</span>)).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">abgrdiffisinv</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgrdiff</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">abgr</span> := <span class="id" title="var">abgrconstr</span> (<span class="id" title="var">abgrdiffcarrier</span> <span class="id" title="var">X</span>) (<span class="id" title="var">abgrdiffinv</span> <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">abgrdiffisinv</span> <span class="id" title="var">X</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">prabgrdiff</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="var">abgrdiff</span> <span class="id" title="var">X</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">λ</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> : <span class="id" title="var">X</span>, <span class="id" title="var">setquotpr</span> (<span class="id" title="var">eqrelabgrdiff</span> <span class="id" title="var">X</span>) (<span class="id" title="var">dirprodpair</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab471"></a><h3 class="section">Abelian group of fractions and abelian monoid of fractions</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">weqabgrdiffint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">weq</span> (<span class="id" title="var">X</span> × <span class="id" title="var">X</span>) (<span class="id" title="var">dirprod</span> <span class="id" title="var">X</span> (<span class="id" title="var">totalsubtype</span> <span class="id" title="var">X</span>)) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">weqdirprodf</span> (<span class="id" title="var">idweq</span> <span class="id" title="var">X</span>) (<span class="id" title="var">invweq</span> (<span class="id" title="var">weqtotalsubtype</span> <span class="id" title="var">X</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">weqabgrdiff</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">weq</span> (<span class="id" title="var">abgrdiff</span> <span class="id" title="var">X</span>) (<span class="id" title="var">abmonoidfrac</span> <span class="id" title="var">X</span> (<span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">weqsetquotweq</span> (<span class="id" title="var">eqrelabgrdiff</span> <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">eqrelabmonoidfrac</span> <span class="id" title="var">X</span> (<span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>)) (<span class="id" title="var">weqabgrdiffint</span> <span class="id" title="var">X</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">x1</span> <span class="id" title="var">x2</span> ]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">x'</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">x1'</span> <span class="id" title="var">x2'</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhfun</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">tt0</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">tt0</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">xx0</span> <span class="id" title="var">is0</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">carrierpair</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, <span class="id" title="var">htrue</span>) <span class="id" title="var">xx0</span> <span class="id" title="var">tt</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">is0</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">x1</span> <span class="id" title="var">x2</span> ]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">x'</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">x1'</span> <span class="id" title="var">x2'</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhfun</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">tt0</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">tt0</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">xx0</span> <span class="id" title="var">is0</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">xx0</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">is0</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab472"></a><h3 class="section">Canonical homomorphism to the abelian group of fractions</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">toabgrdiff</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">X</span>) : <span class="id" title="var">abgrdiff</span> <span class="id" title="var">X</span> := <span class="id" title="var">setquotpr</span> <span class="id" title="var">_</span> (<span class="id" title="var">dirprodpair</span> <span class="id" title="var">x</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isbinopfuntoabgrdiff</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">isbinopfun</span> (<span class="id" title="var">toabgrdiff</span> <span class="id" title="var">X</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">isbinopfun</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">paths</span> (<span class="id" title="var">setquotpr</span> <span class="id" title="var">_</span> (<span class="id" title="var">dirprodpair</span> (<span class="id" title="var">x1</span> + <span class="id" title="var">x2</span>) (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">setquotpr</span> (<span class="id" title="var">eqrelabgrdiff</span> <span class="id" title="var">X</span>) (<span class="id" title="var">dirprodpair</span> (<span class="id" title="var">x1</span> + <span class="id" title="var">x2</span>) ((<span class="id" title="var">unel</span> <span class="id" title="var">X</span>) + (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>))))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">maponpaths</span> (<span class="id" title="var">setquotpr</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (@<span class="id" title="var">pathsdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pathsinv0</span> (<span class="id" title="var">lunax</span> <span class="id" title="var">X</span> 0)).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isunitalfuntoabgrdiff</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">paths</span> (<span class="id" title="var">toabgrdiff</span> <span class="id" title="var">X</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>)) (<span class="id" title="var">unel</span> (<span class="id" title="var">abgrdiff</span> <span class="id" title="var">X</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>. </div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ismonoidfuntoabgrdiff</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">ismonoidfun</span> (<span class="id" title="var">toabgrdiff</span> <span class="id" title="var">X</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">dirprodpair</span> (<span class="id" title="var">isbinopfuntoabgrdiff</span> <span class="id" title="var">X</span>) (<span class="id" title="var">isunitalfuntoabgrdiff</span> <span class="id" title="var">X</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab473"></a><h3 class="section">Abelian group of fractions in the case when all elements are cancelable</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isinclprabgrdiff</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">iscanc</span> : ∏ <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, <span class="id" title="var">isrcancelable</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>) <span class="id" title="var">x</span>) :<br/>
&nbsp;&nbsp;∏ <span class="id" title="var">x'</span> : <span class="id" title="var">X</span>, <span class="id" title="var">isincl</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">prabgrdiff</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">int</span> := <span class="id" title="var">isinclprabmonoidfrac</span> <span class="id" title="var">X</span> (<span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>) (<span class="id" title="var">λ</span> <span class="id" title="var">a</span> : <span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>, <span class="id" title="var">iscanc</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">a</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">carrierpair</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, <span class="id" title="var">htrue</span>) <span class="id" title="var">x'</span> <span class="id" title="var">tt</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">int1</span> := <span class="id" title="var">isinclcomp</span> (<span class="id" title="var">inclpair</span> <span class="id" title="var">_</span> <span class="id" title="var">int</span>) (<span class="id" title="var">weqtoincl</span> (<span class="id" title="var">invweq</span> (<span class="id" title="var">weqabgrdiff</span> <span class="id" title="var">X</span>)))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">int1</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isincltoabgrdiff</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">iscanc</span> : ∏ <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, <span class="id" title="var">isrcancelable</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>) <span class="id" title="var">x</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isincl</span> (<span class="id" title="var">toabgrdiff</span> <span class="id" title="var">X</span>) := <span class="id" title="var">isinclprabgrdiff</span> <span class="id" title="var">X</span> <span class="id" title="var">iscanc</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isdeceqabgrdiff</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">iscanc</span> : ∏ <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, <span class="id" title="var">isrcancelable</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>) <span class="id" title="var">x</span>) (<span class="id" title="keyword">is</span> : <span class="id" title="var">isdeceq</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isdeceq</span> (<span class="id" title="var">abgrdiff</span> <span class="id" title="var">X</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isdeceqweqf</span> (<span class="id" title="var">invweq</span> (<span class="id" title="var">weqabgrdiff</span> <span class="id" title="var">X</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isdeceqabmonoidfrac</span> <span class="id" title="var">X</span> (<span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>) (<span class="id" title="var">λ</span> <span class="id" title="var">a</span> : <span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>, <span class="id" title="var">iscanc</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">a</span>)) <span class="id" title="keyword">is</span>).<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab474"></a><h3 class="section">Relations on the abelian group of fractions</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgrdiffrelint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>) : <span class="id" title="var">hrel</span> (<span class="id" title="var">setwithbinopdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">X</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">λ</span> <span class="id" title="var">xa</span> <span class="id" title="var">yb</span>, <span class="id" title="var">hexists</span> (<span class="id" title="var">λ</span> <span class="id" title="var">c0</span> : <span class="id" title="var">X</span>, <span class="id" title="var">L</span> (((<span class="id" title="var">pr1</span> <span class="id" title="var">xa</span>) + (<span class="id" title="var">pr2</span> <span class="id" title="var">yb</span>)) + <span class="id" title="var">c0</span>) (((<span class="id" title="var">pr1</span> <span class="id" title="var">yb</span>) + (<span class="id" title="var">pr2</span> <span class="id" title="var">xa</span>)) + <span class="id" title="var">c0</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgrdiffrelint'</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>) : <span class="id" title="var">hrel</span> (<span class="id" title="var">setwithbinopdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">X</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">λ</span> <span class="id" title="var">xa1</span> <span class="id" title="var">xa2</span>, <span class="id" title="var">abmonoidfracrelint</span> <span class="id" title="var">_</span> (<span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>) <span class="id" title="var">L</span> (<span class="id" title="var">abgrdiffphi</span> <span class="id" title="var">X</span> <span class="id" title="var">xa1</span>) (<span class="id" title="var">abgrdiffphi</span> <span class="id" title="var">X</span> <span class="id" title="var">xa2</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">logeqabgrdiffrelints</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hrellogeq</span> (<span class="id" title="var">abgrdiffrelint'</span> <span class="id" title="var">X</span> <span class="id" title="var">L</span>) (<span class="id" title="var">abgrdiffrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">L</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">split</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">abgrdiffrelint</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">abgrdiffrelint'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhfun</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">t2</span>. <span class="id" title="tactic">set</span> (<span class="id" title="var">a0</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">t2</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">a0</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">t2</span>). <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhfun</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t2</span>. <span class="id" title="tactic">set</span> (<span class="id" title="var">x0</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">t2</span>). <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">tpair</span> <span class="id" title="var">_</span> <span class="id" title="var">x0</span> <span class="id" title="var">tt</span>). <span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">t2</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iscomprelabgrdiffrelint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">iscomprelrel</span> (<span class="id" title="var">eqrelabgrdiff</span> <span class="id" title="var">X</span>) (<span class="id" title="var">abgrdiffrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">L</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">iscomprelrellogeqf1</span> <span class="id" title="var">_</span> (<span class="id" title="var">logeqhrelsabgrdiff</span> <span class="id" title="var">X</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">iscomprelrellogeqf2</span> <span class="id" title="var">_</span> (<span class="id" title="var">logeqabgrdiffrelints</span> <span class="id" title="var">X</span> <span class="id" title="var">L</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">x0</span> <span class="id" title="var">x0'</span> <span class="id" title="var">r</span> <span class="id" title="var">r0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">iscomprelabmonoidfracrelint</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_</span> (<span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>) (<span class="id" title="var">isbinoptoispartbinop</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">is</span>)  <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">r</span> <span class="id" title="var">r0</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">iscomprelabgrdiffrelint</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgrdiffrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">quotrel</span> (<span class="id" title="var">iscomprelabgrdiffrelint</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgrdiffrel'</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>) : <span class="id" title="var">hrel</span> (<span class="id" title="var">abgrdiff</span> <span class="id" title="var">X</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">λ</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>, <span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> (<span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>) (<span class="id" title="var">isbinoptoispartbinop</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">is</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">weqabgrdiff</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>) (<span class="id" title="var">weqabgrdiff</span> <span class="id" title="var">X</span> <span class="id" title="var">x'</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">logeqabgrdiffrels</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hrellogeq</span> (<span class="id" title="var">abgrdiffrel'</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>) (<span class="id" title="var">abgrdiffrel</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> (<span class="id" title="var">int</span> : ∏ <span class="id" title="var">x</span> <span class="id" title="var">x'</span>, <span class="id" title="var">isaprop</span> (<span class="id" title="var">abgrdiffrel'</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> -&gt; <span class="id" title="var">abgrdiffrel</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>. <span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">setquotuniv2prop</span> <span class="id" title="var">_</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>, <span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> (<span class="id" title="var">int</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ((<span class="id" title="var">abgrdiffrelint'</span> <span class="id" title="var">X</span> <span class="id" title="var">L</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>)  -&gt; (<span class="id" title="var">abgrdiffrelint</span> <span class="id" title="var">_</span> <span class="id" title="var">L</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">logeqabgrdiffrelints</span> <span class="id" title="var">X</span> <span class="id" title="var">L</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> (<span class="id" title="var">int</span> : ∏ <span class="id" title="var">x</span> <span class="id" title="var">x'</span>, <span class="id" title="var">isaprop</span> (<span class="id" title="var">abgrdiffrel</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> -&gt; <span class="id" title="var">abgrdiffrel'</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>. <span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">setquotuniv2prop</span> <span class="id" title="var">_</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>, <span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> (<span class="id" title="var">int</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ((<span class="id" title="var">abgrdiffrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">L</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>) -&gt; (<span class="id" title="var">abgrdiffrelint'</span> <span class="id" title="var">_</span> <span class="id" title="var">L</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">logeqabgrdiffrelints</span> <span class="id" title="var">X</span> <span class="id" title="var">L</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">istransabgrdiffrelint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">istrans</span> <span class="id" title="var">L</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">istrans</span> (<span class="id" title="var">abgrdiffrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">L</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">istranslogeqf</span> (<span class="id" title="var">logeqabgrdiffrelints</span> <span class="id" title="var">X</span> <span class="id" title="var">L</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">rab</span> <span class="id" title="var">rbc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">istransabmonoidfracrelint</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_</span> (<span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>) (<span class="id" title="var">isbinoptoispartbinop</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">is</span>)  <span class="id" title="var">isl</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">rab</span> <span class="id" title="var">rbc</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">istransabgrdiffrelint</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">istransabgrdiffrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">istrans</span> <span class="id" title="var">L</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">istrans</span> (<span class="id" title="var">abgrdiffrel</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">istransquotrel</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">istransabgrdiffrelint</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="keyword">is</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isl</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">issymmabgrdiffrelint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">issymm</span> <span class="id" title="var">L</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">issymm</span> (<span class="id" title="var">abgrdiffrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">L</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">issymmlogeqf</span> (<span class="id" title="var">logeqabgrdiffrelints</span> <span class="id" title="var">X</span> <span class="id" title="var">L</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">rab</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">issymmabmonoidfracrelint</span> <span class="id" title="var">_</span> (<span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>) (<span class="id" title="var">isbinoptoispartbinop</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">isl</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">rab</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">issymmabgrdiffrelint</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">issymmabgrdiffrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">issymm</span> <span class="id" title="var">L</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">issymm</span> (<span class="id" title="var">abgrdiffrel</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">issymmquotrel</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">issymmabgrdiffrelint</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="keyword">is</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isl</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isreflabgrdiffrelint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">isrefl</span> <span class="id" title="var">L</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isrefl</span> (<span class="id" title="var">abgrdiffrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">L</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">xa</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">abgrdiffrelint</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hinhpr</span>. <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>). <span class="id" title="tactic">apply</span> (<span class="id" title="var">isl</span> <span class="id" title="var">_</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isreflabgrdiffrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">isrefl</span> <span class="id" title="var">L</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isrefl</span> (<span class="id" title="var">abgrdiffrel</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">isreflquotrel</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">isreflabgrdiffrelint</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="keyword">is</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isl</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ispoabgrdiffrelint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">ispreorder</span> <span class="id" title="var">L</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">ispreorder</span> (<span class="id" title="var">abgrdiffrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">L</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">istransabgrdiffrelint</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">isl</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isreflabgrdiffrelint</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">isl</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ispoabgrdiffrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">ispreorder</span> <span class="id" title="var">L</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">ispreorder</span> (<span class="id" title="var">abgrdiffrel</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ispoquotrel</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">ispoabgrdiffrelint</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="keyword">is</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isl</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iseqrelabgrdiffrelint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">iseqrel</span> <span class="id" title="var">L</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">iseqrel</span> (<span class="id" title="var">abgrdiffrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">L</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">ispoabgrdiffrelint</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">isl</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">issymmabgrdiffrelint</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">isl</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iseqrelabgrdiffrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">iseqrel</span> <span class="id" title="var">L</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">iseqrel</span> (<span class="id" title="var">abgrdiffrel</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">iseqrelquotrel</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">iseqrelabgrdiffrelint</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="keyword">is</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isl</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isantisymmnegabgrdiffrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">isl</span> : <span class="id" title="var">isantisymmneg</span> <span class="id" title="var">L</span>) : <span class="id" title="var">isantisymmneg</span> (<span class="id" title="var">abgrdiffrel</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isantisymmneglogeqf</span> (<span class="id" title="var">logeqabgrdiffrels</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">rab</span> <span class="id" title="var">rba</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">int</span> := <span class="id" title="var">isantisymmnegabmonoidfracrel</span> <span class="id" title="var">_</span> (<span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>) (<span class="id" title="var">isbinoptoispartbinop</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">is</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isl</span> (<span class="id" title="var">weqabgrdiff</span> <span class="id" title="var">X</span> <span class="id" title="var">a</span>) (<span class="id" title="var">weqabgrdiff</span> <span class="id" title="var">X</span> <span class="id" title="var">b</span>) <span class="id" title="var">rab</span> <span class="id" title="var">rba</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">invmaponpathsweq</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">int</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isantisymmabgrdiffrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">isantisymm</span> <span class="id" title="var">L</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isantisymm</span> (<span class="id" title="var">abgrdiffrel</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isantisymmlogeqf</span> (<span class="id" title="var">logeqabgrdiffrels</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">rab</span> <span class="id" title="var">rba</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">int</span> := <span class="id" title="var">isantisymmabmonoidfracrel</span> <span class="id" title="var">_</span> (<span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>) (<span class="id" title="var">isbinoptoispartbinop</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">is</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isl</span> (<span class="id" title="var">weqabgrdiff</span> <span class="id" title="var">X</span> <span class="id" title="var">a</span>) (<span class="id" title="var">weqabgrdiff</span> <span class="id" title="var">X</span> <span class="id" title="var">b</span>) <span class="id" title="var">rab</span> <span class="id" title="var">rba</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">invmaponpathsweq</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">int</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span>  <span class="id" title="var">isantisymmabgrdiffrel</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isirreflabgrdiffrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">isirrefl</span> <span class="id" title="var">L</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isirrefl</span> (<span class="id" title="var">abgrdiffrel</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isirrefllogeqf</span> (<span class="id" title="var">logeqabgrdiffrels</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">raa</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isirreflabmonoidfracrel</span> <span class="id" title="var">_</span> (<span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>) (<span class="id" title="var">isbinoptoispartbinop</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">is</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isl</span> (<span class="id" title="var">weqabgrdiff</span> <span class="id" title="var">X</span> <span class="id" title="var">a</span>) <span class="id" title="var">raa</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">isirreflabgrdiffrel</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isasymmabgrdiffrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">isasymm</span> <span class="id" title="var">L</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isasymm</span> (<span class="id" title="var">abgrdiffrel</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isasymmlogeqf</span> (<span class="id" title="var">logeqabgrdiffrels</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">rab</span> <span class="id" title="var">rba</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isasymmabmonoidfracrel</span> <span class="id" title="var">_</span> (<span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>) (<span class="id" title="var">isbinoptoispartbinop</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">is</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isl</span> (<span class="id" title="var">weqabgrdiff</span> <span class="id" title="var">X</span> <span class="id" title="var">a</span>) (<span class="id" title="var">weqabgrdiff</span> <span class="id" title="var">X</span> <span class="id" title="var">b</span>) <span class="id" title="var">rab</span> <span class="id" title="var">rba</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">isasymmabgrdiffrel</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iscoasymmabgrdiffrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">iscoasymm</span> <span class="id" title="var">L</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">iscoasymm</span> (<span class="id" title="var">abgrdiffrel</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">iscoasymmlogeqf</span> (<span class="id" title="var">logeqabgrdiffrels</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">rab</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">iscoasymmabmonoidfracrel</span> <span class="id" title="var">_</span> (<span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>) (<span class="id" title="var">isbinoptoispartbinop</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">is</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isl</span> (<span class="id" title="var">weqabgrdiff</span> <span class="id" title="var">X</span> <span class="id" title="var">a</span>) (<span class="id" title="var">weqabgrdiff</span> <span class="id" title="var">X</span> <span class="id" title="var">b</span>) <span class="id" title="var">rab</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">iscoasymmabgrdiffrel</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">istotalabgrdiffrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">istotal</span> <span class="id" title="var">L</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">istotal</span> (<span class="id" title="var">abgrdiffrel</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">istotallogeqf</span> (<span class="id" title="var">logeqabgrdiffrels</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">istotalabmonoidfracrel</span> <span class="id" title="var">_</span> (<span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>) (<span class="id" title="var">isbinoptoispartbinop</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">is</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isl</span> (<span class="id" title="var">weqabgrdiff</span> <span class="id" title="var">X</span> <span class="id" title="var">a</span>) (<span class="id" title="var">weqabgrdiff</span> <span class="id" title="var">X</span> <span class="id" title="var">b</span>)).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">istotalabgrdiffrel</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iscotransabgrdiffrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">iscotrans</span> <span class="id" title="var">L</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">iscotrans</span> (<span class="id" title="var">abgrdiffrel</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">iscotranslogeqf</span> (<span class="id" title="var">logeqabgrdiffrels</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">iscotransabmonoidfracrel</span> <span class="id" title="var">_</span> (<span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>) (<span class="id" title="var">isbinoptoispartbinop</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">is</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isl</span> (<span class="id" title="var">weqabgrdiff</span> <span class="id" title="var">X</span> <span class="id" title="var">a</span>) (<span class="id" title="var">weqabgrdiff</span> <span class="id" title="var">X</span> <span class="id" title="var">b</span>) (<span class="id" title="var">weqabgrdiff</span> <span class="id" title="var">X</span> <span class="id" title="var">c</span>)).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">iscotransabgrdiffrel</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">abgrdiffrelimpl</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> <span class="id" title="var">L'</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>) (<span class="id" title="var">is'</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">impl</span> : ∏ <span class="id" title="var">x</span> <span class="id" title="var">x'</span>, <span class="id" title="var">L</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> -&gt; <span class="id" title="var">L'</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>) (<span class="id" title="var">x</span> <span class="id" title="var">x'</span> : <span class="id" title="var">abgrdiff</span> <span class="id" title="var">X</span>) (<span class="id" title="var">ql</span> : <span class="id" title="var">abgrdiffrel</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">abgrdiffrel</span> <span class="id" title="var">X</span> <span class="id" title="var">is'</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="var">ql</span>. <span class="id" title="tactic">refine</span> (<span class="id" title="var">quotrelimpl</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x0</span> <span class="id" title="var">x0'</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhfun</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">t2</span>. <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">t2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">impl</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">t2</span>)).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">abgrdiffrelimpl</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">abgrdiffrellogeq</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> <span class="id" title="var">L'</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>) (<span class="id" title="var">is'</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">lg</span> : ∏ <span class="id" title="var">x</span> <span class="id" title="var">x'</span>, <span class="id" title="var">L</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> &lt;-&gt; <span class="id" title="var">L'</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>) (<span class="id" title="var">x</span> <span class="id" title="var">x'</span> : <span class="id" title="var">abgrdiff</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;(<span class="id" title="var">abgrdiffrel</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>) &lt;-&gt; (<span class="id" title="var">abgrdiffrel</span> <span class="id" title="var">X</span> <span class="id" title="var">is'</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">quotrellogeq</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">intros</span> <span class="id" title="var">x0</span> <span class="id" title="var">x0'</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhfun</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">t2</span>. <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">t2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">lg</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) (<span class="id" title="var">pr2</span> <span class="id" title="var">t2</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhfun</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">t2</span>. <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">t2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">lg</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) (<span class="id" title="var">pr2</span> <span class="id" title="var">t2</span>)).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">abgrdiffrellogeq</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isbinopabgrdiffrelint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>) :<br/>
&nbsp;&nbsp;@<span class="id" title="var">isbinophrel</span> (<span class="id" title="var">setwithbinopdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">X</span>) (<span class="id" title="var">abgrdiffrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">L</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isbinophrellogeqf</span> (<span class="id" title="var">logeqabgrdiffrelints</span> <span class="id" title="var">X</span> <span class="id" title="var">L</span>)). <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">lab</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">ispartbinopabmonoidfracrelint</span> <span class="id" title="var">_</span> (<span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>) (<span class="id" title="var">isbinoptoispartbinop</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">is</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">abgrdiffphi</span> <span class="id" title="var">X</span> <span class="id" title="var">a</span>) (<span class="id" title="var">abgrdiffphi</span> <span class="id" title="var">X</span> <span class="id" title="var">b</span>) (<span class="id" title="var">abgrdiffphi</span> <span class="id" title="var">X</span> <span class="id" title="var">c</span>) <span class="id" title="var">tt</span> <span class="id" title="var">lab</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">lab</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">ispartbinopabmonoidfracrelint</span> <span class="id" title="var">_</span> (<span class="id" title="var">totalsubmonoid</span> <span class="id" title="var">X</span>) (<span class="id" title="var">isbinoptoispartbinop</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">is</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">abgrdiffphi</span> <span class="id" title="var">X</span> <span class="id" title="var">a</span>) (<span class="id" title="var">abgrdiffphi</span> <span class="id" title="var">X</span> <span class="id" title="var">b</span>) (<span class="id" title="var">abgrdiffphi</span> <span class="id" title="var">X</span> <span class="id" title="var">c</span>) <span class="id" title="var">tt</span> <span class="id" title="var">lab</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">isbinopabgrdiffrelint</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isbinopabgrdiffrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>) :<br/>
&nbsp;&nbsp;@<span class="id" title="var">isbinophrel</span> (<span class="id" title="var">abgrdiff</span> <span class="id" title="var">X</span>) (<span class="id" title="var">abgrdiffrel</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isbinopquotrel</span> (<span class="id" title="var">binopeqrelabgrdiff</span> <span class="id" title="var">X</span>) (<span class="id" title="var">iscomprelabgrdiffrelint</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isbinopabgrdiffrelint</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isdecabgrdiffrelint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">isinvbinophrel</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">isdecrel</span> <span class="id" title="var">L</span>) : <span class="id" title="var">isdecrel</span> (<span class="id" title="var">abgrdiffrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">L</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">xa1</span> <span class="id" title="var">xa2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">x1</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">xa1</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">a1</span> := <span class="id" title="var">pr2</span> <span class="id" title="var">xa1</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">x2</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">xa2</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">a2</span> := <span class="id" title="var">pr2</span> <span class="id" title="var">xa2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">int</span> : <span class="id" title="var">coprod</span> (<span class="id" title="var">L</span> (<span class="id" title="var">x1</span> + <span class="id" title="var">a2</span>) (<span class="id" title="var">x2</span> + <span class="id" title="var">a1</span>)) (<span class="id" title="var">neg</span> (<span class="id" title="var">L</span> (<span class="id" title="var">x1</span> + <span class="id" title="var">a2</span>) (<span class="id" title="var">x2</span> + <span class="id" title="var">a1</span>)))) <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">isl</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">int</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> | <span class="id" title="var">nl</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii1</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">abgrdiffrelint</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhpr</span>. <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">runax</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">runax</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii2</span>. <span class="id" title="tactic">generalize</span> <span class="id" title="var">nl</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">nl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">negf</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">abgrdiffrelint</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> (@<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> (<span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">L</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t2l</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">t2l</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">c0a</span> <span class="id" title="var">l</span> ]. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> ((<span class="id" title="var">pr2</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">c0a</span> <span class="id" title="var">l</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isdecabgrdiffrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">isi</span> : <span class="id" title="var">isinvbinophrel</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">isdecrel</span> <span class="id" title="var">L</span>) : <span class="id" title="var">isdecrel</span> (<span class="id" title="var">abgrdiffrel</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">isdecquotrel</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">isdecabgrdiffrelint</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isi</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isl</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab475"></a><h3 class="section">Relations and the canonical homomorphism to <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">abgrdiff</span></span> <span class="inlinecode"></span></h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iscomptoabgrdiff</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isbinophrel</span> <span class="id" title="var">L</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">iscomprelrelfun</span> <span class="id" title="var">L</span> (<span class="id" title="var">abgrdiffrel</span> <span class="id" title="var">X</span> <span class="id" title="keyword">is</span>) (<span class="id" title="var">toabgrdiff</span> <span class="id" title="var">X</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">iscomprelrelfun</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">abgrdiffrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">L</span> (<span class="id" title="var">dirprodpair</span> <span class="id" title="var">x</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>)) (<span class="id" title="var">dirprodpair</span> <span class="id" title="var">x'</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">hinhpr</span>). <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ((<span class="id" title="var">pr2</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> 0). <span class="id" title="tactic">apply</span> ((<span class="id" title="var">pr2</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> 0).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">l</span>.<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">iscomptoabgrdiff</span>.<br/>

<br/>
<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">addmonoid_scope</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Fractions</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="https://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>