<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
	<script src="http://code.jquery.com/jquery-1.11.0.min.js" type="text/javascript"></script>
	<script src="./proofs-toggle.js" type="text/javascript"></script>
	<style>
		div.proofcomment {
			font-style: italic;
		}
	</style>
	<title>Documentation</title>
</head>
<body>
<div id="page">
<div id="main">
<h1 class="libtitle">Library UniMath.Combinatorics.StandardFiniteSets</h1>

<div class="code">
</div>

<div class="doc">
<a name="lab329"></a><h1 class="section">Standard finite sets . Vladimir Voevodsky . Apr. - Sep. 2011 .</h1>


<div class="paragraph"> </div>

This file contains main constructions related to the standard finite sets defined as the initial intervals of <span class="inlinecode"></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#nat"><span class="id" title="inductive">nat</span></a></span> <span class="inlinecode"></span> and their properties . 
<div class="paragraph"> </div>

<a name="lab330"></a><h2 class="section">Preamble</h2>

<div class="paragraph"> </div>

 Imports. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">UniMath.Foundations.NaturalNumbers</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.MoreFoundations.Tactics</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.MoreFoundations.DecidablePropositions</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.MoreFoundations.NegativePropositions</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab331"></a><h2 class="section">Standard finite sets <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode"></span>.</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stn</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) := ∑ <span class="id" title="var">m</span>, <span class="id" title="var">m</span> &lt; <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stnpair</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> (<span class="id" title="var">l</span>:<span class="id" title="var">m</span>&lt;<span class="id" title="var">n</span>) := (<span class="id" title="var">m</span>,,<span class="id" title="var">l</span>) : <span class="id" title="var">stn</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stntonat</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) : <span class="id" title="var">stn</span> <span class="id" title="var">n</span> -&gt; <span class="id" title="var">nat</span> := @<span class="id" title="var">pr1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> .<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">stntonat</span> : <span class="id" title="var">stn</span> &gt;-&gt; <span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stnlt</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">i</span>:<span class="id" title="var">stn</span> <span class="id" title="var">n</span>) : <span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">i</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Notation</span> &quot; 'stnpr' j " := (<span class="id" title="var">j</span>,,<span class="id" title="var">idpath</span> <span class="id" title="var">_</span>) ( <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70 ).<br/>
<span class="id" title="keyword">Notation</span> &quot; 'stnel' ( i , j ) " := ( (<span class="id" title="var">j</span>,,<span class="id" title="var">idpath</span> <span class="id" title="var">_</span>) : <span class="id" title="var">stn</span> <span class="id" title="var">i</span> ) ( <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70 ).<br/>

<br/>
<span class="id" title="keyword">Delimit</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">stn</span> <span class="id" title="keyword">with</span> <span class="id" title="var">stn</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;⟦ n ⟧" := (<span class="id" title="var">stn</span> <span class="id" title="var">n</span>) : <span class="id" title="var">stn</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;● i" := (<span class="id" title="var">i</span> ,, (<span class="id" title="var">idpath</span> <span class="id" title="var">_</span> : <span class="id" title="var">natgtb</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> = <span class="id" title="var">_</span>)) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 35) : <span class="id" title="var">stn</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isinclstntonat</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) : <span class="id" title="var">isincl</span> ( <span class="id" title="var">stntonat</span> <span class="id" title="var">n</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">isinclpr1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">natlth</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> ) ).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stntonat_incl</span> <span class="id" title="var">n</span> := <span class="id" title="var">inclpair</span> (<span class="id" title="var">stntonat</span> <span class="id" title="var">n</span>) (<span class="id" title="var">isinclstntonat</span> <span class="id" title="var">n</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isdecinclstntonat</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) : <span class="id" title="var">isdecincl</span> ( <span class="id" title="var">stntonat</span> <span class="id" title="var">n</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">isdecinclpr1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isdecpropif</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">pr2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isdecrelnatgth</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">neghfiberstntonat</span> ( <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span> ) ( <span class="id" title="keyword">is</span> : <span class="id" title="var">natgeh</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> ) : ¬ ( <span class="id" title="var">hfiber</span> ( <span class="id" title="var">stntonat</span> <span class="id" title="var">n</span> ) <span class="id" title="var">m</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">h</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">j</span> <span class="id" title="var">e</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">j</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">j</span> <span class="id" title="var">is'</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">is'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">natgehtonegnatlth</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">is</span> <span class="id" title="var">is'</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iscontrhfiberstntonat</span> ( <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span> ) ( <span class="id" title="keyword">is</span> : <span class="id" title="var">natlth</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">iscontr</span> ( <span class="id" title="var">hfiber</span> ( <span class="id" title="var">stntonat</span> <span class="id" title="var">n</span> ) <span class="id" title="var">m</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">iscontrhfiberofincl</span> ( <span class="id" title="var">stntonat</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">isinclstntonat</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">stnpair</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ) ).<br/>
</div>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">stn</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stn_ne_iff_neq</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">i</span> <span class="id" title="var">j</span>: ⟦<span class="id" title="var">n</span>⟧ ) : ¬ (<span class="id" title="var">i</span> = <span class="id" title="var">j</span>) &lt;-&gt; <span class="id" title="var">stntonat</span> <span class="id" title="var">_</span> <span class="id" title="var">i</span> ≠ <span class="id" title="var">stntonat</span> <span class="id" title="var">_</span> <span class="id" title="var">j</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">ne</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_nopath_to_neq</span>. <span class="id" title="var">Set Printing Coercions</span>. <span class="id" title="tactic">idtac</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">e</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">ne</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">ne</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">neq</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">nat_neq_to_nopath</span> <span class="id" title="var">neq</span>), <span class="id" title="var">maponpaths</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Unset Printing Coercions</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stnneq</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} : <span class="id" title="var">neqReln</span> (⟦<span class="id" title="var">n</span>⟧).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> &nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">i</span> ≠ <span class="id" title="var">j</span>)%<span class="id" title="var">nat</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">propproperty</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">stn_ne_iff_neq</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Notation</span> &quot; x ≠ y " := ( <span class="id" title="var">stnneq</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> ) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70, <span class="id" title="keyword">no</span> <span class="id" title="keyword">associativity</span>) : <span class="id" title="var">stn</span>.<br/>
<span class="id" title="keyword">Delimit</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">stn</span> <span class="id" title="keyword">with</span> <span class="id" title="var">stn</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">stn</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isisolatedinstn</span> { <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> } ( <span class="id" title="var">x</span> : ⟦<span class="id" title="var">n</span>⟧ ) : <span class="id" title="var">isisolated</span> <span class="id" title="var">_</span> <span class="id" title="var">x</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">isisolatedinclb</span> ( <span class="id" title="var">stntonat</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">isinclstntonat</span> <span class="id" title="var">n</span> ) <span class="id" title="var">x</span> ( <span class="id" title="var">isisolatedn</span> <span class="id" title="var">x</span> ) ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stnneq_iff_nopath</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">i</span> <span class="id" title="var">j</span>: ⟦<span class="id" title="var">n</span>⟧ ) : ¬ (<span class="id" title="var">i</span> = <span class="id" title="var">j</span>) &lt;-&gt; <span class="id" title="var">i</span> ≠ <span class="id" title="var">j</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">negProp_to_iff</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stnneq_to_nopath</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">i</span> <span class="id" title="var">j</span>: ⟦<span class="id" title="var">n</span>⟧ ) : ¬ (<span class="id" title="var">i</span> = <span class="id" title="var">j</span>) &lt;- <span class="id" title="var">i</span> ≠ <span class="id" title="var">j</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">pr2</span> (<span class="id" title="var">stn_ne_iff_neq</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>).<br/>

<br/>
<span class="id" title="keyword">Corollary</span> <span class="id" title="var">isdeceqstn</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) : <span class="id" title="var">isdeceq</span> (⟦<span class="id" title="var">n</span>⟧).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">isdeceq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isisolatedinstn</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stn_eq_or_neq</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">i</span> <span class="id" title="var">j</span>: ⟦<span class="id" title="var">n</span>⟧ ) : (<span class="id" title="var">i</span>=<span class="id" title="var">j</span>) ⨿ (<span class="id" title="var">i</span>≠<span class="id" title="var">j</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> (<span class="id" title="var">nat_eq_or_neq</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">eq</span>|<span class="id" title="var">ne</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii1</span>, <span class="id" title="var">subtypeEquality_prop</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii2</span>. <span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">weqisolatedstntostn</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) : ( <span class="id" title="var">isolated</span> (⟦<span class="id" title="var">n</span>⟧) ) ≃ ⟦<span class="id" title="var">n</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">weqpr1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">iscontraprop1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isapropisisolated</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">int</span> := <span class="id" title="var">isdeceqstn</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span>  ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Corollary</span> <span class="id" title="var">isasetstn</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) : <span class="id" title="var">isaset</span> (⟦<span class="id" title="var">n</span>⟧).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">isasetifdeceq</span> <span class="id" title="var">_</span> ( <span class="id" title="var">isdeceqstn</span> <span class="id" title="var">n</span> ) ).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stnset</span> <span class="id" title="var">n</span> := <span class="id" title="var">hSetpair</span> (⟦<span class="id" title="var">n</span>⟧) (<span class="id" title="var">isasetstn</span> <span class="id" title="var">n</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stn_to_nat</span> <span class="id" title="var">n</span> : <span class="id" title="var">stnset</span> <span class="id" title="var">n</span> -&gt; <span class="id" title="var">natset</span> := <span class="id" title="var">pr1</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stnposet</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) : <span class="id" title="var">Poset</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">Poset</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">_</span>,,<span class="id" title="var">isasetstn</span> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">PartialOrder</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>: ⟦<span class="id" title="var">n</span>⟧, <span class="id" title="var">i</span> ≤ <span class="id" title="var">j</span>)%<span class="id" title="var">dnat</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">isPartialOrder</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">ispreorder</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">k</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">istransnatleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">isreflnatleh</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">r</span> <span class="id" title="var">s</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">invmaponpathsincl</span> <span class="id" title="var">_</span> ( <span class="id" title="var">isinclstntonat</span> <span class="id" title="var">_</span> )).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isantisymmnatleh</span>; <span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">lastelement</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">natgthsnn</span> <span class="id" title="var">n</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lastelement_ge</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} : ∏ <span class="id" title="var">i</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧, @<span class="id" title="var">lastelement</span> <span class="id" title="var">n</span> ≥ <span class="id" title="var">i</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natlthsntoleh</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">lastelement</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">stnlt</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">firstelement</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> 0.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natgthsn0</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">firstelement_le</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} : ∏ <span class="id" title="var">i</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧, @<span class="id" title="var">firstelement</span> <span class="id" title="var">n</span> ≤ <span class="id" title="var">i</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">firstValue</span> {<span class="id" title="var">X</span>:<span class="id" title="var">UU</span>} {<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>} : (⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">X</span>) -&gt; <span class="id" title="var">X</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">x</span> <span class="id" title="var">firstelement</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">lastValue</span> {<span class="id" title="var">X</span>:<span class="id" title="var">UU</span>} {<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>} : (⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">X</span>) -&gt; <span class="id" title="var">X</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">x</span> <span class="id" title="var">lastelement</span>.<br/>

<br/>
</div>

<div class="doc">
Dual of i in stn n, is n - 1 - i 
</div>
<div class="code">
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Lemma</span> <span class="id" title="var">dualelement_0_empty</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">i</span> : ⟦<span class="id" title="var">n</span>⟧ ) (<span class="id" title="var">e</span> : 0 = <span class="id" title="var">n</span>) : <span class="id" title="var">empty</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">negnatlthn0</span> <span class="id" title="var">_</span> (<span class="id" title="var">stnlt</span> <span class="id" title="var">i</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Lemma</span> <span class="id" title="var">dualelement_lt</span> (<span class="id" title="var">i</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">H</span> : <span class="id" title="var">n</span> &gt; 0) : <span class="id" title="var">n</span> - 1 - <span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">natminusminus</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">natminuslthn</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dualelement</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">i</span> : ⟦<span class="id" title="var">n</span>⟧ ) : ⟦<span class="id" title="var">n</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">natchoice0</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">H</span> | <span class="id" title="var">H</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">stnpair</span> <span class="id" title="var">n</span> (<span class="id" title="var">n</span> - 1 - <span class="id" title="var">i</span>) (<span class="id" title="var">fromempty</span> (<span class="id" title="var">dualelement_0_empty</span> <span class="id" title="var">i</span> <span class="id" title="var">H</span>))).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">stnpair</span> <span class="id" title="var">n</span> (<span class="id" title="var">n</span> - 1 - <span class="id" title="var">i</span>) (<span class="id" title="var">dualelement_lt</span> <span class="id" title="var">i</span> <span class="id" title="var">n</span> <span class="id" title="var">H</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stnmtostnn</span> ( <span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) (<span class="id" title="var">isnatleh</span>: <span class="id" title="var">natleh</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> ) : ⟦<span class="id" title="var">m</span>⟧ -&gt; ⟦<span class="id" title="var">n</span>⟧ :=<br/>
&nbsp;&nbsp;<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : ⟦<span class="id" title="var">m</span>⟧, <span class="id" title="keyword">match</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span> <span class="id" title="var">tpair</span> <span class="id" title="var">_</span> <span class="id" title="var">i</span> <span class="id" title="keyword">is</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="id" title="var">stnpair</span> <span class="id" title="var">_</span> <span class="id" title="var">i</span> ( <span class="id" title="var">natlthlehtrans</span> <span class="id" title="var">i</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="keyword">is</span> <span class="id" title="var">isnatleh</span> ) <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stn_left</span> (<span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : ⟦<span class="id" title="var">m</span>⟧ -&gt; ⟦<span class="id" title="var">m</span>+<span class="id" title="var">n</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">i</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">natlthlehtrans</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">i</span>) <span class="id" title="var">m</span> (<span class="id" title="var">m</span>+<span class="id" title="var">n</span>) (<span class="id" title="var">pr2</span> <span class="id" title="var">i</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natlehnplusnm</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stn_right</span> (<span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : ⟦<span class="id" title="var">n</span>⟧ -&gt; ⟦<span class="id" title="var">m</span>+<span class="id" title="var">n</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">m</span>+<span class="id" title="var">pr1</span> <span class="id" title="var">i</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natlthandplusl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">i</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stn_left_compute</span> (<span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">i</span>: ⟦<span class="id" title="var">m</span>⟧ ) : <span class="id" title="var">pr1</span> (<span class="id" title="var">stn_left</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span>) = <span class="id" title="var">i</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stn_right_compute</span> (<span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">i</span>: ⟦<span class="id" title="var">n</span>⟧ ) : <span class="id" title="var">pr1</span> (<span class="id" title="var">stn_right</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span>) = <span class="id" title="var">m</span>+<span class="id" title="var">i</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stn_left_0</span> {<span class="id" title="var">m</span>:<span class="id" title="var">nat</span>} {<span class="id" title="var">i</span>:⟦<span class="id" title="var">m</span>⟧} (<span class="id" title="var">e</span>: <span class="id" title="var">m</span>=<span class="id" title="var">m</span>+0) : <span class="id" title="var">stn_left</span> <span class="id" title="var">m</span> 0 <span class="id" title="var">i</span> = <span class="id" title="var">transportf</span> <span class="id" title="var">stn</span> <span class="id" title="var">e</span> <span class="id" title="var">i</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stn_left'</span> (<span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">m</span> ≤ <span class="id" title="var">n</span> -&gt; ⟦<span class="id" title="var">m</span>⟧ -&gt; ⟦<span class="id" title="var">n</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">le</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">stnpair</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">natlthlehtrans</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">stnlt</span> <span class="id" title="var">i</span>) <span class="id" title="var">le</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stn_left''</span> {<span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} : <span class="id" title="var">m</span> &lt; <span class="id" title="var">n</span> -&gt; ⟦<span class="id" title="var">m</span>⟧ -&gt; ⟦<span class="id" title="var">n</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">le</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">stnpair</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">istransnatlth</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">stnlt</span> <span class="id" title="var">i</span>) <span class="id" title="var">le</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stn_left_compare</span> (<span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">m</span> ≤ <span class="id" title="var">m</span>+<span class="id" title="var">n</span>) : <span class="id" title="var">stn_left'</span> <span class="id" title="var">m</span> (<span class="id" title="var">m</span>+<span class="id" title="var">n</span>) <span class="id" title="var">r</span> = <span class="id" title="var">stn_left</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">funextfun</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab332"></a><h2 class="section">"Boundary" maps <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">dni</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode">(</span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">)</span> <span class="inlinecode"></span> and their properties.</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dni</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} ( <span class="id" title="var">i</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ ) : ⟦<span class="id" title="var">n</span>⟧ -&gt; ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">di</span> <span class="id" title="var">i</span> <span class="id" title="var">x</span>). <span class="id" title="tactic">unfold</span> <span class="id" title="var">di</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">natlthorgeh</span> <span class="id" title="var">x</span> <span class="id" title="var">i</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">lt</span>|<span class="id" title="var">ge</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">natgthtogths</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">x</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">compute_pr1_dni_last</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">i</span>: ⟦<span class="id" title="var">n</span>⟧ ) : <span class="id" title="var">pr1</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">i</span>) = <span class="id" title="var">pr1</span> <span class="id" title="var">i</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">dni</span>,<span class="id" title="var">di</span>; <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">induction</span> (<span class="id" title="var">natlthorgeh</span> <span class="id" title="var">i</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">q</span>|<span class="id" title="var">q</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">contradicts</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">i</span>) (<span class="id" title="var">natlehneggth</span> <span class="id" title="var">q</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">compute_pr1_dni_first</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">i</span>: ⟦<span class="id" title="var">n</span>⟧ ) : <span class="id" title="var">pr1</span> (<span class="id" title="var">dni</span> <span class="id" title="var">firstelement</span> <span class="id" title="var">i</span>) = <span class="id" title="var">S</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">i</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dni_last</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">i</span>: ⟦<span class="id" title="var">n</span>⟧ ) : <span class="id" title="var">pr1</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">i</span>) = <span class="id" title="var">i</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">i</span> <span class="id" title="var">I</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dni</span>,<span class="id" title="var">di</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">natlthorgeh</span> <span class="id" title="var">i</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">g</span>|<span class="id" title="var">g</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contradicts</span> (<span class="id" title="var">natlehtonegnatgth</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">g</span>) <span class="id" title="var">I</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dni_first</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">i</span>: ⟦<span class="id" title="var">n</span>⟧ ) : <span class="id" title="var">pr1</span> (<span class="id" title="var">dni</span> <span class="id" title="var">firstelement</span> <span class="id" title="var">i</span>) = <span class="id" title="var">S</span> <span class="id" title="var">i</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dni_firstelement</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} : ⟦<span class="id" title="var">n</span>⟧ -&gt; ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">S</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">h</span>),, <span class="id" title="var">pr2</span> <span class="id" title="var">h</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">replace_dni_first</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">dni</span> (@<span class="id" title="var">firstelement</span> <span class="id" title="var">n</span>) = <span class="id" title="var">dni_firstelement</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">funextfun</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">compute_pr1_dni_first</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dni_lastelement</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} : ⟦<span class="id" title="var">n</span>⟧ -&gt; ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">h</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">natlthtolths</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">h</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">replace_dni_last</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">dni</span> (@<span class="id" title="var">lastelement</span> <span class="id" title="var">n</span>) = <span class="id" title="var">dni_lastelement</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">funextfun</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">compute_pr1_dni_last</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dni_lastelement_ord</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} : ∏ <span class="id" title="var">i</span> <span class="id" title="var">j</span>: ⟦<span class="id" title="var">n</span>⟧, <span class="id" title="var">i</span>≤<span class="id" title="var">j</span> -&gt; <span class="id" title="var">dni_lastelement</span> <span class="id" title="var">i</span> ≤ <span class="id" title="var">dni_lastelement</span> <span class="id" title="var">j</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? ? <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">e</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pr1_dni_lastelement</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} {<span class="id" title="var">i</span>: ⟦<span class="id" title="var">n</span>⟧ } : <span class="id" title="var">pr1</span> (<span class="id" title="var">dni_lastelement</span> <span class="id" title="var">i</span>) = <span class="id" title="var">pr1</span> <span class="id" title="var">i</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dni_last_lt</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">j</span> : ⟦ <span class="id" title="var">n</span> ⟧) : <span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">j</span> &lt; @<span class="id" title="var">lastelement</span> <span class="id" title="var">n</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">j</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">j</span> <span class="id" title="var">J</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">di</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">natlthorgeh</span> <span class="id" title="var">j</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">L</span>|<span class="id" title="var">M</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">J</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">natlthtonegnatgeh</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">J</span> <span class="id" title="var">M</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dnicommsq</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) ( <span class="id" title="var">i</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">commsqstr</span>( <span class="id" title="var">dni</span> <span class="id" title="var">i</span> )  ( <span class="id" title="var">stntonat</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) ( <span class="id" title="var">stntonat</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">di</span> <span class="id" title="var">i</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dni</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">di</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">natlthorgeh</span> <span class="id" title="var">x</span> <span class="id" title="var">i</span> ).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">dnihfsq</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) ( <span class="id" title="var">i</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hfsqstr</span> ( <span class="id" title="var">di</span> <span class="id" title="var">i</span> ) ( <span class="id" title="var">stntonat</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) ( <span class="id" title="var">stntonat</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">dni</span> <span class="id" title="var">i</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">ishfsqweqhfibersgtof'</span> ( <span class="id" title="var">di</span> <span class="id" title="var">i</span> ) ( <span class="id" title="var">stntonat</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) ( <span class="id" title="var">stntonat</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">dni</span> <span class="id" title="var">i</span> ) ( <span class="id" title="var">dnicommsq</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>  ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">natlthorgeh</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">g</span> | <span class="id" title="var">l</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> ( <span class="id" title="var">is1</span> : <span class="id" title="var">iscontr</span> ( <span class="id" title="var">hfiber</span> ( <span class="id" title="var">stntonat</span> <span class="id" title="var">n</span> ) <span class="id" title="var">x</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">iscontrhfiberstntonat</span>. <span class="id" title="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">is2</span> : <span class="id" title="var">iscontr</span> ( <span class="id" title="var">hfiber</span> ( <span class="id" title="var">stntonat</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) ( <span class="id" title="var">di</span> <span class="id" title="var">i</span> <span class="id" title="var">x</span> )  ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">iscontrhfiberstntonat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">natlehlthtrans</span> <span class="id" title="var">_</span> ( <span class="id" title="var">S</span> <span class="id" title="var">x</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">natlehdinsn</span> <span class="id" title="var">i</span> <span class="id" title="var">x</span> ) <span class="id" title="var">g</span> ). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isweqcontrcontr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> ( <span class="id" title="var">is1</span> : ¬ ( <span class="id" title="var">hfiber</span> ( <span class="id" title="var">stntonat</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) ( <span class="id" title="var">di</span> <span class="id" title="var">i</span> <span class="id" title="var">x</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">neghfiberstntonat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">di</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">natlthorgeh</span> <span class="id" title="var">x</span> <span class="id" title="var">i</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">l''</span> | <span class="id" title="var">g'</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> ( <span class="id" title="var">natgehchoice2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">l</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">g'</span> | <span class="id" title="var">e</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">g'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">l''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">int</span> := <span class="id" title="var">natlthtolehsn</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">l''</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contradicts</span> (<span class="id" title="var">natgthnegleh</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">i</span>)) <span class="id" title="var">int</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">isweqtoempty2</span> <span class="id" title="var">_</span> <span class="id" title="var">is1</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dni_neq_i</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">i</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧) (<span class="id" title="var">j</span> : ⟦<span class="id" title="var">n</span>⟧ ) : <span class="id" title="var">i</span> ≠ @<span class="id" title="var">dni</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">di_neq_i</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">weqhfiberdnihfiberdi</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) ( <span class="id" title="var">i</span> <span class="id" title="var">j</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ ) :<br/>
&nbsp;&nbsp;( <span class="id" title="var">hfiber</span> ( <span class="id" title="var">dni</span> <span class="id" title="var">i</span> ) <span class="id" title="var">j</span> ) ≃ ( <span class="id" title="var">hfiber</span> ( <span class="id" title="var">di</span> <span class="id" title="var">i</span> ) <span class="id" title="var">j</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">weqhfibersg'tof</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ( <span class="id" title="var">dnihfsq</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span> ) <span class="id" title="var">j</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">neghfiberdni</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) ( <span class="id" title="var">i</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ ) : ¬ ( <span class="id" title="var">hfiber</span> ( <span class="id" title="var">dni</span> <span class="id" title="var">i</span> ) <span class="id" title="var">i</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">negf</span> ( <span class="id" title="var">weqhfiberdnihfiberdi</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span> <span class="id" title="var">i</span> ) ( <span class="id" title="var">neghfiberdi</span> <span class="id" title="var">i</span> ) ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iscontrhfiberdni</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) ( <span class="id" title="var">i</span> <span class="id" title="var">j</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ ) : <span class="id" title="var">i</span> ≠ <span class="id" title="var">j</span> -&gt; <span class="id" title="var">iscontr</span> ( <span class="id" title="var">hfiber</span> ( <span class="id" title="var">dni</span> <span class="id" title="var">i</span> ) <span class="id" title="var">j</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">ne</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ( <span class="id" title="var">iscontrweqb</span> ( <span class="id" title="var">weqhfiberdnihfiberdi</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> ) ( <span class="id" title="var">iscontrhfiberdi</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">ne</span> ) ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isdecincldni</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) ( <span class="id" title="var">i</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ ) : <span class="id" title="var">isdecincl</span> ( <span class="id" title="var">dni</span> <span class="id" title="var">i</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">j</span>. <span class="id" title="tactic">induction</span> ( <span class="id" title="var">stn_eq_or_neq</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> ) <span class="id" title="keyword">as</span> [<span class="id" title="var">eq</span>|<span class="id" title="var">ne</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">eq</span>. <span class="id" title="tactic">apply</span> ( <span class="id" title="var">isdecpropfromneg</span> ( <span class="id" title="var">neghfiberdni</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> ( <span class="id" title="var">isdecpropfromiscontr</span> (<span class="id" title="var">iscontrhfiberdni</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ne</span>) ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isincldni</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) ( <span class="id" title="var">i</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ ) : <span class="id" title="var">isincl</span> ( <span class="id" title="var">dni</span> <span class="id" title="var">i</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ( <span class="id" title="var">isdecincltoisincl</span> <span class="id" title="var">_</span>  ( <span class="id" title="var">isdecincldni</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span> ) ).<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab333"></a><h2 class="section">The order-preserving functions <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">sni</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#i"><span class="id" title="variable">i</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode">(<a class="idref" href="UniMath.Foundations.Preamble.html#S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a>)</span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode"></span> that take the value <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#i"><span class="id" title="variable">i</span></a></span> twice.</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">sni</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} ( <span class="id" title="var">i</span> : ⟦<span class="id" title="var">n</span>⟧ ) : ⟦<span class="id" title="var">n</span>⟧ &lt;- ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">j</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">si</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>). <span class="id" title="tactic">unfold</span> <span class="id" title="var">si</span>. <span class="id" title="tactic">induction</span> (<span class="id" title="var">natlthorgeh</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">lt</span>|<span class="id" title="var">ge</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">j</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">j</span> <span class="id" title="var">J</span>]. <span class="id" title="tactic">induction</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">i</span> <span class="id" title="var">I</span>]. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">j</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">j</span> <span class="id" title="var">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">contradicts</span> (<span class="id" title="var">negnatlthn0</span> <span class="id" title="var">i</span>) <span class="id" title="var">lt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">change</span> (<span class="id" title="var">S</span> <span class="id" title="var">j</span> - 1 &lt; <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">S</span> <span class="id" title="var">j</span>) <span class="id" title="keyword">with</span> (1 + <span class="id" title="var">j</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">natpluscomm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">plusminusnmm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">J</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">i</span> <span class="id" title="var">I</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">natlehlthtrans</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ge</span> <span class="id" title="var">I</span>).<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab334"></a><h2 class="section">Weak equivalences between standard finite sets and constructions on these sets</h2>

<div class="paragraph"> </div>

<a name="lab335"></a><h3 class="section">The weak equivalence from <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode"></span> to the complement of a point <span class="inlinecode"></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#j"><span class="id" title="variable">j</span></a></span> <span class="inlinecode"></span> in <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode">(</span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">)</span> <span class="inlinecode"></span> defined by <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">dni</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#j"><span class="id" title="variable">j</span></a></span> <span class="inlinecode"></span></h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stn_compl</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">i</span>: ⟦<span class="id" title="var">n</span>⟧ ) := <span class="id" title="var">compl_ne</span> <span class="id" title="var">_</span> <span class="id" title="var">i</span> (<span class="id" title="var">stnneq</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dnitocompl</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) ( <span class="id" title="var">i</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ ) : ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">stn_compl</span> <span class="id" title="var">i</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> ( <span class="id" title="var">dni</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">dni_neq_i</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isweqdnitocompl</span>  ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) ( <span class="id" title="var">i</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ ) : <span class="id" title="var">isweq</span> ( <span class="id" title="var">dnitocompl</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">jni</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">w</span> := <span class="id" title="var">samehfibers</span> ( <span class="id" title="var">dnitocompl</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span> )  <span class="id" title="var">_</span> ( <span class="id" title="var">isinclpr1compl_ne</span> <span class="id" title="var">_</span> <span class="id" title="var">i</span> <span class="id" title="var">_</span> ) <span class="id" title="var">jni</span> ) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">iscontrweqb</span> <span class="id" title="var">w</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">iscontrhfiberdni</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">jni</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">weqdnicompl</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">i</span>: ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ ): ⟦<span class="id" title="var">n</span>⟧ ≃ <span class="id" title="var">stn_compl</span> <span class="id" title="var">i</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">w</span> := <span class="id" title="var">weqdicompl</span> (<span class="id" title="var">stntonat</span> <span class="id" title="var">_</span> <span class="id" title="var">i</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">eq</span> : ∏ <span class="id" title="var">j</span>, <span class="id" title="var">j</span> &lt; <span class="id" title="var">n</span> &lt;-&gt; <span class="id" title="var">pr1</span> (<span class="id" title="var">w</span> <span class="id" title="var">j</span>) &lt; <span class="id" title="var">S</span> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">w</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">j</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">pr1</span> ((<span class="id" title="var">weqdicompl</span> <span class="id" title="var">i</span>) <span class="id" title="var">j</span>)) <span class="id" title="keyword">with</span> (<span class="id" title="var">di</span> (<span class="id" title="var">stntonat</span> <span class="id" title="var">_</span> <span class="id" title="var">i</span>) <span class="id" title="var">j</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">di</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">natlthorgeh</span> <span class="id" title="var">j</span> <span class="id" title="var">i</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">lt</span>|<span class="id" title="var">ge</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">natlthtolths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">_</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">natlehlthtrans</span> (<span class="id" title="var">S</span> <span class="id" title="var">j</span>) <span class="id" title="var">i</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) <span class="id" title="var">lt</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">i</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">split</span>; <span class="id" title="tactic">exact</span> (<span class="id" title="var">idfun</span> <span class="id" title="var">_</span>). }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> ∘ (<span class="id" title="var">weq_subtypes</span> <span class="id" title="var">w</span> (<span class="id" title="var">λ</span> <span class="id" title="var">j</span>, <span class="id" title="var">j</span> &lt; <span class="id" title="var">n</span>) (<span class="id" title="var">λ</span> <span class="id" title="var">j</span>, <span class="id" title="var">pr1</span> <span class="id" title="var">j</span> &lt; <span class="id" title="var">S</span> <span class="id" title="var">n</span>) <span class="id" title="var">eq</span>))%<span class="id" title="var">weq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">weqtotal2comm12</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">weqdnicompl_compute</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">j</span>: ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ ) (<span class="id" title="var">i</span>: ⟦<span class="id" title="var">n</span>⟧ ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">pr1</span> (<span class="id" title="var">weqdnicompl</span> <span class="id" title="var">j</span> <span class="id" title="var">i</span>) = <span class="id" title="var">dni</span> <span class="id" title="var">j</span> <span class="id" title="var">i</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab336"></a><h3 class="section">Weak equivalence from <span class="inlinecode"></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#coprod"><span class="id" title="inductive">coprod</span></a></span> <span class="inlinecode">(</span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">)</span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#unit"><span class="id" title="inductive">unit</span></a></span> <span class="inlinecode"></span> to <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode">(</span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">)</span> <span class="inlinecode"></span> defined by <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">dni</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#i"><span class="id" title="variable">i</span></a></span> <span class="inlinecode"></span></h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">weqdnicoprod_provisional</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">j</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧) : ⟦<span class="id" title="var">n</span>⟧ ⨿ <span class="id" title="var">unit</span> ≃ ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">weqcomp</span> (<span class="id" title="var">weqcoprodf</span> (<span class="id" title="var">weqdnicompl</span> <span class="id" title="var">j</span>) (<span class="id" title="var">idweq</span> <span class="id" title="var">unit</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">weqrecompl_ne</span> (⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧) <span class="id" title="var">j</span> (<span class="id" title="var">isdeceqstn</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) <span class="id" title="var">j</span>) (<span class="id" title="var">stnneq</span> <span class="id" title="var">j</span>))).<br/>
</div>

<br/>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">weqdnicoprod_provisional</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">weqdnicoprod_map</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">j</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ ) : ⟦<span class="id" title="var">n</span>⟧ ⨿ <span class="id" title="var">unit</span> -&gt; ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">i</span>|<span class="id" title="var">t</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">dni</span> <span class="id" title="var">j</span> <span class="id" title="var">i</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">j</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">weqdnicoprod_compute</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">j</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">weqdnicoprod_provisional</span> <span class="id" title="var">n</span> <span class="id" title="var">j</span> ~ <span class="id" title="var">weqdnicoprod_map</span> <span class="id" title="var">j</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">i</span>|<span class="id" title="var">i</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">i</span> <span class="id" title="var">I</span>]. <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">weqdnicoprod</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">j</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ ) : ⟦<span class="id" title="var">n</span>⟧ ⨿ <span class="id" title="var">unit</span> ≃ ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">weqpair</span> (<span class="id" title="var">weqdnicoprod_map</span> <span class="id" title="var">j</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isweqhomot</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">weqdnicoprod_compute</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">weqproperty</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">weqoverdnicoprod</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">P</span>: ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ → <span class="id" title="var">UU</span>) :<br/>
&nbsp;&nbsp;(∑ <span class="id" title="var">i</span>, <span class="id" title="var">P</span> <span class="id" title="var">i</span>) ≃ (∑ <span class="id" title="var">j</span>, <span class="id" title="var">P</span>(<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">j</span>)) ⨿ <span class="id" title="var">P</span> <span class="id" title="var">lastelement</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">weqcomp</span> (<span class="id" title="var">weqtotal2overcoprod'</span> <span class="id" title="var">P</span> (<span class="id" title="var">weqdnicoprod</span> <span class="id" title="var">n</span> <span class="id" title="var">lastelement</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">weqcoprodf</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">idweq</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">weqtotal2overunit</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">weqoverdnicoprod_eq1</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">P</span>: ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ → <span class="id" title="var">UU</span>) <span class="id" title="var">j</span> <span class="id" title="var">p</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">invmap</span> (<span class="id" title="var">weqoverdnicoprod</span> <span class="id" title="var">P</span>) (<span class="id" title="var">ii1</span> (<span class="id" title="var">j</span>,,<span class="id" title="var">p</span>)) = ( <span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">j</span> ,, <span class="id" title="var">p</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">weqoverdnicoprod_eq1'</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">P</span>: ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ → <span class="id" title="var">UU</span>) <span class="id" title="var">jp</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">invmap</span> (<span class="id" title="var">weqoverdnicoprod</span> <span class="id" title="var">P</span>) (<span class="id" title="var">ii1</span> <span class="id" title="var">jp</span>) = (<span class="id" title="var">total2_base_map</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span>) <span class="id" title="var">jp</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">jp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">weqoverdnicoprod_eq2</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">P</span>: ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧→<span class="id" title="var">UU</span>) <span class="id" title="var">p</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">invmap</span> (<span class="id" title="var">weqoverdnicoprod</span> <span class="id" title="var">P</span>) (<span class="id" title="var">ii2</span> <span class="id" title="var">p</span>) = (<span class="id" title="var">lastelement</span> ,, <span class="id" title="var">p</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">weqdnicoprod_invmap</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">j</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ ) : ⟦<span class="id" title="var">n</span>⟧ ⨿ <span class="id" title="var">unit</span> &lt;- ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">isdeceqstn</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) <span class="id" title="var">i</span> <span class="id" title="var">j</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">eq</span>|<span class="id" title="var">ne</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">ii2</span> <span class="id" title="var">tt</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii1</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">i</span> <span class="id" title="var">I</span>]. <span class="id" title="tactic">induction</span> <span class="id" title="var">j</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">j</span> <span class="id" title="var">J</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">choose</span> (<span class="id" title="var">i</span> &lt; <span class="id" title="var">j</span>)%<span class="id" title="var">dnat</span> <span class="id" title="var">a</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exists</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">natltltSlt</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span> <span class="id" title="var">J</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exists</span> (<span class="id" title="var">i</span> - 1).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">natlehchoice</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">negnatgthtoleh</span> <span class="id" title="var">a</span>)) <span class="id" title="keyword">as</span> [<span class="id" title="var">b</span>|<span class="id" title="var">b</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">induction</span> (<span class="id" title="var">natlehchoice4</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">I</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">c</span>|<span class="id" title="var">c</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> (<span class="id" title="var">natlehlthtrans</span> (<span class="id" title="var">i</span> - 1) <span class="id" title="var">i</span> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> <span class="id" title="var">natminuslehn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">exact</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">induction</span> <span class="id" title="var">c</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">natminuslthn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> (<span class="id" title="var">natlehlthtrans</span> <span class="id" title="var">_</span> <span class="id" title="var">j</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">apply</span> <span class="id" title="var">natleh0n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">exact</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> <span class="id" title="var">natlthnsn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">induction</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">ne</span> (@<span class="id" title="var">subtypeEquality_prop</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">stnpair</span> <span class="id" title="var">_</span> <span class="id" title="var">j</span> <span class="id" title="var">I</span>) (<span class="id" title="var">stnpair</span> <span class="id" title="var">_</span> <span class="id" title="var">j</span> <span class="id" title="var">J</span>) (<span class="id" title="var">idpath</span> <span class="id" title="var">j</span>))).<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab337"></a><h3 class="section">Weak equivalences from <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode"></span> for <span class="inlinecode"></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode">0</span> <span class="inlinecode">,</span> <span class="inlinecode">1</span> <span class="inlinecode">,</span> <span class="inlinecode">2</span> <span class="inlinecode"></span> to <span class="inlinecode"></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#empty"><span class="id" title="inductive">empty</span></a></span> <span class="inlinecode"></span> , <span class="inlinecode"></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#unit"><span class="id" title="inductive">unit</span></a></span> <span class="inlinecode"></span> and <span class="inlinecode"></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#bool"><span class="id" title="inductive">bool</span></a></span> <span class="inlinecode"></span> ( see also the section on <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">nelstruct</span></span> <span class="inlinecode"></span> in finitesets.v ).</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">negstn0</span> : ¬ (⟦0⟧).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">a</span> <span class="id" title="var">b</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">negnatlthn0</span> <span class="id" title="var">_</span> <span class="id" title="var">b</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">weqstn0toempty</span> : ⟦0⟧ ≃ <span class="id" title="var">empty</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">weqtoempty</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">negstn0</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">weqstn1tounit</span> : ⟦1⟧ ≃ <span class="id" title="var">unit</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">f</span> := <span class="id" title="var">λ</span> <span class="id" title="var">x</span> : ⟦1⟧, <span class="id" title="var">tt</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">weqcontrcontr</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">lastelement</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">t</span> <span class="id" title="var">l</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">e</span> := <span class="id" title="var">natlth1tois0</span> <span class="id" title="var">_</span> <span class="id" title="var">l</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">invmaponpathsincl</span> <span class="id" title="var">_</span> ( <span class="id" title="var">isinclstntonat</span> 1 ) ( <span class="id" title="var">stnpair</span> <span class="id" title="var">_</span> <span class="id" title="var">t</span> <span class="id" title="var">l</span> ) <span class="id" title="var">lastelement</span> <span class="id" title="var">e</span> ).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">iscontrunit</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Corollary</span> <span class="id" title="var">iscontrstn1</span> : <span class="id" title="var">iscontr</span> (⟦1⟧).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">iscontrifweqtounit</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">weqstn1tounit</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Corollary</span> <span class="id" title="var">isconnectedstn1</span> : ∏ <span class="id" title="var">i1</span> <span class="id" title="var">i2</span> : ⟦1⟧, <span class="id" title="var">i1</span> = <span class="id" title="var">i2</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i1</span> <span class="id" title="var">i2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">invmaponpathsweq</span> <span class="id" title="var">weqstn1tounit</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isProofIrrelevantUnit</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isinclfromstn1</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="var">f</span> : ⟦1⟧ -&gt; <span class="id" title="var">X</span> ) ( <span class="id" title="keyword">is</span> : <span class="id" title="var">isaset</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">isincl</span> <span class="id" title="var">f</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">isinclbetweensets</span> <span class="id" title="var">f</span> ( <span class="id" title="var">isasetstn</span> 1 ) <span class="id" title="keyword">is</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">invmaponpathsweq</span> <span class="id" title="var">weqstn1tounit</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> ( <span class="id" title="var">idpath</span> <span class="id" title="var">tt</span> ) ).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">weqstn2tobool</span> : ⟦2⟧ ≃ <span class="id" title="var">bool</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">f</span> := <span class="id" title="var">λ</span> <span class="id" title="var">j</span> : ⟦2⟧, <span class="id" title="keyword">match</span> ( <span class="id" title="var">isdeceqnat</span> <span class="id" title="var">j</span> 0 ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ii1</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">ii2</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">g</span> := <span class="id" title="var">λ</span> <span class="id" title="var">b</span> : <span class="id" title="var">bool</span>, <span class="id" title="keyword">match</span> <span class="id" title="var">b</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">false</span> =&gt; <span class="id" title="var">stnpair</span> 2 0 ( <span class="id" title="var">idpath</span> <span class="id" title="var">true</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">true</span> =&gt; <span class="id" title="var">stnpair</span> 2 1 ( <span class="id" title="var">idpath</span> <span class="id" title="var">true</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">egf</span> : ∏ <span class="id" title="var">j</span> : <span class="id" title="var">_</span> , <span class="id" title="var">paths</span> ( <span class="id" title="var">g</span> ( <span class="id" title="var">f</span> <span class="id" title="var">j</span> ) ) <span class="id" title="var">j</span> ).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">isdeceqnat</span> <span class="id" title="var">j</span> 0 ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">e</span> | <span class="id" title="var">ne</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">invmaponpathsincl</span> <span class="id" title="var">_</span> ( <span class="id" title="var">isinclstntonat</span> 2 ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">invmaponpathsincl</span> <span class="id" title="var">_</span> ( <span class="id" title="var">isinclstntonat</span> 2 ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">j</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">j</span> <span class="id" title="var">l</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">l'</span> := <span class="id" title="var">natlthtolehsn</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">l</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">natlehchoice</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">l'</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">l''</span> | <span class="id" title="var">e</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ne</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span>  ( <span class="id" title="var">ne</span> ( <span class="id" title="var">natlth1tois0</span> <span class="id" title="var">_</span> <span class="id" title="var">l''</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">pathsinv0</span> ( <span class="id" title="var">invmaponpathsS</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">e</span> ) ).<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">efg</span> : ∏ <span class="id" title="var">b</span> : <span class="id" title="var">_</span> , <span class="id" title="var">paths</span> ( <span class="id" title="var">f</span> ( <span class="id" title="var">g</span> <span class="id" title="var">b</span> ) ) <span class="id" title="var">b</span> ).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">isweq_iso</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">egf</span> <span class="id" title="var">efg</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isinjstntonat</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">isInjectiveFunction</span> (<span class="id" title="var">pr1</span> : <span class="id" title="var">stnset</span> <span class="id" title="var">n</span> -&gt; <span class="id" title="var">natset</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab338"></a><h3 class="section">Weak equivalence between the coproduct of <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode"></span> and <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#m"><span class="id" title="variable">m</span></a></span> <span class="inlinecode"></span> and <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode">(</span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#m"><span class="id" title="variable">m</span></a></span> <span class="inlinecode">)</span> <span class="inlinecode"></span></h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">weqfromcoprodofstn_invmap</span> (<span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>) : ⟦<span class="id" title="var">n</span> + <span class="id" title="var">m</span>⟧ -&gt; (⟦<span class="id" title="var">n</span>⟧ ⨿ ⟦<span class="id" title="var">m</span>⟧).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">natlthorgeh</span> <span class="id" title="var">i</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">i1</span> | <span class="id" title="var">i2</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">ii1</span> (<span class="id" title="var">stnpair</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span> <span class="id" title="var">i1</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">ii2</span> (<span class="id" title="var">stnpair</span> <span class="id" title="var">m</span> (<span class="id" title="var">i</span> - <span class="id" title="var">n</span>) (<span class="id" title="var">nat_split</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">i</span>) <span class="id" title="var">i2</span>))).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">weqfromcoprodofstn_invmap_r0</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">i</span> : ⟦<span class="id" title="var">n</span>+0⟧ ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">weqfromcoprodofstn_invmap</span> <span class="id" title="var">n</span> 0 <span class="id" title="var">i</span> = <span class="id" title="var">ii1</span> (<span class="id" title="var">transportf</span> <span class="id" title="var">stn</span> (<span class="id" title="var">natplusr0</span> <span class="id" title="var">n</span>) <span class="id" title="var">i</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">weqfromcoprodofstn_invmap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">natlthorgeh</span> <span class="id" title="var">i</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">I</span>|<span class="id" title="var">J</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">natplusr0</span> <span class="id" title="var">n</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>. <span class="id" title="tactic">induction</span> (! <span class="id" title="var">natplusr0</span> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">natgehtonegnatlth</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">J</span> (<span class="id" title="var">stnlt</span> <span class="id" title="var">i</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">weqfromcoprodofstn_map</span> (<span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>) : (⟦<span class="id" title="var">n</span>⟧ ⨿ ⟦<span class="id" title="var">m</span>⟧) -&gt; ⟦<span class="id" title="var">n</span>+<span class="id" title="var">m</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">i</span> | <span class="id" title="var">i</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">stn_left</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">stn_right</span>. <span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">weqfromcoprodofstn_eq1</span> (<span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;∏ <span class="id" title="var">x</span> : ⟦<span class="id" title="var">n</span>⟧ ⨿ ⟦<span class="id" title="var">m</span>⟧, <span class="id" title="var">weqfromcoprodofstn_invmap</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> (<span class="id" title="var">weqfromcoprodofstn_map</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span>) = <span class="id" title="var">x</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">weqfromcoprodofstn_map</span>, <span class="id" title="var">weqfromcoprodofstn_invmap</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">coprod_rect</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">x</span> | <span class="id" title="var">x</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> (<span class="id" title="var">natlthorgeh</span> (<span class="id" title="var">stn_left</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span>) <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">H</span> | <span class="id" title="var">H</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">isinjstntonat</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">natlthtonegnatgeh</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> (<span class="id" title="var">stnlt</span> <span class="id" title="var">x</span>) <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> (<span class="id" title="var">natlthorgeh</span> (<span class="id" title="var">stn_right</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span>) <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">H</span> | <span class="id" title="var">H</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">tmp</span> := <span class="id" title="var">natlehlthtrans</span> <span class="id" title="var">n</span> (<span class="id" title="var">n</span> + <span class="id" title="var">x</span>) <span class="id" title="var">n</span> (<span class="id" title="var">natlehnplusnm</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span>) <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">isirrefl_natneq</span> <span class="id" title="var">n</span> (<span class="id" title="var">natlthtoneq</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">tmp</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">isinjstntonat</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">natpluscomm</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">plusminusnmm</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">weqfromcoprodofstn_eq2</span> (<span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;∏ <span class="id" title="var">y</span> : ⟦<span class="id" title="var">n</span>+<span class="id" title="var">m</span>⟧, <span class="id" title="var">weqfromcoprodofstn_map</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> (<span class="id" title="var">weqfromcoprodofstn_invmap</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">y</span>) = <span class="id" title="var">y</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">weqfromcoprodofstn_map</span>, <span class="id" title="var">weqfromcoprodofstn_invmap</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">coprod_rect</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">natlthorgeh</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">H</span> | <span class="id" title="var">H</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isinjstntonat</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> (<span class="id" title="var">natchoice0</span> <span class="id" title="var">m</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">H1</span> | <span class="id" title="var">H1</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">induction</span> (! (<span class="id" title="var">natplusr0</span> <span class="id" title="var">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">natlthtonegnatgeh</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> (<span class="id" title="var">stnlt</span> <span class="id" title="var">x</span>) <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">isinjstntonat</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">natpluscomm</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">minusplusnmm</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
A proof of weqfromcoprodofstn using isweq_iso 
</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">weqfromcoprodofstn</span> (<span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>) : (⟦<span class="id" title="var">n</span>⟧ ⨿ ⟦<span class="id" title="var">m</span>⟧) ≃ ⟦<span class="id" title="var">n</span>+<span class="id" title="var">m</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">tpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">weqfromcoprodofstn_map</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">isweq_iso</span> <span class="id" title="var">_</span> (<span class="id" title="var">weqfromcoprodofstn_invmap</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">weqfromcoprodofstn_eq1</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">weqfromcoprodofstn_eq2</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>).<br/>
</div>

<br/>
</div>

<div class="doc">
Associativity of <span class="inlinecode"><span class="id" title="var">weqfromcoprodofstn</span></span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pr1_eqweqmap</span> (<span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">e</span>: <span class="id" title="var">m</span>=<span class="id" title="var">n</span>) (<span class="id" title="var">i</span>: ⟦<span class="id" title="var">m</span>⟧ ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">pr1</span> (<span class="id" title="var">pr1weq</span> (<span class="id" title="var">eqweqmap</span> (<span class="id" title="var">maponpaths</span> <span class="id" title="var">stn</span> <span class="id" title="var">e</span>)) <span class="id" title="var">i</span>) = <span class="id" title="var">pr1</span> <span class="id" title="var">i</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">coprod_stn_assoc</span> (<span class="id" title="var">l</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : (<br/>
&nbsp;&nbsp;<span class="id" title="var">eqweqmap</span> (<span class="id" title="var">maponpaths</span> <span class="id" title="var">stn</span> (<span class="id" title="var">natplusassoc</span> <span class="id" title="var">l</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">weqfromcoprodofstn</span> (<span class="id" title="var">l</span>+<span class="id" title="var">m</span>) <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">weqcoprodf</span> (<span class="id" title="var">weqfromcoprodofstn</span> <span class="id" title="var">l</span> <span class="id" title="var">m</span>) (<span class="id" title="var">idweq</span> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;~<br/>
&nbsp;&nbsp;<span class="id" title="var">weqfromcoprodofstn</span> <span class="id" title="var">l</span> (<span class="id" title="var">m</span>+<span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">weqcoprodf</span> (<span class="id" title="var">idweq</span> <span class="id" title="var">_</span>) (<span class="id" title="var">weqfromcoprodofstn</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">weqcoprodasstor</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;) %<span class="id" title="var">weq</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">abc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 4? <span class="id" title="var">weqcomp_to_funcomp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">invmaponpathsincl</span> <span class="id" title="var">pr1</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">isinclstntonat</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">funcomp_assoc</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">funcomp</span> <span class="id" title="tactic">at</span> 1. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">pr1_eqweqmap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">abc</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">a</span>|<span class="id" title="var">b</span>]|<span class="id" title="var">c</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">natplusassoc</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab339"></a><h3 class="section">Weak equivalence from the total space of a family <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode">(</span> <span class="inlinecode"><a class="idref" href="UniMath.Algebra.DCPO.html#leastupperbound.f"><span class="id" title="variable">f</span></a></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#x"><span class="id" title="variable">x</span></a></span> <span class="inlinecode">)</span> <span class="inlinecode"></span>  over <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode"></span> to <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode">(</span> <span class="inlinecode"><span class="id" title="var">stnsum</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode"><a class="idref" href="UniMath.Algebra.DCPO.html#leastupperbound.f"><span class="id" title="variable">f</span></a></span> <span class="inlinecode">)</span> <span class="inlinecode"></span></h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stnsum</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> : ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) : <span class="id" title="var">nat</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [ | <span class="id" title="var">n</span> <span class="id" title="var">IHn</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">exact</span> 0.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">f</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">IHn</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, <span class="id" title="var">f</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">i</span>)) + <span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stnsum_step</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span>: ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">stnsum</span> <span class="id" title="var">f</span> = <span class="id" title="var">stnsum</span> (<span class="id" title="var">f</span> ∘ (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span>)) + <span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stnsum_eq</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span>: ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) : <span class="id" title="var">f</span> ~ <span class="id" title="var">g</span> -&gt; <span class="id" title="var">stnsum</span> <span class="id" title="var">f</span> = <span class="id" title="var">stnsum</span> <span class="id" title="var">g</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IH</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> 2? <span class="id" title="var">stnsum_step</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">h</span> <span class="id" title="var">lastelement</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">maponpaths</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, <span class="id" title="var">i</span> + <span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">h</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">transport_stnsum</span> {<span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">e</span>: <span class="id" title="var">m</span>=<span class="id" title="var">n</span>) (<span class="id" title="var">g</span>: ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">stnsum</span> <span class="id" title="var">g</span> = <span class="id" title="var">stnsum</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, <span class="id" title="var">g</span>(<span class="id" title="var">transportf</span> <span class="id" title="var">stn</span> <span class="id" title="var">e</span> <span class="id" title="var">i</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stnsum_le</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span>: ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) : (∏ <span class="id" title="var">i</span>, <span class="id" title="var">f</span> <span class="id" title="var">i</span> ≤ <span class="id" title="var">g</span> <span class="id" title="var">i</span>) -&gt; <span class="id" title="var">stnsum</span> <span class="id" title="var">f</span> ≤ <span class="id" title="var">stnsum</span> <span class="id" title="var">g</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">le</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IH</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">natlehandplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">le</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">le</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">transport_stn</span> {<span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">e</span>: <span class="id" title="var">m</span>=<span class="id" title="var">n</span>) (<span class="id" title="var">i</span>: ⟦<span class="id" title="var">m</span>⟧ ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">transportf</span> <span class="id" title="var">stn</span> <span class="id" title="var">e</span> <span class="id" title="var">i</span> = <span class="id" title="var">stnpair</span> <span class="id" title="var">n</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">i</span>) (<span class="id" title="var">transportf</span> (<span class="id" title="var">λ</span> <span class="id" title="var">k</span>, <span class="id" title="var">pr1</span> <span class="id" title="var">i</span> &lt; <span class="id" title="var">k</span>) <span class="id" title="var">e</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">i</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stnsum_left_right</span> (<span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">f</span>: ⟦<span class="id" title="var">m</span>+<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">stnsum</span> <span class="id" title="var">f</span> = <span class="id" title="var">stnsum</span> (<span class="id" title="var">f</span> ∘ <span class="id" title="var">stn_left</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>) + <span class="id" title="var">stnsum</span> (<span class="id" title="var">f</span> ∘ <span class="id" title="var">stn_right</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IHn</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">change</span> (<span class="id" title="var">stnsum</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> 0 <span class="id" title="tactic">at</span> 3. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">natplusr0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">e</span> := ! <span class="id" title="var">natplusr0</span> <span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">transport_stnsum</span> <span class="id" title="var">e</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">stnsum_eq</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">funcomp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">stn_left_0</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">stnsum_step</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">e</span> : <span class="id" title="var">S</span> (<span class="id" title="var">m</span>+<span class="id" title="var">n</span>) = <span class="id" title="var">m</span> + <span class="id" title="var">S</span> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">natplusnsm</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">transport_stnsum</span> <span class="id" title="var">e</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">stnsum_step</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">natplusassoc</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">map_on_two_paths</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHn</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">IHn</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">map_on_two_paths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">stnsum_eq</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">funcomp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">stn_left_compute</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">idpath_transportf</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">dni_last</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">stnsum_eq</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">funcomp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">stn_right_compute</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">stntonat</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">idpath_transportf</span>. <span class="id" title="tactic">rewrite</span> 2? <span class="id" title="var">dni_last</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>. } }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">funcomp</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Corollary</span> <span class="id" title="var">stnsum_left_le</span> (<span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">f</span>: ⟦<span class="id" title="var">m</span>+<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">stnsum</span> (<span class="id" title="var">f</span> ∘ <span class="id" title="var">stn_left</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>) ≤ <span class="id" title="var">stnsum</span> <span class="id" title="var">f</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">stnsum_left_right</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natlehnplusnm</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Corollary</span> <span class="id" title="var">stnsum_left_le'</span> {<span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span>: ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) (<span class="id" title="var">r</span>:<span class="id" title="var">m</span>≤<span class="id" title="var">n</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">stnsum</span> (<span class="id" title="var">f</span> ∘ <span class="id" title="var">stn_left'</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">r</span>) ≤ <span class="id" title="var">stnsum</span> <span class="id" title="var">f</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">s</span> := <span class="id" title="var">minusplusnmm</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">r</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">natpluscomm</span> (<span class="id" title="var">n</span>-<span class="id" title="var">m</span>) <span class="id" title="var">m</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="var">r</span> <span class="id" title="var">f</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">r</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">s</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">k</span> := <span class="id" title="var">n</span>-<span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="var">k</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">k</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">r</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">natpluscomm</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">stn_left_compare</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">stnsum_left_right</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natlehnplusnm</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stnsum_dni</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span>: ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) (<span class="id" title="var">j</span>: ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">stnsum</span> <span class="id" title="var">f</span> = <span class="id" title="var">stnsum</span> (<span class="id" title="var">f</span> ∘ <span class="id" title="var">dni</span> <span class="id" title="var">j</span>) + <span class="id" title="var">f</span> <span class="id" title="var">j</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">j</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">j</span> <span class="id" title="var">J</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">e2</span> : <span class="id" title="var">j</span> + (<span class="id" title="var">n</span> - <span class="id" title="var">j</span>) = <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">natpluscomm</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">minusplusnmm</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">natlthsntoleh</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">J</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">e</span> : (<span class="id" title="var">S</span> <span class="id" title="var">j</span>) + (<span class="id" title="var">n</span> - <span class="id" title="var">j</span>) = <span class="id" title="var">S</span> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">change</span> (<span class="id" title="var">S</span> <span class="id" title="var">j</span> + (<span class="id" title="var">n</span> - <span class="id" title="var">j</span>)) <span class="id" title="keyword">with</span> (<span class="id" title="var">S</span> (<span class="id" title="var">j</span> + (<span class="id" title="var">n</span> - <span class="id" title="var">j</span>))). <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">e2</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="var">intermediate_path</span> (<span class="id" title="var">stnsum</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, <span class="id" title="var">f</span> (<span class="id" title="var">transportf</span> <span class="id" title="var">stn</span> <span class="id" title="var">e</span> <span class="id" title="var">i</span>))).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">transport_stnsum</span> <span class="id" title="var">e</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">stnsum_left_right</span> (<span class="id" title="var">S</span> <span class="id" title="var">j</span>) (<span class="id" title="var">n</span> - <span class="id" title="var">j</span>)); <span class="id" title="tactic">unfold</span> <span class="id" title="var">funcomp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">transport_stnsum</span> <span class="id" title="var">e2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">stnsum_left_right</span> <span class="id" title="var">j</span> (<span class="id" title="var">n</span>-<span class="id" title="var">j</span>)); <span class="id" title="tactic">unfold</span> <span class="id" title="var">funcomp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">stnsum_step</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">f</span> (<span class="id" title="var">transportf</span> <span class="id" title="var">stn</span> <span class="id" title="var">e</span> <span class="id" title="var">_</span>))); <span class="id" title="tactic">unfold</span> <span class="id" title="var">funcomp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">natplusassoc</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">natpluscomm</span> (<span class="id" title="var">f</span> <span class="id" title="var">_</span>)). <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">natplusassoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">map_on_two_paths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">map_on_two_paths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">stnsum_eq</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">i</span> <span class="id" title="var">I</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">idpath_transportf</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">stn_left_compute</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dni</span>,<span class="id" title="var">di</span>, <span class="id" title="var">stntonat</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">natlthorgeh</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">R</span>|<span class="id" title="var">R</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">unfold</span> <span class="id" title="var">stntonat</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">transport_stn</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">natlthorgeh</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">a</span>|<span class="id" title="var">b</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="var">contradicts</span> <span class="id" title="var">R</span> (<span class="id" title="var">natlehneggth</span> <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">unfold</span> <span class="id" title="var">stntonat</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">transport_stn</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">natlthorgeh</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">V</span>|<span class="id" title="var">V</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="var">contradicts</span> <span class="id" title="var">I</span> (<span class="id" title="var">natlehneggth</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">stnsum_eq</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">i</span> <span class="id" title="var">I</span>]. <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dni</span>,<span class="id" title="var">di</span>, <span class="id" title="var">stn_right</span>, <span class="id" title="var">stntonat</span>; <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">transport_stn</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">natlthorgeh</span> (<span class="id" title="var">j</span>+<span class="id" title="var">i</span>) <span class="id" title="var">j</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">X</span>|<span class="id" title="var">X</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">contradicts</span> (<span class="id" title="var">negnatlthplusnmn</span> <span class="id" title="var">j</span> <span class="id" title="var">i</span>) <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">transport_stn</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stnsum_pos</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span>: ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) (<span class="id" title="var">j</span>: ⟦<span class="id" title="var">n</span>⟧ ) : <span class="id" title="var">f</span> <span class="id" title="var">j</span> ≤ <span class="id" title="var">stnsum</span> <span class="id" title="var">f</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">m</span> : 0 &lt; <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> (<span class="id" title="var">natlehlthtrans</span> <span class="id" title="var">_</span> <span class="id" title="var">j</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">natleh0n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">j</span>). }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">l</span> : 1 ≤ <span class="id" title="var">n</span>). { <span class="id" title="tactic">apply</span> <span class="id" title="var">natlthtolehsn</span>. <span class="id" title="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">e</span> : <span class="id" title="var">n</span> = <span class="id" title="var">S</span> (<span class="id" title="var">n</span> - 1)).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">change</span> (<span class="id" title="var">S</span> (<span class="id" title="var">n</span> - 1)) <span class="id" title="keyword">with</span> (1 + (<span class="id" title="var">n</span> - 1)). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">natpluscomm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">minusplusnmm</span>. <span class="id" title="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">transport_stnsum</span> (!<span class="id" title="var">e</span>) <span class="id" title="var">f</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">stnsum_dni</span> <span class="id" title="var">_</span> (<span class="id" title="var">transportf</span> <span class="id" title="var">stn</span> <span class="id" title="var">e</span> <span class="id" title="var">j</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">funcomp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> (<span class="id" title="var">stnsum</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">f</span> (<span class="id" title="var">transportf</span> <span class="id" title="var">stn</span> (! <span class="id" title="var">e</span>) (<span class="id" title="var">dni</span> (<span class="id" title="var">transportf</span> <span class="id" title="var">stn</span> <span class="id" title="var">e</span> <span class="id" title="var">j</span>) <span class="id" title="var">x</span>)))); <span class="id" title="tactic">intro</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">natlehmplusnm</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Corollary</span> <span class="id" title="var">stnsum_pos_0</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span>: ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) : <span class="id" title="var">f</span> <span class="id" title="var">firstelement</span> ≤ <span class="id" title="var">stnsum</span> <span class="id" title="var">f</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">stnsum_pos</span> <span class="id" title="var">f</span> <span class="id" title="var">firstelement</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stnsum_1</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">stnsum</span>(<span class="id" title="var">λ</span> <span class="id" title="var">i</span>: ⟦<span class="id" title="var">n</span>⟧, 1) = <span class="id" title="var">n</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IH</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">natpluscomm</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">IH</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stnsum_const</span> {<span class="id" title="var">m</span> <span class="id" title="var">c</span> : <span class="id" title="var">nat</span>} : <span class="id" title="var">stnsum</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>: ⟦<span class="id" title="var">m</span>⟧, <span class="id" title="var">c</span>) = <span class="id" title="var">m</span>*<span class="id" title="var">c</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">m</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">m</span> <span class="id" title="var">I</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">maponpaths</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, <span class="id" title="var">i</span>+<span class="id" title="var">c</span>) <span class="id" title="var">I</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stnsum_last_le</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span>: ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) : <span class="id" title="var">f</span> <span class="id" title="var">lastelement</span> ≤ <span class="id" title="var">stnsum</span> <span class="id" title="var">f</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">stnsum_step</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">natlehmplusnm</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stnsum_first_le</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span>: ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) : <span class="id" title="var">f</span> <span class="id" title="var">firstelement</span> ≤ <span class="id" title="var">stnsum</span> <span class="id" title="var">f</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IH</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isreflnatleh</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">stnsum_step</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">W</span> := <span class="id" title="var">IH</span> (<span class="id" title="var">f</span> ∘ <span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ((<span class="id" title="var">f</span> ∘ <span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span>) <span class="id" title="var">firstelement</span>) <span class="id" title="keyword">with</span> (<span class="id" title="var">f</span> <span class="id" title="var">firstelement</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">W</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">istransnatleh</span> <span class="id" title="var">W</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">W</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">natlehnplusnm</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">_c_</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} {<span class="id" title="var">m</span>: ⟦ <span class="id" title="var">n</span> ⟧ → <span class="id" title="var">nat</span>} (<span class="id" title="var">ij</span> : ∑ <span class="id" title="var">i</span> : ⟦ <span class="id" title="var">n</span> ⟧, ⟦ <span class="id" title="var">m</span> <span class="id" title="var">i</span> ⟧) :<br/>
&nbsp;&nbsp;<span class="id" title="var">stnsum</span> (<span class="id" title="var">m</span> ∘ <span class="id" title="var">stn_left''</span> (<span class="id" title="var">stnlt</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">ij</span>))) + <span class="id" title="var">pr2</span> <span class="id" title="var">ij</span> &lt; <span class="id" title="var">stnsum</span> <span class="id" title="var">m</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">m1</span> := <span class="id" title="var">m</span> ∘ <span class="id" title="var">stn_left''</span> (<span class="id" title="var">stnlt</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">ij</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">ij</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">i</span> <span class="id" title="var">j</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">i</span> <span class="id" title="var">I</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">j</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">j</span> <span class="id" title="var">J</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">m1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">stnsum</span> <span class="id" title="var">m1</span> + <span class="id" title="var">j</span> &lt; <span class="id" title="var">stnsum</span> <span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">s</span> := <span class="id" title="var">stnsum_left_le'</span> <span class="id" title="var">m</span> (<span class="id" title="var">I</span> : <span class="id" title="var">S</span> <span class="id" title="var">i</span> ≤ <span class="id" title="var">n</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">natlthlehtrans</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">s</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">_</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> (<span class="id" title="var">negnatlthn0</span> <span class="id" title="var">_</span> <span class="id" title="var">I</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> (<span class="id" title="var">t</span> : <span class="id" title="var">stnsum</span> <span class="id" title="var">m1</span> + <span class="id" title="var">j</span> &lt; <span class="id" title="var">stnsum</span> <span class="id" title="var">m1</span> + <span class="id" title="var">m</span> (<span class="id" title="var">i</span>,,<span class="id" title="var">I</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">natlthandplusl</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">J</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">natlthlehtrans</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">K</span> : ∏ <span class="id" title="var">m</span> <span class="id" title="var">n</span>, <span class="id" title="var">m</span> = <span class="id" title="var">n</span> -&gt; <span class="id" title="var">m</span> ≤ <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">isreflnatleh</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">K</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">K</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">stnsum_step</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">j</span> <span class="id" title="var">J</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">m1</span> ; <span class="id" title="tactic">clear</span> <span class="id" title="var">m1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">two_arg_paths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">stnsum_eq</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">funcomp</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>, <span class="id" title="var">di_eq1</span>, <span class="id" title="var">stnlt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">unfold</span> <span class="id" title="var">funcomp</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">weqstnsum_map</span> { <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> } (<span class="id" title="var">m</span> : ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;(∑ <span class="id" title="var">i</span>, ⟦<span class="id" title="var">m</span> <span class="id" title="var">i</span>⟧) -&gt; ⟦<span class="id" title="var">stnsum</span> <span class="id" title="var">m</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">ij</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">stnpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">stnsum</span> (<span class="id" title="var">m</span> ∘ <span class="id" title="var">stn_left''</span> (<span class="id" title="var">stnlt</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">ij</span>))) + <span class="id" title="var">pr2</span> <span class="id" title="var">ij</span>) (<span class="id" title="var">_c_</span> <span class="id" title="var">ij</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">weqstnsum_invmap</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">m</span> : ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;⟦<span class="id" title="var">stnsum</span> <span class="id" title="var">m</span>⟧ -&gt; (∑ <span class="id" title="var">i</span>, ⟦<span class="id" title="var">m</span> <span class="id" title="var">i</span>⟧).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IH</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? <span class="id" title="var">l</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>, <span class="id" title="var">negstn0</span>. <span class="id" title="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (⟦ <span class="id" title="var">stnsum</span> (<span class="id" title="var">m</span> ∘ <span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span>) + <span class="id" title="var">m</span> <span class="id" title="var">lastelement</span> ⟧) <span class="id" title="tactic">in</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">ls</span> := <span class="id" title="var">weqfromcoprodofstn_invmap</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">l</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">ls</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">j</span>|<span class="id" title="var">k</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">total2_base_map</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span>) (<span class="id" title="var">IH</span> <span class="id" title="var">_</span> <span class="id" title="var">j</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">lastelement</span>,,<span class="id" title="var">k</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">weqstnsum_invmap_step1</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">j</span> : <span class="id" title="var">stn</span> (<span class="id" title="var">stnsum</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">f</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">x</span>)))) :<br/>
&nbsp;&nbsp;<span class="id" title="var">weqstnsum_invmap</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">weqfromcoprodofstn_map</span> (<span class="id" title="var">stnsum</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">f</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">x</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>) (<span class="id" title="var">ii1</span> <span class="id" title="var">j</span>))<br/>
&nbsp;&nbsp;= <span class="id" title="var">total2_base_map</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span>) (<span class="id" title="var">weqstnsum_invmap</span> (<span class="id" title="var">f</span> ∘ <span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span>) <span class="id" title="var">j</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">weqstnsum_invmap</span> <span class="id" title="tactic">at</span> 1. <span class="id" title="tactic">unfold</span> <span class="id" title="var">nat_rect</span> <span class="id" title="tactic">at</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">weqfromcoprodofstn_eq1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">weqstnsum_invmap_step2</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">k</span> : ⟦<span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>⟧) :<br/>
&nbsp;&nbsp;<span class="id" title="var">weqstnsum_invmap</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">weqfromcoprodofstn_map</span> (<span class="id" title="var">stnsum</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">f</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">x</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>) (<span class="id" title="var">ii2</span> <span class="id" title="var">k</span>))<br/>
&nbsp;&nbsp;= (<span class="id" title="var">lastelement</span>,,<span class="id" title="var">k</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">weqstnsum_invmap</span> <span class="id" title="tactic">at</span> 1. <span class="id" title="tactic">unfold</span> <span class="id" title="var">nat_rect</span> <span class="id" title="tactic">at</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">weqfromcoprodofstn_eq1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">partial_sum_prop_aux</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} {<span class="id" title="var">m</span> : ⟦<span class="id" title="var">n</span>⟧ → <span class="id" title="var">nat</span>} :<br/>
&nbsp;&nbsp;∏ (<span class="id" title="var">i</span> <span class="id" title="var">i'</span> : ⟦ <span class="id" title="var">n</span> ⟧) (<span class="id" title="var">j</span> : ⟦ <span class="id" title="var">m</span> <span class="id" title="var">i</span> ⟧) (<span class="id" title="var">j'</span> : ⟦ <span class="id" title="var">m</span> <span class="id" title="var">i'</span> ⟧),<br/>
&nbsp;&nbsp;<span class="id" title="var">i</span> &lt; <span class="id" title="var">i'</span> → <span class="id" title="var">stnsum</span> (<span class="id" title="var">m</span> ∘ <span class="id" title="var">stn_left''</span> (<span class="id" title="var">stnlt</span> <span class="id" title="var">i</span>)) + <span class="id" title="var">j</span> &lt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">stnsum</span> (<span class="id" title="var">m</span> ∘ <span class="id" title="var">stn_left''</span> (<span class="id" title="var">stnlt</span> <span class="id" title="var">i'</span>)) + <span class="id" title="var">j'</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? ? ? ? <span class="id" title="var">lt</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natlthtolehsn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">lt</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">ltS</span> := (<span class="id" title="var">natlehlthtrans</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">lt</span> (<span class="id" title="var">stnlt</span> <span class="id" title="var">i'</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">natlthlehtrans</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">natlehnplusnm</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natlthlehtrans</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">stnsum</span> (<span class="id" title="var">m</span> ∘ <span class="id" title="var">stn_left''</span> <span class="id" title="var">ltS</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">stnsum_step</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">stnsum</span> (<span class="id" title="var">m</span> ∘ <span class="id" title="var">stn_left''</span> (<span class="id" title="var">stnlt</span> <span class="id" title="var">i</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">stnsum</span> (<span class="id" title="var">m</span> ∘ <span class="id" title="var">stn_left''</span> <span class="id" title="var">ltS</span> ∘ <span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">e</span>. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">stnsum_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">funcomp</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>, <span class="id" title="var">di_eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">stnlt</span> <span class="id" title="var">k</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natlthandplusl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ((<span class="id" title="var">m</span> ∘ <span class="id" title="var">stn_left''</span> <span class="id" title="var">ltS</span>) <span class="id" title="var">lastelement</span> = <span class="id" title="var">m</span> <span class="id" title="var">i</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">e</span>. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">funcomp</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>, <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">stnlt</span> <span class="id" title="var">j</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> (<span class="id" title="var">stnsum</span> (<span class="id" title="var">m</span> ∘ <span class="id" title="var">stn_left''</span> <span class="id" title="var">ltS</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">stnsum</span> (<span class="id" title="var">m</span> ∘ <span class="id" title="var">stn_left''</span> (<span class="id" title="var">stnlt</span> <span class="id" title="var">i'</span>) ∘ <span class="id" title="var">stn_left'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">lt</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">e</span>. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">stnsum_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">funcomp</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>, <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">stnsum_left_le'</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">partial_sum_prop</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} {<span class="id" title="var">m</span> : ⟦<span class="id" title="var">n</span>⟧ → <span class="id" title="var">nat</span>} {<span class="id" title="var">l</span> : <span class="id" title="var">nat</span>} :<br/>
&nbsp;&nbsp;<span class="id" title="var">isaprop</span> (∑ (<span class="id" title="var">i</span> : ⟦<span class="id" title="var">n</span>⟧ ) (<span class="id" title="var">j</span> : ⟦<span class="id" title="var">m</span> <span class="id" title="var">i</span>⟧ ), <span class="id" title="var">stnsum</span> (<span class="id" title="var">m</span> ∘ <span class="id" title="var">stn_left''</span> (<span class="id" title="var">stnlt</span> <span class="id" title="var">i</span>)) + <span class="id" title="var">j</span> = <span class="id" title="var">l</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">invproofirrelevance</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">t'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">i</span> <span class="id" title="var">je</span>]. <span class="id" title="tactic">induction</span> <span class="id" title="var">je</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">j</span> <span class="id" title="var">e</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t'</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">i'</span> <span class="id" title="var">je'</span>]. <span class="id" title="tactic">induction</span> <span class="id" title="var">je'</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">j'</span> <span class="id" title="var">e'</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">e''</span> := <span class="id" title="var">e</span> @ !<span class="id" title="var">e'</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">i</span> = <span class="id" title="var">i'</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">p</span>. {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">nat_eq_or_neq</span> <span class="id" title="var">i</span> <span class="id" title="var">i'</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">eq</span> | <span class="id" title="var">ne</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="var">e''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_neq_to_nopath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">natneqchoice</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ne</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">apply</span> <span class="id" title="var">natgthtoneq</span> | <span class="id" title="tactic">apply</span> <span class="id" title="var">natlthtoneq</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">partial_sum_prop_aux</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">total2_paths_f</span> <span class="id" title="keyword">with</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">total2_paths_f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">induction</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">natpluslcan</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">e''</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">isasetnat</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">partial_sum_slot</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} {<span class="id" title="var">m</span> : ⟦<span class="id" title="var">n</span>⟧ → <span class="id" title="var">nat</span>} {<span class="id" title="var">l</span> : <span class="id" title="var">nat</span>} : <span class="id" title="var">l</span> &lt; <span class="id" title="var">stnsum</span> <span class="id" title="var">m</span> -&gt;<br/>
&nbsp;&nbsp;∃! (<span class="id" title="var">i</span> : ⟦<span class="id" title="var">n</span>⟧ ) (<span class="id" title="var">j</span> : ⟦<span class="id" title="var">m</span> <span class="id" title="var">i</span>⟧ ), <span class="id" title="var">stnsum</span> (<span class="id" title="var">m</span> ∘ <span class="id" title="var">stn_left''</span> (<span class="id" title="var">stnlt</span> <span class="id" title="var">i</span>)) + <span class="id" title="var">j</span> = <span class="id" title="var">l</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">lt</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">len</span> := <span class="id" title="var">stnsum</span> <span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IH</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>. <span class="id" title="tactic">change</span> (<span class="id" title="var">hProptoType</span>(<span class="id" title="var">l</span> &lt; 0)) <span class="id" title="tactic">in</span> <span class="id" title="var">lt</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">negnatlthn0</span> <span class="id" title="var">_</span> <span class="id" title="var">lt</span>). }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">m'</span> := <span class="id" title="var">m</span> ∘ <span class="id" title="var">dni_lastelement</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">len'</span> := <span class="id" title="var">stnsum</span> <span class="id" title="var">m'</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">natlthorgeh</span> <span class="id" title="var">l</span> <span class="id" title="var">len'</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">I</span>|<span class="id" title="var">J</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> (<span class="id" title="var">IH'</span> := <span class="id" title="var">IH</span> <span class="id" title="var">m'</span> <span class="id" title="var">I</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">IH'</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">ijJ</span> <span class="id" title="var">Q</span>]. <span class="id" title="tactic">induction</span> <span class="id" title="var">ijJ</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">i</span> <span class="id" title="var">jJ</span>]. <span class="id" title="tactic">induction</span> <span class="id" title="var">jJ</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">j</span> <span class="id" title="var">J</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">tpair</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exists</span> (<span class="id" title="var">dni_lastelement</span> <span class="id" title="var">i</span>). <span class="id" title="tactic">exists</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">abstract</span> (<span class="id" title="var">use</span> (<span class="id" title="var">_</span> @ <span class="id" title="var">J</span>); <span class="id" title="tactic">apply</span> (<span class="id" title="var">maponpaths</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">x</span>+<span class="id" title="var">j</span>)); <span class="id" title="tactic">apply</span> <span class="id" title="var">stnsum_eq</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">r</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">m'</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">funcomp</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>, <span class="id" title="var">idpath</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intro</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">partial_sum_prop</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">clear</span> <span class="id" title="var">IH</span>. <span class="id" title="tactic">set</span> (<span class="id" title="var">j</span> := <span class="id" title="var">l</span> - <span class="id" title="var">len'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">iscontraprop1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">partial_sum_prop</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">K</span> := <span class="id" title="var">minusplusnmm</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">J</span>). <span class="id" title="tactic">change</span> (<span class="id" title="var">l</span>-<span class="id" title="var">len'</span>) <span class="id" title="keyword">with</span> <span class="id" title="var">j</span> <span class="id" title="tactic">in</span> <span class="id" title="var">K</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">lastelement</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">tpair</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exists</span> <span class="id" title="var">j</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">natlthandpluslinv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">len'</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">natpluscomm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (!<span class="id" title="var">K</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">K</span> <span class="id" title="var">J</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span>(<span class="id" title="var">C</span> : <span class="id" title="var">len</span> = <span class="id" title="var">len'</span> + <span class="id" title="var">m</span> <span class="id" title="var">lastelement</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">use</span> (<span class="id" title="var">stnsum_step</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>). <span class="id" title="tactic">unfold</span> <span class="id" title="var">len'</span>, <span class="id" title="var">m'</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">m'</span> <span class="id" title="var">len'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">replace_dni_last</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">C</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">lt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">simpl</span>. <span class="id" title="var">intermediate_path</span> (<span class="id" title="var">stnsum</span> <span class="id" title="var">m'</span> + <span class="id" title="var">j</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> (<span class="id" title="var">maponpaths</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">x</span>+<span class="id" title="var">j</span>)). <span class="id" title="tactic">apply</span> <span class="id" title="var">stnsum_eq</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">m'</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">funcomp</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>, <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">natpluscomm</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">K</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stn_right_first</span> (<span class="id" title="var">n</span> <span class="id" title="var">i</span> : <span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">stn_right</span> <span class="id" title="var">i</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) <span class="id" title="var">firstelement</span> = <span class="id" title="var">stnpair</span> (<span class="id" title="var">i</span> + <span class="id" title="var">S</span> <span class="id" title="var">n</span>) <span class="id" title="var">i</span> (<span class="id" title="var">natltplusS</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natplusr0</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nat_rect_step</span> (<span class="id" title="var">P</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">UU</span>) (<span class="id" title="var">p0</span> : <span class="id" title="var">P</span> 0) (<span class="id" title="var">IH</span> : ∏ <span class="id" title="var">n</span>, <span class="id" title="var">P</span> <span class="id" title="var">n</span> → <span class="id" title="var">P</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)) <span class="id" title="var">n</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">nat_rect</span> <span class="id" title="var">P</span> <span class="id" title="var">p0</span> <span class="id" title="var">IH</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) = <span class="id" title="var">IH</span> <span class="id" title="var">n</span> (<span class="id" title="var">nat_rect</span> <span class="id" title="var">P</span> <span class="id" title="var">p0</span> <span class="id" title="var">IH</span> <span class="id" title="var">n</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">weqstnsum1_prelim</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> : ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;(∑ <span class="id" title="var">i</span>, ⟦<span class="id" title="var">f</span> <span class="id" title="var">i</span>⟧) ≃ ⟦<span class="id" title="var">stnsum</span> <span class="id" title="var">f</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [ | <span class="id" title="var">n'</span> <span class="id" title="var">IHn</span> ].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">f</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">weqempty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">negstn0</span> ∘ <span class="id" title="var">pr1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">negstn0</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (⟦<span class="id" title="var">stnsum</span> <span class="id" title="var">f</span>⟧) <span class="id" title="keyword">with</span> (⟦<span class="id" title="var">stnsum</span> (<span class="id" title="var">f</span> ∘ <span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span>) + <span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>⟧).<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">weqcomp</span> <span class="id" title="var">_</span> (<span class="id" title="var">weqfromcoprodofstn</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">weqcomp</span> (<span class="id" title="var">weqoverdnicoprod</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">weqcoprodf1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHn</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">weqstnsum1_step</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">weqstnsum1_prelim</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">weqfromcoprodofstn</span> (<span class="id" title="var">stnsum</span> (<span class="id" title="var">funcomp</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span>) <span class="id" title="var">f</span>)) (<span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ (<span class="id" title="var">weqcoprodf1</span> (<span class="id" title="var">weqstnsum1_prelim</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, <span class="id" title="var">f</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">weqoverdnicoprod</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, ⟦ <span class="id" title="var">f</span> <span class="id" title="var">i</span> ⟧))) % <span class="id" title="var">weq</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">weqstnsum1_prelim_eq</span> { <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> } (<span class="id" title="var">f</span> : ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">weqstnsum1_prelim</span> <span class="id" title="var">f</span> ~ <span class="id" title="var">weqstnsum_map</span> <span class="id" title="var">f</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">I</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">f</span> <span class="id" title="var">ij</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>, <span class="id" title="var">negstn0</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">ij</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">weqstnsum1_step</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">ij</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2 <span class="id" title="var">weqcomp_to_funcomp_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">weqcoprodf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">pr1weq</span> (<span class="id" title="var">weqcoprodf</span> (<span class="id" title="var">weqstnsum1_prelim</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, <span class="id" title="var">f</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">idweq</span> (⟦ <span class="id" title="var">f</span> <span class="id" title="var">lastelement</span> ⟧))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<span class="id" title="var">coprodf</span> (<span class="id" title="var">weqstnsum1_prelim</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, <span class="id" title="var">f</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">idfun</span> (⟦ <span class="id" title="var">f</span> <span class="id" title="var">lastelement</span> ⟧))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">intermediate_path</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">weqfromcoprodofstn</span> (<span class="id" title="var">stnsum</span> (<span class="id" title="var">f</span> ∘ <span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span>)) (<span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">coprodf</span> (<span class="id" title="var">weqstnsum_map</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, <span class="id" title="var">f</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">idfun</span> (⟦ <span class="id" title="var">f</span> <span class="id" title="var">lastelement</span> ⟧)) ((<span class="id" title="var">weqoverdnicoprod</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, ⟦ <span class="id" title="var">f</span> <span class="id" title="var">i</span> ⟧)) <span class="id" title="var">ij</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">homotcoprodfhomot</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">clear</span> <span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="var">ij</span> ; <span class="id" title="tactic">clear</span> <span class="id" title="var">ij</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">homotweqinv'</span> (<span class="id" title="var">weqstnsum_map</span> <span class="id" title="var">f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">weqoverdnicoprod</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span> : ⟦ <span class="id" title="var">S</span> <span class="id" title="var">n</span> ⟧, ⟦ <span class="id" title="var">f</span> <span class="id" title="var">i</span> ⟧))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">c</span>, <span class="id" title="var">pr1weq</span> (<span class="id" title="var">weqfromcoprodofstn</span> (<span class="id" title="var">stnsum</span> (<span class="id" title="var">f</span> ∘ <span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span>)) (<span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">coprodf</span> (<span class="id" title="var">weqstnsum_map</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, <span class="id" title="var">f</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">idfun</span> <span class="id" title="var">_</span>) <span class="id" title="var">c</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">funcomp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">P</span> := <span class="id" title="var">λ</span> <span class="id" title="var">i</span>, ⟦ <span class="id" title="var">f</span> <span class="id" title="var">i</span> ⟧).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">pr1weq</span> (<span class="id" title="var">weqfromcoprodofstn</span> (<span class="id" title="var">stnsum</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : ⟦ <span class="id" title="var">n</span> ⟧, <span class="id" title="var">f</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">x</span>))) (<span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<span class="id" title="var">weqfromcoprodofstn_map</span> (<span class="id" title="var">stnsum</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : ⟦ <span class="id" title="var">n</span> ⟧, <span class="id" title="var">f</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">x</span>))) (<span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">c</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">jk</span>|<span class="id" title="var">k</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">unfold</span> <span class="id" title="var">coprodf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">jk</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">j</span> <span class="id" title="var">k</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">invmap</span> (<span class="id" title="var">weqoverdnicoprod</span> <span class="id" title="var">P</span>) (<span class="id" title="var">ii1</span> (<span class="id" title="var">j</span>,,<span class="id" title="var">k</span>))) <span class="id" title="keyword">with</span> (<span class="id" title="var">tpair</span> <span class="id" title="var">P</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">j</span>) <span class="id" title="var">k</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">weqfromcoprodofstn_map</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">coprod_rect</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">weqstnsum_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">k</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">k</span> <span class="id" title="var">K</span>]. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">maponpaths</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">x</span>+<span class="id" title="var">k</span>)). <span class="id" title="tactic">unfold</span> <span class="id" title="var">funcomp</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">stntonat</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">di</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">K</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">natlthorgeh</span> <span class="id" title="var">_</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">G</span>|<span class="id" title="var">G'</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">stnsum_eq</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">k</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>, <span class="id" title="var">di_eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">istransnatlth</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">stnlt</span> <span class="id" title="var">k</span>) <span class="id" title="var">G</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">natlthtonegnatgeh</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">stnlt</span> <span class="id" title="var">j</span>) <span class="id" title="var">G'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">change</span> (<span class="id" title="var">invmap</span> (<span class="id" title="var">weqoverdnicoprod</span> <span class="id" title="var">P</span>) (<span class="id" title="var">ii2</span> <span class="id" title="var">k</span>)) <span class="id" title="keyword">with</span> (<span class="id" title="var">tpair</span> <span class="id" title="var">P</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">k</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">coprodf</span>, <span class="id" title="var">idfun</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">weqfromcoprodofstn_map</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">coprod_rect</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">weqstnsum_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">k</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">k</span> <span class="id" title="var">K</span>]. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">maponpaths</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">x</span>+<span class="id" title="var">k</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">funextfun</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">i</span> <span class="id" title="var">I</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">funcomp</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>, <span class="id" title="var">di_eq1</span>. <span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">weqstnsum1_prelim_eq'</span> { <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> } (<span class="id" title="var">f</span> : ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">invweq</span> (<span class="id" title="var">weqstnsum1_prelim</span> <span class="id" title="var">f</span>) ~ <span class="id" title="var">weqstnsum_invmap</span> <span class="id" title="var">f</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">I</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">f</span> <span class="id" title="var">k</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>, <span class="id" title="var">negstn0</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">weqstnsum1_step</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span>. <span class="id" title="tactic">rewrite</span> 2 <span class="id" title="var">invweqcomp</span>. <span class="id" title="tactic">rewrite</span> 2 <span class="id" title="var">weqcomp_to_funcomp_app</span>. <span class="id" title="tactic">rewrite</span> 3 <span class="id" title="var">pr1_invweq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">weqcoprodf1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">invmap</span> (<span class="id" title="var">weqcoprodf</span> (<span class="id" title="var">weqstnsum1_prelim</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, <span class="id" title="var">f</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">i</span>))) (<span class="id" title="var">idweq</span> (⟦ <span class="id" title="var">f</span> <span class="id" title="var">lastelement</span> ⟧))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<span class="id" title="var">coprodf</span> (<span class="id" title="var">invweq</span> (<span class="id" title="var">weqstnsum1_prelim</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, <span class="id" title="var">f</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">i</span>)))) (<span class="id" title="var">idweq</span> (⟦ <span class="id" title="var">f</span> <span class="id" title="var">lastelement</span> ⟧))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">intermediate_path</span> (<span class="id" title="var">invmap</span> (<span class="id" title="var">weqoverdnicoprod</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span> : ⟦ <span class="id" title="var">S</span> <span class="id" title="var">n</span> ⟧, ⟦ <span class="id" title="var">f</span> <span class="id" title="var">i</span> ⟧))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">coprodf</span> (<span class="id" title="var">weqstnsum_invmap</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span> : ⟦ <span class="id" title="var">n</span> ⟧, <span class="id" title="var">f</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">i</span>))) (<span class="id" title="var">idweq</span> (⟦ <span class="id" title="var">f</span> <span class="id" title="var">lastelement</span> ⟧))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">invmap</span> (<span class="id" title="var">weqfromcoprodofstn</span> (<span class="id" title="var">stnsum</span> (<span class="id" title="var">f</span> ∘ <span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span>)) (<span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>)) <span class="id" title="var">k</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">invmap</span> <span class="id" title="var">_</span> <span class="id" title="var">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<span class="id" title="var">invmap</span> (<span class="id" title="var">weqfromcoprodofstn</span> (<span class="id" title="var">stnsum</span> (<span class="id" title="var">f</span> ∘ <span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span>)) (<span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>)) <span class="id" title="var">k</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> (<span class="id" title="var">invmap</span> (<span class="id" title="var">weqfromcoprodofstn</span> (<span class="id" title="var">stnsum</span> (<span class="id" title="var">f</span> ∘ <span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span>)) (<span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>)) <span class="id" title="var">k</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">homotcoprodfhomot</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">homotrefl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">clear</span> <span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="var">k</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">homotweqinv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">c</span>, <span class="id" title="var">invmap</span> (<span class="id" title="var">weqoverdnicoprod</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, ⟦ <span class="id" title="var">f</span> <span class="id" title="var">i</span> ⟧))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">coprodf</span> (<span class="id" title="var">weqstnsum_invmap</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, <span class="id" title="var">f</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">idweq</span> (⟦ <span class="id" title="var">f</span> <span class="id" title="var">lastelement</span> ⟧))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">c</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">weqfromcoprodofstn</span> (<span class="id" title="var">stnsum</span> (<span class="id" title="var">f</span> ∘ <span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span>)) (<span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">funcomp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">c</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">r</span>|<span class="id" title="var">s</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">unfold</span> <span class="id" title="var">coprodf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">pr1weq</span> (<span class="id" title="var">weqfromcoprodofstn</span> (<span class="id" title="var">stnsum</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">f</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">x</span>))) (<span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<span class="id" title="var">weqfromcoprodofstn_map</span> (<span class="id" title="var">stnsum</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">f</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">x</span>))) (<span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">P</span> := (<span class="id" title="var">λ</span> <span class="id" title="var">i</span> : ⟦ <span class="id" title="var">S</span> <span class="id" title="var">n</span> ⟧, ⟦ <span class="id" title="var">f</span> <span class="id" title="var">i</span> ⟧)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">weqstnsum_invmap_step1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span> : ⟦ <span class="id" title="var">n</span> ⟧, <span class="id" title="var">f</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">i</span>)) <span class="id" title="keyword">with</span> (<span class="id" title="var">f</span> ∘ <span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> (<span class="id" title="var">weqstnsum_invmap</span> (<span class="id" title="var">f</span> ∘ <span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span>) <span class="id" title="var">r</span>); <span class="id" title="tactic">intro</span> <span class="id" title="var">ij</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">ij</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">i</span> <span class="id" title="var">j</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">unfold</span> <span class="id" title="var">coprodf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">pr1weq</span> (<span class="id" title="var">idweq</span> <span class="id" title="var">_</span>) <span class="id" title="var">s</span>) <span class="id" title="keyword">with</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">P</span> := (<span class="id" title="var">λ</span> <span class="id" title="var">i</span> : ⟦ <span class="id" title="var">S</span> <span class="id" title="var">n</span> ⟧, ⟦ <span class="id" title="var">f</span> <span class="id" title="var">i</span> ⟧)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">pr1weq</span> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<span class="id" title="var">weqfromcoprodofstn_map</span> (<span class="id" title="var">stnsum</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : ⟦ <span class="id" title="var">n</span> ⟧, <span class="id" title="var">f</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">x</span>))) (<span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">weqstnsum_invmap_step2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">weqstnsum1</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> : ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) : (∑ <span class="id" title="var">i</span>, ⟦<span class="id" title="var">f</span> <span class="id" title="var">i</span>⟧) ≃ ⟦<span class="id" title="var">stnsum</span> <span class="id" title="var">f</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">use</span> (<span class="id" title="var">remakeweqboth</span> (<span class="id" title="var">weqstnsum1_prelim_eq</span> <span class="id" title="var">_</span>) (<span class="id" title="var">weqstnsum1_prelim_eq'</span> <span class="id" title="var">_</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">weqstnsum1_eq</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> : ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) : <span class="id" title="var">pr1weq</span> (<span class="id" title="var">weqstnsum1</span> <span class="id" title="var">f</span>) = <span class="id" title="var">weqstnsum_map</span> <span class="id" title="var">f</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">weqstnsum1_eq'</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> : ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) : <span class="id" title="var">invmap</span> (<span class="id" title="var">weqstnsum1</span> <span class="id" title="var">f</span>) = <span class="id" title="var">weqstnsum_invmap</span> <span class="id" title="var">f</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">weqstnsum</span> { <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> } (<span class="id" title="var">P</span> : ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">UU</span>) (<span class="id" title="var">f</span> : ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;(∏ <span class="id" title="var">i</span>, ⟦<span class="id" title="var">f</span> <span class="id" title="var">i</span>⟧ ≃ <span class="id" title="var">P</span> <span class="id" title="var">i</span>) -&gt; <span class="id" title="var">total2</span> <span class="id" title="var">P</span> ≃ ⟦<span class="id" title="var">stnsum</span> <span class="id" title="var">f</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">intermediate_weq</span> (∑ <span class="id" title="var">i</span>, ⟦<span class="id" title="var">f</span> <span class="id" title="var">i</span>⟧).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">invweq</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">weqfibtototal</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">weqstnsum1</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Corollary</span> <span class="id" title="var">weqstnsum2</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> : ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">X</span> -&gt; ⟦<span class="id" title="var">n</span>⟧ ) :<br/>
&nbsp;&nbsp;(∏ <span class="id" title="var">i</span>, ⟦<span class="id" title="var">f</span> <span class="id" title="var">i</span>⟧ ≃ <span class="id" title="var">hfiber</span> <span class="id" title="var">g</span> <span class="id" title="var">i</span>) -&gt; <span class="id" title="var">X</span> ≃ ⟦<span class="id" title="var">stnsum</span> <span class="id" title="var">f</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">weqcomp</span> <span class="id" title="var">_</span> (<span class="id" title="var">weqstnsum</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">w</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">weqtococonusf</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
lexical enumeration of pairs of natural numbers 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">lexicalEnumeration</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">m</span>: ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;⟦<span class="id" title="var">stnsum</span> <span class="id" title="var">m</span>⟧ ≃ (∑ <span class="id" title="var">i</span> : ⟦<span class="id" title="var">n</span>⟧, ⟦<span class="id" title="var">m</span> <span class="id" title="var">i</span>⟧) := <span class="id" title="var">invweq</span> (<span class="id" title="var">weqstnsum1</span> <span class="id" title="var">m</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">inverse_lexicalEnumeration</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">m</span>: ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;(∑ <span class="id" title="var">i</span> : ⟦<span class="id" title="var">n</span>⟧, ⟦<span class="id" title="var">m</span> <span class="id" title="var">i</span>⟧) ≃ ⟦<span class="id" title="var">stnsum</span> <span class="id" title="var">m</span>⟧ := <span class="id" title="var">weqstnsum1</span> <span class="id" title="var">m</span>.<br/>

<br/>
</div>

<div class="doc">
two generalizations of stnsum, potentially useful 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">foldleft</span> {<span class="id" title="var">E</span>} (<span class="id" title="var">e</span> : <span class="id" title="var">E</span>) (<span class="id" title="var">m</span> : <span class="id" title="var">binop</span> <span class="id" title="var">E</span>) {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">x</span>: ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">E</span>) : <span class="id" title="var">E</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">foldleft</span>].<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">m</span> (<span class="id" title="var">foldleft</span> (<span class="id" title="var">x</span> ∘ (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span>))) (<span class="id" title="var">x</span> <span class="id" title="var">lastelement</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">foldright</span> {<span class="id" title="var">E</span>} (<span class="id" title="var">m</span> : <span class="id" title="var">binop</span> <span class="id" title="var">E</span>) (<span class="id" title="var">e</span> : <span class="id" title="var">E</span>) {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">x</span>: ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">E</span>) : <span class="id" title="var">E</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">foldright</span>].<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">m</span> (<span class="id" title="var">x</span> <span class="id" title="var">firstelement</span>) (<span class="id" title="var">foldright</span> (<span class="id" title="var">x</span> ∘ <span class="id" title="var">dni</span> <span class="id" title="var">firstelement</span>))).<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab340"></a><h3 class="section">Weak equivalence between the direct product of <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode"></span> and <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#m"><span class="id" title="variable">m</span></a></span> <span class="inlinecode"></span> and <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">*</span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#m"><span class="id" title="variable">m</span></a></span> <span class="inlinecode"></span></h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">weqfromprodofstn</span> ( <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span> ) : ⟦<span class="id" title="var">n</span>⟧ × ⟦<span class="id" title="var">m</span>⟧ ≃ ⟦<span class="id" title="var">n</span>*<span class="id" title="var">m</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> ( <span class="id" title="var">natgthorleh</span> <span class="id" title="var">m</span> 0 ) <span class="id" title="keyword">as</span> [ <span class="id" title="keyword">is</span> | <span class="id" title="var">i</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> ( <span class="id" title="var">i1</span> : ∏ <span class="id" title="var">i</span> <span class="id" title="var">j</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span> -&gt; <span class="id" title="var">j</span> &lt; <span class="id" title="var">m</span> -&gt; <span class="id" title="var">j</span> + <span class="id" title="var">i</span> * <span class="id" title="var">m</span> &lt; <span class="id" title="var">n</span> * <span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">li</span> <span class="id" title="var">lj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">natlthlehtrans</span> ( <span class="id" title="var">j</span> + <span class="id" title="var">i</span> * <span class="id" title="var">m</span> ) ( ( <span class="id" title="var">S</span> <span class="id" title="var">i</span> ) * <span class="id" title="var">m</span> ) ( <span class="id" title="var">n</span> * <span class="id" title="var">m</span> )).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">change</span> (<span class="id" title="var">S</span> <span class="id" title="var">i</span> * <span class="id" title="var">m</span>) <span class="id" title="keyword">with</span> (<span class="id" title="var">i</span>*<span class="id" title="var">m</span> + <span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">natpluscomm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">natgthandplusl</span> <span class="id" title="var">m</span> <span class="id" title="var">j</span> ( <span class="id" title="var">i</span> * <span class="id" title="var">m</span> ) <span class="id" title="var">lj</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exact</span> ( <span class="id" title="var">natlehandmultr</span> ( <span class="id" title="var">S</span> <span class="id" title="var">i</span> ) <span class="id" title="var">n</span> <span class="id" title="var">m</span> ( <span class="id" title="var">natgthtogehsn</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">li</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">set</span> ( <span class="id" title="var">f</span> := <span class="id" title="var">λ</span> <span class="id" title="var">ij</span> : ⟦<span class="id" title="var">n</span>⟧ × ⟦<span class="id" title="var">m</span>⟧,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">ij</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">tpair</span> <span class="id" title="var">_</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">stnpair</span> ( <span class="id" title="var">n</span> * <span class="id" title="var">m</span> ) ( <span class="id" title="var">j</span> + <span class="id" title="var">i</span> * <span class="id" title="var">m</span> ) ( <span class="id" title="var">i1</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">i</span> ) ( <span class="id" title="var">pr2</span> <span class="id" title="var">j</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">isinf</span> : <span class="id" title="var">isincl</span> <span class="id" title="var">f</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">isinclbetweensets</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">isofhleveldirprod</span> 2 <span class="id" title="var">_</span> <span class="id" title="var">_</span> ( <span class="id" title="var">isasetstn</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">isasetstn</span> <span class="id" title="var">m</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">isasetstn</span> ( <span class="id" title="var">n</span> * <span class="id" title="var">m</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">ij</span> <span class="id" title="var">ij'</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">ij</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">i</span> <span class="id" title="var">j</span> ]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">ij'</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">i'</span> <span class="id" title="var">j'</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">i</span> <span class="id" title="var">li</span> ]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">i'</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">i'</span> <span class="id" title="var">li'</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">j</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">j</span> <span class="id" title="var">lj</span> ]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">j'</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">j'</span> <span class="id" title="var">lj'</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">e'</span> := <span class="id" title="var">maponpaths</span> ( <span class="id" title="var">stntonat</span> ( <span class="id" title="var">n</span> * <span class="id" title="var">m</span> ) ) <span class="id" title="var">e</span> ). <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">eei</span> : <span class="id" title="var">i</span> = <span class="id" title="var">i'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">natdivremunique</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">i'</span> <span class="id" title="var">j'</span> <span class="id" title="var">lj</span> <span class="id" title="var">lj'</span> ( <span class="id" title="var">maponpaths</span> ( <span class="id" title="var">stntonat</span> <span class="id" title="var">_</span> ) <span class="id" title="var">e</span> ) ) ). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">eeis</span> := <span class="id" title="var">invmaponpathsincl</span> <span class="id" title="var">_</span> ( <span class="id" title="var">isinclstntonat</span> <span class="id" title="var">_</span> ) ( <span class="id" title="var">stnpair</span> <span class="id" title="var">_</span> <span class="id" title="var">i</span> <span class="id" title="var">li</span> ) ( <span class="id" title="var">stnpair</span> <span class="id" title="var">_</span> <span class="id" title="var">i'</span> <span class="id" title="var">li'</span> ) <span class="id" title="var">eei</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">eej</span> : <span class="id" title="var">j</span> = <span class="id" title="var">j'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">natdivremunique</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">i'</span> <span class="id" title="var">j'</span> <span class="id" title="var">lj</span> <span class="id" title="var">lj'</span> ( <span class="id" title="var">maponpaths</span> ( <span class="id" title="var">stntonat</span> <span class="id" title="var">_</span> ) <span class="id" title="var">e</span> ) ) ). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">eejs</span> := <span class="id" title="var">invmaponpathsincl</span> <span class="id" title="var">_</span> ( <span class="id" title="var">isinclstntonat</span> <span class="id" title="var">_</span> ) ( <span class="id" title="var">stnpair</span> <span class="id" title="var">_</span> <span class="id" title="var">j</span> <span class="id" title="var">lj</span> ) ( <span class="id" title="var">stnpair</span> <span class="id" title="var">_</span> <span class="id" title="var">j'</span> <span class="id" title="var">lj'</span> ) <span class="id" title="var">eej</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pathsdirprod</span> <span class="id" title="var">eeis</span> <span class="id" title="var">eejs</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">intro</span> <span class="id" title="var">xnm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">iscontraprop1</span>. <span class="id" title="tactic">apply</span> ( <span class="id" title="var">isinf</span> <span class="id" title="var">xnm</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">e</span> := <span class="id" title="var">pathsinv0</span> ( <span class="id" title="var">natdivremrule</span> <span class="id" title="var">xnm</span> <span class="id" title="var">m</span> ( <span class="id" title="var">natgthtoneq</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">is</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">i</span> := <span class="id" title="var">natdiv</span> <span class="id" title="var">xnm</span> <span class="id" title="var">m</span> ). <span class="id" title="tactic">set</span> ( <span class="id" title="var">j</span> := <span class="id" title="var">natrem</span> <span class="id" title="var">xnm</span> <span class="id" title="var">m</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">xnm</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">xnm</span> <span class="id" title="var">lxnm</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">li</span> := <span class="id" title="var">natlthandmultrinv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ( <span class="id" title="var">natlehlthtrans</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ( <span class="id" title="var">natlehmultnatdiv</span> <span class="id" title="var">xnm</span> <span class="id" title="var">m</span> ( <span class="id" title="var">natgthtoneq</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">is</span> ) ) <span class="id" title="var">lxnm</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">lj</span> := <span class="id" title="var">lthnatrem</span> <span class="id" title="var">xnm</span> <span class="id" title="var">m</span> ( <span class="id" title="var">natgthtoneq</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">is</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">dirprodpair</span> ( <span class="id" title="var">stnpair</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span> <span class="id" title="var">li</span> ) ( <span class="id" title="var">stnpair</span> <span class="id" title="var">m</span> <span class="id" title="var">j</span> <span class="id" title="var">lj</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">invmaponpathsincl</span> <span class="id" title="var">_</span> ( <span class="id" title="var">isinclstntonat</span> <span class="id" title="var">_</span> ) <span class="id" title="var">_</span> <span class="id" title="var">_</span> ). <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">set</span> ( <span class="id" title="var">e</span> := <span class="id" title="var">natleh0tois0</span> <span class="id" title="var">i</span> ). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">natmultn0</span> <span class="id" title="var">n</span> ). <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( @<span class="id" title="var">pr2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ). <span class="id" title="tactic">apply</span> ( <span class="id" title="var">isweqtoempty2</span> <span class="id" title="var">_</span> ( <span class="id" title="var">weqstn0toempty</span> ) ).<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab341"></a><h3 class="section">Weak equivalences between decidable subsets of <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode"></span> and <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#x"><span class="id" title="variable">x</span></a></span> <span class="inlinecode"></span></h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">weqfromdecsubsetofstn</span> { <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> } ( <span class="id" title="var">f</span> : ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">bool</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">total2</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">hfiber</span> <span class="id" title="var">f</span> <span class="id" title="var">true</span> ≃ (⟦<span class="id" title="var">x</span>⟧) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [ | <span class="id" title="var">n</span> <span class="id" title="var">IHn</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">g</span> : <span class="id" title="var">hfiber</span> <span class="id" title="var">f</span> <span class="id" title="var">true</span> -&gt; (⟦0⟧) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">hf</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">i</span> <span class="id" title="var">e</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">weqstn0toempty</span> <span class="id" title="var">i</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">weqtoempty2</span> <span class="id" title="var">g</span> <span class="id" title="var">weqstn0toempty</span> ).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">g</span> := <span class="id" title="var">weqfromcoprodofstn</span> 1 <span class="id" title="var">n</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( 1 + <span class="id" title="var">n</span> ) <span class="id" title="keyword">with</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) <span class="id" title="tactic">in</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">fl</span> := <span class="id" title="var">λ</span> <span class="id" title="var">i</span> : ⟦1⟧, <span class="id" title="var">f</span> ( <span class="id" title="var">g</span> ( <span class="id" title="var">ii1</span> <span class="id" title="var">i</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">fh</span> := <span class="id" title="var">λ</span> <span class="id" title="var">i</span> : ⟦<span class="id" title="var">n</span>⟧, <span class="id" title="var">f</span> ( <span class="id" title="var">g</span> ( <span class="id" title="var">ii2</span> <span class="id" title="var">i</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">w</span> : ( <span class="id" title="var">hfiber</span> <span class="id" title="var">f</span> <span class="id" title="var">true</span> ) ≃ ( <span class="id" title="var">hfiber</span> ( <span class="id" title="var">sumofmaps</span> <span class="id" title="var">fl</span> <span class="id" title="var">fh</span> ) <span class="id" title="var">true</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">set</span> ( <span class="id" title="var">int</span> := <span class="id" title="var">invweq</span> ( <span class="id" title="var">weqhfibersgwtog</span> <span class="id" title="var">g</span> <span class="id" title="var">f</span> <span class="id" title="var">true</span>  ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">h</span> : ∏ <span class="id" title="var">x</span> : <span class="id" title="var">_</span> , <span class="id" title="var">paths</span> ( <span class="id" title="var">f</span> ( <span class="id" title="var">g</span> <span class="id" title="var">x</span> ) ) ( <span class="id" title="var">sumofmaps</span> <span class="id" title="var">fl</span> <span class="id" title="var">fh</span> <span class="id" title="var">x</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">x1</span> | <span class="id" title="var">xn</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">weqcomp</span> <span class="id" title="var">int</span> ( <span class="id" title="var">weqhfibershomot</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">h</span> <span class="id" title="var">true</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">w'</span> := <span class="id" title="var">weqcomp</span> <span class="id" title="var">w</span> ( <span class="id" title="var">invweq</span> ( <span class="id" title="var">weqhfibersofsumofmaps</span> <span class="id" title="var">fl</span> <span class="id" title="var">fh</span> <span class="id" title="var">true</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">x0</span> := <span class="id" title="var">pr1</span> ( <span class="id" title="var">IHn</span> <span class="id" title="var">fh</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">w0</span> := <span class="id" title="var">pr2</span> ( <span class="id" title="var">IHn</span> <span class="id" title="var">fh</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">w0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">boolchoice</span> ( <span class="id" title="var">fl</span> <span class="id" title="var">lastelement</span> ) ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">i</span> | <span class="id" title="var">ni</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">S</span> <span class="id" title="var">x0</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">wi</span> : <span class="id" title="var">hfiber</span> <span class="id" title="var">fl</span> <span class="id" title="var">true</span> ≃ ⟦1⟧ ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">assert</span> ( <span class="id" title="keyword">is</span> : <span class="id" title="var">iscontr</span> ( <span class="id" title="var">hfiber</span> <span class="id" title="var">fl</span> <span class="id" title="var">true</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">iscontraprop1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> ( <span class="id" title="var">isinclfromstn1</span> <span class="id" title="var">fl</span> <span class="id" title="var">isasetbool</span> <span class="id" title="var">true</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hfiberpair</span> <span class="id" title="var">_</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">i</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">weqcontrcontr</span> <span class="id" title="keyword">is</span> <span class="id" title="var">iscontrstn1</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">weqcomp</span> ( <span class="id" title="var">weqcomp</span> <span class="id" title="var">w'</span> ( <span class="id" title="var">weqcoprodf</span> <span class="id" title="var">wi</span> <span class="id" title="var">w0</span> ) ) ( <span class="id" title="var">weqfromcoprodofstn</span> 1 <span class="id" title="var">_</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">x0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">g'</span> : ¬ ( <span class="id" title="var">hfiber</span> <span class="id" title="var">fl</span> <span class="id" title="var">true</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">hf</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">j</span> <span class="id" title="var">e</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">ee</span> : <span class="id" title="var">j</span> = <span class="id" title="var">lastelement</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">proofirrelevance</span> <span class="id" title="var">_</span> ( <span class="id" title="var">isapropifcontr</span> <span class="id" title="var">iscontrstn1</span> ) <span class="id" title="var">_</span> <span class="id" title="var">_</span> ). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">nopathstruetofalse</span> ( <span class="id" title="var">pathscomp0</span> ( <span class="id" title="var">pathscomp0</span> ( <span class="id" title="var">pathsinv0</span> <span class="id" title="var">e</span> ) ( <span class="id" title="var">maponpaths</span> <span class="id" title="var">fl</span> <span class="id" title="var">ee</span> ) ) <span class="id" title="var">ni</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">weqcomp</span> <span class="id" title="var">w'</span> ( <span class="id" title="var">weqcomp</span> ( <span class="id" title="var">invweq</span> ( <span class="id" title="var">weqii2withneg</span> <span class="id" title="var">_</span> <span class="id" title="var">g'</span> ) ) <span class="id" title="var">w0</span> )  ).<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab342"></a><h3 class="section">Weak equivalences between hfibers of functions from <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode"></span> over isolated points and <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#x"><span class="id" title="variable">x</span></a></span> <span class="inlinecode"></span></h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">weqfromhfiberfromstn</span> { <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> } { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="var">x</span> : <span class="id" title="var">X</span> )<br/>
&nbsp;&nbsp;( <span class="id" title="keyword">is</span> : <span class="id" title="var">isisolated</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span> ) ( <span class="id" title="var">f</span> : ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">X</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">total2</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">x0</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">hfiber</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>  ≃ (⟦<span class="id" title="var">x0</span>⟧) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">t</span> := <span class="id" title="var">weqfromdecsubsetofstn</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">i</span> : <span class="id" title="var">_</span>, <span class="id" title="var">eqbx</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">f</span> <span class="id" title="var">i</span> ) ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">t</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">weqcomp</span> ( <span class="id" title="var">weqhfibertobhfiber</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="keyword">is</span> ) ( <span class="id" title="var">pr2</span> <span class="id" title="var">t</span> ) ).<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab343"></a><h3 class="section">Weak equivalence between <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#m"><span class="id" title="variable">m</span></a></span> <span class="inlinecode"></span> and <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode">(</span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.NaturalNumbers.html#natpower"><span class="id" title="definition">natpower</span></a></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#m"><span class="id" title="variable">m</span></a></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">)</span> <span class="inlinecode"></span> ( uses functional extensionality )</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">weqfromfunstntostn</span> ( <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span> ) : (⟦<span class="id" title="var">n</span>⟧ -&gt; ⟦<span class="id" title="var">m</span>⟧) ≃ ⟦<span class="id" title="var">natpower</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [ | <span class="id" title="var">n</span> <span class="id" title="var">IHn</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">weqcontrcontr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">iscontrfunfromempty2</span> <span class="id" title="var">_</span> <span class="id" title="var">weqstn0toempty</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">iscontrstn1</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">w1</span> := <span class="id" title="var">weqfromcoprodofstn</span> 1 <span class="id" title="var">n</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">w2</span> : ( ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ -&gt; ⟦<span class="id" title="var">m</span>⟧ ) ≃ ( (⟦1⟧ ⨿ ⟦<span class="id" title="var">n</span>⟧) -&gt; ⟦<span class="id" title="var">m</span>⟧ ) ) <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> ( <span class="id" title="var">weqbfun</span> <span class="id" title="var">_</span> <span class="id" title="var">w1</span>  ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">w3</span> := <span class="id" title="var">weqcomp</span> <span class="id" title="var">w2</span> ( <span class="id" title="var">weqfunfromcoprodtoprod</span> (⟦1⟧) (⟦<span class="id" title="var">n</span>⟧) (⟦<span class="id" title="var">m</span>⟧) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">w4</span> := <span class="id" title="var">weqcomp</span> <span class="id" title="var">w3</span> ( <span class="id" title="var">weqdirprodf</span> ( <span class="id" title="var">weqfunfromcontr</span> (⟦<span class="id" title="var">m</span>⟧) <span class="id" title="var">iscontrstn1</span> ) ( <span class="id" title="var">IHn</span> <span class="id" title="var">m</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">weqcomp</span> <span class="id" title="var">w4</span> ( <span class="id" title="var">weqfromprodofstn</span> <span class="id" title="var">m</span> ( <span class="id" title="var">natpower</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> ) ) ).<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab344"></a><h3 class="section">Weak equivalence from the space of functions of a family <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode">(</span> <span class="inlinecode"><a class="idref" href="UniMath.Algebra.DCPO.html#leastupperbound.f"><span class="id" title="variable">f</span></a></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#x"><span class="id" title="variable">x</span></a></span> <span class="inlinecode">)</span> <span class="inlinecode"></span>  over <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode"></span> to <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode">(</span> <span class="inlinecode"><span class="id" title="var">stnprod</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode"><a class="idref" href="UniMath.Algebra.DCPO.html#leastupperbound.f"><span class="id" title="variable">f</span></a></span> <span class="inlinecode">)</span> <span class="inlinecode"></span> ( uses functional extensionality )</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stnprod</span> { <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> } ( <span class="id" title="var">f</span> : ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span> ) : <span class="id" title="var">nat</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [ | <span class="id" title="var">n</span> <span class="id" title="var">IHn</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> 1.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (  ( <span class="id" title="var">IHn</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">i</span> : ⟦<span class="id" title="var">n</span>⟧, <span class="id" title="var">f</span> ( <span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">i</span> ) ) ) * <span class="id" title="var">f</span> <span class="id" title="var">lastelement</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stnprod_step</span> { <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> } ( <span class="id" title="var">f</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">stnprod</span> <span class="id" title="var">f</span> = <span class="id" title="var">stnprod</span> (<span class="id" title="var">f</span> ∘ <span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span>) * <span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stnprod_eq</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span>: ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>) : <span class="id" title="var">f</span> ~ <span class="id" title="var">g</span> -&gt; <span class="id" title="var">stnprod</span> <span class="id" title="var">f</span> = <span class="id" title="var">stnprod</span> <span class="id" title="var">g</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">h</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IH</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2? <span class="id" title="var">stnprod_step</span>. <span class="id" title="tactic">induction</span> (<span class="id" title="var">h</span> <span class="id" title="var">lastelement</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">maponpaths</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, <span class="id" title="var">i</span> * <span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>)). <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">h</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">weqstnprod</span> { <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> } ( <span class="id" title="var">P</span> : ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">UU</span> ) ( <span class="id" title="var">f</span> : ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span> )<br/>
&nbsp;&nbsp;( <span class="id" title="var">ww</span> : ∏ <span class="id" title="var">i</span> : ⟦<span class="id" title="var">n</span>⟧ , ( <span class="id" title="var">stn</span> ( <span class="id" title="var">f</span> <span class="id" title="var">i</span> ) ) ≃ ( <span class="id" title="var">P</span> <span class="id" title="var">i</span> ) ) :<br/>
&nbsp;&nbsp;( ∏ <span class="id" title="var">x</span> : ⟦<span class="id" title="var">n</span>⟧ , <span class="id" title="var">P</span> <span class="id" title="var">x</span>  ) ≃ <span class="id" title="var">stn</span> ( <span class="id" title="var">stnprod</span> <span class="id" title="var">f</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">P</span> <span class="id" title="var">f</span> <span class="id" title="var">ww</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [ | <span class="id" title="var">n</span> <span class="id" title="var">IHn</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> ( <span class="id" title="var">weqcontrcontr</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">iscontrsecoverempty2</span> <span class="id" title="var">_</span> ( <span class="id" title="var">negstn0</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">iscontrstn1</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">w1</span> := <span class="id" title="var">weqdnicoprod</span> <span class="id" title="var">n</span> <span class="id" title="var">lastelement</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">w2</span> := <span class="id" title="var">weqonsecbase</span> <span class="id" title="var">P</span> <span class="id" title="var">w1</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">w3</span> := <span class="id" title="var">weqsecovercoprodtoprod</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">_</span>, <span class="id" title="var">P</span> ( <span class="id" title="var">w1</span> <span class="id" title="var">x</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">w4</span> := <span class="id" title="var">weqcomp</span> <span class="id" title="var">w2</span> <span class="id" title="var">w3</span> ) ; <span class="id" title="tactic">clear</span> <span class="id" title="var">w2</span> <span class="id" title="var">w3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">w5</span> := <span class="id" title="var">IHn</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">x</span> : ⟦<span class="id" title="var">n</span>⟧, <span class="id" title="var">P</span> ( <span class="id" title="var">w1</span> ( <span class="id" title="var">ii1</span> <span class="id" title="var">x</span> ) ) ) ( <span class="id" title="var">λ</span> <span class="id" title="var">x</span> : ⟦<span class="id" title="var">n</span>⟧, <span class="id" title="var">f</span> ( <span class="id" title="var">w1</span> ( <span class="id" title="var">ii1</span> <span class="id" title="var">x</span> ) ) ) ( <span class="id" title="var">λ</span> <span class="id" title="var">i</span> : ⟦<span class="id" title="var">n</span>⟧, <span class="id" title="var">ww</span> ( <span class="id" title="var">w1</span> ( <span class="id" title="var">ii1</span> <span class="id" title="var">i</span> ) ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">w6</span> := <span class="id" title="var">weqcomp</span> <span class="id" title="var">w4</span> ( <span class="id" title="var">weqdirprodf</span> <span class="id" title="var">w5</span> ( <span class="id" title="var">weqsecoverunit</span> <span class="id" title="var">_</span> ) ) ) ; <span class="id" title="tactic">clear</span> <span class="id" title="var">w4</span> <span class="id" title="var">w5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">w6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">w7</span> := <span class="id" title="var">weqcomp</span> <span class="id" title="var">w6</span> ( <span class="id" title="var">weqdirprodf</span> ( <span class="id" title="var">idweq</span> <span class="id" title="var">_</span> ) ( <span class="id" title="var">invweq</span> ( <span class="id" title="var">ww</span> <span class="id" title="var">lastelement</span> ) ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> ( <span class="id" title="var">_</span> ∘ <span class="id" title="var">w7</span> )%<span class="id" title="var">weq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">w1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">weqfromprodofstn</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ).<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab345"></a><h3 class="section">Weak equivalence between <span class="inlinecode"></span> <span class="inlinecode">(</span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">)</span> <span class="inlinecode">≃</span> <span class="inlinecode">(</span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">)</span> <span class="inlinecode"></span> and <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode">(</span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.NaturalNumbers.html#factorial"><span class="id" title="definition">factorial</span></a></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">)</span> <span class="inlinecode"></span> ( uses functional extensionality )</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">weqweqstnsn</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) : (⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ ≃ ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧)  ≃  ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ × ( ⟦<span class="id" title="var">n</span>⟧ ≃ ⟦<span class="id" title="var">n</span>⟧ ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">l</span> := @<span class="id" title="var">lastelement</span> <span class="id" title="var">n</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="var">intermediate_weq</span> ( <span class="id" title="var">isolated</span> (⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧) × (<span class="id" title="var">compl</span> <span class="id" title="var">_</span> <span class="id" title="var">l</span> ≃ <span class="id" title="var">compl</span> <span class="id" title="var">_</span> <span class="id" title="var">l</span>) ).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">weqcutonweq</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">isdeceqstn</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">weqdirprodf</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">weqisolatedstntostn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">weqweq</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">invweq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">intermediate_weq</span> (<span class="id" title="var">compl_ne</span> (⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧) <span class="id" title="var">l</span> (<span class="id" title="var">stnneq</span> <span class="id" title="var">l</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">weqdnicompl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">compl_weq_compl_ne</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">weqfromweqstntostn</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) : ( (⟦<span class="id" title="var">n</span>⟧) ≃ (⟦<span class="id" title="var">n</span>⟧) ) ≃ ⟦<span class="id" title="var">factorial</span> <span class="id" title="var">n</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [ | <span class="id" title="var">n</span> <span class="id" title="var">IHn</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">weqcontrcontr</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">iscontraprop1</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> ( <span class="id" title="var">isapropweqtoempty2</span> <span class="id" title="var">_</span> ( <span class="id" title="var">negstn0</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">idweq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">iscontrstn1</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">change</span> ( <span class="id" title="var">factorial</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) <span class="id" title="keyword">with</span> ( ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) * ( <span class="id" title="var">factorial</span> <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">w1</span> := <span class="id" title="var">weqweqstnsn</span> <span class="id" title="var">n</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">weqcomp</span> <span class="id" title="var">w1</span> ( <span class="id" title="var">weqcomp</span> ( <span class="id" title="var">weqdirprodf</span> ( <span class="id" title="var">idweq</span> <span class="id" title="var">_</span> ) <span class="id" title="var">IHn</span> ) ( <span class="id" title="var">weqfromprodofstn</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ) ) ).<br/>
</div>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab346"></a><h2 class="section">Standard finite sets satisfy weak axiom of choice</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">ischoicebasestn</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) : <span class="id" title="var">ischoicebase</span> (⟦<span class="id" title="var">n</span>⟧).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [ | <span class="id" title="var">n</span> <span class="id" title="var">IHn</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">ischoicebaseempty2</span> <span class="id" title="var">negstn0</span> ).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">ischoicebaseweqf</span> ( <span class="id" title="var">weqdnicoprod</span> <span class="id" title="var">n</span> <span class="id" title="var">lastelement</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">ischoicebasecoprod</span> <span class="id" title="var">IHn</span> <span class="id" title="var">ischoicebaseunit</span> ) ).<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab347"></a><h2 class="section">Weak equivalence class of <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode"></span> determines <span class="inlinecode"></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode"></span>.</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">negweqstnsn0</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : ¬ (⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ ≃ <span class="id" title="var">stn</span> <span class="id" title="var">O</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">neg</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">lp</span>: ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧) <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">lastelement</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">weqstn0toempty</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">X</span> <span class="id" title="var">lp</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">negweqstn0sn</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : ¬ (<span class="id" title="var">stn</span> <span class="id" title="var">O</span> ≃ ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">neg</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">lp</span>: ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧) <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">lastelement</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">weqstn0toempty</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pr1</span> ( <span class="id" title="var">invweq</span> <span class="id" title="var">X</span> ) <span class="id" title="var">lp</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">weqcutforstn</span> ( <span class="id" title="var">n</span> <span class="id" title="var">n'</span> : <span class="id" title="var">nat</span> ) : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ ≃ ⟦<span class="id" title="var">S</span> <span class="id" title="var">n'</span>⟧ -&gt; ⟦<span class="id" title="var">n</span>⟧ ≃ ⟦<span class="id" title="var">n'</span>⟧.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">w</span>. <span class="id" title="tactic">assert</span> ( <span class="id" title="var">k</span> := @<span class="id" title="var">lastelement</span> <span class="id" title="var">n</span>  ).<br/>
&nbsp;&nbsp;<span class="id" title="var">intermediate_weq</span> (<span class="id" title="var">stn_compl</span> <span class="id" title="var">k</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">weqdnicompl</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">intermediate_weq</span> (<span class="id" title="var">stn_compl</span> (<span class="id" title="var">w</span> <span class="id" title="var">k</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">weqoncompl_ne</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">invweq</span>, <span class="id" title="var">weqdnicompl</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">weqtoeqstn</span> { <span class="id" title="var">n</span> <span class="id" title="var">n'</span> : <span class="id" title="var">nat</span> } : ⟦<span class="id" title="var">n</span>⟧ ≃ ⟦<span class="id" title="var">n'</span>⟧ -&gt; <span class="id" title="var">n</span> = <span class="id" title="var">n'</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="var">revert</span> <span class="id" title="var">n'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [ | <span class="id" title="var">n</span> <span class="id" title="var">IHn</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">n'</span> <span class="id" title="keyword">as</span> [ | <span class="id" title="var">n'</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intro</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">fromempty</span> (<span class="id" title="var">negweqstn0sn</span> <span class="id" title="var">_</span> <span class="id" title="var">X</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">n'</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">n'</span> <span class="id" title="keyword">as</span> [ | <span class="id" title="var">n'</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intro</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">fromempty</span> ( <span class="id" title="var">negweqstnsn0</span> <span class="id" title="var">n</span> <span class="id" title="var">X</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intro</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">weqcutforstn</span>. <span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Corollary</span> <span class="id" title="var">stnsdnegweqtoeq</span> ( <span class="id" title="var">n</span> <span class="id" title="var">n'</span> : <span class="id" title="var">nat</span> ) ( <span class="id" title="var">dw</span> : <span class="id" title="var">dneg</span> (⟦<span class="id" title="var">n</span>⟧ ≃ ⟦<span class="id" title="var">n'</span>⟧) ) : <span class="id" title="var">n</span> = <span class="id" title="var">n'</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">eqfromdnegeq</span> <span class="id" title="var">nat</span> <span class="id" title="var">isdeceqnat</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>  (<span class="id" title="var">dnegf</span> (@<span class="id" title="var">weqtoeqstn</span> <span class="id" title="var">n</span> <span class="id" title="var">n'</span>) <span class="id" title="var">dw</span>)).<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab348"></a><h2 class="section">Some results on bounded quantification</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">weqforallnatlehn0</span> ( <span class="id" title="var">F</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="var">hProp</span> ) :<br/>
&nbsp;&nbsp;( ∏ <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> , <span class="id" title="var">natleh</span> <span class="id" title="var">n</span> 0 -&gt; <span class="id" title="var">F</span> <span class="id" title="var">n</span> ) ≃ ( <span class="id" title="var">F</span> 0 ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">lg</span> : ( ∏ <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> , <span class="id" title="var">natleh</span> <span class="id" title="var">n</span> 0 -&gt; <span class="id" title="var">F</span> <span class="id" title="var">n</span> ) &lt;-&gt; ( <span class="id" title="var">F</span> 0 ) ).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">f</span> 0 ( <span class="id" title="var">isreflnatleh</span> 0 ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">f0</span> <span class="id" title="var">n</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">e</span> := <span class="id" title="var">natleh0tois0</span> <span class="id" title="var">l</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">f0</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">is1</span> : <span class="id" title="var">isaprop</span> ( ∏ <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> , <span class="id" title="var">natleh</span> <span class="id" title="var">n</span> 0 -&gt; <span class="id" title="var">F</span> <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">F</span> <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">weqimplimpl</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">lg</span> ) ( <span class="id" title="var">pr2</span> <span class="id" title="var">lg</span> ) <span class="id" title="var">is1</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">F</span> 0 ) ) ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">weqforallnatlehnsn'</span> ( <span class="id" title="var">n'</span> : <span class="id" title="var">nat</span> ) ( <span class="id" title="var">F</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="var">hProp</span> ) :<br/>
&nbsp;&nbsp;( ∏ <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> , <span class="id" title="var">natleh</span> <span class="id" title="var">n</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n'</span> ) -&gt; <span class="id" title="var">F</span> <span class="id" title="var">n</span> ) ≃<br/>
&nbsp;&nbsp;( ∏ <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> , <span class="id" title="var">natleh</span> <span class="id" title="var">n</span> <span class="id" title="var">n'</span> -&gt; <span class="id" title="var">F</span> <span class="id" title="var">n</span> ) × ( <span class="id" title="var">F</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n'</span> ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">lg</span> : ( ∏ <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> , <span class="id" title="var">natleh</span> <span class="id" title="var">n</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n'</span> ) -&gt; <span class="id" title="var">F</span> <span class="id" title="var">n</span> ) &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( ∏ <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> , <span class="id" title="var">natleh</span> <span class="id" title="var">n</span> <span class="id" title="var">n'</span> -&gt; <span class="id" title="var">F</span> <span class="id" title="var">n</span> ) × ( <span class="id" title="var">F</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n'</span> ) ) ).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">dirprodpair</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">n</span>, <span class="id" title="var">λ</span> <span class="id" title="var">l</span>, ( <span class="id" title="var">f</span> <span class="id" title="var">n</span> ( <span class="id" title="var">natlehtolehs</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">l</span> ) ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">f</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n'</span> ) ( <span class="id" title="var">isreflnatleh</span> <span class="id" title="var">_</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">d2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">natlehchoice2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">l</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">h</span> | <span class="id" title="var">e</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">d2</span> <span class="id" title="var">n</span> <span class="id" title="var">h</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">d2</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">f2</span> <span class="id" title="var">d2</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">d2</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">is1</span> : <span class="id" title="var">isaprop</span> ( ∏ <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> , <span class="id" title="var">natleh</span> <span class="id" title="var">n</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n'</span> ) -&gt; <span class="id" title="var">F</span> <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">F</span> <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">is2</span> : <span class="id" title="var">isaprop</span> ( ( ∏ <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> , <span class="id" title="var">natleh</span> <span class="id" title="var">n</span> <span class="id" title="var">n'</span> -&gt; <span class="id" title="var">F</span> <span class="id" title="var">n</span> ) × ( <span class="id" title="var">F</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n'</span> ) ) ) ).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">isapropdirprod</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">F</span> <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">F</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n'</span> ) ) ).<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">weqimplimpl</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">lg</span> ) ( <span class="id" title="var">pr2</span> <span class="id" title="var">lg</span> ) <span class="id" title="var">is1</span> <span class="id" title="var">is2</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">weqexistsnatlehn0</span> ( <span class="id" title="var">P</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="var">hProp</span>  ) :<br/>
&nbsp;&nbsp;( <span class="id" title="var">hexists</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, ( <span class="id" title="var">natleh</span> <span class="id" title="var">n</span> 0 ) × ( <span class="id" title="var">P</span> <span class="id" title="var">n</span> ) ) ) ≃ <span class="id" title="var">P</span> 0.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">lg</span> : <span class="id" title="var">hexists</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, ( <span class="id" title="var">natleh</span> <span class="id" title="var">n</span> 0 ) × ( <span class="id" title="var">P</span> <span class="id" title="var">n</span> ) ) &lt;-&gt; <span class="id" title="var">P</span> 0  ).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( @<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> ( <span class="id" title="var">P</span> 0 ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t2</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">n</span> <span class="id" title="var">d2</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">d2</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> <span class="id" title="var">p</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">e</span> := <span class="id" title="var">natleh0tois0</span> <span class="id" title="var">l</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">clearbody</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hinhpr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">isreflnatleh</span> 0 ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">weqimplimpl</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">lg</span> ) ( <span class="id" title="var">pr2</span> <span class="id" title="var">lg</span> ) ( <span class="id" title="var">pr2</span> <span class="id" title="var">_</span> ) ( <span class="id" title="var">pr2</span> <span class="id" title="var">_</span> ) ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">weqexistsnatlehnsn'</span> ( <span class="id" title="var">n'</span> : <span class="id" title="var">nat</span> ) ( <span class="id" title="var">P</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="var">hProp</span>  ) :<br/>
&nbsp;&nbsp;( <span class="id" title="var">hexists</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, ( <span class="id" title="var">natleh</span> <span class="id" title="var">n</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n'</span> ) ) × ( <span class="id" title="var">P</span> <span class="id" title="var">n</span> ) ) ) ≃<br/>
&nbsp;&nbsp;<span class="id" title="var">hdisj</span> ( <span class="id" title="var">hexists</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, ( <span class="id" title="var">natleh</span> <span class="id" title="var">n</span> <span class="id" title="var">n'</span> ) × ( <span class="id" title="var">P</span> <span class="id" title="var">n</span> ) ) )  ( <span class="id" title="var">P</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n'</span> ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">lg</span> : <span class="id" title="var">hexists</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, ( <span class="id" title="var">natleh</span> <span class="id" title="var">n</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n'</span> ) ) × ( <span class="id" title="var">P</span> <span class="id" title="var">n</span> ) ) &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hdisj</span> ( <span class="id" title="var">hexists</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, ( <span class="id" title="var">natleh</span> <span class="id" title="var">n</span> <span class="id" title="var">n'</span> ) × ( <span class="id" title="var">P</span> <span class="id" title="var">n</span> ) ) )  ( <span class="id" title="var">P</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n'</span> ) ) ).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhfun</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t2</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">n</span> <span class="id" title="var">d2</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">d2</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> <span class="id" title="var">p</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">natlehchoice2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">l</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">h</span> | <span class="id" title="var">nh</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ii1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hinhpr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">dirprodpair</span> <span class="id" title="var">h</span> <span class="id" title="var">p</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">nh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">ii2</span> <span class="id" title="var">p</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( @<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> ( <span class="id" title="var">ishinh</span> <span class="id" title="var">_</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">t</span> | <span class="id" title="var">p</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">generalize</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hinhfun</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">n</span> <span class="id" title="var">d2</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">d2</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> <span class="id" title="var">p</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">natlehtolehs</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">l</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhpr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">isreflnatleh</span> <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">weqimplimpl</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">lg</span> ) ( <span class="id" title="var">pr2</span> <span class="id" title="var">lg</span> ) ( <span class="id" title="var">pr2</span> <span class="id" title="var">_</span> ) ( <span class="id" title="var">pr2</span> <span class="id" title="var">_</span> ) ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isdecbexists</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) ( <span class="id" title="var">P</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="var">UU</span> ) ( <span class="id" title="keyword">is</span> : ∏ <span class="id" title="var">n'</span> , <span class="id" title="var">isdecprop</span> ( <span class="id" title="var">P</span> <span class="id" title="var">n'</span> ) ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isdecprop</span> ( <span class="id" title="var">hexists</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">n'</span>, ( <span class="id" title="var">natleh</span> <span class="id" title="var">n'</span> <span class="id" title="var">n</span> ) × ( <span class="id" title="var">P</span> <span class="id" title="var">n'</span> ) ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">P'</span> := <span class="id" title="var">λ</span> <span class="id" title="var">n'</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> ( <span class="id" title="keyword">is</span> <span class="id" title="var">n'</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [ | <span class="id" title="var">n</span> <span class="id" title="var">IHn</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">isdecpropweqb</span> ( <span class="id" title="var">weqexistsnatlehn0</span> <span class="id" title="var">P'</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="keyword">is</span> 0 ).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">isdecpropweqb</span> ( <span class="id" title="var">weqexistsnatlehnsn'</span> <span class="id" title="var">_</span> <span class="id" title="var">P'</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isdecprophdisj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> ( <span class="id" title="keyword">is</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isdecbforall</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) ( <span class="id" title="var">P</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="var">UU</span> ) ( <span class="id" title="keyword">is</span> : ∏ <span class="id" title="var">n'</span> , <span class="id" title="var">isdecprop</span> ( <span class="id" title="var">P</span> <span class="id" title="var">n'</span> ) ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isdecprop</span> ( ∏ <span class="id" title="var">n'</span> , <span class="id" title="var">natleh</span> <span class="id" title="var">n'</span> <span class="id" title="var">n</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">n'</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">P'</span> := <span class="id" title="var">λ</span> <span class="id" title="var">n'</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> ( <span class="id" title="keyword">is</span> <span class="id" title="var">n'</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [ | <span class="id" title="var">n</span> <span class="id" title="var">IHn</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">isdecpropweqb</span> ( <span class="id" title="var">weqforallnatlehn0</span> <span class="id" title="var">P'</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="keyword">is</span> 0 ).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">isdecpropweqb</span> ( <span class="id" title="var">weqforallnatlehnsn'</span> <span class="id" title="var">_</span> <span class="id" title="var">P'</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isdecpropdirprod</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> ( <span class="id" title="keyword">is</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ).<br/>
</div>

<br/>
</div>

<div class="doc">
The following lemma finds the largest <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">n'</span></span> <span class="inlinecode"></span> such that <span class="inlinecode"></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#neg"><span class="id" title="definition">neg</span></a></span> <span class="inlinecode">(</span> <span class="inlinecode"><a class="idref" href="UniMath.Partiality.PCF.html#P"><span class="id" title="definition">P</span></a></span> <span class="inlinecode"><span class="id" title="var">n'</span></span> <span class="inlinecode">)</span> <span class="inlinecode"></span>. It is a stronger form of ( neg ∏ ) -&gt; ( exists neg ) in the case of bounded quantification of decidable propositions. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">negbforalldectototal2neg</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) ( <span class="id" title="var">P</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="var">UU</span> )<br/>
&nbsp;&nbsp;( <span class="id" title="keyword">is</span> : ∏ <span class="id" title="var">n'</span> : <span class="id" title="var">nat</span> , <span class="id" title="var">isdecprop</span> ( <span class="id" title="var">P</span> <span class="id" title="var">n'</span> ) ) :<br/>
&nbsp;&nbsp;¬ ( ∏ <span class="id" title="var">n'</span> : <span class="id" title="var">nat</span> , <span class="id" title="var">natleh</span> <span class="id" title="var">n'</span> <span class="id" title="var">n</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">n'</span> ) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">total2</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">n'</span>, ( <span class="id" title="var">natleh</span> <span class="id" title="var">n'</span> <span class="id" title="var">n</span> ) × ¬ ( <span class="id" title="var">P</span> <span class="id" title="var">n'</span> ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">P'</span> := <span class="id" title="var">λ</span> <span class="id" title="var">n'</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> ( <span class="id" title="keyword">is</span> <span class="id" title="var">n'</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [ | <span class="id" title="var">n</span> <span class="id" title="var">IHn</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">nf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">nf0</span> := <span class="id" title="var">negf</span> ( <span class="id" title="var">invweq</span> ( <span class="id" title="var">weqforallnatlehn0</span> <span class="id" title="var">P'</span> ) ) <span class="id" title="var">nf</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">dirprodpair</span> ( <span class="id" title="var">isreflnatleh</span> 0 ) <span class="id" title="var">nf0</span> ).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">nf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">nf2</span> := <span class="id" title="var">negf</span> ( <span class="id" title="var">invweq</span> ( <span class="id" title="var">weqforallnatlehnsn'</span> <span class="id" title="var">n</span> <span class="id" title="var">P'</span> ) ) <span class="id" title="var">nf</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">nf3</span> := <span class="id" title="var">fromneganddecy</span> ( <span class="id" title="keyword">is</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) <span class="id" title="var">nf2</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">nf3</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">f1</span> | <span class="id" title="var">f2</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">set</span> ( <span class="id" title="var">int</span> := <span class="id" title="var">IHn</span> <span class="id" title="var">f1</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">int</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">n'</span> <span class="id" title="var">d2</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">d2</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> <span class="id" title="var">np</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">n'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">natlehtolehs</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">l</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">np</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">isreflnatleh</span> <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">f2</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab349"></a><h2 class="section">Accessibility - the least element of an inhabited decidable subset of <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#nat"><span class="id" title="inductive">nat</span></a></span></h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">natdecleast</span> ( <span class="id" title="var">F</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="var">UU</span> ) ( <span class="id" title="keyword">is</span> : ∏ <span class="id" title="var">n</span> , <span class="id" title="var">isdecprop</span> ( <span class="id" title="var">F</span> <span class="id" title="var">n</span> ) ) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">total2</span> ( <span class="id" title="var">λ</span>  <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, ( <span class="id" title="var">F</span> <span class="id" title="var">n</span> ) × ( ∏ <span class="id" title="var">n'</span> : <span class="id" title="var">nat</span> , <span class="id" title="var">F</span> <span class="id" title="var">n'</span> -&gt; <span class="id" title="var">natleh</span> <span class="id" title="var">n</span> <span class="id" title="var">n'</span> ) ).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isapropnatdecleast</span> ( <span class="id" title="var">F</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="var">UU</span> ) ( <span class="id" title="keyword">is</span> : ∏ <span class="id" title="var">n</span> , <span class="id" title="var">isdecprop</span> ( <span class="id" title="var">F</span> <span class="id" title="var">n</span> ) ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isaprop</span> ( <span class="id" title="var">natdecleast</span> <span class="id" title="var">F</span> <span class="id" title="keyword">is</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">P</span> := <span class="id" title="var">λ</span> <span class="id" title="var">n'</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> ( <span class="id" title="keyword">is</span> <span class="id" title="var">n'</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">int1</span> : ∏ <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">isaprop</span> ( ( <span class="id" title="var">F</span> <span class="id" title="var">n</span> ) × ( ∏ <span class="id" title="var">n'</span> : <span class="id" title="var">nat</span> , <span class="id" title="var">F</span> <span class="id" title="var">n'</span> -&gt; <span class="id" title="var">natleh</span> <span class="id" title="var">n</span> <span class="id" title="var">n'</span> ) ) ).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isapropdirprod</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">P</span> <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">natleh</span> <span class="id" title="var">n</span> <span class="id" title="var">t</span> ) ).<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">int2</span> := ( <span class="id" title="var">λ</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> ( <span class="id" title="var">int1</span> <span class="id" title="var">n</span> ) ) : <span class="id" title="var">nat</span> -&gt; <span class="id" title="var">hProp</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">isaprop</span> ( <span class="id" title="var">total2</span> <span class="id" title="var">int2</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isapropsubtype</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">c1</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">e1</span> <span class="id" title="var">c1</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">c2</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">e2</span> <span class="id" title="var">c2</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">l1</span> := <span class="id" title="var">c1</span> <span class="id" title="var">x2</span> <span class="id" title="var">e2</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">l2</span> := <span class="id" title="var">c2</span> <span class="id" title="var">x1</span> <span class="id" title="var">e1</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">isantisymmnatleh</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">accth</span> ( <span class="id" title="var">F</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="var">UU</span> ) ( <span class="id" title="keyword">is</span> : ∏ <span class="id" title="var">n</span> , <span class="id" title="var">isdecprop</span> ( <span class="id" title="var">F</span> <span class="id" title="var">n</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">is'</span> : <span class="id" title="var">hexists</span> <span class="id" title="var">F</span> ) : <span class="id" title="var">natdecleast</span> <span class="id" title="var">F</span> <span class="id" title="keyword">is</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">is'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (@<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> ( <span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> ( <span class="id" title="var">isapropnatdecleast</span> <span class="id" title="var">F</span> <span class="id" title="keyword">is</span> ) ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t2</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">n</span> <span class="id" title="var">l</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">F'</span> := <span class="id" title="var">λ</span> <span class="id" title="var">n'</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">hexists</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">n''</span>, ( <span class="id" title="var">natleh</span> <span class="id" title="var">n''</span> <span class="id" title="var">n'</span> ) × ( <span class="id" title="var">F</span> <span class="id" title="var">n''</span> ) ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">X</span> : ∏ <span class="id" title="var">n'</span> , <span class="id" title="var">F'</span> <span class="id" title="var">n'</span> -&gt; <span class="id" title="var">natdecleast</span> <span class="id" title="var">F</span> <span class="id" title="keyword">is</span> ).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">n'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n'</span> <span class="id" title="keyword">as</span> [ | <span class="id" title="var">n'</span> <span class="id" title="var">IHn'</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( @<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span>  ( <span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> ( <span class="id" title="var">isapropnatdecleast</span> <span class="id" title="var">F</span> <span class="id" title="keyword">is</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t2</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">n''</span> <span class="id" title="var">is''</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">is''</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">l''</span> <span class="id" title="var">d''</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">set</span> ( <span class="id" title="var">e</span> := <span class="id" title="var">natleh0tois0</span> <span class="id" title="var">l''</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">clearbody</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">d''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">n'</span>, <span class="id" title="var">λ</span> <span class="id" title="var">f</span> : <span class="id" title="var">_</span>, <span class="id" title="var">natleh0n</span> <span class="id" title="var">n'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( @<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span>  ( <span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> ( <span class="id" title="var">isapropnatdecleast</span> <span class="id" title="var">F</span> <span class="id" title="keyword">is</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t2</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">n''</span> <span class="id" title="var">is''</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">j</span> := <span class="id" title="var">natlehchoice2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">is''</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">j</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">jl</span> | <span class="id" title="var">je</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">IHn'</span> ( <span class="id" title="var">hinhpr</span> ( <span class="id" title="var">tpair</span> <span class="id" title="var">_</span> <span class="id" title="var">n''</span> ( <span class="id" title="var">dirprodpair</span> <span class="id" title="var">jl</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">is''</span> ) ) ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">je</span> <span class="id" title="tactic">in</span> <span class="id" title="var">is''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">is''</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">nn</span> <span class="id" title="var">is''</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">nn</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">je</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">n''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">is'</span> : <span class="id" title="var">isdecprop</span> ( <span class="id" title="var">F'</span> <span class="id" title="var">n'</span> ) ) <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> ( <span class="id" title="var">isdecbexists</span> <span class="id" title="var">n'</span> <span class="id" title="var">F</span> <span class="id" title="keyword">is</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">is'</span> ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">f</span> | <span class="id" title="var">nf</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> ( <span class="id" title="var">IHn'</span>  <span class="id" title="var">f</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">is''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n0</span> <span class="id" title="var">fn0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">natlthorgeh</span> <span class="id" title="var">n0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n'</span> ) )  <span class="id" title="keyword">as</span> [ <span class="id" title="var">l'</span> | <span class="id" title="var">g'</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">set</span> ( <span class="id" title="var">i'</span> := <span class="id" title="var">natlthtolehsn</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">l'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">nf</span> ( <span class="id" title="var">hinhpr</span> ( <span class="id" title="var">tpair</span> <span class="id" title="var">_</span> <span class="id" title="var">n0</span> ( <span class="id" title="var">dirprodpair</span> <span class="id" title="var">i'</span> <span class="id" title="var">fn0</span> ) ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> <span class="id" title="var">g'</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">X</span> <span class="id" title="var">n</span> ( <span class="id" title="var">hinhpr</span> ( <span class="id" title="var">tpair</span> <span class="id" title="var">_</span> <span class="id" title="var">n</span> ( <span class="id" title="var">dirprodpair</span> ( <span class="id" title="var">isreflnatleh</span> <span class="id" title="var">n</span> ) <span class="id" title="var">l</span> ) ) ) ).<br/>
</div>

<br/>
<span class="id" title="keyword">Corollary</span> <span class="id" title="var">dni_lastelement_is_inj</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} {<span class="id" title="var">i</span> <span class="id" title="var">j</span> : ⟦<span class="id" title="var">n</span>⟧ }<br/>
&nbsp;&nbsp;(<span class="id" title="var">e</span> : <span class="id" title="var">dni_lastelement</span> <span class="id" title="var">i</span> = <span class="id" title="var">dni_lastelement</span> <span class="id" title="var">j</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">i</span> = <span class="id" title="var">j</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isinjstntonat</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">dni_lastelement</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">maponpaths</span> <span class="id" title="var">pr1</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">e</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Corollary</span> <span class="id" title="var">dni_lastelement_eq</span> : ∏ (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">i</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ ) (<span class="id" title="var">ie</span> : <span class="id" title="var">pr1</span> <span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">i</span> = <span class="id" title="var">dni_lastelement</span> (<span class="id" title="var">stnpair</span> <span class="id" title="var">n</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">i</span>) <span class="id" title="var">ie</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span> <span class="id" title="var">ie</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isinjstntonat</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Corollary</span> <span class="id" title="var">lastelement_eq</span> : ∏ (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">i</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">n</span>⟧ ) (<span class="id" title="var">e</span> : <span class="id" title="var">pr1</span> <span class="id" title="var">i</span> = <span class="id" title="var">n</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">i</span> = <span class="id" title="var">lastelement</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">lastelement</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isinjstntonat</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">e</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">inductive_reflexivity</span> <span class="id" title="var">i</span> <span class="id" title="var">b</span> :=<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">i</span>];<br/>
&nbsp;&nbsp;[ <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">isinjstntonat</span> ; <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span> |<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contradicts</span> (<span class="id" title="var">negnatlthn0</span> <span class="id" title="var">i</span>) <span class="id" title="var">b</span> || <span class="id" title="var">inductive_reflexivity</span> <span class="id" title="var">i</span> <span class="id" title="var">b</span> ].<br/>

<br/>
</div>

<div class="doc">
concatenation and flattening of functions 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">concatenate'</span> {<span class="id" title="var">X</span>:<span class="id" title="var">UU</span>} {<span class="id" title="var">m</span> <span class="id" title="var">n</span>:<span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> : ⟦<span class="id" title="var">m</span>⟧ -&gt; <span class="id" title="var">X</span>) (<span class="id" title="var">g</span> : ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">X</span>) : ⟦<span class="id" title="var">m</span>+<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">X</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">weqfromcoprodofstn_invmap</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">i</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">j</span> | <span class="id" title="var">k</span>].<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">f</span> <span class="id" title="var">j</span>).<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">g</span> <span class="id" title="var">k</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">concatenate'_r0</span> {<span class="id" title="var">X</span>:<span class="id" title="var">UU</span>} {<span class="id" title="var">m</span>:<span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> : ⟦<span class="id" title="var">m</span>⟧ -&gt; <span class="id" title="var">X</span>) (<span class="id" title="var">g</span> : ⟦0⟧ -&gt; <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">concatenate'</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> = <span class="id" title="var">transportb</span> (<span class="id" title="var">λ</span> <span class="id" title="var">n</span>, ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">X</span>) (<span class="id" title="var">natplusr0</span> <span class="id" title="var">m</span>) <span class="id" title="var">f</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">funextfun</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">concatenate'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">weqfromcoprodofstn_invmap_r0</span>; <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">transportb_fun'</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">concatenate'_r0'</span> {<span class="id" title="var">X</span>:<span class="id" title="var">UU</span>} {<span class="id" title="var">m</span>:<span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> : ⟦<span class="id" title="var">m</span>⟧ -&gt; <span class="id" title="var">X</span>) (<span class="id" title="var">g</span> : ⟦0⟧ -&gt; <span class="id" title="var">X</span>) (<span class="id" title="var">i</span> : ⟦<span class="id" title="var">m</span>+0⟧ ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">concatenate'</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">i</span> = <span class="id" title="var">f</span> (<span class="id" title="var">transportf</span> <span class="id" title="var">stn</span> (<span class="id" title="var">natplusr0</span> <span class="id" title="var">m</span>) <span class="id" title="var">i</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">concatenate'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">weqfromcoprodofstn_invmap_r0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">flatten'</span> {<span class="id" title="var">X</span>:<span class="id" title="var">UU</span>} {<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>} {<span class="id" title="var">m</span>: ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">nat</span>} :<br/>
&nbsp;&nbsp;(∏ (<span class="id" title="var">i</span>: ⟦<span class="id" title="var">n</span>⟧ ), ⟦<span class="id" title="var">m</span> <span class="id" title="var">i</span>⟧ -&gt; <span class="id" title="var">X</span>) -&gt; ( ⟦<span class="id" title="var">stnsum</span> <span class="id" title="var">m</span>⟧ -&gt; <span class="id" title="var">X</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">uncurry</span> <span class="id" title="var">g</span> ∘ <span class="id" title="var">invmap</span> (<span class="id" title="var">weqstnsum1</span> <span class="id" title="var">m</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stn_predicate</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">P</span> : ⟦<span class="id" title="var">n</span>⟧ -&gt; <span class="id" title="var">UU</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">h</span> <span class="id" title="var">h'</span> : <span class="id" title="var">k</span> &lt; <span class="id" title="var">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> (<span class="id" title="var">k</span>,,<span class="id" title="var">h</span>) -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">k</span>,,<span class="id" title="var">h'</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">transparent</span> <span class="id" title="tactic">assert</span> (<span class="id" title="var">X</span> : (<span class="id" title="var">h</span> = <span class="id" title="var">h'</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">propproperty</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">transportf</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">P</span> (<span class="id" title="var">k</span>,,<span class="id" title="var">x</span>)) <span class="id" title="var">X</span> <span class="id" title="var">H</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">two</span> := ⟦2⟧.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">two_rec</span> {<span class="id" title="var">A</span> : <span class="id" title="var">UU</span>} (<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">A</span>) : ⟦2⟧ -&gt; <span class="id" title="var">A</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> 1 <span class="id" title="keyword">as</span> [<span class="id" title="var">n</span> <span class="id" title="var">p</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">_</span>]; [<span class="id" title="tactic">apply</span> <span class="id" title="var">a</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">_</span>]; [<span class="id" title="tactic">apply</span> <span class="id" title="var">b</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">nopathsfalsetotrue</span> <span class="id" title="var">p</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">two_rec_dep</span> (<span class="id" title="var">P</span> : <span class="id" title="var">two</span> -&gt; <span class="id" title="var">UU</span>):<br/>
&nbsp;&nbsp;<span class="id" title="var">P</span> (● 0) -&gt; <span class="id" title="var">P</span> (● 1) -&gt; ∏ <span class="id" title="var">n</span>, <span class="id" title="var">P</span> <span class="id" title="var">n</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">n</span> <span class="id" title="var">p</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">_</span>]. <span class="id" title="tactic">eapply</span> <span class="id" title="var">stn_predicate</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">_</span>]. <span class="id" title="tactic">eapply</span> <span class="id" title="var">stn_predicate</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">nopathsfalsetotrue</span> <span class="id" title="var">p</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">three</span> := <span class="id" title="var">stn</span> 3.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">three_rec</span> {<span class="id" title="var">A</span> : <span class="id" title="var">UU</span>} (<span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> : <span class="id" title="var">A</span>) : <span class="id" title="var">stn</span> 3 -&gt; <span class="id" title="var">A</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> 1 <span class="id" title="keyword">as</span> [<span class="id" title="var">n</span> <span class="id" title="var">p</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">_</span>]; [<span class="id" title="tactic">apply</span> <span class="id" title="var">a</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">_</span>]; [<span class="id" title="tactic">apply</span> <span class="id" title="var">b</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">_</span>]; [<span class="id" title="tactic">apply</span> <span class="id" title="var">c</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">nopathsfalsetotrue</span> <span class="id" title="var">p</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">three_rec_dep</span> (<span class="id" title="var">P</span> : <span class="id" title="var">three</span> -&gt; <span class="id" title="var">UU</span>):<br/>
&nbsp;&nbsp;<span class="id" title="var">P</span> (● 0) -&gt; <span class="id" title="var">P</span> (● 1) -&gt; <span class="id" title="var">P</span> (● 2) -&gt; ∏ <span class="id" title="var">n</span>, <span class="id" title="var">P</span> <span class="id" title="var">n</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">n</span> <span class="id" title="var">p</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">_</span>]. <span class="id" title="tactic">eapply</span> <span class="id" title="var">stn_predicate</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">_</span>]. <span class="id" title="tactic">eapply</span> <span class="id" title="var">stn_predicate</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">_</span>]. <span class="id" title="tactic">eapply</span> <span class="id" title="var">stn_predicate</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">nopathsfalsetotrue</span> <span class="id" title="var">p</span>).<br/>
</div>

<br/>
</div>

<div class="doc">
ordered bijections are unique 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">is_stn_increasing</span> {<span class="id" title="var">m</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> : ⟦<span class="id" title="var">m</span>⟧ → <span class="id" title="var">nat</span>) :=<br/>
&nbsp;&nbsp;∏ (<span class="id" title="var">i</span> <span class="id" title="var">j</span>: ⟦<span class="id" title="var">m</span>⟧ ), <span class="id" title="var">i</span> ≤ <span class="id" title="var">j</span> → <span class="id" title="var">f</span> <span class="id" title="var">i</span> ≤ <span class="id" title="var">f</span> <span class="id" title="var">j</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">is_stn_strictly_increasing</span> {<span class="id" title="var">m</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> : ⟦<span class="id" title="var">m</span>⟧ → <span class="id" title="var">nat</span>) :=<br/>
&nbsp;&nbsp;∏ (<span class="id" title="var">i</span> <span class="id" title="var">j</span>: ⟦<span class="id" title="var">m</span>⟧ ), <span class="id" title="var">i</span> &lt; <span class="id" title="var">j</span> → <span class="id" title="var">f</span> <span class="id" title="var">i</span> &lt; <span class="id" title="var">f</span> <span class="id" title="var">j</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">is_strincr_impl_incr</span> {<span class="id" title="var">m</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> : ⟦<span class="id" title="var">m</span>⟧ → <span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">is_stn_strictly_increasing</span> <span class="id" title="var">f</span> -&gt; <span class="id" title="var">is_stn_increasing</span> <span class="id" title="var">f</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">inc</span> ? ? <span class="id" title="var">e</span>. <span class="id" title="tactic">induction</span> (<span class="id" title="var">natlehchoice</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">e</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">I</span>|<span class="id" title="var">J</span>]; <span class="id" title="tactic">clear</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">natlthtoleh</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">inc</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">assert</span> (<span class="id" title="var">J'</span> : <span class="id" title="var">i</span> = <span class="id" title="var">j</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">J</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">J</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">J'</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">isreflnatleh</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">is_incr_impl_strincr</span> {<span class="id" title="var">m</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> : ⟦<span class="id" title="var">m</span>⟧ → <span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isincl</span> <span class="id" title="var">f</span> -&gt; <span class="id" title="var">is_stn_increasing</span> <span class="id" title="var">f</span> -&gt; <span class="id" title="var">is_stn_strictly_increasing</span> <span class="id" title="var">f</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">incl</span> <span class="id" title="var">incr</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">d</span> : <span class="id" title="var">i</span> ≤ <span class="id" title="var">j</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">natlthtoleh</span>. <span class="id" title="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">c</span> := <span class="id" title="var">incr</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">d</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">d</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">b</span> : <span class="id" title="var">i</span> != <span class="id" title="var">j</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">isirreflnatlth</span> <span class="id" title="var">_</span> <span class="id" title="var">e</span>). }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">natlehchoice</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">c</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">T</span>|<span class="id" title="var">U</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">T</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">isincl</span>,<span class="id" title="var">isofhlevel</span>,<span class="id" title="var">isofhlevelf</span> <span class="id" title="tactic">in</span> <span class="id" title="var">incl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">V</span> := <span class="id" title="var">invmaponpathsincl</span> <span class="id" title="var">f</span> <span class="id" title="var">incl</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">U</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">V</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">isirreflnatlth</span> <span class="id" title="var">_</span> <span class="id" title="var">e</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stnsum_ge1</span> {<span class="id" title="var">m</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> : ⟦<span class="id" title="var">m</span>⟧ → <span class="id" title="var">nat</span>) : ( ∏ <span class="id" title="var">i</span>, <span class="id" title="var">f</span> <span class="id" title="var">i</span> ≥ 1 ) → <span class="id" title="var">stnsum</span> <span class="id" title="var">f</span> ≥ <span class="id" title="var">m</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">G</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">g</span> := <span class="id" title="var">λ</span> <span class="id" title="var">i</span>:⟦<span class="id" title="var">m</span>⟧, 1).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">E</span> : <span class="id" title="var">stnsum</span> <span class="id" title="var">g</span> = <span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">stnsum_1</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">F</span> : <span class="id" title="var">stnsum</span> <span class="id" title="var">g</span> ≤ <span class="id" title="var">stnsum</span> <span class="id" title="var">f</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">stnsum_le</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">G</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="var">E</span> <span class="id" title="var">F</span>; <span class="id" title="tactic">generalize</span> (<span class="id" title="var">stnsum</span> <span class="id" title="var">g</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">E</span> <span class="id" title="var">F</span> <span class="id" title="var">g</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">s</span> <span class="id" title="var">e</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">i</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stnsum_add</span> {<span class="id" title="var">m</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : ⟦<span class="id" title="var">m</span>⟧ → <span class="id" title="var">nat</span>) : <span class="id" title="var">stnsum</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, <span class="id" title="var">f</span> <span class="id" title="var">i</span> + <span class="id" title="var">g</span> <span class="id" title="var">i</span>) = <span class="id" title="var">stnsum</span> <span class="id" title="var">f</span> + <span class="id" title="var">stnsum</span> <span class="id" title="var">g</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">m</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">m</span> <span class="id" title="var">I</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> 3 <span class="id" title="var">stnsum_step</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ((<span class="id" title="var">λ</span> <span class="id" title="var">i</span> : ⟦ <span class="id" title="var">S</span> <span class="id" title="var">m</span> ⟧, <span class="id" title="var">f</span> <span class="id" title="var">i</span> + <span class="id" title="var">g</span> <span class="id" title="var">i</span>) ∘ <span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<span class="id" title="var">λ</span> <span class="id" title="var">y</span> : ⟦ <span class="id" title="var">m</span> ⟧, <span class="id" title="var">f</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">y</span>) + <span class="id" title="var">g</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">I</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">natplusassoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">natplusassoc</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">funcomp</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">natpluscomm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">natplusassoc</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">natpluscomm</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stnsum_lt</span> {<span class="id" title="var">m</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : ⟦<span class="id" title="var">m</span>⟧ → <span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;( ∏ <span class="id" title="var">i</span>, <span class="id" title="var">f</span> <span class="id" title="var">i</span> &lt; <span class="id" title="var">g</span> <span class="id" title="var">i</span> ) → <span class="id" title="var">stnsum</span> <span class="id" title="var">g</span> ≥ <span class="id" title="var">stnsum</span> <span class="id" title="var">f</span> + <span class="id" title="var">m</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">set</span> (<span class="id" title="var">h</span> := <span class="id" title="var">λ</span> <span class="id" title="var">i</span>, <span class="id" title="var">f</span> <span class="id" title="var">i</span> + 1).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">E</span> : <span class="id" title="var">stnsum</span> <span class="id" title="var">h</span> = <span class="id" title="var">stnsum</span> <span class="id" title="var">f</span> + <span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">unfold</span> <span class="id" title="var">h</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">h</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">stnsum_add</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">stnsum_1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">E</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">stnsum_le</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">h</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">natlthtolehp1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="var">Arguments</span> <span class="id" title="var">dni</span> {<span class="id" title="var">_</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stnsum_diffs</span> {<span class="id" title="var">m</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">m</span>⟧ → <span class="id" title="var">nat</span>) : <span class="id" title="var">is_stn_increasing</span> <span class="id" title="var">f</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">stnsum</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, <span class="id" title="var">f</span> (<span class="id" title="var">dni_firstelement</span> <span class="id" title="var">i</span>) - <span class="id" title="var">f</span> (<span class="id" title="var">dni_lastelement</span> <span class="id" title="var">i</span>)) =<br/>
&nbsp;&nbsp;<span class="id" title="var">f</span> <span class="id" title="var">lastelement</span> - <span class="id" title="var">f</span> <span class="id" title="var">firstelement</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">m</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">m</span> <span class="id" title="var">I</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">change</span> (0 = <span class="id" title="var">f</span> <span class="id" title="var">firstelement</span> - <span class="id" title="var">f</span> <span class="id" title="var">firstelement</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">minuseq0'</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">stnsum_step</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">f</span> (<span class="id" title="var">dni_firstelement</span> <span class="id" title="var">lastelement</span>)) <span class="id" title="keyword">with</span> (<span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">natpluscomm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">_</span> @ ! @<span class="id" title="var">natdiffplusdiff</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> (<span class="id" title="var">dni_lastelement</span> <span class="id" title="var">lastelement</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> <span class="id" title="var">firstelement</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">_</span> @ <span class="id" title="var">I</span> (<span class="id" title="var">f</span> ∘ <span class="id" title="var">dni_lastelement</span>) <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">unfold</span> <span class="id" title="var">funcomp</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">stnsum_eq</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">replace_dni_last</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">s</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">funcomp</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">lastelement_ge</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">firstelement_le</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stn_ord_incl</span> {<span class="id" title="var">m</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> : ⟦<span class="id" title="var">S</span> <span class="id" title="var">m</span>⟧ → <span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">is_stn_strictly_increasing</span> <span class="id" title="var">f</span>  →  <span class="id" title="var">f</span> <span class="id" title="var">lastelement</span> ≥ <span class="id" title="var">f</span> <span class="id" title="var">firstelement</span> + <span class="id" title="var">m</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">strinc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">inc</span> := <span class="id" title="var">is_strincr_impl_incr</span> <span class="id" title="var">_</span> <span class="id" title="var">strinc</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">d</span> := <span class="id" title="var">λ</span> <span class="id" title="var">i</span> : ⟦ <span class="id" title="var">m</span> ⟧, <span class="id" title="var">f</span> (<span class="id" title="var">dni_firstelement</span> <span class="id" title="var">i</span>) - <span class="id" title="var">f</span> (<span class="id" title="var">dni_lastelement</span> <span class="id" title="var">i</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">E</span> := <span class="id" title="var">stnsum_diffs</span> <span class="id" title="var">f</span> <span class="id" title="var">inc</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">stnsum</span> <span class="id" title="var">d</span> = <span class="id" title="var">f</span> <span class="id" title="var">lastelement</span> - <span class="id" title="var">f</span> <span class="id" title="var">firstelement</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">F</span> : ∏ <span class="id" title="var">i</span>, <span class="id" title="var">f</span> (<span class="id" title="var">dni_firstelement</span> <span class="id" title="var">i</span>) &gt; <span class="id" title="var">f</span> (<span class="id" title="var">dni_lastelement</span> <span class="id" title="var">i</span>)).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">strinc</span>. <span class="id" title="tactic">change</span> (<span class="id" title="var">stntonat</span> <span class="id" title="var">_</span> <span class="id" title="var">i</span> &lt; <span class="id" title="var">S</span>(<span class="id" title="var">stntonat</span> <span class="id" title="var">_</span> <span class="id" title="var">i</span>)). <span class="id" title="tactic">apply</span> <span class="id" title="var">natlthnsn</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">G</span> : ∏ <span class="id" title="var">i</span>, <span class="id" title="var">d</span> <span class="id" title="var">i</span> ≥ 1).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">natgthtogehsn</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">minusgth0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">F</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">F</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H</span> := <span class="id" title="var">stnsum_ge1</span> <span class="id" title="var">_</span> <span class="id" title="var">G</span>). <span class="id" title="tactic">clear</span> <span class="id" title="var">G</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">E</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">E</span> <span class="id" title="var">d</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">I</span> : <span class="id" title="var">f</span> <span class="id" title="var">lastelement</span> ≥ <span class="id" title="var">f</span> <span class="id" title="var">firstelement</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">inc</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">J</span> := <span class="id" title="var">minusplusnmm</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">I</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">J</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">J</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">natpluscomm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natgehandplusl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">H</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stn_ord_inj</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">incl</span> (⟦<span class="id" title="var">n</span>⟧) (⟦<span class="id" title="var">n</span>⟧)) :<br/>
&nbsp;&nbsp;(∏ (<span class="id" title="var">i</span> <span class="id" title="var">j</span>: ⟦<span class="id" title="var">n</span>⟧ ), <span class="id" title="var">i</span> ≤ <span class="id" title="var">j</span> → <span class="id" title="var">f</span> <span class="id" title="var">i</span> ≤ <span class="id" title="var">f</span> <span class="id" title="var">j</span>) -&gt; ∏ <span class="id" title="var">i</span>, <span class="id" title="var">f</span> <span class="id" title="var">i</span> = <span class="id" title="var">i</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">inc</span> ?.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">I</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">negstn0</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> (<span class="id" title="var">strincr</span> : <span class="id" title="var">is_stn_strictly_increasing</span> (<span class="id" title="var">pr1incl</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">is_incr_impl_strincr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">use</span> (<span class="id" title="var">isinclcomp</span> <span class="id" title="var">f</span> (<span class="id" title="var">stntonat_incl</span> <span class="id" title="var">_</span>)). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> <span class="id" title="var">inc</span>. } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">M</span> : <span class="id" title="var">stntonat</span> <span class="id" title="var">_</span> (<span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>) = <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">isantisymmnatgeh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assert</span> (<span class="id" title="var">N</span> : <span class="id" title="var">f</span> <span class="id" title="var">lastelement</span> ≥ <span class="id" title="var">f</span> <span class="id" title="var">firstelement</span> + <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">stn_ord_incl</span> (<span class="id" title="var">pr1incl</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>) <span class="id" title="var">strincr</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">istransnatgeh</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">N</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natgehplusnmm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exact</span> (<span class="id" title="var">stnlt</span> (<span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>)). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">L</span> : ∏ <span class="id" title="var">j</span>, <span class="id" title="var">f</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">j</span>) &lt; <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">strincr</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dni_last_lt</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">f''</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inclcomp</span> (<span class="id" title="var">inclcomp</span> (<span class="id" title="var">inclpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">isincldni</span> <span class="id" title="var">n</span> <span class="id" title="var">lastelement</span>)) <span class="id" title="var">f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">inclpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">isinclstntonat</span> <span class="id" title="var">_</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">f'</span> := <span class="id" title="var">λ</span> <span class="id" title="var">j</span> : ⟦<span class="id" title="var">n</span>⟧, <span class="id" title="var">stnpair</span> <span class="id" title="var">n</span> (<span class="id" title="var">f''</span> <span class="id" title="var">j</span>) (<span class="id" title="var">L</span> <span class="id" title="var">j</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">J</span> : <span class="id" title="var">isincl</span> <span class="id" title="var">f'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">unfold</span> <span class="id" title="var">f'</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">j</span> <span class="id" title="var">j'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">iscontraprop1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">isaset_hfiber</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">isasetstn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">use</span> <span class="id" title="var">subtypeEquality</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">intros</span> ?. <span class="id" title="tactic">apply</span> <span class="id" title="var">isasetstn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id" title="tactic">induction</span> <span class="id" title="var">j</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">j</span> <span class="id" title="var">e</span>]. <span class="id" title="tactic">induction</span> <span class="id" title="var">j'</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">j'</span> <span class="id" title="var">e'</span>]. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">invmaponpathsincl</span> <span class="id" title="var">f''</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">f''</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">base_paths</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">e</span> @ !<span class="id" title="var">e'</span>)). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">F</span> : ∏ <span class="id" title="var">j</span> : ⟦<span class="id" title="var">n</span>⟧, <span class="id" title="var">f'</span> <span class="id" title="var">j</span> = <span class="id" title="var">j</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> (<span class="id" title="var">I</span> (<span class="id" title="var">inclpair</span> <span class="id" title="var">_</span> <span class="id" title="var">J</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">j</span> <span class="id" title="var">j'</span> <span class="id" title="var">lt</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">inc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">j</span>) ≤ <span class="id" title="var">pr1</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> <span class="id" title="var">j'</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2?<span class="id" title="var">dni_last</span>. <span class="id" title="tactic">assumption</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">stntonat</span> <span class="id" title="var">_</span> (<span class="id" title="var">f</span> <span class="id" title="var">i</span>) = <span class="id" title="var">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">natgehchoice</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">lastelement_ge</span> <span class="id" title="var">i</span>)) <span class="id" title="keyword">as</span> [<span class="id" title="var">ge</span> | <span class="id" title="var">eq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">pose</span> (<span class="id" title="var">p</span> := <span class="id" title="var">maponpaths</span> (<span class="id" title="var">stntonat</span> <span class="id" title="var">_</span>) (<span class="id" title="var">F</span> (<span class="id" title="var">stnpair</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span> <span class="id" title="var">ge</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">stntonat</span> <span class="id" title="var">_</span> (<span class="id" title="var">f</span> <span class="id" title="var">i</span>) = <span class="id" title="var">f</span> (<span class="id" title="var">dni</span> <span class="id" title="var">lastelement</span> (<span class="id" title="var">stnpair</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span> <span class="id" title="var">ge</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>, <span class="id" title="var">maponpaths</span>, <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dni_last</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">subtypeEquality_prop</span> <span class="id" title="tactic">in</span> <span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">M</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stn_ord_bij</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">f</span> : ⟦ <span class="id" title="var">n</span> ⟧ ≃ ⟦ <span class="id" title="var">n</span> ⟧) :<br/>
&nbsp;&nbsp;(∏ (<span class="id" title="var">i</span> <span class="id" title="var">j</span>: ⟦<span class="id" title="var">n</span>⟧ ), <span class="id" title="var">i</span> ≤ <span class="id" title="var">j</span> → <span class="id" title="var">f</span> <span class="id" title="var">i</span> ≤ <span class="id" title="var">f</span> <span class="id" title="var">j</span>) -&gt; ∏ <span class="id" title="var">i</span>, <span class="id" title="var">f</span> <span class="id" title="var">i</span> = <span class="id" title="var">i</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">stn_ord_inj</span> (<span class="id" title="var">weqtoincl</span> <span class="id" title="var">f</span>)).<br/>
</div>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>