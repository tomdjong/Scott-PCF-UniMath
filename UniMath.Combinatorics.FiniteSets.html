<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
	<script src="http://code.jquery.com/jquery-1.11.0.min.js" type="text/javascript"></script>
	<script src="./proofs-toggle.js" type="text/javascript"></script>
	<style>
		div.proofcomment {
			font-style: italic;
		}
	</style>
	<title>Documentation</title>
</head>
<body>
<div id="page">
<div id="main">
<h1 class="libtitle">Library UniMath.Combinatorics.FiniteSets</h1>

<div class="code">
</div>

<div class="doc">
<a name="lab351"></a><h1 class="section">Finite sets. Vladimir Voevodsky . Apr. - Sep. 2011.</h1>


<div class="paragraph"> </div>

This file contains the definition and main properties of finite sets. At the end of the file there are several elementary examples which are used as test cases to check that our constructions do not prevent Coq from normalizing terms of type nat to numerals.

<div class="paragraph"> </div>


<div class="paragraph"> </div>

<a name="lab352"></a><h2 class="section">Preamble</h2>

<div class="paragraph"> </div>

 Imports. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.MoreFoundations.Tactics</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.MoreFoundations.DecidablePropositions</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.MoreFoundations.NegativePropositions</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">UniMath.Combinatorics.StandardFiniteSets</span> .<br/>

<br/>
</div>

<div class="doc">
<a name="lab353"></a><h2 class="section">Sets with a given number of elements.</h2>

<div class="paragraph"> </div>

<a name="lab354"></a><h3 class="section">Structure of a set with <span class="inlinecode"></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode"></span> elements on <span class="inlinecode"></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#X"><span class="id" title="variable">X</span></a></span> <span class="inlinecode"></span> defined as a term in <span class="inlinecode"></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#weq"><span class="id" title="definition">weq</span></a></span> <span class="inlinecode">(</span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">)</span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#X"><span class="id" title="variable">X</span></a></span> <span class="inlinecode"></span></h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nelstruct</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) ( <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> ) := <span class="id" title="var">weq</span> ( <span class="id" title="var">stn</span> <span class="id" title="var">n</span> ) <span class="id" title="var">X</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nelstructToFunction</span> {<span class="id" title="var">n</span>} {<span class="id" title="var">X</span>} (<span class="id" title="var">S</span> : <span class="id" title="var">nelstruct</span> <span class="id" title="var">n</span> <span class="id" title="var">X</span>) : <span class="id" title="var">stn</span> <span class="id" title="var">n</span> -&gt; <span class="id" title="var">X</span> := <span class="id" title="var">pr1weq</span> <span class="id" title="var">S</span>.<br/>

<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">nelstructToFunction</span> : <span class="id" title="var">nelstruct</span> &gt;-&gt; <span class="id" title="var">Funclass</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nelstructonstn</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) : <span class="id" title="var">nelstruct</span> <span class="id" title="var">n</span> ( <span class="id" title="var">stn</span> <span class="id" title="var">n</span> ) := <span class="id" title="var">idweq</span> <span class="id" title="var">_</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nelstructweqf</span> { <span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">UU</span> } { <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> } ( <span class="id" title="var">w</span> : <span class="id" title="var">X</span> ≃ <span class="id" title="var">Y</span> ) ( <span class="id" title="var">sx</span> : <span class="id" title="var">nelstruct</span> <span class="id" title="var">n</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">nelstruct</span> <span class="id" title="var">n</span> <span class="id" title="var">Y</span> := <span class="id" title="var">weqcomp</span> <span class="id" title="var">sx</span> <span class="id" title="var">w</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nelstructweqb</span> { <span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">UU</span> } { <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> } ( <span class="id" title="var">w</span> : <span class="id" title="var">X</span> ≃ <span class="id" title="var">Y</span> ) ( <span class="id" title="var">sy</span> : <span class="id" title="var">nelstruct</span> <span class="id" title="var">n</span> <span class="id" title="var">Y</span> ) : <span class="id" title="var">nelstruct</span> <span class="id" title="var">n</span> <span class="id" title="var">X</span> := <span class="id" title="var">weqcomp</span> <span class="id" title="var">sy</span> ( <span class="id" title="var">invweq</span> <span class="id" title="var">w</span> ) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nelstructonempty</span> : <span class="id" title="var">nelstruct</span> 0 <span class="id" title="var">empty</span> := <span class="id" title="var">weqstn0toempty</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nelstructonempty2</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="keyword">is</span> : <span class="id" title="var">neg</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">nelstruct</span> 0 <span class="id" title="var">X</span> :=  <span class="id" title="var">weqcomp</span> <span class="id" title="var">weqstn0toempty</span> ( <span class="id" title="var">invweq</span> ( <span class="id" title="var">weqtoempty</span> <span class="id" title="keyword">is</span> ) ) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nelstructonunit</span> : <span class="id" title="var">nelstruct</span> 1 <span class="id" title="var">unit</span> := <span class="id" title="var">weqstn1tounit</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nelstructoncontr</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="keyword">is</span> : <span class="id" title="var">iscontr</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">nelstruct</span> 1 <span class="id" title="var">X</span> := <span class="id" title="var">weqcomp</span> <span class="id" title="var">weqstn1tounit</span> ( <span class="id" title="var">invweq</span> ( <span class="id" title="var">weqcontrtounit</span> <span class="id" title="keyword">is</span> ) ) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nelstructonbool</span> : <span class="id" title="var">nelstruct</span> 2 <span class="id" title="var">bool</span> := <span class="id" title="var">weqstn2tobool</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nelstructoncoprodwithunit</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } { <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> } ( <span class="id" title="var">sx</span> : <span class="id" title="var">nelstruct</span> <span class="id" title="var">n</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">nelstruct</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">coprod</span> <span class="id" title="var">X</span> <span class="id" title="var">unit</span> ) :=  <span class="id" title="var">weqcomp</span> ( <span class="id" title="var">invweq</span> ( <span class="id" title="var">weqdnicoprod</span> <span class="id" title="var">n</span> <span class="id" title="var">lastelement</span> ) ) ( <span class="id" title="var">weqcoprodf</span> <span class="id" title="var">sx</span> ( <span class="id" title="var">idweq</span> <span class="id" title="var">unit</span> ) ) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nelstructoncompl</span> {<span class="id" title="var">X</span>} {<span class="id" title="var">n</span>} (<span class="id" title="var">x</span>:<span class="id" title="var">X</span>) : <span class="id" title="var">nelstruct</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) <span class="id" title="var">X</span> -&gt; <span class="id" title="var">nelstruct</span> <span class="id" title="var">n</span> (<span class="id" title="var">compl</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">sx</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">invweq</span> ( <span class="id" title="var">weqoncompl</span> ( <span class="id" title="var">invweq</span> <span class="id" title="var">sx</span> ) <span class="id" title="var">x</span>) ∘ <span class="id" title="var">_</span> ∘ <span class="id" title="var">weqdnicompl</span> (<span class="id" title="var">invweq</span> <span class="id" title="var">sx</span> <span class="id" title="var">x</span>))%<span class="id" title="var">weq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">compl_weq_compl_ne</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nelstructoncoprod</span> { <span class="id" title="var">X</span>  <span class="id" title="var">Y</span> : <span class="id" title="var">UU</span> } { <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span> } ( <span class="id" title="var">sx</span> : <span class="id" title="var">nelstruct</span> <span class="id" title="var">n</span> <span class="id" title="var">X</span> ) ( <span class="id" title="var">sy</span> : <span class="id" title="var">nelstruct</span> <span class="id" title="var">m</span> <span class="id" title="var">Y</span> ) : <span class="id" title="var">nelstruct</span> ( <span class="id" title="var">n</span> + <span class="id" title="var">m</span> ) ( <span class="id" title="var">coprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> ) := <span class="id" title="var">weqcomp</span> ( <span class="id" title="var">invweq</span> ( <span class="id" title="var">weqfromcoprodofstn</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> ) ) ( <span class="id" title="var">weqcoprodf</span> <span class="id" title="var">sx</span> <span class="id" title="var">sy</span> ) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nelstructontotal2</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="var">P</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">UU</span> ) ( <span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">nat</span> ) { <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> } ( <span class="id" title="var">sx</span> : <span class="id" title="var">nelstruct</span> <span class="id" title="var">n</span> <span class="id" title="var">X</span> ) ( <span class="id" title="var">fs</span> : ∏ <span class="id" title="var">x</span> : <span class="id" title="var">X</span> , <span class="id" title="var">nelstruct</span> ( <span class="id" title="var">f</span> <span class="id" title="var">x</span> ) ( <span class="id" title="var">P</span> <span class="id" title="var">x</span> ) ) : <span class="id" title="var">nelstruct</span> ( <span class="id" title="var">stnsum</span> ( <span class="id" title="var">funcomp</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">sx</span> ) <span class="id" title="var">f</span> ) ) ( <span class="id" title="var">total2</span> <span class="id" title="var">P</span> )  := <span class="id" title="var">weqcomp</span> ( <span class="id" title="var">invweq</span> ( <span class="id" title="var">weqstnsum</span> ( <span class="id" title="var">funcomp</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">sx</span> ) <span class="id" title="var">P</span> ) ( <span class="id" title="var">funcomp</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">sx</span> ) <span class="id" title="var">f</span> ) ( <span class="id" title="var">λ</span> <span class="id" title="var">i</span> : <span class="id" title="var">stn</span> <span class="id" title="var">n</span>, <span class="id" title="var">fs</span> ( ( <span class="id" title="var">pr1</span> <span class="id" title="var">sx</span> ) <span class="id" title="var">i</span> ) ) ) )  ( <span class="id" title="var">weqfp</span> <span class="id" title="var">sx</span> <span class="id" title="var">P</span> )  .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nelstructondirprod</span> { <span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">UU</span> } { <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span> } ( <span class="id" title="var">sx</span> : <span class="id" title="var">nelstruct</span> <span class="id" title="var">n</span> <span class="id" title="var">X</span> ) ( <span class="id" title="var">sy</span> : <span class="id" title="var">nelstruct</span> <span class="id" title="var">m</span> <span class="id" title="var">Y</span> ) : <span class="id" title="var">nelstruct</span> ( <span class="id" title="var">n</span> * <span class="id" title="var">m</span> ) ( <span class="id" title="var">dirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> ) := <span class="id" title="var">weqcomp</span> ( <span class="id" title="var">invweq</span> ( <span class="id" title="var">weqfromprodofstn</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> ) ) ( <span class="id" title="var">weqdirprodf</span> <span class="id" title="var">sx</span> <span class="id" title="var">sy</span> ) .<br/>

<br/>
</div>

<div class="doc">
For a generalization of <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">weqfromdecsubsetofstn</span></span> <span class="inlinecode"></span> see below 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nelstructonfun</span> { <span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">UU</span> } { <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span> } ( <span class="id" title="var">sx</span> : <span class="id" title="var">nelstruct</span> <span class="id" title="var">n</span> <span class="id" title="var">X</span> ) ( <span class="id" title="var">sy</span> : <span class="id" title="var">nelstruct</span> <span class="id" title="var">m</span> <span class="id" title="var">Y</span> ) : <span class="id" title="var">nelstruct</span> ( <span class="id" title="var">natpower</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Y</span> ) := <span class="id" title="var">weqcomp</span> ( <span class="id" title="var">invweq</span> ( <span class="id" title="var">weqfromfunstntostn</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> ) ) ( <span class="id" title="var">weqcomp</span> ( <span class="id" title="var">weqbfun</span> <span class="id" title="var">_</span> ( <span class="id" title="var">invweq</span> <span class="id" title="var">sx</span> ) ) ( <span class="id" title="var">weqffun</span> <span class="id" title="var">_</span> <span class="id" title="var">sy</span> ) )  .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nelstructonforall</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="var">P</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">UU</span> ) ( <span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">nat</span> ) { <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> } ( <span class="id" title="var">sx</span> : <span class="id" title="var">nelstruct</span> <span class="id" title="var">n</span> <span class="id" title="var">X</span> ) ( <span class="id" title="var">fs</span> : ∏ <span class="id" title="var">x</span> : <span class="id" title="var">X</span> , <span class="id" title="var">nelstruct</span> ( <span class="id" title="var">f</span> <span class="id" title="var">x</span> ) ( <span class="id" title="var">P</span> <span class="id" title="var">x</span> ) ) : <span class="id" title="var">nelstruct</span> ( <span class="id" title="var">stnprod</span> ( <span class="id" title="var">funcomp</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">sx</span> ) <span class="id" title="var">f</span> ) ) ( ∏ <span class="id" title="var">x</span> : <span class="id" title="var">X</span> , <span class="id" title="var">P</span> <span class="id" title="var">x</span> )  := <span class="id" title="var">invweq</span> ( <span class="id" title="var">weqcomp</span> ( <span class="id" title="var">weqonsecbase</span> <span class="id" title="var">P</span> <span class="id" title="var">sx</span> ) ( <span class="id" title="var">weqstnprod</span> ( <span class="id" title="var">funcomp</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">sx</span> ) <span class="id" title="var">P</span> ) ( <span class="id" title="var">funcomp</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">sx</span> ) <span class="id" title="var">f</span> ) ( <span class="id" title="var">λ</span> <span class="id" title="var">i</span> : <span class="id" title="var">stn</span> <span class="id" title="var">n</span>, <span class="id" title="var">fs</span> ( ( <span class="id" title="var">pr1</span> <span class="id" title="var">sx</span> ) <span class="id" title="var">i</span> ) ) ) )  .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nelstructonweq</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } { <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> } ( <span class="id" title="var">sx</span> : <span class="id" title="var">nelstruct</span> <span class="id" title="var">n</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">nelstruct</span> ( <span class="id" title="var">factorial</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">X</span> ≃ <span class="id" title="var">X</span> ) := <span class="id" title="var">weqcomp</span> ( <span class="id" title="var">invweq</span> ( <span class="id" title="var">weqfromweqstntostn</span> <span class="id" title="var">n</span> ) ) ( <span class="id" title="var">weqcomp</span> ( <span class="id" title="var">weqbweq</span> <span class="id" title="var">_</span> ( <span class="id" title="var">invweq</span> <span class="id" title="var">sx</span> ) ) ( <span class="id" title="var">weqfweq</span> <span class="id" title="var">_</span> <span class="id" title="var">sx</span> ) ) .<br/>

<br/>
</div>

<div class="doc">
<a name="lab355"></a><h3 class="section">The property of <span class="inlinecode"></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#X"><span class="id" title="variable">X</span></a></span> <span class="inlinecode"></span> to have <span class="inlinecode"></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode"></span> elements</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isofnel</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) ( <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> ) : <span class="id" title="var">hProp</span> := <span class="id" title="var">ishinh</span> ( <span class="id" title="var">weq</span> ( <span class="id" title="var">stn</span> <span class="id" title="var">n</span> ) <span class="id" title="var">X</span> ) .<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isofneluniv</span> { <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> }  ( <span class="id" title="var">P</span> : <span class="id" title="var">hProp</span> ) : ( ( <span class="id" title="var">nelstruct</span> <span class="id" title="var">n</span> <span class="id" title="var">X</span> ) -&gt; <span class="id" title="var">P</span> ) -&gt; ( <span class="id" title="var">isofnel</span> <span class="id" title="var">n</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">P</span> ) .<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> @<span class="id" title="var">hinhuniv</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">weq</span> ( <span class="id" title="var">stn</span> <span class="id" title="var">n</span> ) <span class="id" title="var">X</span> ) . <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">assumption</span>. </div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isofnelstn</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) : <span class="id" title="var">isofnel</span> <span class="id" title="var">n</span> ( <span class="id" title="var">stn</span> <span class="id" title="var">n</span> ) := <span class="id" title="var">hinhpr</span> ( <span class="id" title="var">nelstructonstn</span> <span class="id" title="var">n</span> ) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isofnelweqf</span> { <span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">UU</span> } { <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> } ( <span class="id" title="var">w</span> : <span class="id" title="var">X</span> ≃ <span class="id" title="var">Y</span> ) ( <span class="id" title="var">sx</span> : <span class="id" title="var">isofnel</span> <span class="id" title="var">n</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">isofnel</span> <span class="id" title="var">n</span> <span class="id" title="var">Y</span> := <span class="id" title="var">hinhfun</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">sx0</span> : <span class="id" title="var">_</span>,  <span class="id" title="var">nelstructweqf</span> <span class="id" title="var">w</span> <span class="id" title="var">sx0</span> ) <span class="id" title="var">sx</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isofnelweqb</span> { <span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">UU</span> } { <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> } ( <span class="id" title="var">w</span> : <span class="id" title="var">X</span> ≃ <span class="id" title="var">Y</span> ) ( <span class="id" title="var">sy</span> : <span class="id" title="var">isofnel</span> <span class="id" title="var">n</span> <span class="id" title="var">Y</span> ) : <span class="id" title="var">isofnel</span> <span class="id" title="var">n</span> <span class="id" title="var">X</span> :=  <span class="id" title="var">hinhfun</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">sy0</span> : <span class="id" title="var">_</span>, <span class="id" title="var">nelstructweqb</span> <span class="id" title="var">w</span> <span class="id" title="var">sy0</span> ) <span class="id" title="var">sy</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isofnelempty</span> : <span class="id" title="var">isofnel</span> 0 <span class="id" title="var">empty</span> := <span class="id" title="var">hinhpr</span> <span class="id" title="var">nelstructonempty</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isofnelempty2</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="keyword">is</span> : <span class="id" title="var">neg</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">isofnel</span> 0 <span class="id" title="var">X</span> :=  <span class="id" title="var">hinhpr</span> ( <span class="id" title="var">nelstructonempty2</span> <span class="id" title="keyword">is</span> ) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isofnelunit</span> : <span class="id" title="var">isofnel</span> 1 <span class="id" title="var">unit</span> := <span class="id" title="var">hinhpr</span> <span class="id" title="var">nelstructonunit</span>  .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isofnelcontr</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="keyword">is</span> : <span class="id" title="var">iscontr</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">isofnel</span> 1 <span class="id" title="var">X</span> := <span class="id" title="var">hinhpr</span> ( <span class="id" title="var">nelstructoncontr</span> <span class="id" title="keyword">is</span> ) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isofnelbool</span> : <span class="id" title="var">isofnel</span> 2 <span class="id" title="var">bool</span> := <span class="id" title="var">hinhpr</span> <span class="id" title="var">nelstructonbool</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isofnelcoprodwithunit</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } { <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> } ( <span class="id" title="var">sx</span> : <span class="id" title="var">isofnel</span> <span class="id" title="var">n</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">isofnel</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">coprod</span> <span class="id" title="var">X</span> <span class="id" title="var">unit</span> ) :=   <span class="id" title="var">hinhfun</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">sx0</span> : <span class="id" title="var">_</span>,  <span class="id" title="var">nelstructoncoprodwithunit</span> <span class="id" title="var">sx0</span> ) <span class="id" title="var">sx</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isofnelcompl</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } { <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> } ( <span class="id" title="var">x</span> : <span class="id" title="var">X</span> ) ( <span class="id" title="var">sx</span> : <span class="id" title="var">isofnel</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) <span class="id" title="var">X</span> ) : <span class="id" title="var">isofnel</span> <span class="id" title="var">n</span> ( <span class="id" title="var">compl</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span> ) := <span class="id" title="var">hinhfun</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">sx0</span> : <span class="id" title="var">_</span>,  <span class="id" title="var">nelstructoncompl</span> <span class="id" title="var">x</span> <span class="id" title="var">sx0</span> ) <span class="id" title="var">sx</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isofnelcoprod</span> { <span class="id" title="var">X</span>  <span class="id" title="var">Y</span> : <span class="id" title="var">UU</span> } { <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span> } ( <span class="id" title="var">sx</span> : <span class="id" title="var">isofnel</span> <span class="id" title="var">n</span> <span class="id" title="var">X</span> ) ( <span class="id" title="var">sy</span> : <span class="id" title="var">isofnel</span> <span class="id" title="var">m</span> <span class="id" title="var">Y</span> ) : <span class="id" title="var">isofnel</span> ( <span class="id" title="var">n</span> + <span class="id" title="var">m</span> ) ( <span class="id" title="var">coprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> ) :=  <span class="id" title="var">hinhfun2</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">sx0</span> : <span class="id" title="var">_</span>, <span class="id" title="var">λ</span> <span class="id" title="var">sy0</span> : <span class="id" title="var">_</span>,  <span class="id" title="var">nelstructoncoprod</span> <span class="id" title="var">sx0</span> <span class="id" title="var">sy0</span> ) <span class="id" title="var">sx</span> <span class="id" title="var">sy</span> .<br/>

<br/>
</div>

<div class="doc">
For a result corresponding to <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">nelstructontotal2</span></span> <span class="inlinecode"></span> see below . 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isofnelondirprod</span> { <span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">UU</span> } { <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span> } ( <span class="id" title="var">sx</span> : <span class="id" title="var">isofnel</span> <span class="id" title="var">n</span> <span class="id" title="var">X</span> ) ( <span class="id" title="var">sy</span> : <span class="id" title="var">isofnel</span> <span class="id" title="var">m</span> <span class="id" title="var">Y</span> ) : <span class="id" title="var">isofnel</span> ( <span class="id" title="var">n</span> * <span class="id" title="var">m</span> ) ( <span class="id" title="var">dirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> ) := <span class="id" title="var">hinhfun2</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">sx0</span> : <span class="id" title="var">_</span>, <span class="id" title="var">λ</span> <span class="id" title="var">sy0</span> : <span class="id" title="var">_</span>,  <span class="id" title="var">nelstructondirprod</span> <span class="id" title="var">sx0</span> <span class="id" title="var">sy0</span> ) <span class="id" title="var">sx</span> <span class="id" title="var">sy</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isofnelonfun</span> { <span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">UU</span> } { <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span> } ( <span class="id" title="var">sx</span> : <span class="id" title="var">isofnel</span> <span class="id" title="var">n</span> <span class="id" title="var">X</span> ) ( <span class="id" title="var">sy</span> : <span class="id" title="var">isofnel</span> <span class="id" title="var">m</span> <span class="id" title="var">Y</span> ) : <span class="id" title="var">isofnel</span> ( <span class="id" title="var">natpower</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Y</span> ) := <span class="id" title="var">hinhfun2</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">sx0</span> : <span class="id" title="var">_</span>, <span class="id" title="var">λ</span> <span class="id" title="var">sy0</span> : <span class="id" title="var">_</span>,  <span class="id" title="var">nelstructonfun</span> <span class="id" title="var">sx0</span> <span class="id" title="var">sy0</span> ) <span class="id" title="var">sx</span> <span class="id" title="var">sy</span> .<br/>

<br/>
</div>

<div class="doc">
For a result corresponding to <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">nelstructonforall</span></span> <span class="inlinecode"></span> see below . 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isofnelonweq</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } { <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> } ( <span class="id" title="var">sx</span> : <span class="id" title="var">isofnel</span> <span class="id" title="var">n</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">isofnel</span> ( <span class="id" title="var">factorial</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">X</span> ≃ <span class="id" title="var">X</span> ) := <span class="id" title="var">hinhfun</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">sx0</span> : <span class="id" title="var">_</span>,  <span class="id" title="var">nelstructonweq</span> <span class="id" title="var">sx0</span> ) <span class="id" title="var">sx</span> .<br/>

<br/>
</div>

<div class="doc">
<a name="lab356"></a><h2 class="section">General finite sets.</h2>

<div class="paragraph"> </div>

<a name="lab357"></a><h3 class="section">Finite structure on a type <span class="inlinecode"></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#X"><span class="id" title="variable">X</span></a></span> <span class="inlinecode"></span> defined as a pair <span class="inlinecode"></span> <span class="inlinecode">(</span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">,</span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Tests.html#Test_isweq_iso.w"><span class="id" title="definition">w</span></a></span> <span class="inlinecode">)</span> <span class="inlinecode"></span> where <span class="inlinecode"></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#nat"><span class="id" title="inductive">nat</span></a></span> <span class="inlinecode"></span> and <span class="inlinecode"></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Tests.html#Test_isweq_iso.w"><span class="id" title="definition">w</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#weq"><span class="id" title="definition">weq</span></a></span> <span class="inlinecode">(</span> <span class="inlinecode"><span class="id" title="var">stn</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.Preamble.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">)</span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#X"><span class="id" title="variable">X</span></a></span> <span class="inlinecode"></span></h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">finstruct</span>  ( <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> ) := <span class="id" title="var">total2</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">nelstruct</span> <span class="id" title="var">n</span> <span class="id" title="var">X</span> ) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">finstructToFunction</span> {<span class="id" title="var">X</span>} (<span class="id" title="var">S</span> : <span class="id" title="var">finstruct</span> <span class="id" title="var">X</span>) := <span class="id" title="var">pr2</span> <span class="id" title="var">S</span> : <span class="id" title="var">nelstruct</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">S</span>) <span class="id" title="var">X</span>.<br/>

<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">finstructToFunction</span> : <span class="id" title="var">finstruct</span> &gt;-&gt; <span class="id" title="var">nelstruct</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">finstructpair</span>  ( <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> )  := <span class="id" title="var">tpair</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">nelstruct</span> <span class="id" title="var">n</span> <span class="id" title="var">X</span> ) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">finstructonstn</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) : <span class="id" title="var">finstruct</span> ( <span class="id" title="var">stn</span> <span class="id" title="var">n</span> ) := <span class="id" title="var">tpair</span> <span class="id" title="var">_</span> <span class="id" title="var">n</span> ( <span class="id" title="var">nelstructonstn</span> <span class="id" title="var">n</span> ) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">finstructweqf</span> { <span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="var">w</span> : <span class="id" title="var">X</span> ≃ <span class="id" title="var">Y</span> ) ( <span class="id" title="var">sx</span> : <span class="id" title="var">finstruct</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">finstruct</span> <span class="id" title="var">Y</span> := <span class="id" title="var">tpair</span> <span class="id" title="var">_</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">sx</span> ) ( <span class="id" title="var">nelstructweqf</span> <span class="id" title="var">w</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">sx</span> ) ) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">finstructweqb</span> { <span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="var">w</span> : <span class="id" title="var">X</span> ≃ <span class="id" title="var">Y</span> ) ( <span class="id" title="var">sy</span> : <span class="id" title="var">finstruct</span> <span class="id" title="var">Y</span> ) : <span class="id" title="var">finstruct</span> <span class="id" title="var">X</span> :=  <span class="id" title="var">tpair</span> <span class="id" title="var">_</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">sy</span> ) ( <span class="id" title="var">nelstructweqb</span> <span class="id" title="var">w</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">sy</span> ) ) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">finstructonempty</span> : <span class="id" title="var">finstruct</span> <span class="id" title="var">empty</span> := <span class="id" title="var">tpair</span> <span class="id" title="var">_</span> 0 <span class="id" title="var">nelstructonempty</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">finstructonempty2</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="keyword">is</span> : <span class="id" title="var">neg</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">finstruct</span> <span class="id" title="var">X</span> :=  <span class="id" title="var">tpair</span> <span class="id" title="var">_</span> 0 ( <span class="id" title="var">nelstructonempty2</span> <span class="id" title="keyword">is</span> ) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">finstructonunit</span> : <span class="id" title="var">finstruct</span> <span class="id" title="var">unit</span> := <span class="id" title="var">tpair</span> <span class="id" title="var">_</span> 1 <span class="id" title="var">nelstructonunit</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">finstructoncontr</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="keyword">is</span> : <span class="id" title="var">iscontr</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">finstruct</span> <span class="id" title="var">X</span> := <span class="id" title="var">tpair</span> <span class="id" title="var">_</span> 1 ( <span class="id" title="var">nelstructoncontr</span> <span class="id" title="keyword">is</span> ) .<br/>

<br/>
</div>

<div class="doc">
It is not difficult to show that a direct summand of a finite set is a finite set . As a corrolary it follows that a proposition ( a type of h-level 1 ) is a finite set if and only if it is decidable . 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">finstructonbool</span> : <span class="id" title="var">finstruct</span> <span class="id" title="var">bool</span> := <span class="id" title="var">tpair</span> <span class="id" title="var">_</span> 2 <span class="id" title="var">nelstructonbool</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">finstructoncoprodwithunit</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> }  ( <span class="id" title="var">sx</span> : <span class="id" title="var">finstruct</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">finstruct</span> ( <span class="id" title="var">coprod</span> <span class="id" title="var">X</span> <span class="id" title="var">unit</span> ) :=  <span class="id" title="var">tpair</span> <span class="id" title="var">_</span> ( <span class="id" title="var">S</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">sx</span> ) ) ( <span class="id" title="var">nelstructoncoprodwithunit</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">sx</span> ) ) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">finstructoncompl</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="var">x</span> : <span class="id" title="var">X</span> ) ( <span class="id" title="var">sx</span> : <span class="id" title="var">finstruct</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">finstruct</span> ( <span class="id" title="var">compl</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span> ) .<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">. <span class="id" title="tactic">intros</span> . <span class="id" title="tactic">unfold</span> <span class="id" title="var">finstruct</span> . <span class="id" title="tactic">unfold</span> <span class="id" title="var">finstruct</span> <span class="id" title="tactic">in</span> <span class="id" title="var">sx</span> . <span class="id" title="tactic">destruct</span> <span class="id" title="var">sx</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">n</span> <span class="id" title="var">w</span> ] . <span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [ | <span class="id" title="var">n</span> ] . <span class="id" title="tactic">destruct</span> ( <span class="id" title="var">negstn0</span> ( <span class="id" title="var">invweq</span> <span class="id" title="var">w</span> <span class="id" title="var">x</span> ) ) . <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">n</span> . <span class="id" title="tactic">apply</span> ( <span class="id" title="var">nelstructoncompl</span> <span class="id" title="var">x</span> <span class="id" title="var">w</span> ) . </div>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">finstructoncoprod</span> { <span class="id" title="var">X</span>  <span class="id" title="var">Y</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="var">sx</span> : <span class="id" title="var">finstruct</span> <span class="id" title="var">X</span> ) ( <span class="id" title="var">sy</span> : <span class="id" title="var">finstruct</span> <span class="id" title="var">Y</span> ) : <span class="id" title="var">finstruct</span> ( <span class="id" title="var">coprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> ) := <span class="id" title="var">tpair</span> <span class="id" title="var">_</span> ( ( <span class="id" title="var">pr1</span> <span class="id" title="var">sx</span> ) + ( <span class="id" title="var">pr1</span> <span class="id" title="var">sy</span> ) ) ( <span class="id" title="var">nelstructoncoprod</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">sx</span> ) ( <span class="id" title="var">pr2</span> <span class="id" title="var">sy</span> ) ) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">finstructontotal2</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="var">P</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">UU</span> )   ( <span class="id" title="var">sx</span> : <span class="id" title="var">finstruct</span> <span class="id" title="var">X</span> ) ( <span class="id" title="var">fs</span> : ∏ <span class="id" title="var">x</span> : <span class="id" title="var">X</span> , <span class="id" title="var">finstruct</span> ( <span class="id" title="var">P</span> <span class="id" title="var">x</span> ) ) : <span class="id" title="var">finstruct</span> ( <span class="id" title="var">total2</span> <span class="id" title="var">P</span> ) := <span class="id" title="var">tpair</span> <span class="id" title="var">_</span> ( <span class="id" title="var">stnsum</span> ( <span class="id" title="var">funcomp</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">sx</span> ) ) ( <span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>,  <span class="id" title="var">pr1</span> ( <span class="id" title="var">fs</span> <span class="id" title="var">x</span> ) ) ) ) ( <span class="id" title="var">nelstructontotal2</span> <span class="id" title="var">P</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, <span class="id" title="var">pr1</span> ( <span class="id" title="var">fs</span> <span class="id" title="var">x</span> ) ) ( <span class="id" title="var">pr2</span> <span class="id" title="var">sx</span> ) ( <span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, <span class="id" title="var">pr2</span> ( <span class="id" title="var">fs</span> <span class="id" title="var">x</span> ) ) ) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">finstructondirprod</span> { <span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="var">sx</span> : <span class="id" title="var">finstruct</span> <span class="id" title="var">X</span> ) ( <span class="id" title="var">sy</span> : <span class="id" title="var">finstruct</span> <span class="id" title="var">Y</span> ) : <span class="id" title="var">finstruct</span> ( <span class="id" title="var">dirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> ) := <span class="id" title="var">tpair</span> <span class="id" title="var">_</span> ( ( <span class="id" title="var">pr1</span> <span class="id" title="var">sx</span> ) * ( <span class="id" title="var">pr1</span> <span class="id" title="var">sy</span> ) ) ( <span class="id" title="var">nelstructondirprod</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">sx</span> ) ( <span class="id" title="var">pr2</span> <span class="id" title="var">sy</span> ) ) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">finstructondecsubset</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> }  ( <span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">bool</span> ) ( <span class="id" title="var">sx</span> : <span class="id" title="var">finstruct</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">finstruct</span> ( <span class="id" title="var">hfiber</span> <span class="id" title="var">f</span> <span class="id" title="var">true</span> ) := <span class="id" title="var">tpair</span> <span class="id" title="var">_</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">weqfromdecsubsetofstn</span> ( <span class="id" title="var">funcomp</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">sx</span> ) ) <span class="id" title="var">f</span> ) ) ) ( <span class="id" title="var">weqcomp</span> ( <span class="id" title="var">invweq</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">weqfromdecsubsetofstn</span> ( <span class="id" title="var">funcomp</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">sx</span> ) ) <span class="id" title="var">f</span> ) ) ) ) ( <span class="id" title="var">weqhfibersgwtog</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">sx</span> ) <span class="id" title="var">f</span> <span class="id" title="var">true</span> ) ) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">finstructonfun</span> { <span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="var">sx</span> : <span class="id" title="var">finstruct</span> <span class="id" title="var">X</span> ) ( <span class="id" title="var">sy</span> : <span class="id" title="var">finstruct</span> <span class="id" title="var">Y</span> ) : <span class="id" title="var">finstruct</span> ( <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Y</span> ) := <span class="id" title="var">tpair</span> <span class="id" title="var">_</span> ( <span class="id" title="var">natpower</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">sy</span> ) ( <span class="id" title="var">pr1</span> <span class="id" title="var">sx</span> ) ) ( <span class="id" title="var">nelstructonfun</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">sx</span> ) ( <span class="id" title="var">pr2</span> <span class="id" title="var">sy</span> ) ) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">finstructonforall</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="var">P</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">UU</span> )  ( <span class="id" title="var">sx</span> : <span class="id" title="var">finstruct</span> <span class="id" title="var">X</span> ) ( <span class="id" title="var">fs</span> : ∏ <span class="id" title="var">x</span> : <span class="id" title="var">X</span> , <span class="id" title="var">finstruct</span> ( <span class="id" title="var">P</span> <span class="id" title="var">x</span> ) ) : <span class="id" title="var">finstruct</span> ( ∏ <span class="id" title="var">x</span> : <span class="id" title="var">X</span> , <span class="id" title="var">P</span> <span class="id" title="var">x</span> )  := <span class="id" title="var">tpair</span> <span class="id" title="var">_</span> ( <span class="id" title="var">stnprod</span> ( <span class="id" title="var">funcomp</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">sx</span> ) ) ( <span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>,  <span class="id" title="var">pr1</span> ( <span class="id" title="var">fs</span> <span class="id" title="var">x</span> ) ) ) ) ( <span class="id" title="var">nelstructonforall</span> <span class="id" title="var">P</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, <span class="id" title="var">pr1</span> ( <span class="id" title="var">fs</span> <span class="id" title="var">x</span> ) ) ( <span class="id" title="var">pr2</span> <span class="id" title="var">sx</span> ) ( <span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, <span class="id" title="var">pr2</span> ( <span class="id" title="var">fs</span> <span class="id" title="var">x</span> ) ) ) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">finstructonweq</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> }  ( <span class="id" title="var">sx</span> : <span class="id" title="var">finstruct</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">finstruct</span> ( <span class="id" title="var">X</span> ≃ <span class="id" title="var">X</span> ) := <span class="id" title="var">tpair</span> <span class="id" title="var">_</span> ( <span class="id" title="var">factorial</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">sx</span> ) ) ( <span class="id" title="var">nelstructonweq</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">sx</span> ) ) .<br/>

<br/>
</div>

<div class="doc">
<a name="lab358"></a><h3 class="section">The property of being finite</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isfinite</span>  ( <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> ) := <span class="id" title="var">ishinh</span> ( <span class="id" title="var">finstruct</span> <span class="id" title="var">X</span> ) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">FiniteSet</span> := ∑ <span class="id" title="var">X</span>:<span class="id" title="var">UU</span>, <span class="id" title="var">isfinite</span> <span class="id" title="var">X</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isfinite_to_FiniteSet</span> {<span class="id" title="var">X</span>:<span class="id" title="var">UU</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">isfinite</span> <span class="id" title="var">X</span>) : <span class="id" title="var">FiniteSet</span> := <span class="id" title="var">X</span>,,<span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isfinite_isdeceq</span> <span class="id" title="var">X</span> : <span class="id" title="var">isfinite</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">isdeceq</span> <span class="id" title="var">X</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span> <span class="id" title="var">isfin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isfin</span> (<span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> (<span class="id" title="var">isapropisdeceq</span> <span class="id" title="var">X</span>))); <span class="id" title="tactic">intro</span> <span class="id" title="var">f</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">isfin</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isdeceqweqf</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">f</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isdeceqstn</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isfinite_isaset</span> <span class="id" title="var">X</span> : <span class="id" title="var">isfinite</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">isaset</span> <span class="id" title="var">X</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">isfin</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">isfin</span> (<span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> (<span class="id" title="var">isapropisaset</span> <span class="id" title="var">X</span>))); <span class="id" title="tactic">intro</span> <span class="id" title="var">f</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">isfin</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isofhlevelweqf</span> 2 (<span class="id" title="var">pr2</span> <span class="id" title="var">f</span>)). <span class="id" title="tactic">apply</span> <span class="id" title="var">isasetstn</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">FiniteSet_to_hSet</span> : <span class="id" title="var">FiniteSet</span> -&gt; <span class="id" title="var">hSet</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intro</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">hSetpair</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">X</span>) (<span class="id" title="var">isfinite_isaset</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">X</span>) (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>))).<br/>
</div>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">FiniteSet_to_hSet</span> : <span class="id" title="var">FiniteSet</span> &gt;-&gt; <span class="id" title="var">hSet</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fincard</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="keyword">is</span> : <span class="id" title="var">isfinite</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">nat</span> .<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_pairs_to_set</span> (<span class="id" title="var">λ</span> <span class="id" title="var">n</span>, <span class="id" title="var">stn</span> <span class="id" title="var">n</span> ≃ <span class="id" title="var">X</span>) <span class="id" title="var">isasetnat</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">n'</span> <span class="id" title="var">w</span> <span class="id" title="var">w'</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">weqtoeqstn</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">invweq</span> <span class="id" title="var">w'</span> ∘ <span class="id" title="var">w</span>)%<span class="id" title="var">weq</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">cardinalityFiniteSet</span> (<span class="id" title="var">X</span>:<span class="id" title="var">FiniteSet</span>) : <span class="id" title="var">nat</span> := <span class="id" title="var">fincard</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>).<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">ischoicebasefiniteset</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="keyword">is</span> : <span class="id" title="var">isfinite</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">ischoicebase</span> <span class="id" title="var">X</span> .<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">. <span class="id" title="tactic">intros</span> . <span class="id" title="tactic">apply</span> ( @<span class="id" title="var">hinhuniv</span> ( <span class="id" title="var">finstruct</span> <span class="id" title="var">X</span> ) ( <span class="id" title="var">ischoicebase</span> <span class="id" title="var">X</span> ) ) . <span class="id" title="tactic">intro</span> <span class="id" title="var">nw</span> . <span class="id" title="tactic">destruct</span> <span class="id" title="var">nw</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">n</span> <span class="id" title="var">w</span> ] . <span class="id" title="tactic">apply</span> ( <span class="id" title="var">ischoicebaseweqf</span> <span class="id" title="var">w</span> ( <span class="id" title="var">ischoicebasestn</span> <span class="id" title="var">n</span> ) ) . <span class="id" title="tactic">apply</span> <span class="id" title="keyword">is</span> . </div>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isfinitestn</span> ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) : <span class="id" title="var">isfinite</span> ( <span class="id" title="var">stn</span> <span class="id" title="var">n</span> ) := <span class="id" title="var">hinhpr</span> ( <span class="id" title="var">finstructonstn</span> <span class="id" title="var">n</span> ) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">standardFiniteSet</span> <span class="id" title="var">n</span> : <span class="id" title="var">FiniteSet</span> := <span class="id" title="var">isfinite_to_FiniteSet</span> (<span class="id" title="var">isfinitestn</span> <span class="id" title="var">n</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isfiniteweqf</span> { <span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="var">w</span> : <span class="id" title="var">X</span> ≃ <span class="id" title="var">Y</span> ) ( <span class="id" title="var">sx</span> : <span class="id" title="var">isfinite</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">isfinite</span> <span class="id" title="var">Y</span> :=  <span class="id" title="var">hinhfun</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">sx0</span> : <span class="id" title="var">_</span>,  <span class="id" title="var">finstructweqf</span> <span class="id" title="var">w</span> <span class="id" title="var">sx0</span> ) <span class="id" title="var">sx</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isfiniteweqb</span> { <span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="var">w</span> : <span class="id" title="var">X</span> ≃ <span class="id" title="var">Y</span> ) ( <span class="id" title="var">sy</span> : <span class="id" title="var">isfinite</span> <span class="id" title="var">Y</span> ) : <span class="id" title="var">isfinite</span> <span class="id" title="var">X</span> :=   <span class="id" title="var">hinhfun</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">sy0</span> : <span class="id" title="var">_</span>,  <span class="id" title="var">finstructweqb</span> <span class="id" title="var">w</span> <span class="id" title="var">sy0</span> ) <span class="id" title="var">sy</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isfiniteempty</span> : <span class="id" title="var">isfinite</span> <span class="id" title="var">empty</span> := <span class="id" title="var">hinhpr</span> <span class="id" title="var">finstructonempty</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isfiniteempty2</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="keyword">is</span> : <span class="id" title="var">neg</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">isfinite</span> <span class="id" title="var">X</span> :=  <span class="id" title="var">hinhpr</span> ( <span class="id" title="var">finstructonempty2</span> <span class="id" title="keyword">is</span> ) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isfiniteunit</span> : <span class="id" title="var">isfinite</span> <span class="id" title="var">unit</span> := <span class="id" title="var">hinhpr</span> <span class="id" title="var">finstructonunit</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isfinitecontr</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="keyword">is</span> : <span class="id" title="var">iscontr</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">isfinite</span> <span class="id" title="var">X</span> := <span class="id" title="var">hinhpr</span> ( <span class="id" title="var">finstructoncontr</span> <span class="id" title="keyword">is</span> ) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isfinitebool</span> : <span class="id" title="var">isfinite</span> <span class="id" title="var">bool</span> := <span class="id" title="var">hinhpr</span> <span class="id" title="var">finstructonbool</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isfinitecoprodwithunit</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="var">sx</span> : <span class="id" title="var">isfinite</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">isfinite</span> ( <span class="id" title="var">coprod</span> <span class="id" title="var">X</span> <span class="id" title="var">unit</span> ) :=  <span class="id" title="var">hinhfun</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">sx0</span> : <span class="id" title="var">_</span>, <span class="id" title="var">finstructoncoprodwithunit</span> <span class="id" title="var">sx0</span> ) <span class="id" title="var">sx</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isfinitecompl</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="var">x</span> : <span class="id" title="var">X</span> ) ( <span class="id" title="var">sx</span> : <span class="id" title="var">isfinite</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">isfinite</span> ( <span class="id" title="var">compl</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span> ) := <span class="id" title="var">hinhfun</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">sx0</span> : <span class="id" title="var">_</span>, <span class="id" title="var">finstructoncompl</span> <span class="id" title="var">x</span> <span class="id" title="var">sx0</span> ) <span class="id" title="var">sx</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isfinitecoprod</span> { <span class="id" title="var">X</span>  <span class="id" title="var">Y</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="var">sx</span> : <span class="id" title="var">isfinite</span> <span class="id" title="var">X</span> ) ( <span class="id" title="var">sy</span> : <span class="id" title="var">isfinite</span> <span class="id" title="var">Y</span> ) : <span class="id" title="var">isfinite</span> ( <span class="id" title="var">coprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> ) := <span class="id" title="var">hinhfun2</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">sx0</span> : <span class="id" title="var">_</span>, <span class="id" title="var">λ</span> <span class="id" title="var">sy0</span> : <span class="id" title="var">_</span>, <span class="id" title="var">finstructoncoprod</span> <span class="id" title="var">sx0</span> <span class="id" title="var">sy0</span> ) <span class="id" title="var">sx</span> <span class="id" title="var">sy</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isfinitetotal2</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="var">P</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">UU</span> ) ( <span class="id" title="var">sx</span> : <span class="id" title="var">isfinite</span> <span class="id" title="var">X</span> ) ( <span class="id" title="var">fs</span> : ∏ <span class="id" title="var">x</span> : <span class="id" title="var">X</span> , <span class="id" title="var">isfinite</span> ( <span class="id" title="var">P</span> <span class="id" title="var">x</span> ) ) : <span class="id" title="var">isfinite</span> ( <span class="id" title="var">total2</span> <span class="id" title="var">P</span> ) .<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">. <span class="id" title="tactic">intros</span> . <span class="id" title="tactic">set</span> ( <span class="id" title="var">fs'</span> := <span class="id" title="var">ischoicebasefiniteset</span> <span class="id" title="var">sx</span> <span class="id" title="var">_</span> <span class="id" title="var">fs</span> ) . <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hinhfun2</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">fx0</span> : ∏ <span class="id" title="var">x</span> : <span class="id" title="var">X</span> , <span class="id" title="var">finstruct</span> ( <span class="id" title="var">P</span> <span class="id" title="var">x</span> )  =&gt; <span class="id" title="var">λ</span> <span class="id" title="var">sx0</span> : <span class="id" title="var">_</span>, <span class="id" title="var">finstructontotal2</span> <span class="id" title="var">P</span> <span class="id" title="var">sx0</span> <span class="id" title="var">fx0</span> ) <span class="id" title="var">fs'</span> <span class="id" title="var">sx</span> ) . </div>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">FiniteSetSum</span> {<span class="id" title="var">I</span>:<span class="id" title="var">FiniteSet</span>} (<span class="id" title="var">X</span> : <span class="id" title="var">I</span> -&gt; <span class="id" title="var">FiniteSet</span>) : <span class="id" title="var">FiniteSet</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exists</span> (∑ <span class="id" title="var">i</span>, <span class="id" title="var">X</span> <span class="id" title="var">i</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isfinitetotal2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">I</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">X</span> <span class="id" title="var">i</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Delimit</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">finset</span> <span class="id" title="keyword">with</span> <span class="id" title="var">finset</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;'∑' x .. y , P" := (<span class="id" title="var">FiniteSetSum</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>,.. (<span class="id" title="var">FiniteSetSum</span> (<span class="id" title="var">λ</span> <span class="id" title="var">y</span>, <span class="id" title="var">P</span>))..))<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 200, <span class="id" title="var">x</span> <span class="id" title="var">binder</span>, <span class="id" title="var">y</span> <span class="id" title="var">binder</span>, <span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>) : <span class="id" title="var">finset</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isfinitedirprod</span> { <span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="var">sx</span> : <span class="id" title="var">isfinite</span> <span class="id" title="var">X</span> ) ( <span class="id" title="var">sy</span> : <span class="id" title="var">isfinite</span> <span class="id" title="var">Y</span> ) : <span class="id" title="var">isfinite</span> ( <span class="id" title="var">dirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> ) := <span class="id" title="var">hinhfun2</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">sx0</span> : <span class="id" title="var">_</span>, <span class="id" title="var">λ</span> <span class="id" title="var">sy0</span> : <span class="id" title="var">_</span>, <span class="id" title="var">finstructondirprod</span> <span class="id" title="var">sx0</span> <span class="id" title="var">sy0</span> ) <span class="id" title="var">sx</span> <span class="id" title="var">sy</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isfinitedecsubset</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">bool</span> ) ( <span class="id" title="var">sx</span> : <span class="id" title="var">isfinite</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">isfinite</span> ( <span class="id" title="var">hfiber</span> <span class="id" title="var">f</span> <span class="id" title="var">true</span> ) := <span class="id" title="var">hinhfun</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">sx0</span> : <span class="id" title="var">_</span>,  <span class="id" title="var">finstructondecsubset</span> <span class="id" title="var">f</span> <span class="id" title="var">sx0</span> ) <span class="id" title="var">sx</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isfinitefun</span> { <span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="var">sx</span> : <span class="id" title="var">isfinite</span> <span class="id" title="var">X</span> ) ( <span class="id" title="var">sy</span> : <span class="id" title="var">isfinite</span> <span class="id" title="var">Y</span> ) : <span class="id" title="var">isfinite</span> ( <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Y</span> ) := <span class="id" title="var">hinhfun2</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">sx0</span> : <span class="id" title="var">_</span>, <span class="id" title="var">λ</span> <span class="id" title="var">sy0</span> : <span class="id" title="var">_</span>, <span class="id" title="var">finstructonfun</span> <span class="id" title="var">sx0</span> <span class="id" title="var">sy0</span> ) <span class="id" title="var">sx</span> <span class="id" title="var">sy</span> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isfiniteforall</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="var">P</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">UU</span> ) ( <span class="id" title="var">sx</span> : <span class="id" title="var">isfinite</span> <span class="id" title="var">X</span> ) ( <span class="id" title="var">fs</span> : ∏ <span class="id" title="var">x</span> : <span class="id" title="var">X</span> , <span class="id" title="var">isfinite</span> ( <span class="id" title="var">P</span> <span class="id" title="var">x</span> ) ) : <span class="id" title="var">isfinite</span> ( ∏ <span class="id" title="var">x</span> : <span class="id" title="var">X</span> , <span class="id" title="var">P</span> <span class="id" title="var">x</span> ) .<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">. <span class="id" title="tactic">intros</span> . <span class="id" title="tactic">set</span> ( <span class="id" title="var">fs'</span> := <span class="id" title="var">ischoicebasefiniteset</span> <span class="id" title="var">sx</span> <span class="id" title="var">_</span> <span class="id" title="var">fs</span> ) . <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hinhfun2</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">fx0</span> : ∏ <span class="id" title="var">x</span> : <span class="id" title="var">X</span> , <span class="id" title="var">finstruct</span> ( <span class="id" title="var">P</span> <span class="id" title="var">x</span> )  =&gt; <span class="id" title="var">λ</span> <span class="id" title="var">sx0</span> : <span class="id" title="var">_</span>, <span class="id" title="var">finstructonforall</span> <span class="id" title="var">P</span> <span class="id" title="var">sx0</span> <span class="id" title="var">fx0</span> ) <span class="id" title="var">fs'</span> <span class="id" title="var">sx</span> ) . </div>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isfiniteweq</span> { <span class="id" title="var">X</span> : <span class="id" title="var">UU</span> } ( <span class="id" title="var">sx</span> : <span class="id" title="var">isfinite</span> <span class="id" title="var">X</span> ) : <span class="id" title="var">isfinite</span> ( <span class="id" title="var">X</span> ≃ <span class="id" title="var">X</span> ) := <span class="id" title="var">hinhfun</span> ( <span class="id" title="var">λ</span> <span class="id" title="var">sx0</span> : <span class="id" title="var">_</span>,  <span class="id" title="var">finstructonweq</span> <span class="id" title="var">sx0</span> ) <span class="id" title="var">sx</span> .<br/>

<br/>

<br/>

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isfinite_to_DecidableEquality</span> {<span class="id" title="var">X</span>} : <span class="id" title="var">isfinite</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">DecidableRelation</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">fin</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (@<span class="id" title="var">isdecprop_to_DecidableProposition</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">x</span>=<span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">isdecpropif</span> (<span class="id" title="var">x</span>=<span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">isfinite_isaset</span> <span class="id" title="var">X</span> <span class="id" title="var">fin</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">isfinite_isdeceq</span> <span class="id" title="var">X</span> <span class="id" title="var">fin</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>))).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">subsetFiniteness</span> {<span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isfinite</span> <span class="id" title="var">X</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">DecidableSubtype</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isfinite</span> (<span class="id" title="var">decidableSubtypeCarrier</span> <span class="id" title="var">P</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">fin</span> : <span class="id" title="var">isfinite</span> (<span class="id" title="var">decidableSubtypeCarrier'</span> <span class="id" title="var">P</span>)).<br/>
&nbsp;&nbsp;{ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">isfinitedecsubset</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">isfiniteweqf</span> <span class="id" title="var">_</span> <span class="id" title="var">fin</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">decidableSubtypeCarrier_weq</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">subsetFiniteSet</span> {<span class="id" title="var">X</span>:<span class="id" title="var">FiniteSet</span>} (<span class="id" title="var">P</span>:<span class="id" title="var">DecidableSubtype</span> <span class="id" title="var">X</span>) : <span class="id" title="var">FiniteSet</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">exact</span> (<span class="id" title="var">isfinite_to_FiniteSet</span> (<span class="id" title="var">subsetFiniteness</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>) <span class="id" title="var">P</span>)). </div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fincard_subset</span> {<span class="id" title="var">X</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">isfinite</span> <span class="id" title="var">X</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">DecidableSubtype</span> <span class="id" title="var">X</span>) : <span class="id" title="var">nat</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">exact</span> (<span class="id" title="var">fincard</span> (<span class="id" title="var">subsetFiniteness</span> <span class="id" title="keyword">is</span> <span class="id" title="var">P</span>)). </div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fincard_standardSubset</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">P</span> : <span class="id" title="var">DecidableSubtype</span> (<span class="id" title="var">stn</span> <span class="id" title="var">n</span>)) : <span class="id" title="var">nat</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">fincard</span> (<span class="id" title="var">subsetFiniteness</span> (<span class="id" title="var">isfinitestn</span> <span class="id" title="var">n</span>) <span class="id" title="var">P</span>)). </div>

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">bound01</span> (<span class="id" title="var">P</span>:<span class="id" title="var">DecidableProposition</span>) : ((<span class="id" title="var">choice</span> <span class="id" title="var">P</span> 1 0) ≤ 1)%<span class="id" title="var">nat</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">choice</span>. <span class="id" title="var">choose</span> <span class="id" title="var">P</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">tallyStandardSubset</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">P</span>: <span class="id" title="var">DecidableSubtype</span> (<span class="id" title="var">stn</span> <span class="id" title="var">n</span>)) : <span class="id" title="var">stn</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">stnsum</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">choice</span> (<span class="id" title="var">P</span> <span class="id" title="var">x</span>) 1 0)). <span class="id" title="tactic">apply</span> <span class="id" title="var">natlehtolthsn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">istransnatleh</span> (<span class="id" title="var">m</span> := <span class="id" title="var">stnsum</span>(<span class="id" title="var">λ</span> <span class="id" title="var">_</span> : <span class="id" title="var">stn</span> <span class="id" title="var">n</span>, 1))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">stnsum_le</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">bound01</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">p</span> : ∏ <span class="id" title="var">r</span> <span class="id" title="var">s</span>, <span class="id" title="var">r</span> = <span class="id" title="var">s</span> -&gt; (<span class="id" title="var">r</span> ≤ <span class="id" title="var">s</span>)%<span class="id" title="var">nat</span>). { <span class="id" title="tactic">intros</span> ? ? <span class="id" title="var">e</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">isreflnatleh</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">stnsum_1</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">tallyStandardSubsetSegment</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">P</span>: <span class="id" title="var">DecidableSubtype</span> (<span class="id" title="var">stn</span> <span class="id" title="var">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">i</span>:<span class="id" title="var">stn</span> <span class="id" title="var">n</span>) : <span class="id" title="var">stn</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">k</span> := <span class="id" title="var">tallyStandardSubset</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">j</span>:<span class="id" title="var">stn</span> <span class="id" title="var">i</span>, <span class="id" title="var">P</span> (<span class="id" title="var">stnmtostnn</span> <span class="id" title="var">i</span> <span class="id" title="var">n</span> (<span class="id" title="var">natlthtoleh</span> <span class="id" title="var">i</span> <span class="id" title="var">n</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">i</span>)) <span class="id" title="var">j</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">stnmtostnn</span> (<span class="id" title="var">S</span> <span class="id" title="var">i</span>) <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">natlthtolehsn</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">i</span>). }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">k</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>