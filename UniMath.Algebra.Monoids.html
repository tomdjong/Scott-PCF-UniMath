<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
	<script src="https://code.jquery.com/jquery-1.11.0.min.js" type="text/javascript"></script>
	<script src="./proofs-toggle.js" type="text/javascript"></script>
	<style>
		div.proofcomment {
			font-style: italic;
		}
	</style>
	<title>Documentation</title>
</head>
<body>
<div id="page">
<div id="main">
<h1 class="libtitle">Library UniMath.Algebra.Monoids</h1>

<div class="code">
</div>

<div class="doc">
<a name="lab419"></a><h1 class="section">Algebra I. Part B.  Monoids, abelian monoids. Vladimir Voevodsky. Aug. 2011 - .</h1>

<div class="paragraph"> </div>

<a name="lab420"></a><h2 class="section">Contents</h2>


<div class="paragraph"> </div>

<ul class="doclist">
<li> Monoids
<ul class="doclist">
<li> Basics definitions

</li>
<li> Univalence for monoids

</li>
<li> Functions between monoids compatible with structures (homomorphisms)
    and their properties

</li>
<li> Subobjects

</li>
<li> Kernels

</li>
<li> Quotient objects

</li>
<li> Cosets

</li>
<li> Direct products

</li>
</ul>

</li>
<li> Abelian (commutative) monoids
<ul class="doclist">
<li> Basic definitions

</li>
<li> Univalence for abelian monoids

</li>
<li> Subobjects

</li>
<li> Quotient objects

</li>
<li> Direct products

</li>
<li> Monoid of fractions of an abelian monoid

</li>
<li> Canonical homomorphism to the monoid of fractions

</li>
<li> Abelian monoid of fractions in the case when elements of the
    localization submonoid are cancelable

</li>
<li> Relations on the abelian monoid of fractions

</li>
<li> Relations and canonical homomorphism to <span class="inlinecode"><span class="id" title="var">abmonoidfrac</span></span>

</li>
</ul>

</li>
</ul>

<div class="paragraph"> </div>

 For some examples, see <span class="inlinecode"><span class="id" title="var">UniMath.NumberSystems.NaturalNumbersAlgebra</span></span> 
<div class="paragraph"> </div>

<a name="lab421"></a><h2 class="section">Preamble</h2>

<div class="paragraph"> </div>

 Settings 
<div class="paragraph"> </div>

 The following line has to be removed for the file to compile with Coq8.2 
</div>
<div class="code">
<span class="id" title="keyword">Unset</span> <span class="id" title="var">Kernel</span> <span class="id" title="var">Term</span> <span class="id" title="var">Sharing</span>.<br/>

<br/>
</div>

<div class="doc">
Imports 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">UniMath.Algebra.BinaryOperations</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.MoreFoundations.All</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab422"></a><h2 class="section">Standard Algebraic Structures</h2>

<div class="paragraph"> </div>

<a name="lab423"></a><h3 class="section">Monoids</h3>

<div class="paragraph"> </div>

<a name="lab424"></a><h4 class="section">Basic definitions</h4>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoid</span> : <span class="id" title="var">UU</span> := <span class="id" title="var">total2</span> (<span class="id" title="var">λ</span> <span class="id" title="var">X</span> : <span class="id" title="var">setwithbinop</span>, <span class="id" title="var">ismonoidop</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoidpair</span> :<br/>
&nbsp;&nbsp;∏ (<span class="id" title="var">t</span> : <span class="id" title="var">setwithbinop</span>), (<span class="id" title="var">λ</span> <span class="id" title="var">X</span> : <span class="id" title="var">setwithbinop</span>, <span class="id" title="var">ismonoidop</span> <span class="id" title="var">op</span>) <span class="id" title="var">t</span> → ∑ <span class="id" title="var">X</span> : <span class="id" title="var">setwithbinop</span>, <span class="id" title="var">ismonoidop</span> <span class="id" title="var">op</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">tpair</span> (<span class="id" title="var">λ</span> <span class="id" title="var">X</span> : <span class="id" title="var">setwithbinop</span>, <span class="id" title="var">ismonoidop</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pr1monoid</span> : <span class="id" title="var">monoid</span> -&gt; <span class="id" title="var">setwithbinop</span> := @<span class="id" title="var">pr1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">pr1monoid</span> : <span class="id" title="var">monoid</span> &gt;-&gt; <span class="id" title="var">setwithbinop</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">assocax</span> (<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">isassoc</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>) := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">X</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">lunax</span> (<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">islunit</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>) (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>) := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>))).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">runax</span> (<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">isrunit</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>) (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>) := <span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>))).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unax</span> (<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">isunit</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>) (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>) := <span class="id" title="var">dirprodpair</span> (<span class="id" title="var">lunax</span> <span class="id" title="var">X</span>) (<span class="id" title="var">runax</span> <span class="id" title="var">X</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isasetmonoid</span> (<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">isaset</span> <span class="id" title="var">X</span> := <span class="id" title="var">pr2</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">X</span>)).<br/>

<br/>
<span class="id" title="keyword">Delimit</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">addmonoid_scope</span> <span class="id" title="keyword">with</span> <span class="id" title="var">addmonoid</span>.<br/>
<span class="id" title="keyword">Delimit</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">multmonoid_scope</span> <span class="id" title="keyword">with</span> <span class="id" title="var">multmonoid</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;x * y" := (<span class="id" title="var">op</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) : <span class="id" title="var">multmonoid_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;1" := (<span class="id" title="var">unel</span> <span class="id" title="var">_</span>) : <span class="id" title="var">multmonoid_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">AddNotation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> &quot;x + y" := (<span class="id" title="var">op</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) : <span class="id" title="var">addmonoid_scope</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> &quot;0" := (<span class="id" title="var">unel</span> <span class="id" title="var">_</span>) : <span class="id" title="var">addmonoid_scope</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">AddNotation</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab425"></a><h4 class="section">Construction of the trivial monoid consisting of one element given by unit.</h4>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unitmonoid_ismonoid</span> : <span class="id" title="var">ismonoidop</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">unitset</span>, <span class="id" title="var">λ</span> <span class="id" title="var">y</span> : <span class="id" title="var">unitset</span>, <span class="id" title="var">x</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">mk_ismonoidop</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">x''</span>. <span class="id" title="var">use</span> <span class="id" title="var">isProofIrrelevantUnit</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">isunitalpair</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> <span class="id" title="var">tt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">use</span> <span class="id" title="var">isunitpair</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="var">use</span> <span class="id" title="var">isProofIrrelevantUnit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="var">use</span> <span class="id" title="var">isProofIrrelevantUnit</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unitmonoid</span> : <span class="id" title="var">monoid</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">monoidpair</span> (<span class="id" title="var">setwithbinoppair</span> <span class="id" title="var">unitset</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">unitset</span>, <span class="id" title="var">λ</span> <span class="id" title="var">y</span> : <span class="id" title="var">unitset</span>, <span class="id" title="var">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unitmonoid_ismonoid</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab426"></a><h4 class="section">Functions between monoids compatible with structure (homomorphisms) and their properties</h4>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ismonoidfun</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Y</span>) : <span class="id" title="var">UU</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">dirprod</span> (<span class="id" title="var">isbinopfun</span> <span class="id" title="var">f</span>) (<span class="id" title="var">f</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>) = (<span class="id" title="var">unel</span> <span class="id" title="var">Y</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">mk_ismonoidfun</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>} {<span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Y</span>} (<span class="id" title="var">H1</span> : <span class="id" title="var">isbinopfun</span> <span class="id" title="var">f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">H2</span> : <span class="id" title="var">f</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>) = <span class="id" title="var">unel</span> <span class="id" title="var">Y</span>) : <span class="id" title="var">ismonoidfun</span> <span class="id" title="var">f</span> := <span class="id" title="var">dirprodpair</span> <span class="id" title="var">H1</span> <span class="id" title="var">H2</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ismonoidfunisbinopfun</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>} {<span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Y</span>} (<span class="id" title="var">H</span> : <span class="id" title="var">ismonoidfun</span> <span class="id" title="var">f</span>) : <span class="id" title="var">isbinopfun</span> <span class="id" title="var">f</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">dirprod_pr1</span> <span class="id" title="var">H</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ismonoidfununel</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>} {<span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Y</span>} (<span class="id" title="var">H</span> : <span class="id" title="var">ismonoidfun</span> <span class="id" title="var">f</span>) : <span class="id" title="var">f</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>) = <span class="id" title="var">unel</span> <span class="id" title="var">Y</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">dirprod_pr2</span> <span class="id" title="var">H</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isapropismonoidfun</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Y</span>) : <span class="id" title="var">isaprop</span> (<span class="id" title="var">ismonoidfun</span> <span class="id" title="var">f</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isofhleveldirprod</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isapropisbinopfun</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">setproperty</span> <span class="id" title="var">Y</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoidfun</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">UU</span> := <span class="id" title="var">total2</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Y</span> =&gt; <span class="id" title="var">ismonoidfun</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoidfunconstr</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>} {<span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Y</span>} (<span class="id" title="keyword">is</span> : <span class="id" title="var">ismonoidfun</span> <span class="id" title="var">f</span>) : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">tpair</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> <span class="id" title="keyword">is</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pr1monoidfun</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> -&gt; (<span class="id" title="var">X</span> -&gt; <span class="id" title="var">Y</span>) := @<span class="id" title="var">pr1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoidfuntobinopfun</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> -&gt; <span class="id" title="var">binopfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">λ</span> <span class="id" title="var">f</span>, <span class="id" title="var">binopfunpair</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">f</span>) (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">f</span>)).<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">monoidfuntobinopfun</span> : <span class="id" title="var">monoidfun</span> &gt;-&gt; <span class="id" title="var">binopfun</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoidfununel</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) : <span class="id" title="var">f</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>) = (<span class="id" title="var">unel</span> <span class="id" title="var">Y</span>) := <span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoidfunmul</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) (<span class="id" title="var">x</span> <span class="id" title="var">x'</span> : <span class="id" title="var">X</span>) : <span class="id" title="var">f</span> (<span class="id" title="var">op</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>) = <span class="id" title="var">op</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) (<span class="id" title="var">f</span> <span class="id" title="var">x'</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">f</span>) <span class="id" title="var">x</span> <span class="id" title="var">x'</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoidfun_paths</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) (<span class="id" title="var">e</span> : <span class="id" title="var">pr1</span> <span class="id" title="var">f</span> = <span class="id" title="var">pr1</span> <span class="id" title="var">g</span>) : <span class="id" title="var">f</span> = <span class="id" title="var">g</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">total2_paths_f</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">proofirrelevance</span>. <span class="id" title="var">use</span> <span class="id" title="var">isapropismonoidfun</span>.<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">monoidfun_paths</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isasetmonoidfun</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">isaset</span> (<span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isasetsubset</span> (<span class="id" title="var">pr1monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">change</span> (<span class="id" title="var">isofhlevel</span> 2 (<span class="id" title="var">X</span> -&gt; <span class="id" title="var">Y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>. <span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">setproperty</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">refine</span> (<span class="id" title="var">isinclpr1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isapropismonoidfun</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ismonoidfuncomp</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">Z</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">Y</span> <span class="id" title="var">Z</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">ismonoidfun</span> (<span class="id" title="var">funcomp</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">f</span>) (<span class="id" title="var">pr1</span> <span class="id" title="var">g</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">isbinopfuncomp</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">funcomp</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">f</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">g</span>)).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">ismonoidfuncomp</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoidfuncomp</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">Z</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">Y</span> <span class="id" title="var">Z</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Z</span> := <span class="id" title="var">monoidfunconstr</span> (<span class="id" title="var">ismonoidfuncomp</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">monoidfunassoc</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">Z</span> <span class="id" title="var">W</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">Y</span> <span class="id" title="var">Z</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">h</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">Z</span> <span class="id" title="var">W</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">monoidfuncomp</span> <span class="id" title="var">f</span> (<span class="id" title="var">monoidfuncomp</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span>) = <span class="id" title="var">monoidfuncomp</span> (<span class="id" title="var">monoidfuncomp</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>) <span class="id" title="var">h</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">monoidfun_paths</span>. <span class="id" title="var">use</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">unelmonoidfun_ismonoidfun</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">ismonoidfun</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, (<span class="id" title="var">unel</span> <span class="id" title="var">Y</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">mk_ismonoidfun</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">mk_isbinopfun</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>. <span class="id" title="var">use</span> <span class="id" title="var">pathsinv0</span>. <span class="id" title="var">use</span> <span class="id" title="var">lunax</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unelmonoidfun</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">monoidfunconstr</span> (<span class="id" title="var">unelmonoidfun_ismonoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">monoidfuntounit_ismonoidfun</span> (<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">ismonoidfun</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, (<span class="id" title="var">unel</span> <span class="id" title="var">unitmonoid</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">mk_ismonoidfun</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">mk_isbinopfun</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>. <span class="id" title="var">use</span> <span class="id" title="var">isProofIrrelevantUnit</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">isProofIrrelevantUnit</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoidfuntounit</span> (<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">unitmonoid</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">monoidfunconstr</span> (<span class="id" title="var">monoidfuntounit_ismonoidfun</span> <span class="id" title="var">X</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">monoidfunfromunit_ismonoidfun</span> (<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">ismonoidfun</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">unitmonoid</span>, (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">mk_ismonoidfun</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">mk_isbinopfun</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>. <span class="id" title="var">use</span> <span class="id" title="var">pathsinv0</span>. <span class="id" title="var">use</span> (<span class="id" title="var">runax</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoidfunfromunit</span> (<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">monoidfun</span> <span class="id" title="var">unitmonoid</span> <span class="id" title="var">X</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">monoidfunconstr</span> (<span class="id" title="var">monoidfunfromunit_ismonoidfun</span> <span class="id" title="var">X</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoidmono</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">UU</span> := <span class="id" title="var">total2</span> (<span class="id" title="var">λ</span> <span class="id" title="var">f</span> : <span class="id" title="var">incl</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>, <span class="id" title="var">ismonoidfun</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoidmonopair</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">incl</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) (<span class="id" title="keyword">is</span> : <span class="id" title="var">ismonoidfun</span> <span class="id" title="var">f</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">monoidmono</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> := <span class="id" title="var">tpair</span> <span class="id" title="var">_</span>  <span class="id" title="var">f</span> <span class="id" title="keyword">is</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pr1monoidmono</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">monoidmono</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> -&gt; <span class="id" title="var">incl</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> := @<span class="id" title="var">pr1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">pr1monoidmono</span> : <span class="id" title="var">monoidmono</span> &gt;-&gt; <span class="id" title="var">incl</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoidincltomonoidfun</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">monoidmono</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> -&gt; <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> := <span class="id" title="var">λ</span> <span class="id" title="var">f</span>, <span class="id" title="var">monoidfunconstr</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">monoidincltomonoidfun</span> : <span class="id" title="var">monoidmono</span> &gt;-&gt; <span class="id" title="var">monoidfun</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoidmonotobinopmono</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">monoidmono</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> -&gt; <span class="id" title="var">binopmono</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">λ</span> <span class="id" title="var">f</span>, <span class="id" title="var">binopmonopair</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">f</span>) (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">f</span>)).<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">monoidmonotobinopmono</span> : <span class="id" title="var">monoidmono</span> &gt;-&gt; <span class="id" title="var">binopmono</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoidmonocomp</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">Z</span> : <span class="id" title="var">monoid</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> : <span class="id" title="var">monoidmono</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">monoidmono</span> <span class="id" title="var">Y</span> <span class="id" title="var">Z</span>) : <span class="id" title="var">monoidmono</span> <span class="id" title="var">X</span> <span class="id" title="var">Z</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">monoidmonopair</span> (<span class="id" title="var">inclcomp</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">f</span>) (<span class="id" title="var">pr1</span> <span class="id" title="var">g</span>)) (<span class="id" title="var">ismonoidfuncomp</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoidiso</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">UU</span> := <span class="id" title="var">total2</span> (<span class="id" title="var">λ</span> <span class="id" title="var">f</span> : <span class="id" title="var">X</span> ≃ <span class="id" title="var">Y</span>, <span class="id" title="var">ismonoidfun</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoidisopair</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">X</span> ≃ <span class="id" title="var">Y</span>) (<span class="id" title="keyword">is</span> : <span class="id" title="var">ismonoidfun</span> <span class="id" title="var">f</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">monoidiso</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> := <span class="id" title="var">tpair</span> <span class="id" title="var">_</span>  <span class="id" title="var">f</span> <span class="id" title="keyword">is</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pr1monoidiso</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">monoidiso</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> -&gt; <span class="id" title="var">X</span> ≃ <span class="id" title="var">Y</span> := @<span class="id" title="var">pr1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">pr1monoidiso</span> : <span class="id" title="var">monoidiso</span> &gt;-&gt; <span class="id" title="var">weq</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoidisotomonoidmono</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">monoidiso</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> -&gt; <span class="id" title="var">monoidmono</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">λ</span> <span class="id" title="var">f</span>, <span class="id" title="var">monoidmonopair</span> (<span class="id" title="var">weqtoincl</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">f</span>)) (<span class="id" title="var">pr2</span> <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">monoidisotomonoidmono</span> : <span class="id" title="var">monoidiso</span> &gt;-&gt; <span class="id" title="var">monoidmono</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoidisotobinopiso</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">monoidiso</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> -&gt; <span class="id" title="var">binopiso</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">λ</span> <span class="id" title="var">f</span>, <span class="id" title="var">binopisopair</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">f</span>) (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">f</span>)).<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">monoidisotobinopiso</span> : <span class="id" title="var">monoidiso</span> &gt;-&gt; <span class="id" title="var">binopiso</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoidiso_paths</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">monoidiso</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) (<span class="id" title="var">e</span> : <span class="id" title="var">pr1</span> <span class="id" title="var">f</span> = <span class="id" title="var">pr1</span> <span class="id" title="var">g</span>) : <span class="id" title="var">f</span> = <span class="id" title="var">g</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">total2_paths_f</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">proofirrelevance</span>. <span class="id" title="var">use</span> <span class="id" title="var">isapropismonoidfun</span>.<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">monoidiso_paths</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ismonoidfuninvmap</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidiso</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">ismonoidfun</span> (<span class="id" title="var">invmap</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">f</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">isbinopfuninvmap</span> <span class="id" title="var">f</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">invmaponpathsweq</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">f</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">homotweqinvweq</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">f</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pathsinv0</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">f</span>))).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">ismonoidfuninvmap</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">invmonoidiso</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidiso</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) : <span class="id" title="var">monoidiso</span> <span class="id" title="var">Y</span> <span class="id" title="var">X</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">monoidisopair</span> (<span class="id" title="var">invweq</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">f</span>)) (<span class="id" title="var">ismonoidfuninvmap</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">idmonoidiso</span> (<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">monoidiso</span> <span class="id" title="var">X</span> <span class="id" title="var">X</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">monoidisopair</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">idweq</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">dirprodpair</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>. <span class="id" title="var">use</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">use</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">monoidfunidleft</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) : <span class="id" title="var">monoidfuncomp</span> (<span class="id" title="var">idmonoidiso</span> <span class="id" title="var">A</span>) <span class="id" title="var">f</span> = <span class="id" title="var">f</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">monoidfun_paths</span>. <span class="id" title="var">use</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">monoidfunidright</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) : <span class="id" title="var">monoidfuncomp</span> <span class="id" title="var">f</span> (<span class="id" title="var">idmonoidiso</span> <span class="id" title="var">B</span>) = <span class="id" title="var">f</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">monoidfun_paths</span>. <span class="id" title="var">use</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab427"></a><h4 class="section">(X = Y) ≃ (monoidiso X Y)</h4>

   The idea here is to use the following composition

<div class="paragraph"> </div>

                           (X = Y) ≃ (X ╝ Y)
                                   ≃ (monoidiso' X Y)
                                   ≃ (monoidiso X Y).

<div class="paragraph"> </div>

   The reason why we use monoidiso' is that then we can use univalence for sets with binops,
   <span class="inlinecode"><span class="id" title="var">setwithbinop_univalence</span></span>. See <span class="inlinecode"><span class="id" title="var">monoid_univalence_weq2</span></span>.
 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">monoidiso'</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">UU</span> :=<br/>
&nbsp;&nbsp;∑ <span class="id" title="var">g</span> : (∑ <span class="id" title="var">f</span> : <span class="id" title="var">X</span> ≃ <span class="id" title="var">Y</span>, <span class="id" title="var">isbinopfun</span> <span class="id" title="var">f</span>), (<span class="id" title="var">pr1</span> <span class="id" title="var">g</span>) (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>) = <span class="id" title="var">unel</span> <span class="id" title="var">Y</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoid_univalence_weq1</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>) : (<span class="id" title="var">X</span> = <span class="id" title="var">Y</span>) ≃ (<span class="id" title="var">X</span> ╝ <span class="id" title="var">Y</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">total2_paths_equiv</span> <span class="id" title="var">_</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoid_univalence_weq2</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>) : (<span class="id" title="var">X</span> ╝ <span class="id" title="var">Y</span>) ≃ (<span class="id" title="var">monoidiso'</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">weqbandf</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">setwithbinop_univalence</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">e</span>. <span class="id" title="var">cbn</span>. <span class="id" title="var">use</span> <span class="id" title="var">invweq</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">X</span> <span class="id" title="var">Xop</span>]. <span class="id" title="tactic">induction</span> <span class="id" title="var">Y</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Y</span> <span class="id" title="var">Yop</span>]. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>. <span class="id" title="var">use</span> <span class="id" title="var">weqimplimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>. <span class="id" title="var">use</span> <span class="id" title="var">proofirrelevance</span>. <span class="id" title="var">use</span> <span class="id" title="var">isapropismonoidop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">i</span>. <span class="id" title="var">use</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">use</span> <span class="id" title="var">setproperty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">use</span> <span class="id" title="var">isapropifcontr</span>. <span class="id" title="tactic">exact</span> (@<span class="id" title="var">isapropismonoidop</span> <span class="id" title="var">X</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>) <span class="id" title="var">Xop</span> <span class="id" title="var">Yop</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">monoid_univalence_weq2</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoid_univalence_weq3</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>) : (<span class="id" title="var">monoidiso'</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) ≃ (<span class="id" title="var">monoidiso</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">weqtotal2asstor</span> (<span class="id" title="var">λ</span> <span class="id" title="var">w</span> : <span class="id" title="var">X</span> ≃ <span class="id" title="var">Y</span>, <span class="id" title="var">isbinopfun</span> <span class="id" title="var">w</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">y</span> : (∑ <span class="id" title="var">w</span> : <span class="id" title="var">weq</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>, <span class="id" title="var">isbinopfun</span> <span class="id" title="var">w</span>), (<span class="id" title="var">pr1</span> <span class="id" title="var">y</span>) (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>) = <span class="id" title="var">unel</span> <span class="id" title="var">Y</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoid_univalence_map</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">X</span> = <span class="id" title="var">Y</span> -&gt; <span class="id" title="var">monoidiso</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">idmonoidiso</span> <span class="id" title="var">X</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">monoid_univalence_isweq</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isweq</span> (<span class="id" title="var">monoid_univalence_map</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">isweqhomot</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">weqcomp</span> (<span class="id" title="var">monoid_univalence_weq1</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">weqcomp</span> (<span class="id" title="var">monoid_univalence_weq2</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) (<span class="id" title="var">monoid_univalence_weq3</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>))).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">pathscomp0</span> <span class="id" title="var">weqcomp_to_funcomp_app</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">weqcomp_to_funcomp_app</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">weqproperty</span>.<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">monoid_univalence_isweq</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoid_univalence</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>) : (<span class="id" title="var">X</span> = <span class="id" title="var">Y</span>) ≃ (<span class="id" title="var">monoidiso</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">weqpair</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">monoid_univalence_map</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">monoid_univalence_isweq</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">monoid_univalence</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab428"></a><h4 class="section">Subobjects</h4>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">issubmonoid</span> {<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">hsubtype</span> <span class="id" title="var">X</span>) : <span class="id" title="var">UU</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">dirprod</span> (<span class="id" title="var">issubsetwithbinop</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>) <span class="id" title="var">A</span>) (<span class="id" title="var">A</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">issubmonoidpair</span> {<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>} {<span class="id" title="var">A</span> : <span class="id" title="var">hsubtype</span> <span class="id" title="var">X</span>} (<span class="id" title="var">H1</span> : <span class="id" title="var">issubsetwithbinop</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>) <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">H2</span> : <span class="id" title="var">A</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>)) : <span class="id" title="var">issubmonoid</span> <span class="id" title="var">A</span> := <span class="id" title="var">dirprodpair</span> <span class="id" title="var">H1</span> <span class="id" title="var">H2</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isapropissubmonoid</span> {<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">hsubtype</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isaprop</span> (<span class="id" title="var">issubmonoid</span> <span class="id" title="var">A</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isofhleveldirprod</span> 1).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isapropissubsetwithbinop</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">A</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>))).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">submonoid</span> (<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">UU</span> := <span class="id" title="var">total2</span> (<span class="id" title="var">λ</span> <span class="id" title="var">A</span> : <span class="id" title="var">hsubtype</span> <span class="id" title="var">X</span>, <span class="id" title="var">issubmonoid</span> <span class="id" title="var">A</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">submonoidpair</span> {<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>} :<br/>
&nbsp;&nbsp;∏ (<span class="id" title="var">t</span> : <span class="id" title="var">hsubtype</span> <span class="id" title="var">X</span>), (<span class="id" title="var">λ</span> <span class="id" title="var">A</span> : <span class="id" title="var">hsubtype</span> <span class="id" title="var">X</span>, <span class="id" title="var">issubmonoid</span> <span class="id" title="var">A</span>) <span class="id" title="var">t</span> → ∑ <span class="id" title="var">A</span> : <span class="id" title="var">hsubtype</span> <span class="id" title="var">X</span>, <span class="id" title="var">issubmonoid</span> <span class="id" title="var">A</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">tpair</span> (<span class="id" title="var">λ</span> <span class="id" title="var">A</span> : <span class="id" title="var">hsubtype</span> <span class="id" title="var">X</span>, <span class="id" title="var">issubmonoid</span> <span class="id" title="var">A</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pr1submonoid</span> (<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">hsubtype</span> <span class="id" title="var">X</span> := @<span class="id" title="var">pr1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">totalsubmonoid</span> (<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">totalsubtype</span> <span class="id" title="var">X</span>). <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">tt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">tt</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">trivialsubmonoid</span> (<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>) : @<span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">x</span> = @<span class="id" title="var">unel</span> <span class="id" title="var">X</span>)%<span class="id" title="tactic">set</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">b</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">x</span> <span class="id" title="var">p</span>], <span class="id" title="var">c</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">y</span> <span class="id" title="var">q</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (!<span class="id" title="var">p</span>), (!<span class="id" title="var">q</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">lunax</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">submonoidtosubsetswithbinop</span> (<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span> -&gt; @<span class="id" title="var">subsetswithbinop</span> <span class="id" title="var">X</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">λ</span> <span class="id" title="var">A</span> : <span class="id" title="var">_</span>, <span class="id" title="var">subsetswithbinoppair</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">A</span>) (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">A</span>)).<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">submonoidtosubsetswithbinop</span> : <span class="id" title="var">submonoid</span> &gt;-&gt; <span class="id" title="var">subsetswithbinop</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ismonoidcarrier</span> {<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>) : <span class="id" title="var">ismonoidop</span> (@<span class="id" title="var">op</span> <span class="id" title="var">A</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">a'</span> <span class="id" title="var">a''</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">invmaponpathsincl</span> <span class="id" title="var">_</span> (<span class="id" title="var">isinclpr1carrier</span> <span class="id" title="var">A</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">assocax</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">carrierpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>) (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">A</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">invmaponpathsincl</span> <span class="id" title="var">_</span> (<span class="id" title="var">isinclpr1carrier</span> <span class="id" title="var">A</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">lunax</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">invmaponpathsincl</span> <span class="id" title="var">_</span> (<span class="id" title="var">isinclpr1carrier</span> <span class="id" title="var">A</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">runax</span> <span class="id" title="var">X</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">carrierofsubmonoid</span> {<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>) : <span class="id" title="var">monoid</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">A</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ismonoidcarrier</span>. </div>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">carrierofsubmonoid</span> : <span class="id" title="var">submonoid</span> &gt;-&gt; <span class="id" title="var">monoid</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">intersection_submonoid</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>} {<span class="id" title="var">I</span> : <span class="id" title="var">UU</span>} (<span class="id" title="var">S</span> : <span class="id" title="var">I</span> -&gt; <span class="id" title="var">hsubtype</span> <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">each_is_submonoid</span> : ∏ <span class="id" title="var">i</span> : <span class="id" title="var">I</span>, <span class="id" title="var">issubmonoid</span> (<span class="id" title="var">S</span> <span class="id" title="var">i</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">issubmonoid</span> (<span class="id" title="var">subtype_intersection</span> <span class="id" title="var">S</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">issubmonoidpair</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">is_subgr</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">each_is_submonoid</span> <span class="id" title="var">i</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">is_subgr</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">g</span>,, (<span class="id" title="var">pr2</span> <span class="id" title="var">g</span>) <span class="id" title="var">i</span>) (<span class="id" title="var">pr1</span> <span class="id" title="var">h</span>,, (<span class="id" title="var">pr2</span> <span class="id" title="var">h</span>) <span class="id" title="var">i</span>)).<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, <span class="id" title="var">pr2</span> (<span class="id" title="var">each_is_submonoid</span> <span class="id" title="var">i</span>)).<br/>
</div>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ismonoidfun_pr1</span> {<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>) : @<span class="id" title="var">ismonoidfun</span> <span class="id" title="var">A</span> <span class="id" title="var">X</span> <span class="id" title="var">pr1</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">mk_ismonoidfun</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">a'</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">submonoid_incl</span> {<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>) : <span class="id" title="var">monoidfun</span> <span class="id" title="var">A</span> <span class="id" title="var">X</span> :=<br/>
<span class="id" title="var">monoidfunconstr</span> (<span class="id" title="var">ismonoidfun_pr1</span> <span class="id" title="var">A</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab429"></a><h4 class="section">Kernels</h4>

<div class="paragraph"> </div>

 Kernels
    Let f : X → Y be a morphism of monoids. The kernel of f is
    the submonoid of X consisting of elements x such that <span class="inlinecode"><a class="idref" href="UniMath.Algebra.DCPO.html#leastupperbound.f"><span class="id" title="variable">f</span></a></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#x"><span class="id" title="variable">x</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">unel</span></span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#Y"><span class="id" title="variable">Y</span></a></span>.
 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoid_kernel_hsubtype</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) : <span class="id" title="var">hsubtype</span> <span class="id" title="var">A</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">hProppair</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">f</span> <span class="id" title="var">a</span> = <span class="id" title="var">unel</span> <span class="id" title="var">B</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
Kernel as a monoid 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">kernel_issubmonoid</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">issubmonoid</span> (<span class="id" title="var">monoid_kernel_hsubtype</span> <span class="id" title="var">f</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">issubmonoidpair</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">monoidfunmul</span> <span class="id" title="var">f</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">maponpaths</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">y</span>) @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">runax</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">monoidfununel</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">kernel_submonoid</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) : @<span class="id" title="var">submonoid</span> <span class="id" title="var">A</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">submonoidpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">kernel_issubmonoid</span> <span class="id" title="var">f</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab430"></a><h4 class="section">Quotient objects</h4>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isassocquot</span> {<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">binopeqrel</span> <span class="id" title="var">X</span>) : <span class="id" title="var">isassoc</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">setwithbinopquot</span> <span class="id" title="var">R</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">setquotuniv3prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">x''</span> : <span class="id" title="var">setwithbinopquot</span> <span class="id" title="var">R</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> (<span class="id" title="var">setproperty</span> (<span class="id" title="var">setwithbinopquot</span> <span class="id" title="var">R</span>) (<span class="id" title="var">op</span> (<span class="id" title="var">op</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>) <span class="id" title="var">x''</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">op</span> <span class="id" title="var">x</span> (<span class="id" title="var">op</span> <span class="id" title="var">x'</span> <span class="id" title="var">x''</span>))))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">x''</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">maponpaths</span> (<span class="id" title="var">setquotpr</span> <span class="id" title="var">R</span>) (<span class="id" title="var">assocax</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">x''</span>)).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">isassocquot</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isunitquot</span> {<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">binopeqrel</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isunit</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">setwithbinopquot</span> <span class="id" title="var">R</span>)) (<span class="id" title="var">setquotpr</span> <span class="id" title="var">R</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>)))).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">qun</span> := <span class="id" title="var">setquotpr</span> <span class="id" title="var">R</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>)))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">qsetwithop</span> := <span class="id" title="var">setwithbinopquot</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">setquotunivprop</span> <span class="id" title="var">R</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, @<span class="id" title="var">eqset</span> <span class="id" title="var">qsetwithop</span> ((@<span class="id" title="var">op</span> <span class="id" title="var">qsetwithop</span>) <span class="id" title="var">qun</span> <span class="id" title="var">x</span>) <span class="id" title="var">x</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">x0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">maponpaths</span> (<span class="id" title="var">setquotpr</span> <span class="id" title="var">R</span>) (<span class="id" title="var">lunax</span> <span class="id" title="var">X</span> <span class="id" title="var">x0</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">setquotunivprop</span> <span class="id" title="var">R</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, @<span class="id" title="var">eqset</span> <span class="id" title="var">qsetwithop</span> ((@<span class="id" title="var">op</span> <span class="id" title="var">qsetwithop</span>) <span class="id" title="var">x</span> <span class="id" title="var">qun</span>) <span class="id" title="var">x</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">x0</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">maponpaths</span> (<span class="id" title="var">setquotpr</span> <span class="id" title="var">R</span>) (<span class="id" title="var">runax</span> <span class="id" title="var">X</span> <span class="id" title="var">x0</span>)).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">isunitquot</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ismonoidquot</span> {<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">binopeqrel</span> <span class="id" title="var">X</span>) : <span class="id" title="var">ismonoidop</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">setwithbinopquot</span> <span class="id" title="var">R</span>)) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">tpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">isassocquot</span> <span class="id" title="var">R</span>) (<span class="id" title="var">tpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">setquotpr</span> <span class="id" title="var">R</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>)))) (<span class="id" title="var">isunitquot</span> <span class="id" title="var">R</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoidquot</span> {<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">binopeqrel</span> <span class="id" title="var">X</span>) : <span class="id" title="var">monoid</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">setwithbinopquot</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">ismonoidquot</span>. </div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ismonoidfun_setquotpr</span> {<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">binopeqrel</span> <span class="id" title="var">X</span>) : @<span class="id" title="var">ismonoidfun</span> <span class="id" title="var">X</span> (<span class="id" title="var">monoidquot</span> <span class="id" title="var">R</span>) (<span class="id" title="var">setquotpr</span> <span class="id" title="var">R</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">mk_ismonoidfun</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoidquotpr</span> {<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">binopeqrel</span> <span class="id" title="var">X</span>) : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> (<span class="id" title="var">monoidquot</span> <span class="id" title="var">R</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">monoidfunconstr</span> (<span class="id" title="var">ismonoidfun_setquotpr</span> <span class="id" title="var">R</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ismonoidfun_setquotuniv</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>} {<span class="id" title="var">R</span> : <span class="id" title="var">binopeqrel</span> <span class="id" title="var">X</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">H</span> : <span class="id" title="var">iscomprelfun</span> <span class="id" title="var">R</span> <span class="id" title="var">f</span>) : @<span class="id" title="var">ismonoidfun</span> (<span class="id" title="var">monoidquot</span> <span class="id" title="var">R</span>) <span class="id" title="var">Y</span> (<span class="id" title="var">setquotuniv</span> <span class="id" title="var">R</span> <span class="id" title="var">Y</span> <span class="id" title="var">f</span> <span class="id" title="var">H</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">mk_ismonoidfun</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">refine</span> (<span class="id" title="var">setquotuniv2prop'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">isasetmonoid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">setquotfun2comm</span>. <span class="id" title="tactic">rewrite</span> !<span class="id" title="var">setquotunivcomm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">monoidfunmul</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">setquotunivcomm</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">monoidfununel</span> <span class="id" title="var">_</span>).<br/>
</div>

<br/>
</div>

<div class="doc">
The universal property of the quotient monoid. If X, Y are monoids, R is a congruence on X, and
    <span class="inlinecode"><a class="idref" href="UniMath.Algebra.DCPO.html#leastupperbound.f"><span class="id" title="variable">f</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#X"><span class="id" title="variable">X</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#Y"><span class="id" title="variable">Y</span></a></span> is a homomorphism which respects R, then there exists a unique homomorphism
    <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#f'"><span class="id" title="variable">f'</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#X"><span class="id" title="variable">X</span></a>/<a class="idref" href="UniMath.Foundations.UnivalenceAxiom.html#R"><span class="id" title="variable">R</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartA.html#Y"><span class="id" title="variable">Y</span></a></span> making the following diagram commute:
    <tt>
    X -π-&gt; X/R
     \      |
       f    | ∃! f'
         \  |
          V V
           Y
    </tt>
<div class="paragraph"> </div>

 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoidquotuniv</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>} {<span class="id" title="var">R</span> : <span class="id" title="var">binopeqrel</span> <span class="id" title="var">X</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">H</span> : <span class="id" title="var">iscomprelfun</span> <span class="id" title="var">R</span> <span class="id" title="var">f</span>) : <span class="id" title="var">monoidfun</span> (<span class="id" title="var">monoidquot</span> <span class="id" title="var">R</span>) <span class="id" title="var">Y</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">monoidfunconstr</span> (<span class="id" title="var">ismonoidfun_setquotuniv</span> <span class="id" title="var">f</span> <span class="id" title="var">H</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoidquotfun</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>} {<span class="id" title="var">R</span> : <span class="id" title="var">binopeqrel</span> <span class="id" title="var">X</span>} {<span class="id" title="var">S</span> : <span class="id" title="var">binopeqrel</span> <span class="id" title="var">Y</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) (<span class="id" title="var">H</span> : ∏ <span class="id" title="var">x</span> <span class="id" title="var">x'</span> : <span class="id" title="var">X</span>, <span class="id" title="var">R</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> → <span class="id" title="var">S</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) (<span class="id" title="var">f</span> <span class="id" title="var">x'</span>)) : <span class="id" title="var">monoidfun</span> (<span class="id" title="var">monoidquot</span> <span class="id" title="var">R</span>) (<span class="id" title="var">monoidquot</span> <span class="id" title="var">S</span>) :=<br/>
<span class="id" title="var">monoidquotuniv</span> (<span class="id" title="var">monoidfuncomp</span> <span class="id" title="var">f</span> (<span class="id" title="var">monoidquotpr</span> <span class="id" title="var">S</span>)) (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">r</span>, <span class="id" title="var">iscompsetquotpr</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">H</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">r</span>)).<br/>

<br/>
</div>

<div class="doc">
Quotients by the equivalence relation of being in the same fiber.
    This is exactly X / ker f for a homomorphism f. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">multmonoid</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fiber_binopeqrel</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) : <span class="id" title="var">binopeqrel</span> <span class="id" title="var">X</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">binopeqrelpair</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">same_fiber_eqrel</span> <span class="id" title="var">f</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">mk_isbinophrel</span>; <span class="id" title="tactic">intros</span> ? ? ? <span class="id" title="var">same</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">monoidfunmul</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span> @ !<span class="id" title="var">monoidfunmul</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ </div>

<div class="doc">
Prove that it's a congruence for left multiplication 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">same</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ </div>

<div class="doc">
Prove that it's a congruence for right multiplication 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">maponpaths</span> (<span class="id" title="var">λ</span> <span class="id" title="var">z</span>, <span class="id" title="var">z</span> * <span class="id" title="var">f</span> <span class="id" title="var">c</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">same</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">quotient_by_monoidfun</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) : <span class="id" title="var">monoid</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">monoidquot</span> (<span class="id" title="var">fiber_binopeqrel</span> <span class="id" title="var">f</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab431"></a><h4 class="section">Cosets</h4>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Cosets</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>} (<span class="id" title="var">Y</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">in_same_left_coset</span> (<span class="id" title="var">x1</span> <span class="id" title="var">x2</span> : <span class="id" title="var">X</span>) : <span class="id" title="var">UU</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;∑ <span class="id" title="var">y</span> : <span class="id" title="var">Y</span>, <span class="id" title="var">x1</span> * (<span class="id" title="var">pr1</span> <span class="id" title="var">y</span>) = <span class="id" title="var">x2</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">in_same_right_coset</span> (<span class="id" title="var">x1</span> <span class="id" title="var">x2</span> : <span class="id" title="var">X</span>) : <span class="id" title="var">UU</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;∑ <span class="id" title="var">y</span> : <span class="id" title="var">Y</span>, (<span class="id" title="var">pr1</span> <span class="id" title="var">y</span>) * <span class="id" title="var">x1</span> = <span class="id" title="var">x2</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Cosets</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab432"></a><h4 class="section">Direct products</h4>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isassocdirprod</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">isassoc</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">setwithbinopdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">xy</span> <span class="id" title="var">xy'</span> <span class="id" title="var">xy''</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pathsdirprod</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">assocax</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">assocax</span> <span class="id" title="var">Y</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">isassocdirprod</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isunitindirprod</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isunit</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">setwithbinopdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>)) (<span class="id" title="var">dirprodpair</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>) (<span class="id" title="var">unel</span> <span class="id" title="var">Y</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">xy</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">xy</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">x</span> <span class="id" title="var">y</span> ]. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pathsdirprod</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">lunax</span> <span class="id" title="var">X</span>). <span class="id" title="tactic">apply</span> (<span class="id" title="var">lunax</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">xy</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">xy</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">x</span> <span class="id" title="var">y</span> ]. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pathsdirprod</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">runax</span> <span class="id" title="var">X</span>). <span class="id" title="tactic">apply</span> (<span class="id" title="var">runax</span> <span class="id" title="var">Y</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">isunitindirprod</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ismonoiddirprod</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">ismonoidop</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">setwithbinopdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>)) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">tpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">isassocdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) (<span class="id" title="var">tpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">dirprodpair</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>) (<span class="id" title="var">unel</span> <span class="id" title="var">Y</span>)) (<span class="id" title="var">isunitindirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">monoiddirprod</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">monoid</span>) : <span class="id" title="var">monoid</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">setwithbinopdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ismonoiddirprod</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab433"></a><h3 class="section">Abelian (commutative) monoids</h3>

<div class="paragraph"> </div>

<a name="lab434"></a><h4 class="section">Basic definitions</h4>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abmonoid</span> : <span class="id" title="var">UU</span> := <span class="id" title="var">total2</span> (<span class="id" title="var">λ</span> <span class="id" title="var">X</span> : <span class="id" title="var">setwithbinop</span>, <span class="id" title="var">isabmonoidop</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abmonoidpair</span> :<br/>
&nbsp;&nbsp;∏ (<span class="id" title="var">t</span> : <span class="id" title="var">setwithbinop</span>), (<span class="id" title="var">λ</span> <span class="id" title="var">X</span> : <span class="id" title="var">setwithbinop</span>, <span class="id" title="var">isabmonoidop</span> <span class="id" title="var">op</span>) <span class="id" title="var">t</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∑ <span class="id" title="var">X</span> : <span class="id" title="var">setwithbinop</span>, <span class="id" title="var">isabmonoidop</span> <span class="id" title="var">op</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">tpair</span> (<span class="id" title="var">λ</span> <span class="id" title="var">X</span> : <span class="id" title="var">setwithbinop</span>, <span class="id" title="var">isabmonoidop</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abmonoidtomonoid</span> : <span class="id" title="var">abmonoid</span> -&gt; <span class="id" title="var">monoid</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">λ</span> <span class="id" title="var">X</span> : <span class="id" title="var">_</span>, <span class="id" title="var">monoidpair</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">X</span>) (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>)).<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">abmonoidtomonoid</span> : <span class="id" title="var">abmonoid</span> &gt;-&gt; <span class="id" title="var">monoid</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">commax</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">iscomm</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>) := <span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abmonoidrer</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> : <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">paths</span> (<span class="id" title="var">op</span> (<span class="id" title="var">op</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>) (<span class="id" title="var">op</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span>)) (<span class="id" title="var">op</span> (<span class="id" title="var">op</span> <span class="id" title="var">a</span> <span class="id" title="var">c</span>) (<span class="id" title="var">op</span> <span class="id" title="var">b</span> <span class="id" title="var">d</span>)) := <span class="id" title="var">abmonoidoprer</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>) <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abmonoid_of_monoid</span> (<span class="id" title="var">X</span> : <span class="id" title="var">monoid</span>) (<span class="id" title="var">H</span> : <span class="id" title="var">iscomm</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>)) : <span class="id" title="var">abmonoid</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">abmonoidpair</span> <span class="id" title="var">X</span> (<span class="id" title="var">mk_isabmonoidop</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>) <span class="id" title="var">H</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab435"></a><h4 class="section">Construction of the trivial abmonoid consisting of one element given by unit.</h4>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unitabmonoid_isabmonoid</span> : <span class="id" title="var">isabmonoidop</span> (@<span class="id" title="var">op</span> <span class="id" title="var">unitmonoid</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">mk_isabmonoidop</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">unitmonoid_ismonoid</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>. <span class="id" title="var">use</span> <span class="id" title="var">isProofIrrelevantUnit</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unitabmonoid</span> : <span class="id" title="var">abmonoid</span> := <span class="id" title="var">abmonoidpair</span> <span class="id" title="var">unitmonoid</span> <span class="id" title="var">unitabmonoid_isabmonoid</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">abmonoidfuntounit_ismonoidfun</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">ismonoidfun</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, (<span class="id" title="var">unel</span> <span class="id" title="var">unitabmonoid</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">mk_ismonoidfun</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">mk_isbinopfun</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>. <span class="id" title="var">use</span> <span class="id" title="var">isProofIrrelevantUnit</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">isProofIrrelevantUnit</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abmonoidfuntounit</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">unitabmonoid</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">monoidfunconstr</span> (<span class="id" title="var">abmonoidfuntounit_ismonoidfun</span> <span class="id" title="var">X</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">abmonoidfunfromunit_ismonoidfun</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">ismonoidfun</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">unitabmonoid</span>, (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">mk_ismonoidfun</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">mk_isbinopfun</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>. <span class="id" title="var">use</span> <span class="id" title="var">pathsinv0</span>. <span class="id" title="var">use</span> (<span class="id" title="var">runax</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abmonoidfunfromunit</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">monoidfun</span> <span class="id" title="var">unitabmonoid</span> <span class="id" title="var">X</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">monoidfunconstr</span> (<span class="id" title="var">abmonoidfunfromunit_ismonoidfun</span> <span class="id" title="var">X</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">unelabmonoidfun_ismonoidfun</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">ismonoidfun</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, (<span class="id" title="var">unel</span> <span class="id" title="var">Y</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">mk_ismonoidfun</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">mk_isbinopfun</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>. <span class="id" title="var">use</span> <span class="id" title="var">pathsinv0</span>. <span class="id" title="var">use</span> <span class="id" title="var">lunax</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unelabmonoidfun</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">monoidfunconstr</span> (<span class="id" title="var">unelabmonoidfun_ismonoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab436"></a><h4 class="section">Abelian monoid structure on homsets</h4>

    If f g : X -&gt; Y are morphisms of abelian monoids, then we define f + g to be the morphism
    (f + g)(x) = f(x) + g(x).
 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">abmonoidshombinop_ismonoidfun</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abmonoid</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) :<br/>
&nbsp;&nbsp;@<span class="id" title="var">ismonoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">pr1</span> <span class="id" title="var">X</span>, (<span class="id" title="var">pr1</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> * <span class="id" title="var">pr1</span> <span class="id" title="var">g</span> <span class="id" title="var">x</span>)%<span class="id" title="var">multmonoid</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">mk_ismonoidfun</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">mk_isbinopfun</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">f</span>)). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">g</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assocax</span> <span class="id" title="var">Y</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assocax</span> <span class="id" title="var">Y</span>). <span class="id" title="var">use</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">assocax</span> <span class="id" title="var">Y</span>). <span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">assocax</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">maponpaths</span> (<span class="id" title="var">λ</span> <span class="id" title="var">y</span> : <span class="id" title="var">Y</span>, (<span class="id" title="var">y</span> * (<span class="id" title="var">pr1</span> <span class="id" title="var">g</span> <span class="id" title="var">x'</span>))%<span class="id" title="var">multmonoid</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">commax</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> (<span class="id" title="var">pathscomp0</span> (<span class="id" title="var">maponpaths</span> (<span class="id" title="var">λ</span> <span class="id" title="var">h</span> : <span class="id" title="var">Y</span>, (<span class="id" title="var">pr1</span> <span class="id" title="var">f</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>) * <span class="id" title="var">h</span>)%<span class="id" title="var">multmonoid</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">monoidfununel</span> <span class="id" title="var">g</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">runax</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">monoidfununel</span> <span class="id" title="var">f</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abmonoidshombinop</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abmonoid</span>} : <span class="id" title="var">binop</span> (<span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) :=<br/>
&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>, <span class="id" title="var">monoidfunconstr</span> (<span class="id" title="var">abmonoidshombinop_ismonoidfun</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">abmonoidsbinop_runax</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abmonoid</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">abmonoidshombinop</span> <span class="id" title="var">f</span> (<span class="id" title="var">unelmonoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) = <span class="id" title="var">f</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">monoidfun_paths</span>. <span class="id" title="var">use</span> <span class="id" title="var">funextfun</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="var">use</span> (<span class="id" title="var">runax</span> <span class="id" title="var">Y</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">abmonoidsbinop_lunax</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abmonoid</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">abmonoidshombinop</span> (<span class="id" title="var">unelmonoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) <span class="id" title="var">f</span> = <span class="id" title="var">f</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">monoidfun_paths</span>. <span class="id" title="var">use</span> <span class="id" title="var">funextfun</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="var">use</span> (<span class="id" title="var">lunax</span> <span class="id" title="var">Y</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">abmonoidshombinop_assoc</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abmonoid</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">abmonoidshombinop</span> (<span class="id" title="var">abmonoidshombinop</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>) <span class="id" title="var">h</span> = <span class="id" title="var">abmonoidshombinop</span> <span class="id" title="var">f</span> (<span class="id" title="var">abmonoidshombinop</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">monoidfun_paths</span>. <span class="id" title="var">use</span> <span class="id" title="var">funextfun</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="var">use</span> <span class="id" title="var">assocax</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">abmonoidshombinop_comm</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abmonoid</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">abmonoidshombinop</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> = <span class="id" title="var">abmonoidshombinop</span> <span class="id" title="var">g</span> <span class="id" title="var">f</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">monoidfun_paths</span>. <span class="id" title="var">use</span> <span class="id" title="var">funextfun</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="var">use</span> (<span class="id" title="var">commax</span> <span class="id" title="var">Y</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">abmonoidshomabmonoid_ismonoidop</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abmonoid</span>) :<br/>
&nbsp;&nbsp;@<span class="id" title="var">ismonoidop</span> (<span class="id" title="var">hSetpair</span> (<span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) (<span class="id" title="var">isasetmonoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>, <span class="id" title="var">abmonoidshombinop</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">mk_ismonoidop</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">abmonoidshombinop_assoc</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">isunitalpair</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">unelmonoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">use</span> <span class="id" title="var">isunitpair</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">intros</span> <span class="id" title="var">f</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">abmonoidsbinop_lunax</span> <span class="id" title="var">f</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">intros</span> <span class="id" title="var">f</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">abmonoidsbinop_runax</span> <span class="id" title="var">f</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">abmonoidshomabmonoid_isabmonoid</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abmonoid</span>) :<br/>
&nbsp;&nbsp;@<span class="id" title="var">isabmonoidop</span> (<span class="id" title="var">hSetpair</span> (<span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) (<span class="id" title="var">isasetmonoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>, <span class="id" title="var">abmonoidshombinop</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">mk_isabmonoidop</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">abmonoidshomabmonoid_ismonoidop</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">abmonoidshombinop_comm</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abmonoidshomabmonoid</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">abmonoid</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">abmonoidpair</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">setwithbinoppair</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">use</span> <span class="id" title="var">hSetpair</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exact</span> (<span class="id" title="var">monoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exact</span> (<span class="id" title="var">isasetmonoidfun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">abmonoidshombinop</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">abmonoidshomabmonoid_isabmonoid</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab437"></a><h4 class="section">(X = Y) ≃ (monoidiso X Y)</h4>

    We use the following composition

<div class="paragraph"> </div>

                      (X = Y) ≃ ((mk_abmonoid' X) = (mk_abmonoid' Y))
                              ≃ ((pr1 (mk_abmonoid' X)) = (pr1 (mk_abmonoid' Y)))
                              ≃ (monoidiso X Y)

<div class="paragraph"> </div>

    where the third weak equivalence is given by univalence for monoids, <span class="inlinecode"><span class="id" title="var">monoid_univalence</span></span>.

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">abmonoid'</span> : <span class="id" title="var">UU</span> := ∑ <span class="id" title="var">m</span> : <span class="id" title="var">monoid</span>, <span class="id" title="var">iscomm</span> (@<span class="id" title="var">op</span> <span class="id" title="var">m</span>).<br/>

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">mk_abmonoid'</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">abmonoid'</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">tpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">tpair</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">X</span>) (<span class="id" title="var">dirprod_pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>))) (<span class="id" title="var">dirprod_pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abmonoid_univalence_weq1</span> : <span class="id" title="var">abmonoid</span> ≃ <span class="id" title="var">abmonoid'</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">weqtotal2asstol</span> (<span class="id" title="var">λ</span> <span class="id" title="var">X</span> : <span class="id" title="var">setwithbinop</span>, <span class="id" title="var">ismonoidop</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> : (∑ <span class="id" title="var">X</span> : <span class="id" title="var">setwithbinop</span>, <span class="id" title="var">ismonoidop</span> <span class="id" title="var">op</span>) =&gt; <span class="id" title="var">iscomm</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">y</span>))).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abmonoid_univalence_weq1'</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abmonoid</span>) :<br/>
&nbsp;&nbsp;(<span class="id" title="var">X</span> = <span class="id" title="var">Y</span>) ≃ ((<span class="id" title="var">mk_abmonoid'</span> <span class="id" title="var">X</span>) = (<span class="id" title="var">mk_abmonoid'</span> <span class="id" title="var">Y</span>)) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">weqpair</span> <span class="id" title="var">_</span> (@<span class="id" title="var">isweqmaponpaths</span> <span class="id" title="var">abmonoid</span> <span class="id" title="var">abmonoid'</span> <span class="id" title="var">abmonoid_univalence_weq1</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abmonoid_univalence_weq2</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abmonoid</span>) :<br/>
&nbsp;&nbsp;((<span class="id" title="var">mk_abmonoid'</span> <span class="id" title="var">X</span>) = (<span class="id" title="var">mk_abmonoid'</span> <span class="id" title="var">Y</span>)) ≃ ((<span class="id" title="var">pr1</span> (<span class="id" title="var">mk_abmonoid'</span> <span class="id" title="var">X</span>)) = (<span class="id" title="var">pr1</span> (<span class="id" title="var">mk_abmonoid'</span> <span class="id" title="var">Y</span>))).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">subtypeInjectivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">w</span>. <span class="id" title="var">use</span> <span class="id" title="var">isapropiscomm</span>.<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">abmonoid_univalence_weq2</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abmonoid_univalence_weq3</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abmonoid</span>) :<br/>
&nbsp;&nbsp;((<span class="id" title="var">pr1</span> (<span class="id" title="var">mk_abmonoid'</span> <span class="id" title="var">X</span>)) = (<span class="id" title="var">pr1</span> (<span class="id" title="var">mk_abmonoid'</span> <span class="id" title="var">Y</span>))) ≃ (<span class="id" title="var">monoidiso</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">monoid_univalence</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">mk_abmonoid'</span> <span class="id" title="var">X</span>)) (<span class="id" title="var">pr1</span> (<span class="id" title="var">mk_abmonoid'</span> <span class="id" title="var">Y</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abmonoid_univalence_map</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abmonoid</span>) : (<span class="id" title="var">X</span> = <span class="id" title="var">Y</span>) -&gt; (<span class="id" title="var">monoidiso</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">idmonoidiso</span> <span class="id" title="var">X</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">abmonoid_univalence_isweq</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">isweq</span> (<span class="id" title="var">abmonoid_univalence_map</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">isweqhomot</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">weqcomp</span> (<span class="id" title="var">abmonoid_univalence_weq1'</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">weqcomp</span> (<span class="id" title="var">abmonoid_univalence_weq2</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) (<span class="id" title="var">abmonoid_univalence_weq3</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>))).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">pathscomp0</span> <span class="id" title="var">weqcomp_to_funcomp_app</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">weqcomp_to_funcomp_app</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> <span class="id" title="var">weqproperty</span>.<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">abmonoid_univalence_isweq</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abmonoid_univalence</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abmonoid</span>) : (<span class="id" title="var">X</span> = <span class="id" title="var">Y</span>) ≃ (<span class="id" title="var">monoidiso</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">use</span> <span class="id" title="var">weqpair</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">abmonoid_univalence_map</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">abmonoid_univalence_isweq</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">abmonoid_univalence</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab438"></a><h4 class="section">Subobjects</h4>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">subabmonoid</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) := <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>.<br/>
<span class="id" title="keyword">Identity</span> <span class="id" title="keyword">Coercion</span> <span class="id" title="var">id_subabmonoid</span> : <span class="id" title="var">subabmonoid</span> &gt;-&gt; <span class="id" title="var">submonoid</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iscommcarrier</span> {<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>) : <span class="id" title="var">iscomm</span> (@<span class="id" title="var">op</span> <span class="id" title="var">A</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">a'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">invmaponpathsincl</span> <span class="id" title="var">_</span> (<span class="id" title="var">isinclpr1carrier</span> <span class="id" title="var">A</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>)).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">iscommcarrier</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isabmonoidcarrier</span> {<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isabmonoidop</span> (@<span class="id" title="var">op</span> <span class="id" title="var">A</span>) := <span class="id" title="var">dirprodpair</span> (<span class="id" title="var">ismonoidcarrier</span> <span class="id" title="var">A</span>) (<span class="id" title="var">iscommcarrier</span> <span class="id" title="var">A</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">carrierofsubabmonoid</span> {<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) : <span class="id" title="var">abmonoid</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">subabmonoid</span> <span class="id" title="tactic">in</span> <span class="id" title="var">A</span>. <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">A</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">isabmonoidcarrier</span>.<br/>
</div>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">carrierofsubabmonoid</span> : <span class="id" title="var">subabmonoid</span> &gt;-&gt; <span class="id" title="var">abmonoid</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">subabmonoid_incl</span> {<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) : <span class="id" title="var">monoidfun</span> <span class="id" title="var">A</span> <span class="id" title="var">X</span> :=<br/>
<span class="id" title="var">submonoid_incl</span> <span class="id" title="var">A</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab439"></a><h4 class="section">Quotient objects</h4>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iscommquot</span> {<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">binopeqrel</span> <span class="id" title="var">X</span>) : <span class="id" title="var">iscomm</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">setwithbinopquot</span> <span class="id" title="var">R</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">X0</span> := <span class="id" title="var">setwithbinopquot</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">setquotuniv2prop</span> <span class="id" title="var">R</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> : <span class="id" title="var">X0</span>, <span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> (<span class="id" title="var">setproperty</span> <span class="id" title="var">X0</span> (<span class="id" title="var">op</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>) (<span class="id" title="var">op</span> <span class="id" title="var">x'</span> <span class="id" title="var">x</span>)))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x0</span> <span class="id" title="var">x0'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">maponpaths</span> (<span class="id" title="var">setquotpr</span> <span class="id" title="var">R</span>) ((<span class="id" title="var">commax</span> <span class="id" title="var">X</span>) <span class="id" title="var">x0</span> <span class="id" title="var">x0'</span>)).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">iscommquot</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isabmonoidquot</span> {<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">binopeqrel</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isabmonoidop</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">setwithbinopquot</span> <span class="id" title="var">R</span>)) := <span class="id" title="var">dirprodpair</span> (<span class="id" title="var">ismonoidquot</span> <span class="id" title="var">R</span>) (<span class="id" title="var">iscommquot</span> <span class="id" title="var">R</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abmonoidquot</span> {<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">binopeqrel</span> <span class="id" title="var">X</span>) : <span class="id" title="var">abmonoid</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">setwithbinopquot</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">isabmonoidquot</span>. </div>

<br/>
</div>

<div class="doc">
<a name="lab440"></a><h4 class="section">Direct products</h4>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iscommdirprod</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">iscomm</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">setwithbinopdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">xy</span> <span class="id" title="var">xy'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">xy</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">x</span> <span class="id" title="var">y</span> ]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">xy'</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">x'</span> <span class="id" title="var">y'</span> ]. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsdirprod</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">commax</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">commax</span> <span class="id" title="var">Y</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">iscommdirprod</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isabmonoiddirprod</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">isabmonoidop</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">setwithbinopdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>)) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">dirprodpair</span> (<span class="id" title="var">ismonoiddirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) (<span class="id" title="var">iscommdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abmonoiddirprod</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">abmonoid</span>) : <span class="id" title="var">abmonoid</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">setwithbinopdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">isabmonoiddirprod</span>. </div>

<br/>
</div>

<div class="doc">
<a name="lab441"></a><h4 class="section">Monoid of fractions of an abelian monoid</h4>


<div class="paragraph"> </div>

Note : the following construction uses onbly associativity and commutativity
of the <span class="inlinecode"><span class="id" title="var">abmonoid</span></span> operations but does not use the unit element. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">addmonoid_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">AddNotation</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abmonoidfracopint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">binop</span> (<span class="id" title="var">X</span> × <span class="id" title="var">A</span>) := @<span class="id" title="var">op</span> (<span class="id" title="var">setwithbinopdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hrelabmonoidfrac</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>) : <span class="id" title="var">hrel</span> (<span class="id" title="var">setwithbinopdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">λ</span> <span class="id" title="var">xa</span> <span class="id" title="var">yb</span> : <span class="id" title="var">dirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>, <span class="id" title="var">hexists</span> (<span class="id" title="var">λ</span> <span class="id" title="var">a0</span> : <span class="id" title="var">A</span>, <span class="id" title="var">paths</span> (((<span class="id" title="var">pr1</span> <span class="id" title="var">xa</span>) + (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">yb</span>))) + (<span class="id" title="var">pr1</span> <span class="id" title="var">a0</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(((<span class="id" title="var">pr1</span> <span class="id" title="var">yb</span>) + (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa</span>)) + (<span class="id" title="var">pr1</span> <span class="id" title="var">a0</span>)))).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iseqrelabmonoidfrac</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>) : <span class="id" title="var">iseqrel</span> (<span class="id" title="var">hrelabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">assoc</span> := <span class="id" title="var">assocax</span> <span class="id" title="var">X</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">comm</span> := <span class="id" title="var">commax</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">R</span> := <span class="id" title="var">hrelabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">symm</span> : <span class="id" title="var">issymm</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">xa</span> <span class="id" title="var">yb</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">R</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhfun</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">eq1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">eq1</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">x1</span> <span class="id" title="var">eq1</span> ]. <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">x1</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">x1</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">x1</span> <span class="id" title="var">isx1</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">pathsinv0</span> <span class="id" title="var">eq1</span>).<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">trans</span> : <span class="id" title="var">istrans</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">istrans</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">ab</span> <span class="id" title="var">cd</span> <span class="id" title="var">ef</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhfun2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ab</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">a</span> <span class="id" title="var">b</span> ]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">cd</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">c</span> <span class="id" title="var">d</span> ]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">ef</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">e</span> <span class="id" title="var">f</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">b</span> <span class="id" title="var">isb</span> ]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">d</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">d</span> <span class="id" title="var">isd</span> ]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">f</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">f</span> <span class="id" title="var">isf</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">eq1</span> <span class="id" title="var">eq2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">eq1</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">x1</span> <span class="id" title="var">eq1</span> ]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">eq2</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">x2</span> <span class="id" title="var">eq2</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (@<span class="id" title="var">op</span> <span class="id" title="var">A</span> (<span class="id" title="var">tpair</span> <span class="id" title="var">_</span> <span class="id" title="var">d</span> <span class="id" title="var">isd</span>) (@<span class="id" title="var">op</span> <span class="id" title="var">A</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x1</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">x1</span> <span class="id" title="var">isx1</span> ]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">x2</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">x2</span> <span class="id" title="var">isx2</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">A</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">A</span> <span class="id" title="var">ax</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">a</span> <span class="id" title="var">f</span> (<span class="id" title="var">d</span> + (<span class="id" title="var">x1</span> + <span class="id" title="var">x2</span>))). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">comm</span> <span class="id" title="var">f</span> (<span class="id" title="var">d</span> + (<span class="id" title="var">x1</span> + <span class="id" title="var">x2</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">a</span> (<span class="id" title="var">d</span> + (<span class="id" title="var">x1</span> + <span class="id" title="var">x2</span>)) <span class="id" title="var">f</span>). <span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">a</span> <span class="id" title="var">d</span> (<span class="id" title="var">x1</span> + <span class="id" title="var">x2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">a</span> + <span class="id" title="var">d</span>) <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">eq1</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">comm</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">e</span> <span class="id" title="var">b</span> (<span class="id" title="var">d</span> + (<span class="id" title="var">x2</span> + <span class="id" title="var">x1</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">comm</span> <span class="id" title="var">b</span> (<span class="id" title="var">d</span> + (<span class="id" title="var">x2</span> + <span class="id" title="var">x1</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">e</span> (<span class="id" title="var">d</span> + (<span class="id" title="var">x2</span> + <span class="id" title="var">x1</span>)) <span class="id" title="var">b</span>). <span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">e</span> <span class="id" title="var">d</span> (<span class="id" title="var">x2</span> + <span class="id" title="var">x1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">e</span> + <span class="id" title="var">d</span>) <span class="id" title="var">x2</span> <span class="id" title="var">x1</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">eq2</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">c</span> + <span class="id" title="var">b</span>) <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">c</span> + <span class="id" title="var">f</span>) <span class="id" title="var">x2</span> <span class="id" title="var">x1</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">comm</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">c</span> + <span class="id" title="var">b</span>) (<span class="id" title="var">x2</span> + <span class="id" title="var">x1</span>) <span class="id" title="var">f</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">c</span> + <span class="id" title="var">f</span>) (<span class="id" title="var">x2</span> + <span class="id" title="var">x1</span>) <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">comm</span> (<span class="id" title="var">x2</span> + <span class="id" title="var">x1</span>) <span class="id" title="var">f</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">comm</span> (<span class="id" title="var">x2</span> + <span class="id" title="var">x1</span>) <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">c</span> + <span class="id" title="var">b</span>) <span class="id" title="var">f</span> (<span class="id" title="var">x2</span> + <span class="id" title="var">x1</span>)). <span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">c</span> + <span class="id" title="var">f</span>) <span class="id" title="var">b</span> (<span class="id" title="var">x2</span> + <span class="id" title="var">x1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">c</span> <span class="id" title="var">b</span> <span class="id" title="var">f</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">c</span> <span class="id" title="var">f</span> <span class="id" title="var">b</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">comm</span> <span class="id" title="var">b</span> <span class="id" title="var">f</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">refl</span> : <span class="id" title="var">isrefl</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">xa</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhpr</span>. <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">iseqrelconstr</span> <span class="id" title="var">trans</span> <span class="id" title="var">refl</span> <span class="id" title="var">symm</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">iseqrelabmonoidfrac</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">eqrelabmonoidfrac</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>) : <span class="id" title="var">eqrel</span> (<span class="id" title="var">setwithbinopdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">eqrelpair</span> (<span class="id" title="var">hrelabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>) (<span class="id" title="var">iseqrelabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isbinophrelabmonoidfrac</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;@<span class="id" title="var">isbinophrel</span> (<span class="id" title="var">setwithbinopdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>) (<span class="id" title="var">eqrelabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isbinopreflrel</span> (<span class="id" title="var">eqrelabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>) (<span class="id" title="var">eqrelrefl</span> (<span class="id" title="var">eqrelabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">rer</span> := <span class="id" title="var">abmonoidoprer</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">X</span>)). <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hinhfun2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">a</span> <span class="id" title="var">a'</span> ]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">a'</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">a'</span> <span class="id" title="var">isa'</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">b</span> <span class="id" title="var">b'</span> ]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">b'</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">b'</span> <span class="id" title="var">isb'</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">c</span> <span class="id" title="var">c'</span> ]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">c'</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">c'</span> <span class="id" title="var">isc'</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">d</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">d</span> <span class="id" title="var">d'</span> ]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">d'</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">d'</span> <span class="id" title="var">isd'</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">ax</span> <span class="id" title="var">ay</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">ax</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">a1</span> <span class="id" title="var">eq1</span> ]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">ay</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">a2</span> <span class="id" title="var">eq2</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (@<span class="id" title="var">op</span> <span class="id" title="var">A</span>  <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a1</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">a1</span> <span class="id" title="var">aa1</span> ]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">a2</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">a2</span> <span class="id" title="var">aa2</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">rer</span> <span class="id" title="var">a</span> <span class="id" title="var">c</span> <span class="id" title="var">b'</span> <span class="id" title="var">d'</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">rer</span> <span class="id" title="var">b</span> <span class="id" title="var">d</span> <span class="id" title="var">a'</span> <span class="id" title="var">c'</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">rer</span> (<span class="id" title="var">a</span> + <span class="id" title="var">b'</span>) (<span class="id" title="var">c</span> + <span class="id" title="var">d'</span>) <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">rer</span> (<span class="id" title="var">b</span> + <span class="id" title="var">a'</span>) (<span class="id" title="var">d</span> + <span class="id" title="var">c'</span>) <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">eq1</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">eq2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">isbinophrelabmonoidfrac</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abmonoidfracop</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">binop</span> (<span class="id" title="var">setquot</span> (<span class="id" title="var">hrelabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>)) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">setquotfun2</span> (<span class="id" title="var">hrelabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>) (<span class="id" title="var">eqrelabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>) (<span class="id" title="var">abmonoidfracopint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">iscompbinoptransrel</span> <span class="id" title="var">_</span> (<span class="id" title="var">eqreltrans</span> <span class="id" title="var">_</span>) (<span class="id" title="var">isbinophrelabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>))).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">binopeqrelabmonoidfrac</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">binopeqrel</span> (<span class="id" title="var">abmonoiddirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>) :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">binopeqrelpair</span> (<span class="id" title="var">setwithbinopdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>) (<span class="id" title="var">eqrelabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>) (<span class="id" title="var">isbinophrelabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abmonoidfrac</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>) : <span class="id" title="var">abmonoid</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">abmonoidquot</span> (<span class="id" title="var">binopeqrelabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">prabmonoidfrac</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>) : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="var">abmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> (<span class="id" title="var">x</span> : <span class="id" title="var">X</span>) (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) =&gt; <span class="id" title="var">setquotpr</span> (<span class="id" title="var">eqrelabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>) (<span class="id" title="var">dirprodpair</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span>).<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">invertibilityinabmonoidfrac</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;∏ <span class="id" title="var">a</span> <span class="id" title="var">a'</span> : <span class="id" title="var">A</span>, <span class="id" title="var">isinvertible</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">abmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>)) (<span class="id" title="var">prabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">a</span>) <span class="id" title="var">a'</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">a'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">R</span> := <span class="id" title="var">eqrelabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>). <span class="id" title="tactic">unfold</span> <span class="id" title="var">isinvertible</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">isl</span> : <span class="id" title="var">islinvertible</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">abmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">prabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">a</span>) <span class="id" title="var">a'</span>)).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">islinvertible</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">f</span> := <span class="id" title="var">λ</span> <span class="id" title="var">x0</span> : <span class="id" title="var">abmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>, <span class="id" title="var">prabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">a</span>) <span class="id" title="var">a'</span> + <span class="id" title="var">x0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">g</span> := <span class="id" title="var">λ</span> <span class="id" title="var">x0</span> : <span class="id" title="var">abmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>, <span class="id" title="var">prabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">a'</span>) <span class="id" title="var">a</span> + <span class="id" title="var">x0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">egf</span> : ∏ <span class="id" title="var">x0</span> : <span class="id" title="var">_</span>, <span class="id" title="var">paths</span> (<span class="id" title="var">g</span> (<span class="id" title="var">f</span> <span class="id" title="var">x0</span>)) <span class="id" title="var">x0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">setquotunivprop</span> <span class="id" title="var">R</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x0</span> : <span class="id" title="var">abmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>, <span class="id" title="var">eqset</span> (<span class="id" title="var">g</span> (<span class="id" title="var">f</span> <span class="id" title="var">x0</span>)) <span class="id" title="var">x0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">xb</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">iscompsetquotpr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> (@<span class="id" title="var">dirprodpair</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> ((<span class="id" title="var">pr1</span> <span class="id" title="var">a'</span>) + ((<span class="id" title="var">pr1</span> <span class="id" title="var">a</span>) + (<span class="id" title="var">pr1</span> <span class="id" title="var">xb</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((@<span class="id" title="var">op</span> <span class="id" title="var">A</span>) <span class="id" title="var">a</span> ((@<span class="id" title="var">op</span> <span class="id" title="var">A</span>) <span class="id" title="var">a'</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xb</span>))))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhpr</span>. <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">unel</span> <span class="id" title="var">A</span>). <span class="id" title="tactic">unfold</span> <span class="id" title="var">pr1carrier</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">e</span> := <span class="id" title="var">assocax</span> <span class="id" title="var">X</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">a</span>) (<span class="id" title="var">pr1</span> <span class="id" title="var">a'</span>) (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xb</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">e</span> := <span class="id" title="var">assocax</span> <span class="id" title="var">X</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">xb</span>) (<span class="id" title="var">pr1</span> <span class="id" title="var">a</span> + <span class="id" title="var">pr1</span> <span class="id" title="var">a'</span>) (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xb</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">e</span> := <span class="id" title="var">assocax</span> <span class="id" title="var">X</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">a'</span>) (<span class="id" title="var">pr1</span> <span class="id" title="var">a</span>) (<span class="id" title="var">pr1</span> <span class="id" title="var">xb</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">e</span> := <span class="id" title="var">commax</span> <span class="id" title="var">X</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">a</span>) (<span class="id" title="var">pr1</span> <span class="id" title="var">a'</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">e</span> := <span class="id" title="var">commax</span> <span class="id" title="var">X</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">a</span> + <span class="id" title="var">pr1</span> <span class="id" title="var">a'</span>) (<span class="id" title="var">pr1</span> <span class="id" title="var">xb</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">efg</span> : ∏ <span class="id" title="var">x0</span> : <span class="id" title="var">_</span>, <span class="id" title="var">paths</span> (<span class="id" title="var">f</span> (<span class="id" title="var">g</span> <span class="id" title="var">x0</span>)) <span class="id" title="var">x0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">setquotunivprop</span> <span class="id" title="var">R</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x0</span> : <span class="id" title="var">abmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>, <span class="id" title="var">eqset</span> (<span class="id" title="var">f</span> (<span class="id" title="var">g</span> <span class="id" title="var">x0</span>)) <span class="id" title="var">x0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">xb</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">iscompsetquotpr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> (@<span class="id" title="var">dirprodpair</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> ((<span class="id" title="var">pr1</span> <span class="id" title="var">a</span>) + ((<span class="id" title="var">pr1</span> <span class="id" title="var">a'</span>) + (<span class="id" title="var">pr1</span> <span class="id" title="var">xb</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((@<span class="id" title="var">op</span> <span class="id" title="var">A</span>) <span class="id" title="var">a'</span> ((@<span class="id" title="var">op</span> <span class="id" title="var">A</span>) <span class="id" title="var">a</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xb</span>))))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhpr</span>. <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">unel</span> <span class="id" title="var">A</span>). <span class="id" title="tactic">unfold</span> <span class="id" title="var">pr1carrier</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">e</span> := <span class="id" title="var">assocax</span> <span class="id" title="var">X</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">a'</span>) (<span class="id" title="var">pr1</span> <span class="id" title="var">a</span>) (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xb</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">e</span> := <span class="id" title="var">assocax</span> <span class="id" title="var">X</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">xb</span>) (<span class="id" title="var">pr1</span> <span class="id" title="var">a'</span> + <span class="id" title="var">pr1</span> <span class="id" title="var">a</span>) (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xb</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">e</span> := <span class="id" title="var">assocax</span> <span class="id" title="var">X</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">a</span>) (<span class="id" title="var">pr1</span> <span class="id" title="var">a'</span>) (<span class="id" title="var">pr1</span> <span class="id" title="var">xb</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">e</span> := <span class="id" title="var">commax</span> <span class="id" title="var">X</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">a'</span>) (<span class="id" title="var">pr1</span> <span class="id" title="var">a</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">e</span> := <span class="id" title="var">commax</span> <span class="id" title="var">X</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">a'</span> + <span class="id" title="var">pr1</span> <span class="id" title="var">a</span>) (<span class="id" title="var">pr1</span> <span class="id" title="var">xb</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isweq_iso</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">egf</span> <span class="id" title="var">efg</span>).<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">dirprodpair</span> <span class="id" title="var">isl</span> (<span class="id" title="var">weqlinvertiblerinvertible</span> (@<span class="id" title="var">op</span> (<span class="id" title="var">abmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">commax</span> (<span class="id" title="var">abmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">prabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">a</span>) <span class="id" title="var">a'</span>) <span class="id" title="var">isl</span>)).<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab442"></a><h4 class="section">Canonical homomorphism to the monoid of fractions</h4>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">toabmonoidfrac</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">X</span>) : <span class="id" title="var">abmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">setquotpr</span> <span class="id" title="var">_</span> (<span class="id" title="var">dirprodpair</span> <span class="id" title="var">x</span> (<span class="id" title="var">unel</span> <span class="id" title="var">A</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isbinopfuntoabmonoidfrac</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>) : <span class="id" title="var">isbinopfun</span> (<span class="id" title="var">toabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">isbinopfun</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">paths</span> (<span class="id" title="var">setquotpr</span> <span class="id" title="var">_</span> (<span class="id" title="var">dirprodpair</span> (<span class="id" title="var">x1</span> + <span class="id" title="var">x2</span>) (@<span class="id" title="var">unel</span> <span class="id" title="var">A</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">setquotpr</span> (<span class="id" title="var">eqrelabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>) (<span class="id" title="var">dirprodpair</span> (<span class="id" title="var">x1</span> + <span class="id" title="var">x2</span>) ((<span class="id" title="var">unel</span> <span class="id" title="var">A</span>) + (<span class="id" title="var">unel</span> <span class="id" title="var">A</span>))))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">maponpaths</span> (<span class="id" title="var">setquotpr</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (@<span class="id" title="var">pathsdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pathsinv0</span> (<span class="id" title="var">lunax</span> <span class="id" title="var">A</span> 0)).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isunitalfuntoabmonoidfrac</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">paths</span> (<span class="id" title="var">toabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> (<span class="id" title="var">unel</span> <span class="id" title="var">X</span>)) (<span class="id" title="var">unel</span> (<span class="id" title="var">abmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>. </div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ismonoidfuntoabmonoidfrac</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">ismonoidfun</span> (<span class="id" title="var">toabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">dirprodpair</span> (<span class="id" title="var">isbinopfuntoabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>) (<span class="id" title="var">isunitalfuntoabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab443"></a><h4 class="section">Abelian monoid of fractions in the case when elements of the localziation submonoid are cancelable</h4>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hrel0abmonoidfrac</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>) : <span class="id" title="var">hrel</span> (<span class="id" title="var">X</span> × <span class="id" title="var">A</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">λ</span> <span class="id" title="var">xa</span> <span class="id" title="var">yb</span> : <span class="id" title="var">setdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>, <span class="id" title="var">eqset</span> ((<span class="id" title="var">pr1</span> <span class="id" title="var">xa</span>) + (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">yb</span>))) ((<span class="id" title="var">pr1</span> <span class="id" title="var">yb</span>) + (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa</span>))).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">weqhrelhrel0abmonoidfrac</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">iscanc</span> : ∏ <span class="id" title="var">a</span> : <span class="id" title="var">A</span>, <span class="id" title="var">isrcancelable</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>) (<span class="id" title="var">pr1carrier</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">xa</span> <span class="id" title="var">xa'</span> : <span class="id" title="var">dirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>) : (<span class="id" title="var">eqrelabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">xa</span> <span class="id" title="var">xa'</span>) ≃ (<span class="id" title="var">hrel0abmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">xa</span> <span class="id" title="var">xa'</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">eqrelabmonoidfrac</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">hrelabmonoidfrac</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">weqimplimpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (@<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> (<span class="id" title="var">eqset</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">xa</span> + <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa'</span>)) (<span class="id" title="var">pr1</span> <span class="id" title="var">xa'</span> + <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa</span>)))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">ae</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">ae</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">a</span> <span class="id" title="var">eq</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">invmaponpathsincl</span> <span class="id" title="var">_</span> (<span class="id" title="var">iscanc</span> <span class="id" title="var">a</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">eq</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">eq</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhpr</span>. <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">unel</span> <span class="id" title="var">A</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">runax</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">runax</span> <span class="id" title="var">X</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">eq</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">isapropishinh</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">setproperty</span> <span class="id" title="var">X</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isinclprabmonoidfrac</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">iscanc</span> : ∏ <span class="id" title="var">a</span> : <span class="id" title="var">A</span>, <span class="id" title="var">isrcancelable</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>) (<span class="id" title="var">pr1carrier</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span>)) :<br/>
&nbsp;&nbsp;∏ <span class="id" title="var">a'</span> : <span class="id" title="var">A</span>, <span class="id" title="var">isincl</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">prabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">x</span> <span class="id" title="var">a'</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">a'</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">isinclbetweensets</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">setproperty</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">setproperty</span> (<span class="id" title="var">abmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">e'</span> := <span class="id" title="var">invweq</span> (<span class="id" title="var">weqpathsinsetquot</span> (<span class="id" title="var">eqrelabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>) (<span class="id" title="var">dirprodpair</span> <span class="id" title="var">x</span> <span class="id" title="var">a'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">dirprodpair</span> <span class="id" title="var">x'</span> <span class="id" title="var">a'</span>)) <span class="id" title="var">e</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">e''</span> := <span class="id" title="var">weqhrelhrel0abmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">iscanc</span> (<span class="id" title="var">dirprodpair</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) (<span class="id" title="var">dirprodpair</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">e'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">invmaponpathsincl</span> <span class="id" title="var">_</span> (<span class="id" title="var">iscanc</span> <span class="id" title="var">a'</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">e''</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isincltoabmonoidfrac</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">iscanc</span> : ∏ <span class="id" title="var">a</span> : <span class="id" title="var">A</span>, <span class="id" title="var">isrcancelable</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>) (<span class="id" title="var">pr1carrier</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span>)) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isincl</span> (<span class="id" title="var">toabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>) := <span class="id" title="var">isinclprabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">iscanc</span> (<span class="id" title="var">unel</span> <span class="id" title="var">A</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isdeceqabmonoidfrac</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">iscanc</span> : ∏ <span class="id" title="var">a</span> : <span class="id" title="var">A</span>, <span class="id" title="var">isrcancelable</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>) (<span class="id" title="var">pr1carrier</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span>)) (<span class="id" title="keyword">is</span> : <span class="id" title="var">isdeceq</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isdeceq</span> (<span class="id" title="var">abmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isdeceqsetquot</span> (<span class="id" title="var">eqrelabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>)). <span class="id" title="tactic">intros</span> <span class="id" title="var">xa</span> <span class="id" title="var">xa'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isdecpropweqb</span> (<span class="id" title="var">weqhrelhrel0abmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">iscanc</span> <span class="id" title="var">xa</span> <span class="id" title="var">xa'</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isdecpropif</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">isaprop</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">int</span> := <span class="id" title="var">setproperty</span> <span class="id" title="var">X</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">xa</span> + <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa'</span>)) (<span class="id" title="var">pr1</span> <span class="id" title="var">xa'</span> + <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">int</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">int</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">hrel0abmonoidfrac</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">eqset</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="keyword">is</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab444"></a><h4 class="section">Relations on the abelian monoid of fractions</h4>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abmonoidfracrelint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) (<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hrel</span> (<span class="id" title="var">setwithbinopdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">λ</span> <span class="id" title="var">xa</span> <span class="id" title="var">yb</span>, <span class="id" title="var">hexists</span> (<span class="id" title="var">λ</span> <span class="id" title="var">c0</span> : <span class="id" title="var">A</span>, <span class="id" title="var">L</span> (((<span class="id" title="var">pr1</span> <span class="id" title="var">xa</span>) + (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">yb</span>))) + (<span class="id" title="var">pr1</span> <span class="id" title="var">c0</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(((<span class="id" title="var">pr1</span> <span class="id" title="var">yb</span>) + (<span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa</span>))) + (<span class="id" title="var">pr1</span> <span class="id" title="var">c0</span>))).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iscomprelabmonoidfracrelint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) : <span class="id" title="var">iscomprelrel</span> (<span class="id" title="var">eqrelabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>) (<span class="id" title="var">abmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">assoc</span> := (<span class="id" title="var">assocax</span> <span class="id" title="var">X</span>) : <span class="id" title="var">isassoc</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">isassoc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">assoc</span>. <span class="id" title="tactic">set</span> (<span class="id" title="var">comm</span> := <span class="id" title="var">commax</span> <span class="id" title="var">X</span>). <span class="id" title="tactic">unfold</span> <span class="id" title="var">iscomm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">rer</span> := <span class="id" title="var">abmonoidrer</span> <span class="id" title="var">X</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">iscomprelrelif</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">eqrelsymm</span> (<span class="id" title="var">eqrelabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">xa</span> <span class="id" title="var">xa'</span> <span class="id" title="var">yb</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">hrelabmonoidfrac</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> (@<span class="id" title="var">hinhfun2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t2e</span> <span class="id" title="var">t2l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t2e</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">c1a</span> <span class="id" title="var">e</span> ]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">t2l</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">c0a</span> <span class="id" title="var">l</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">x</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">xa</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">a</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">x'</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">xa'</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">a'</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa'</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">y</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">yb</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">b</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">yb</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">c0</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">c0a</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">c1</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">c1a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ((<span class="id" title="var">pr2</span> <span class="id" title="var">xa</span>) + <span class="id" title="var">c1a</span> + <span class="id" title="var">c0a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">L</span> ((<span class="id" title="var">x'</span> + <span class="id" title="var">b</span>) + ((<span class="id" title="var">a</span> + <span class="id" title="var">c1</span>) + <span class="id" title="var">c0</span>)) ((<span class="id" title="var">y</span> + <span class="id" title="var">a'</span>) + ((<span class="id" title="var">a</span> + <span class="id" title="var">c1</span>) + <span class="id" title="var">c0</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">paths</span> (<span class="id" title="var">x</span> + <span class="id" title="var">a'</span> + <span class="id" title="var">c1</span>) (<span class="id" title="var">x'</span> + <span class="id" title="var">a</span> + <span class="id" title="var">c1</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">rer</span> <span class="id" title="var">x'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">c0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">x'</span> <span class="id" title="var">a</span> <span class="id" title="var">c1</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">x</span> <span class="id" title="var">a'</span> <span class="id" title="var">c1</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">rer</span> <span class="id" title="var">x</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">c0</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">a</span> <span class="id" title="var">c1</span> <span class="id" title="var">c0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">rer</span> <span class="id" title="var">_</span> <span class="id" title="var">a'</span> <span class="id" title="var">a</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">a'</span> <span class="id" title="var">c1</span> <span class="id" title="var">c0</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">comm</span> <span class="id" title="var">a'</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">comm</span> <span class="id" title="var">c1</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span>  <span class="id" title="var">c0</span> <span class="id" title="var">c1</span> <span class="id" title="var">a'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">x</span> + <span class="id" title="var">b</span>) <span class="id" title="var">c0</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span> <span class="id" title="var">c1</span> <span class="id" title="var">a'</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">y</span> + <span class="id" title="var">a</span>) <span class="id" title="var">c0</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span> <span class="id" title="var">c1</span> <span class="id" title="var">a'</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ((<span class="id" title="var">pr2</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr2</span> (@<span class="id" title="var">op</span> <span class="id" title="var">A</span> <span class="id" title="var">c1a</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa'</span>))) <span class="id" title="var">l</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">xa</span> <span class="id" title="var">yb</span> <span class="id" title="var">yb'</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">hrelabmonoidfrac</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> (@<span class="id" title="var">hinhfun2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t2e</span> <span class="id" title="var">t2l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t2e</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">c1a</span> <span class="id" title="var">e</span> ]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">t2l</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">c0a</span> <span class="id" title="var">l</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">x</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">xa</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">a</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">y'</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">yb'</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">b'</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">yb'</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">y</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">yb</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">b</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">yb</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">c0</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">c0a</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">c1</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">c1a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ((<span class="id" title="var">pr2</span> <span class="id" title="var">yb</span>) + <span class="id" title="var">c1a</span> + <span class="id" title="var">c0a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">L</span> ((<span class="id" title="var">x</span> + <span class="id" title="var">b'</span>) + ((<span class="id" title="var">b</span> + <span class="id" title="var">c1</span>) + <span class="id" title="var">c0</span>)) ((<span class="id" title="var">y'</span> + <span class="id" title="var">a</span>) + ((<span class="id" title="var">b</span> + <span class="id" title="var">c1</span>) + <span class="id" title="var">c0</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">paths</span> (<span class="id" title="var">y</span> + <span class="id" title="var">b'</span> + <span class="id" title="var">c1</span>) (<span class="id" title="var">y'</span> + <span class="id" title="var">b</span> + <span class="id" title="var">c1</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">rer</span> <span class="id" title="var">y'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">c0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">y'</span> <span class="id" title="var">b</span> <span class="id" title="var">c1</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">y</span> <span class="id" title="var">b'</span> <span class="id" title="var">c1</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">rer</span> <span class="id" title="var">y</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">c0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">b</span> <span class="id" title="var">c1</span> <span class="id" title="var">c0</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">rer</span> <span class="id" title="var">_</span> <span class="id" title="var">b'</span> <span class="id" title="var">b</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">b'</span> <span class="id" title="var">c1</span> <span class="id" title="var">c0</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">comm</span> <span class="id" title="var">b'</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">comm</span> <span class="id" title="var">c1</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span>  <span class="id" title="var">c0</span> <span class="id" title="var">c1</span> <span class="id" title="var">b'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">x</span> + <span class="id" title="var">b</span>) <span class="id" title="var">c0</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span> <span class="id" title="var">c1</span> <span class="id" title="var">b'</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">y</span> + <span class="id" title="var">a</span>) <span class="id" title="var">c0</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span> <span class="id" title="var">c1</span> <span class="id" title="var">b'</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ((<span class="id" title="var">pr2</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr2</span> (@<span class="id" title="var">op</span> <span class="id" title="var">A</span> <span class="id" title="var">c1a</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">yb'</span>))) <span class="id" title="var">l</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">iscomprelabmonoidfracrelint</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abmonoidfracrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) := <span class="id" title="var">quotrel</span> (<span class="id" title="var">iscomprelabmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">istransabmonoidfracrelint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">istrans</span> <span class="id" title="var">L</span>) : <span class="id" title="var">istrans</span> (<span class="id" title="var">abmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">assoc</span> := (<span class="id" title="var">assocax</span> <span class="id" title="var">X</span>) : <span class="id" title="var">isassoc</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>)). <span class="id" title="tactic">unfold</span> <span class="id" title="var">isassoc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">comm</span> := <span class="id" title="var">commax</span> <span class="id" title="var">X</span>). <span class="id" title="tactic">unfold</span> <span class="id" title="var">iscomm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">comm</span>. <span class="id" title="tactic">set</span> (<span class="id" title="var">rer</span> := <span class="id" title="var">abmonoidrer</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">xa1</span> <span class="id" title="var">xa2</span> <span class="id" title="var">xa3</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">abmonoidfracrelint</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hinhfun2</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">t2l1</span> <span class="id" title="var">t2l2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">c1a</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">t2l1</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">l1</span> := <span class="id" title="var">pr2</span> <span class="id" title="var">t2l1</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">c2a</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">t2l2</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">l2</span> := <span class="id" title="var">pr2</span> <span class="id" title="var">t2l2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">x1</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">xa1</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">a1</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa1</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">x2</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">xa2</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">a2</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa2</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">x3</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">xa3</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">a3</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa3</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">c1</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">c1a</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">c2</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">c2a</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ((<span class="id" title="var">pr2</span> <span class="id" title="var">xa2</span>) + (@<span class="id" title="var">op</span> <span class="id" title="var">A</span> <span class="id" title="var">c1a</span> <span class="id" title="var">c2a</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">L</span> ((<span class="id" title="var">x1</span> + <span class="id" title="var">a3</span>) + (<span class="id" title="var">a2</span> + (<span class="id" title="var">c1</span> + <span class="id" title="var">c2</span>))) ((<span class="id" title="var">x3</span> + <span class="id" title="var">a1</span>) + (<span class="id" title="var">a2</span> + (<span class="id" title="var">c1</span> + <span class="id" title="var">c2</span>)))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">ll1</span> : <span class="id" title="var">L</span> ((<span class="id" title="var">x1</span> + <span class="id" title="var">a3</span>) + (<span class="id" title="var">a2</span> + (@<span class="id" title="var">op</span> <span class="id" title="var">X</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(((<span class="id" title="var">x2</span> + <span class="id" title="var">a1</span>) + <span class="id" title="var">c1</span>) + (<span class="id" title="var">c2</span> + <span class="id" title="var">a3</span>))).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">rer</span> <span class="id" title="var">_</span> <span class="id" title="var">a3</span> <span class="id" title="var">a2</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">comm</span> <span class="id" title="var">a3</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span> <span class="id" title="var">a3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">x1</span> + <span class="id" title="var">a2</span>) <span class="id" title="var">c1</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span> <span class="id" title="var">c2</span> <span class="id" title="var">a3</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ((<span class="id" title="var">pr2</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr2</span> (@<span class="id" title="var">op</span> <span class="id" title="var">A</span> <span class="id" title="var">c2a</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa3</span>))) <span class="id" title="var">l1</span>).<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">ll2</span> : <span class="id" title="var">L</span> (((<span class="id" title="var">x2</span> + <span class="id" title="var">a3</span>) + <span class="id" title="var">c2</span>) + (@<span class="id" title="var">op</span> <span class="id" title="var">X</span> <span class="id" title="var">a1</span> <span class="id" title="var">c1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">x3</span> + <span class="id" title="var">a1</span>) + (<span class="id" title="var">a2</span> + (@<span class="id" title="var">op</span> <span class="id" title="var">X</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>)))).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">rer</span> <span class="id" title="var">_</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">a1</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">comm</span> (<span class="id" title="var">a1</span> + <span class="id" title="var">c1</span>) <span class="id" title="var">c2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">x3</span> + <span class="id" title="var">a2</span>) <span class="id" title="var">c2</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span> <span class="id" title="var">a1</span> <span class="id" title="var">c1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ((<span class="id" title="var">pr2</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr2</span> (@<span class="id" title="var">op</span> <span class="id" title="var">A</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa1</span>) <span class="id" title="var">c1a</span>)) <span class="id" title="var">l2</span>).<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">e</span> : <span class="id" title="var">paths</span> (<span class="id" title="var">x2</span> + <span class="id" title="var">a1</span> + <span class="id" title="var">c1</span> + (<span class="id" title="var">c2</span> + <span class="id" title="var">a3</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">x2</span> + <span class="id" title="var">a3</span> + <span class="id" title="var">c2</span> + (<span class="id" title="var">a1</span> + <span class="id" title="var">c1</span>))).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">x2</span> + <span class="id" title="var">a1</span>) <span class="id" title="var">c1</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">x2</span> + <span class="id" title="var">a3</span>) <span class="id" title="var">c2</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">x2</span> <span class="id" title="var">a1</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">x2</span> <span class="id" title="var">a3</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">a1</span> <span class="id" title="var">c1</span> (<span class="id" title="var">c2</span> + <span class="id" title="var">a3</span>)). <span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">a3</span> <span class="id" title="var">c2</span> (<span class="id" title="var">a1</span> + <span class="id" title="var">c1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">comm</span> (<span class="id" title="var">c2</span> + <span class="id" title="var">a3</span>) (<span class="id" title="var">a1</span> + <span class="id" title="var">c1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">comm</span> <span class="id" title="var">a3</span> <span class="id" title="var">c2</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">isl</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ll1</span> <span class="id" title="var">ll2</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">istransabmonoidfracrelint</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">istransabmonoidfracrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">istrans</span> <span class="id" title="var">L</span>) : <span class="id" title="var">istrans</span> (<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">istransquotrel</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">istransabmonoidfracrelint</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="keyword">is</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isl</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">issymmabmonoidfracrelint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">issymm</span> <span class="id" title="var">L</span>) : <span class="id" title="var">issymm</span> (<span class="id" title="var">abmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">xa1</span> <span class="id" title="var">xa2</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">abmonoidfracrelint</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hinhfun</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">t2l1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">c1a</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">t2l1</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">l1</span> := <span class="id" title="var">pr2</span> <span class="id" title="var">t2l1</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">c1a</span>). <span class="id" title="tactic">apply</span> (<span class="id" title="var">isl</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">l1</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">issymmabmonoidfracrelint</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">issymmabmonoidfracrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">issymm</span> <span class="id" title="var">L</span>) : <span class="id" title="var">issymm</span> (<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">issymmquotrel</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">issymmabmonoidfracrelint</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="keyword">is</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isl</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isreflabmonoidfracrelint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">isrefl</span> <span class="id" title="var">L</span>) : <span class="id" title="var">isrefl</span> (<span class="id" title="var">abmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">xa</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">abmonoidfracrelint</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhpr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">unel</span> <span class="id" title="var">A</span>). <span class="id" title="tactic">apply</span> (<span class="id" title="var">isl</span> <span class="id" title="var">_</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isreflabmonoidfracrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">isrefl</span> <span class="id" title="var">L</span>) : <span class="id" title="var">isrefl</span> (<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isreflquotrel</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">isreflabmonoidfracrelint</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="keyword">is</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isl</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ispoabmonoidfracrelint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">ispreorder</span> <span class="id" title="var">L</span>) : <span class="id" title="var">ispreorder</span> (<span class="id" title="var">abmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">istransabmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">isl</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isreflabmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">isl</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ispoabmonoidfracrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">ispreorder</span> <span class="id" title="var">L</span>) : <span class="id" title="var">ispreorder</span> (<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ispoquotrel</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ispoabmonoidfracrelint</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="keyword">is</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">isl</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iseqrelabmonoidfracrelint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">iseqrel</span> <span class="id" title="var">L</span>) : <span class="id" title="var">iseqrel</span> (<span class="id" title="var">abmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">ispoabmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">isl</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">issymmabmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">isl</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iseqrelabmonoidfracrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">iseqrel</span> <span class="id" title="var">L</span>) : <span class="id" title="var">iseqrel</span> (<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">iseqrelquotrel</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">iseqrelabmonoidfracrelint</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="keyword">is</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isl</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isirreflabmonoidfracrelint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">isirrefl</span> <span class="id" title="var">L</span>) : <span class="id" title="var">isirrefl</span> (<span class="id" title="var">abmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">isirrefl</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">xa</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">abmonoidfracrelint</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">neg</span>. <span class="id" title="tactic">apply</span> (@<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> (<span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> <span class="id" title="var">isapropempty</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t2</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">isl</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">t2</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isirreflabmonoidfracrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">isirrefl</span> <span class="id" title="var">L</span>) : <span class="id" title="var">isirrefl</span> (<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isirreflquotrel</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">isirreflabmonoidfracrelint</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="keyword">is</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isl</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isasymmabmonoidfracrelint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">isasymm</span> <span class="id" title="var">L</span>) : <span class="id" title="var">isasymm</span> (<span class="id" title="var">abmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">assoc</span> := (<span class="id" title="var">assocax</span> <span class="id" title="var">X</span>) : <span class="id" title="var">isassoc</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">isassoc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">assoc</span>. <span class="id" title="tactic">set</span> (<span class="id" title="var">comm</span> := <span class="id" title="var">commax</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">iscomm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">comm</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">isasymm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">xa1</span> <span class="id" title="var">xa2</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">abmonoidfracrelint</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (@<span class="id" title="var">hinhuniv2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> <span class="id" title="var">isapropempty</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t2l1</span> <span class="id" title="var">t2l2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">c1a</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">t2l1</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">l1</span> := <span class="id" title="var">pr2</span> <span class="id" title="var">t2l1</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">c2a</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">t2l2</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">l2</span> := <span class="id" title="var">pr2</span> <span class="id" title="var">t2l2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">c1</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">c1a</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">c2</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">c2a</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">x1</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">xa1</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">a1</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa1</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">x2</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">xa2</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">a2</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa2</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">ll1</span> : <span class="id" title="var">L</span> ((<span class="id" title="var">x1</span> + <span class="id" title="var">a2</span>) + (@<span class="id" title="var">op</span> <span class="id" title="var">X</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>)) ((<span class="id" title="var">x2</span> + <span class="id" title="var">a1</span>) + (@<span class="id" title="var">op</span> <span class="id" title="var">X</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>))).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">x1</span> + <span class="id" title="var">a2</span>) <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>). <span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">x2</span> + <span class="id" title="var">a1</span>) <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ((<span class="id" title="var">pr2</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">c2a</span>)). <span class="id" title="tactic">apply</span> <span class="id" title="var">l1</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">ll2</span> : <span class="id" title="var">L</span> ((<span class="id" title="var">x2</span> + <span class="id" title="var">a1</span>) + (@<span class="id" title="var">op</span> <span class="id" title="var">X</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>)) ((<span class="id" title="var">x1</span> + <span class="id" title="var">a2</span>) + (@<span class="id" title="var">op</span> <span class="id" title="var">X</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>))).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">comm</span> <span class="id" title="var">c2</span> <span class="id" title="var">c1</span>). <span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">x1</span> + <span class="id" title="var">a2</span>) <span class="id" title="var">c2</span> <span class="id" title="var">c1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">x2</span> + <span class="id" title="var">a1</span>) <span class="id" title="var">c2</span> <span class="id" title="var">c1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ((<span class="id" title="var">pr2</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">c1a</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">l2</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isl</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ll1</span> <span class="id" title="var">ll2</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">isasymmabmonoidfracrelint</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isasymmabmonoidfracrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">isasymm</span> <span class="id" title="var">L</span>) : <span class="id" title="var">isasymm</span> (<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isasymmquotrel</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">isasymmabmonoidfracrelint</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="keyword">is</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isl</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iscoasymmabmonoidfracrelint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">iscoasymm</span> <span class="id" title="var">L</span>) : <span class="id" title="var">iscoasymm</span> (<span class="id" title="var">abmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">assoc</span> := (<span class="id" title="var">assocax</span> <span class="id" title="var">X</span>) : <span class="id" title="var">isassoc</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>)). <span class="id" title="tactic">unfold</span> <span class="id" title="var">isassoc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">comm</span> := <span class="id" title="var">commax</span> <span class="id" title="var">X</span>). <span class="id" title="tactic">unfold</span> <span class="id" title="var">iscomm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">comm</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">iscoasymm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">xa1</span> <span class="id" title="var">xa2</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">nl0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">nl</span> := <span class="id" title="var">neghexisttoforallneg</span> <span class="id" title="var">_</span> <span class="id" title="var">nl0</span> (<span class="id" title="var">unel</span> <span class="id" title="var">A</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">nl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">l</span> := <span class="id" title="var">isl</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">nl</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hinhpr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">unel</span> <span class="id" title="var">A</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">l</span>.<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">isasymmabmonoidfracrelint</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iscoasymmabmonoidfracrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">iscoasymm</span> <span class="id" title="var">L</span>) : <span class="id" title="var">iscoasymm</span> (<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">iscoasymmquotrel</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">iscoasymmabmonoidfracrelint</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="keyword">is</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isl</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">istotalabmonoidfracrelint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">istotal</span> <span class="id" title="var">L</span>) : <span class="id" title="var">istotal</span> (<span class="id" title="var">abmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">istotal</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">abmonoidfracrelint</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">int</span> := <span class="id" title="var">isl</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">x1</span> + <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">x2</span>)) (<span class="id" title="var">pr1</span> <span class="id" title="var">x2</span> + <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">x1</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="var">int</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">int</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hinhfun</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">coprodf</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hinhpr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">unel</span> <span class="id" title="var">A</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">runax</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">runax</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">l</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hinhpr</span>. <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">unel</span> <span class="id" title="var">A</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">runax</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">runax</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">l</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">istotalabmonoidfracrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">istotal</span> <span class="id" title="var">L</span>) : <span class="id" title="var">istotal</span> (<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">istotalquotrel</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">istotalabmonoidfracrelint</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="keyword">is</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isl</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iscotransabmonoidfracrelint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">iscotrans</span> <span class="id" title="var">L</span>) : <span class="id" title="var">iscotrans</span> (<span class="id" title="var">abmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">assoc</span> := (<span class="id" title="var">assocax</span> <span class="id" title="var">X</span>) : <span class="id" title="var">isassoc</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>)). <span class="id" title="tactic">unfold</span> <span class="id" title="var">isassoc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">comm</span> := (<span class="id" title="var">commax</span> <span class="id" title="var">X</span>) : <span class="id" title="var">iscomm</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>)). <span class="id" title="tactic">unfold</span> <span class="id" title="var">iscomm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">rer</span> := <span class="id" title="var">abmonoidrer</span> <span class="id" title="var">X</span>). <span class="id" title="tactic">unfold</span> <span class="id" title="var">iscotrans</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">xa1</span> <span class="id" title="var">xa2</span> <span class="id" title="var">xa3</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">abmonoidfracrelint</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (@<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> (<span class="id" title="var">ishinh</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">c0a</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">t2</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">l0</span> := <span class="id" title="var">pr2</span> <span class="id" title="var">t2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">x1</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">xa1</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">a1</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa1</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">x2</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">xa2</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">a2</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa2</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">x3</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">xa3</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">a3</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa3</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">c0</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">c0a</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">z1</span> := (<span class="id" title="var">x1</span> + <span class="id" title="var">a3</span> + (<span class="id" title="var">a2</span> + <span class="id" title="var">c0</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">z2</span> := <span class="id" title="var">x2</span> + <span class="id" title="var">a1</span> + (<span class="id" title="var">a3</span> + <span class="id" title="var">c0</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">z3</span> := <span class="id" title="var">x3</span> + <span class="id" title="var">a1</span> + (<span class="id" title="var">a2</span> + <span class="id" title="var">c0</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">int</span> : <span class="id" title="var">L</span> <span class="id" title="var">z1</span> <span class="id" title="var">z3</span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">z1</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">z3</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">comm</span> <span class="id" title="var">a2</span> <span class="id" title="var">c0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">pathsinv0</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">a2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">pathsinv0</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">a2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ((<span class="id" title="var">pr2</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa2</span>)) <span class="id" title="var">l0</span>).<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">int'</span> := <span class="id" title="var">isl</span> <span class="id" title="var">z1</span> <span class="id" title="var">z2</span> <span class="id" title="var">z3</span> <span class="id" title="var">int</span>). <span class="id" title="tactic">generalize</span> <span class="id" title="var">int'</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">int'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhfun</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">cc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">cc</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">l12</span> | <span class="id" title="var">l23</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhpr</span>. <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ((<span class="id" title="var">pr2</span> <span class="id" title="var">xa3</span>) + <span class="id" title="var">c0a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">L</span> (<span class="id" title="var">x1</span> + <span class="id" title="var">a2</span> + (<span class="id" title="var">a3</span> + <span class="id" title="var">c0</span>)) (<span class="id" title="var">x2</span> + <span class="id" title="var">a1</span> + (<span class="id" title="var">a3</span> + <span class="id" title="var">c0</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">rer</span> <span class="id" title="var">_</span> <span class="id" title="var">a2</span> <span class="id" title="var">a3</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">l12</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhpr</span>. <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ((<span class="id" title="var">pr2</span> <span class="id" title="var">xa1</span>) + <span class="id" title="var">c0a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">L</span> (<span class="id" title="var">x2</span> + <span class="id" title="var">a3</span> + (<span class="id" title="var">a1</span> + <span class="id" title="var">c0</span>)) (<span class="id" title="var">x3</span> + <span class="id" title="var">a2</span> + (<span class="id" title="var">a1</span> + <span class="id" title="var">c0</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">rer</span> <span class="id" title="var">_</span> <span class="id" title="var">a3</span> <span class="id" title="var">a1</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">rer</span> <span class="id" title="var">_</span> <span class="id" title="var">a2</span> <span class="id" title="var">a1</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">l23</span>.<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">iscotransabmonoidfracrelint</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iscotransabmonoidfracrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">iscotrans</span> <span class="id" title="var">L</span>) : <span class="id" title="var">iscotrans</span> (<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">iscotransquotrel</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">iscotransabmonoidfracrelint</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="keyword">is</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isl</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isantisymmnegabmonoidfracrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">isantisymmneg</span> <span class="id" title="var">L</span>) : <span class="id" title="var">isantisymmneg</span> (<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">int</span> : ∏ <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>, <span class="id" title="var">isaprop</span> (<span class="id" title="var">neg</span> (<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">neg</span> (<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x2</span> <span class="id" title="var">x1</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x1</span> = <span class="id" title="var">x2</span>)).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>. <span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>. <span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isasetsetquot</span> <span class="id" title="var">_</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>).<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">isantisymmneg</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">setquotuniv2prop</span> <span class="id" title="var">_</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>, <span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> (<span class="id" title="var">int</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">xa1</span> <span class="id" title="var">xa2</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">r</span> <span class="id" title="var">r'</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">weqpathsinsetquot</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="var">r</span> <span class="id" title="var">r'</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">r</span> <span class="id" title="var">r'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">neg</span> (<span class="id" title="var">abmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span> <span class="id" title="var">xa1</span> <span class="id" title="var">xa2</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">neg</span> (<span class="id" title="var">abmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span> <span class="id" title="var">xa2</span> <span class="id" title="var">xa1</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">eqrelabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">xa1</span> <span class="id" title="var">xa2</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">nr12</span> <span class="id" title="var">nr21</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">nr12'</span> := <span class="id" title="var">neghexisttoforallneg</span> <span class="id" title="var">_</span> <span class="id" title="var">nr12</span> (<span class="id" title="var">unel</span> <span class="id" title="var">A</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">nr21'</span> := <span class="id" title="var">neghexisttoforallneg</span> <span class="id" title="var">_</span> <span class="id" title="var">nr21</span> (<span class="id" title="var">unel</span> <span class="id" title="var">A</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">int'</span> := <span class="id" title="var">isl</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">nr12'</span> <span class="id" title="var">nr21'</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhpr</span>. <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">unel</span> <span class="id" title="var">A</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">int'</span>.<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">isantisymmnegabmonoidfracrel</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isantisymmabmonoidfracrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">isantisymm</span> <span class="id" title="var">L</span>) : <span class="id" title="var">isantisymm</span> (<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">assoc</span> := (<span class="id" title="var">assocax</span> <span class="id" title="var">X</span>) : <span class="id" title="var">isassoc</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>)). <span class="id" title="tactic">unfold</span> <span class="id" title="var">isassoc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">comm</span> := <span class="id" title="var">commax</span> <span class="id" title="var">X</span>). <span class="id" title="tactic">unfold</span> <span class="id" title="var">iscomm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">comm</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">isantisymm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">int</span> : ∏ <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>, <span class="id" title="var">isaprop</span> ((<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x2</span> <span class="id" title="var">x1</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x1</span> = <span class="id" title="var">x2</span>)).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>. <span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>. <span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isasetsetquot</span> <span class="id" title="var">_</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>).<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">setquotuniv2prop</span> <span class="id" title="var">_</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>, <span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> (<span class="id" title="var">int</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">xa1</span> <span class="id" title="var">xa2</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">r</span> <span class="id" title="var">r'</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">weqpathsinsetquot</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="var">r</span> <span class="id" title="var">r'</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">r</span> <span class="id" title="var">r'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> ((<span class="id" title="var">abmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span> <span class="id" title="var">xa1</span> <span class="id" title="var">xa2</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">abmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span> <span class="id" title="var">xa2</span> <span class="id" title="var">xa1</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">eqrelabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">xa1</span> <span class="id" title="var">xa2</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">abmonoidfracrelint</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">eqrelabmonoidfrac</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hinhfun2</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">t2l1</span> <span class="id" title="var">t2l2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">c1a</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">t2l1</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">l1</span> := <span class="id" title="var">pr2</span> <span class="id" title="var">t2l1</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">c2a</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">t2l2</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">l2</span> := <span class="id" title="var">pr2</span> <span class="id" title="var">t2l2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">c1</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">c1a</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">c2</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">c2a</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (@<span class="id" title="var">op</span> <span class="id" title="var">A</span> <span class="id" title="var">c1a</span> <span class="id" title="var">c2a</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">x1</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">xa1</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">a1</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa1</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">x2</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">xa2</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">a2</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa2</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">paths</span> (<span class="id" title="var">x1</span> + <span class="id" title="var">a2</span> + (@<span class="id" title="var">op</span> <span class="id" title="var">X</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>)) (<span class="id" title="var">x2</span> + <span class="id" title="var">a1</span> + (@<span class="id" title="var">op</span> <span class="id" title="var">X</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">ll1</span> : <span class="id" title="var">L</span> ((<span class="id" title="var">x1</span> + <span class="id" title="var">a2</span>) + (@<span class="id" title="var">op</span> <span class="id" title="var">X</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>)) ((<span class="id" title="var">x2</span> + <span class="id" title="var">a1</span>) + (@<span class="id" title="var">op</span> <span class="id" title="var">X</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>))).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">x1</span> + <span class="id" title="var">a2</span>) <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">x2</span> + <span class="id" title="var">a1</span>) <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ((<span class="id" title="var">pr2</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">c2a</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">l1</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">ll2</span> : <span class="id" title="var">L</span> ((<span class="id" title="var">x2</span> + <span class="id" title="var">a1</span>) + (@<span class="id" title="var">op</span> <span class="id" title="var">X</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>)) ((<span class="id" title="var">x1</span> + <span class="id" title="var">a2</span>) + (@<span class="id" title="var">op</span> <span class="id" title="var">X</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>))).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">comm</span> <span class="id" title="var">c2</span> <span class="id" title="var">c1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">x1</span> + <span class="id" title="var">a2</span>) <span class="id" title="var">c2</span> <span class="id" title="var">c1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">x2</span> + <span class="id" title="var">a1</span>) <span class="id" title="var">c2</span> <span class="id" title="var">c1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ((<span class="id" title="var">pr2</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">c1a</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">l2</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isl</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ll1</span> <span class="id" title="var">ll2</span>).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">isantisymmabmonoidfracrel</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ispartbinopabmonoidfracrelint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) :<br/>
&nbsp;&nbsp;@<span class="id" title="var">ispartbinophrel</span> (<span class="id" title="var">setwithbinopdirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>) (<span class="id" title="var">λ</span> <span class="id" title="var">xa</span>, <span class="id" title="var">A</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">xa</span>)) (<span class="id" title="var">abmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">assoc</span> := (<span class="id" title="var">assocax</span> <span class="id" title="var">X</span>) : <span class="id" title="var">isassoc</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>)). <span class="id" title="tactic">unfold</span> <span class="id" title="var">isassoc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">comm</span> := <span class="id" title="var">commax</span> <span class="id" title="var">X</span>). <span class="id" title="tactic">unfold</span> <span class="id" title="var">iscomm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">rer</span> := <span class="id" title="var">abmonoidrer</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ispartbinophrelif</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">commax</span> (<span class="id" title="var">abmonoiddirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">xa</span> <span class="id" title="var">yb</span> <span class="id" title="var">zc</span> <span class="id" title="var">s</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">abmonoidfracrelint</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (@<span class="id" title="var">hinhfun</span>). <span class="id" title="tactic">intro</span> <span class="id" title="var">t2l</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">t2l</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">c0a</span> <span class="id" title="var">l</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">x</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">xa</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">a</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">y</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">yb</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">b</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">yb</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">z</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">zc</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">c</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">zc</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">c0</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">c0a</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">c0a</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">L</span> (((<span class="id" title="var">z</span> + <span class="id" title="var">x</span>) + (<span class="id" title="var">c</span> + <span class="id" title="var">b</span>)) + <span class="id" title="var">c0</span>) (((<span class="id" title="var">z</span> + <span class="id" title="var">y</span>) + (<span class="id" title="var">c</span> + <span class="id" title="var">a</span>)) + <span class="id" title="var">c0</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">L</span> ((<span class="id" title="var">x</span> + <span class="id" title="var">b</span>) + <span class="id" title="var">c0</span>) ((<span class="id" title="var">y</span> + <span class="id" title="var">a</span>) + <span class="id" title="var">c0</span>))) <span class="id" title="tactic">in</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">rer</span> <span class="id" title="var">z</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">b</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">z</span> + <span class="id" title="var">c</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">rer</span> <span class="id" title="var">z</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">z</span> + <span class="id" title="var">c</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ((<span class="id" title="var">pr1</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr2</span> (@<span class="id" title="var">op</span> <span class="id" title="var">A</span> (<span class="id" title="var">carrierpair</span> <span class="id" title="var">A</span> <span class="id" title="var">z</span> <span class="id" title="var">s</span>) (<span class="id" title="var">pr2</span> <span class="id" title="var">zc</span>)))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">l</span>.<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">ispartbinopabmonoidfracrelint</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ispartlbinopabmonoidfracrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">aa</span> <span class="id" title="var">aa'</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">z</span> <span class="id" title="var">z'</span> : <span class="id" title="var">abmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">l</span> : <span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span> <span class="id" title="var">z</span> <span class="id" title="var">z'</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">prabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">aa</span>) <span class="id" title="var">aa'</span>) + <span class="id" title="var">z</span>) ((<span class="id" title="var">prabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">aa</span>) <span class="id" title="var">aa'</span>) + <span class="id" title="var">z'</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">z</span> <span class="id" title="var">z'</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">assoc</span> := (<span class="id" title="var">assocax</span> <span class="id" title="var">X</span>) : <span class="id" title="var">isassoc</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>)). <span class="id" title="tactic">unfold</span> <span class="id" title="var">isassoc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">comm</span> := <span class="id" title="var">commax</span> <span class="id" title="var">X</span>). <span class="id" title="tactic">unfold</span> <span class="id" title="var">iscomm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">rer</span> := <span class="id" title="var">abmonoidrer</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">int</span> : ∏ <span class="id" title="var">z</span> <span class="id" title="var">z'</span>, <span class="id" title="var">isaprop</span> (<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span> <span class="id" title="var">z</span> <span class="id" title="var">z'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">abmonoidfracrel</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">prabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">aa</span>) <span class="id" title="var">aa'</span> + <span class="id" title="var">z</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">prabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">aa</span>) <span class="id" title="var">aa'</span> + <span class="id" title="var">z'</span>))).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">z</span> <span class="id" title="var">z'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>. <span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">setquotuniv2prop</span> <span class="id" title="var">_</span> (<span class="id" title="var">λ</span> <span class="id" title="var">z</span> <span class="id" title="var">z'</span>, <span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> (<span class="id" title="var">int</span> <span class="id" title="var">z</span> <span class="id" title="var">z'</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">xa1</span> <span class="id" title="var">xa2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">abmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span> <span class="id" title="var">xa1</span> <span class="id" title="var">xa2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">abmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">op</span> (<span class="id" title="var">abmonoiddirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>) (<span class="id" title="var">dirprodpair</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">aa</span>) <span class="id" title="var">aa'</span>) <span class="id" title="var">xa1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">op</span> (<span class="id" title="var">abmonoiddirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>) (<span class="id" title="var">dirprodpair</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">aa</span>) <span class="id" title="var">aa'</span>) <span class="id" title="var">xa2</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">abmonoidfracrelint</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhfun</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">t2l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">a</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">aa</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">a'</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">aa'</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">c0a</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">t2l</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">l</span> := <span class="id" title="var">pr2</span> <span class="id" title="var">t2l</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">c0</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">c0a</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">x1</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">xa1</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">a1</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa1</span>)). <span class="id" title="tactic">set</span> (<span class="id" title="var">x2</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">xa2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">a2</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa2</span>)). <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">c0a</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">L</span> (<span class="id" title="var">a</span> + <span class="id" title="var">x1</span> + (<span class="id" title="var">a'</span> + <span class="id" title="var">a2</span>) + <span class="id" title="var">c0</span>) (<span class="id" title="var">a</span> + <span class="id" title="var">x2</span> + (<span class="id" title="var">a'</span> + <span class="id" title="var">a1</span>) + <span class="id" title="var">c0</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">rer</span> <span class="id" title="var">_</span> <span class="id" title="var">x1</span> <span class="id" title="var">a'</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">rer</span> <span class="id" title="var">_</span> <span class="id" title="var">x2</span> <span class="id" title="var">a'</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">_</span> (<span class="id" title="var">x1</span> + <span class="id" title="var">a2</span>) <span class="id" title="var">c0</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span> <span class="id" title="var">_</span> (<span class="id" title="var">x2</span> + <span class="id" title="var">a1</span>) <span class="id" title="var">c0</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ((<span class="id" title="var">pr1</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr2</span> (@<span class="id" title="var">op</span> <span class="id" title="var">A</span> <span class="id" title="var">aa</span> <span class="id" title="var">aa'</span>))). <span class="id" title="tactic">apply</span> <span class="id" title="var">l</span>.<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">ispartlbinopabmonoidfracrel</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ispartrbinopabmonoidfracrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">aa</span> <span class="id" title="var">aa'</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">z</span> <span class="id" title="var">z'</span> : <span class="id" title="var">abmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">l</span> : <span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span> <span class="id" title="var">z</span> <span class="id" title="var">z'</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">z</span> + (<span class="id" title="var">prabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">aa</span>) <span class="id" title="var">aa'</span>)) (<span class="id" title="var">z'</span> + (<span class="id" title="var">prabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">aa</span>) <span class="id" title="var">aa'</span>)).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">z</span> <span class="id" title="var">z'</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">assoc</span> := (<span class="id" title="var">assocax</span> <span class="id" title="var">X</span>) : <span class="id" title="var">isassoc</span> (@<span class="id" title="var">op</span> <span class="id" title="var">X</span>)). <span class="id" title="tactic">unfold</span> <span class="id" title="var">isassoc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">comm</span> := <span class="id" title="var">commax</span> <span class="id" title="var">X</span>). <span class="id" title="tactic">unfold</span> <span class="id" title="var">iscomm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">rer</span> := <span class="id" title="var">abmonoidrer</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">int</span> : ∏ (<span class="id" title="var">z</span> <span class="id" title="var">z'</span> : <span class="id" title="var">abmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isaprop</span> (<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span> <span class="id" title="var">z</span> <span class="id" title="var">z'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">z</span> + (<span class="id" title="var">prabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">aa</span>) <span class="id" title="var">aa'</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">z'</span> + <span class="id" title="var">prabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">aa</span>) <span class="id" title="var">aa'</span>))).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">z</span> <span class="id" title="var">z'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>. <span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">setquotuniv2prop</span> <span class="id" title="var">_</span> (<span class="id" title="var">λ</span> <span class="id" title="var">z</span> <span class="id" title="var">z'</span>, <span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> (<span class="id" title="var">int</span> <span class="id" title="var">z</span> <span class="id" title="var">z'</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">xa1</span> <span class="id" title="var">xa2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">abmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span> <span class="id" title="var">xa1</span> <span class="id" title="var">xa2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">abmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">op</span> (<span class="id" title="var">abmonoiddirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>) <span class="id" title="var">xa1</span> (<span class="id" title="var">dirprodpair</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">aa</span>) <span class="id" title="var">aa'</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">op</span> (<span class="id" title="var">abmonoiddirprod</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>) <span class="id" title="var">xa2</span> (<span class="id" title="var">dirprodpair</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">aa</span>) <span class="id" title="var">aa'</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">abmonoidfracrelint</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhfun</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">t2l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">a</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">aa</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">a'</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">aa'</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">c0a</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">t2l</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">l</span> := <span class="id" title="var">pr2</span> <span class="id" title="var">t2l</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">c0</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">c0a</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">x1</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">xa1</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">a1</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa1</span>)). <span class="id" title="tactic">set</span> (<span class="id" title="var">x2</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">xa2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">a2</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa2</span>)). <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">c0a</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">L</span> (<span class="id" title="var">x1</span> + <span class="id" title="var">a</span> + (<span class="id" title="var">a2</span> + <span class="id" title="var">a'</span>) + <span class="id" title="var">c0</span>) (<span class="id" title="var">x2</span> + <span class="id" title="var">a</span> + (<span class="id" title="var">a1</span> + <span class="id" title="var">a'</span>) + <span class="id" title="var">c0</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">rer</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span> <span class="id" title="var">a2</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">rer</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span> <span class="id" title="var">a1</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">x1</span> + <span class="id" title="var">a2</span>) <span class="id" title="var">_</span> <span class="id" title="var">c0</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">x2</span> + <span class="id" title="var">a1</span>) <span class="id" title="var">_</span> <span class="id" title="var">c0</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">comm</span> <span class="id" title="var">_</span> <span class="id" title="var">c0</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">x1</span> + <span class="id" title="var">a2</span>) <span class="id" title="var">c0</span> (<span class="id" title="var">a</span> + <span class="id" title="var">a'</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">assoc</span> (<span class="id" title="var">x2</span> + <span class="id" title="var">a1</span>) <span class="id" title="var">c0</span> (<span class="id" title="var">a</span> + <span class="id" title="var">a'</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ((<span class="id" title="var">pr2</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr2</span> (@<span class="id" title="var">op</span> <span class="id" title="var">A</span> <span class="id" title="var">aa</span> <span class="id" title="var">aa'</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">l</span>.<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">ispartrbinopabmonoidfracrel</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">abmonoidfracrelimpl</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> <span class="id" title="var">L'</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">is'</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">impl</span> : ∏ <span class="id" title="var">x</span> <span class="id" title="var">x'</span>, <span class="id" title="var">L</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> -&gt; <span class="id" title="var">L'</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>) (<span class="id" title="var">x</span> <span class="id" title="var">x'</span> : <span class="id" title="var">abmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ql</span> : <span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>) : <span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">is'</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="var">ql</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">quotrelimpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x0</span> <span class="id" title="var">x0'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">abmonoidfracrelint</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhfun</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t2</span>. <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">t2</span>). <span class="id" title="tactic">apply</span> (<span class="id" title="var">impl</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">t2</span>)).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">abmonoidfracrelimpl</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">abmonoidfracrellogeq</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> <span class="id" title="var">L'</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">is'</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">lg</span> : ∏ <span class="id" title="var">x</span> <span class="id" title="var">x'</span>, <span class="id" title="var">L</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> &lt;-&gt; <span class="id" title="var">L'</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>) (<span class="id" title="var">x</span> <span class="id" title="var">x'</span> : <span class="id" title="var">abmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>) :<br/>
&nbsp;&nbsp;(<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>) &lt;-&gt; (<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">is'</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">quotrellogeq</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x0</span> <span class="id" title="var">x0'</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">abmonoidfracrelint</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhfun</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">t2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">t2</span>). <span class="id" title="tactic">apply</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">lg</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) (<span class="id" title="var">pr2</span> <span class="id" title="var">t2</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">abmonoidfracrelint</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhfun</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">t2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">t2</span>). <span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">lg</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) (<span class="id" title="var">pr2</span> <span class="id" title="var">t2</span>)).<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">abmonoidfracrellogeq</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isdecabmonoidfracrelint</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">subabmonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartinvbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isl</span> : <span class="id" title="var">isdecrel</span> <span class="id" title="var">L</span>) : <span class="id" title="var">isdecrel</span> (<span class="id" title="var">abmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">xa1</span> <span class="id" title="var">xa2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">x1</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">xa1</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">a1</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa1</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">x2</span> := <span class="id" title="var">pr1</span> <span class="id" title="var">xa2</span>). <span class="id" title="tactic">set</span> (<span class="id" title="var">a2</span> := <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">xa2</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">int</span> : <span class="id" title="var">coprod</span> (<span class="id" title="var">L</span> (<span class="id" title="var">x1</span> + <span class="id" title="var">a2</span>) (<span class="id" title="var">x2</span> + <span class="id" title="var">a1</span>)) (<span class="id" title="var">neg</span> (<span class="id" title="var">L</span> (<span class="id" title="var">x1</span> + <span class="id" title="var">a2</span>) (<span class="id" title="var">x2</span> + <span class="id" title="var">a1</span>)))) <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">isl</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">int</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> | <span class="id" title="var">nl</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii1</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">abmonoidfracrelint</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hinhpr</span>. <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">unel</span> <span class="id" title="var">A</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">runax</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">runax</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii2</span>. <span class="id" title="tactic">generalize</span> <span class="id" title="var">nl</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">nl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">negf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">abmonoidfracrelint</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (@<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> (<span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">L</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t2l</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">t2l</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">c0a</span> <span class="id" title="var">l</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ((<span class="id" title="var">pr2</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">c0a</span>) <span class="id" title="var">l</span>).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isdecabmonoidfracrel</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) (<span class="id" title="var">isi</span> : <span class="id" title="var">ispartinvbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">isl</span> : <span class="id" title="var">isdecrel</span> <span class="id" title="var">L</span>) : <span class="id" title="var">isdecrel</span> (<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isdecquotrel</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">isdecabmonoidfracrelint</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isi</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isl</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab445"></a><h4 class="section">Relations and the canonical homomorphism to <span class="inlinecode"><span class="id" title="var">abmonoidfrac</span></span></h4>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iscomptoabmonoidfrac</span> (<span class="id" title="var">X</span> : <span class="id" title="var">abmonoid</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">submonoid</span> <span class="id" title="var">X</span>) {<span class="id" title="var">L</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">is</span> : <span class="id" title="var">ispartbinophrel</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span>) : <span class="id" title="var">iscomprelrelfun</span> <span class="id" title="var">L</span> (<span class="id" title="var">abmonoidfracrel</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="keyword">is</span>) (<span class="id" title="var">toabmonoidfrac</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">iscomprelrelfun</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">abmonoidfracrelint</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span> (<span class="id" title="var">dirprodpair</span> <span class="id" title="var">x</span> (<span class="id" title="var">unel</span> <span class="id" title="var">A</span>)) (<span class="id" title="var">dirprodpair</span> <span class="id" title="var">x'</span> (<span class="id" title="var">unel</span> <span class="id" title="var">A</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">hinhpr</span>). <span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">unel</span> <span class="id" title="var">A</span>). <span class="id" title="tactic">apply</span> ((<span class="id" title="var">pr2</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> 0).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">unel</span> <span class="id" title="var">A</span>)). <span class="id" title="tactic">apply</span> ((<span class="id" title="var">pr2</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> 0). <span class="id" title="tactic">apply</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">unel</span> <span class="id" title="var">A</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">l</span>.<br/>
</div>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">iscomptoabmonoidfrac</span>.<br/>

<br/>
<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">addmonoid_scope</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="https://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>