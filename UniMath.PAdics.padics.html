<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
	<script src="http://code.jquery.com/jquery-1.11.0.min.js" type="text/javascript"></script>
	<script src="./proofs-toggle.js" type="text/javascript"></script>
	<style>
		div.proofcomment {
			font-style: italic;
		}
	</style>
	<title>Documentation</title>
</head>
<body>
<div id="page">
<div id="main">
<h1 class="libtitle">Library UniMath.PAdics.padics</h1>

<div class="code">
</div>

<div class="doc">
*p adic numbers 
<div class="paragraph"> </div>

 By Alvaro Pelayo, Vladimir Voevodsky and Michael A. Warren 
<div class="paragraph"> </div>

 2012 
<div class="paragraph"> </div>

 made compatible with the current UniMath library by Ralph Matthes in October 2017 
<div class="paragraph"> </div>

 Imports 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.PAdics.lemmas</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.PAdics.fps</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.PAdics.frac</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.PAdics.z_mod_p</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.NumberSystems.Integers</span>.<br/>

<br/>
<span class="id" title="keyword">Unset</span> <span class="id" title="var">Kernel</span> <span class="id" title="var">Term</span> <span class="id" title="var">Sharing</span>. </div>

<div class="doc">
crucial for timely proof-checking, otherwise unbearable 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Upstream</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">hz_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzmultrmul</span> (<span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> : <span class="id" title="var">hz</span>) (<span class="id" title="keyword">is</span> : <span class="id" title="var">a</span> = <span class="id" title="var">b</span>) : <span class="id" title="var">a</span> * <span class="id" title="var">c</span> = <span class="id" title="var">b</span> * <span class="id" title="var">c</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="keyword">is</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzmultlmul</span> (<span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> : <span class="id" title="var">hz</span>) (<span class="id" title="keyword">is</span> : <span class="id" title="var">a</span> = <span class="id" title="var">b</span>) : <span class="id" title="var">c</span> * <span class="id" title="var">a</span> = <span class="id" title="var">c</span> * <span class="id" title="var">b</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="keyword">is</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">hz_scope</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Upstream</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab703"></a><h1 class="section">I. Several basic lemmas</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">hz_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrandnatsummation0r</span> ( <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">m</span> )<br/>
&nbsp;&nbsp;( <span class="id" title="var">a</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="var">hz</span> ) ( <span class="id" title="var">upper</span> : <span class="id" title="var">nat</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">natsummation0</span> <span class="id" title="var">upper</span> <span class="id" title="var">a</span> ) =<br/>
&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">natsummation0</span> <span class="id" title="var">upper</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> =&gt; <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">upper</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermoditerated</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">change</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">natsummation0</span> <span class="id" title="var">upper</span> <span class="id" title="var">a</span> + <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">natsummation0</span> <span class="id" title="var">upper</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) ) + <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermodandplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHupper</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzremaindermoditerated</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzremaindermodandplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermoditerated</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrandnatsummation0q</span> ( <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">m</span> )<br/>
&nbsp;&nbsp;( <span class="id" title="var">a</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="var">hz</span> ) ( <span class="id" title="var">upper</span> : <span class="id" title="var">nat</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">natsummation0</span> <span class="id" title="var">upper</span> <span class="id" title="var">a</span> ) =<br/>
&nbsp;&nbsp;( <span class="id" title="var">natsummation0</span> <span class="id" title="var">upper</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) ) + <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">natsummation0</span> <span class="id" title="var">upper</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> =&gt; <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) ) ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">upper</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzqrandremainderq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusr0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">change</span> ( <span class="id" title="var">natsummation0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) <span class="id" title="var">a</span> ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">natsummation0</span> <span class="id" title="var">upper</span> <span class="id" title="var">a</span> + <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzquotientmodandplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHupper</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzplusassoc</span> ( <span class="id" title="var">natsummation0</span> <span class="id" title="var">upper</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) ) ) <span class="id" title="var">_</span> ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzpluscomm</span> ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">natsummation0</span> <span class="id" title="var">upper</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> =&gt; <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) ) ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzplusassoc</span> ( <span class="id" title="var">natsummation0</span> <span class="id" title="var">upper</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> =&gt; <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) ) ) <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">natsummation0</span> <span class="id" title="var">upper</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> =&gt; <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) ) ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">natsummation0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) ( <span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> =&gt; <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrandnatsummation0r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzquotientmodandplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzqrandremainderq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusl0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermoditerated</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzplusassoc</span> (<span class="id" title="var">natsummation0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> =&gt; <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">natsummation0</span> <span class="id" title="var">upper</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) ) ) ) <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzplusassoc</span> ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">natsummation0</span> <span class="id" title="var">upper</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) ) ) ) <span class="id" title="var">_</span> <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzquotientmodandplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzquotientandtimesl</span> ( <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">m</span> ) ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) =<br/>
&nbsp;&nbsp;( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> ) * <span class="id" title="var">b</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> * <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzquotientmodandtimes</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzmultcomm</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ) ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultassoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzldistr</span> ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> * <span class="id" title="var">m</span> ) <span class="id" title="var">_</span> ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> )).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzmultcomm</span> <span class="id" title="var">_</span> <span class="id" title="var">m</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzdivequationmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusassoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzquotientandfpstimesl</span> ( <span class="id" title="var">m</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">m</span> )<br/>
&nbsp;&nbsp;&nbsp;( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="var">hz</span> ) ( <span class="id" title="var">upper</span> : <span class="id" title="var">nat</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">fpstimes</span> <span class="id" title="var">hz</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">upper</span> ) =<br/>
&nbsp;&nbsp;<span class="id" title="var">natsummation0</span> <span class="id" title="var">upper</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> <span class="id" title="var">i</span> ) * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> <span class="id" title="var">upper</span> <span class="id" title="var">i</span> ) ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">natsummation0</span> <span class="id" title="var">upper</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> <span class="id" title="var">i</span> ) * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> <span class="id" title="var">upper</span> <span class="id" title="var">i</span> ) ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">upper</span> <span class="id" title="keyword">as</span> [ | <span class="id" title="var">upper</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">fpstimes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzquotientandtimesl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusassoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">maponpaths</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">v</span> : <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> ) * <span class="id" title="var">b</span> 0%<span class="id" title="var">nat</span> + <span class="id" title="var">v</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzquotientmodandtimes</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> ) ) ( <span class="id" title="var">b</span> 0%<span class="id" title="var">nat</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzqrandremainderq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultx0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2! <span class="id" title="var">hzmult0x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusl0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermoditerated</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">fpstimes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrandnatsummation0q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> (<span class="id" title="var">a</span> <span class="id" title="var">n</span> * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) <span class="id" title="var">n</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) <span class="id" title="var">n</span> ) ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) <span class="id" title="var">n</span> ) ) ) ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzquotientandtimesl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">natsummationpathsupperfixed</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x0</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="var">f</span> <span class="id" title="var">x0</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">natsummationplusdistr</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x0</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> (<span class="id" title="var">a</span> <span class="id" title="var">x0</span>) * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) <span class="id" title="var">x0</span>)%<span class="id" title="var">nat</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> (<span class="id" title="var">a</span> <span class="id" title="var">x0</span>) * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> (<span class="id" title="var">b</span> (<span class="id" title="var">S</span> <span class="id" title="var">upper</span> - <span class="id" title="var">x0</span>)%<span class="id" title="var">nat</span>) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">natsummationplusdistr</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x0</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> (<span class="id" title="var">a</span> <span class="id" title="var">x0</span>) * <span class="id" title="var">b</span> (<span class="id" title="var">S</span> <span class="id" title="var">upper</span> - <span class="id" title="var">x0</span>)%<span class="id" title="var">nat</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2! <span class="id" title="var">hzplusassoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">maponpaths</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">v</span> =&gt; <span class="id" title="var">natsummation0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) ( <span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> <span class="id" title="var">i</span> ) * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) <span class="id" title="var">i</span> ) ) + <span class="id" title="var">v</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzqrandnatsummation0q</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> <span class="id" title="var">i</span> ) * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) <span class="id" title="var">i</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">natsummation0</span> (<span class="id" title="var">S</span> <span class="id" title="var">upper</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> (<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> (<span class="id" title="var">a</span> <span class="id" title="var">n</span>) * <span class="id" title="var">b</span> (<span class="id" title="var">S</span> <span class="id" title="var">upper</span> - <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>))=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">natsummation0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) ( <span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> <span class="id" title="var">n</span> * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) <span class="id" title="var">n</span> ) ) ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">natsummationpathsupperfixed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">j</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermodandtimes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermoditerated</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzremaindermodandtimes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzplusassoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">natsummation0</span> (<span class="id" title="var">S</span> <span class="id" title="var">upper</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">x0</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> (<span class="id" title="var">a</span> <span class="id" title="var">x0</span>) * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> (<span class="id" title="var">b</span> (<span class="id" title="var">S</span> <span class="id" title="var">upper</span> - <span class="id" title="var">x0</span>)%<span class="id" title="var">nat</span>)) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">natsummation0</span> (<span class="id" title="var">S</span> <span class="id" title="var">upper</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">x0</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> (<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> (<span class="id" title="var">a</span> <span class="id" title="var">x0</span>) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> (<span class="id" title="var">b</span> (<span class="id" title="var">S</span> <span class="id" title="var">upper</span> - <span class="id" title="var">x0</span>)%<span class="id" title="var">nat</span>))) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">natsummation0</span> (<span class="id" title="var">S</span> <span class="id" title="var">upper</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> (<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> (<span class="id" title="var">a</span> <span class="id" title="var">n</span>) * <span class="id" title="var">b</span> (<span class="id" title="var">S</span> <span class="id" title="var">upper</span> - <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>)) ) <span class="id" title="keyword">as</span> <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">natsummationplusdistr</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x0</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> <span class="id" title="var">x0</span> ) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) <span class="id" title="var">x0</span> ) ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natsummationpathsupperfixed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">j</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzquotientmodandtimes</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ( <span class="id" title="var">a</span> <span class="id" title="var">j</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) <span class="id" title="var">j</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzqrandremainderq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2! <span class="id" title="var">hzmult0x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultx0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusl0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermoditerated</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">idpath</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">hz_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab704"></a><h1 class="section">II. The carrying operation and induced equivalence relation on</h1>

formal power series 
<div class="paragraph"> </div>

 A lemma that does not depend on a non-zero integer and that used to
    appear where needed below - the point has been marked by a comment. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">ring_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">natsummationplusshift</span> { <span class="id" title="var">R</span> : <span class="id" title="var">commring</span> } ( <span class="id" title="var">upper</span> : <span class="id" title="var">nat</span> )<br/>
&nbsp;&nbsp;( <span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="var">R</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">natsummation0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) <span class="id" title="var">f</span> + <span class="id" title="var">natsummation0</span> <span class="id" title="var">upper</span> <span class="id" title="var">g</span> =<br/>
&nbsp;&nbsp;<span class="id" title="var">f</span> 0%<span class="id" title="var">nat</span> + <span class="id" title="var">natsummation0</span> <span class="id" title="var">upper</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt; <span class="id" title="var">f</span> ( <span class="id" title="var">S</span> <span class="id" title="var">x</span> ) + <span class="id" title="var">g</span> <span class="id" title="var">x</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">upper</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">natsummation0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">ringassoc1</span> <span class="id" title="var">R</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">natsummationshift0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">upper</span> ) <span class="id" title="var">f</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringcomm1</span> <span class="id" title="var">R</span> <span class="id" title="var">_</span> ( <span class="id" title="var">f</span> 0%<span class="id" title="var">nat</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringassoc1</span> <span class="id" title="var">R</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">natsummationplusdistr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">hz_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">carry</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">ring_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">m</span> : <span class="id" title="var">hz</span>.<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="keyword">is</span> : <span class="id" title="var">hzneq</span> 0 <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">precarry</span> ( <span class="id" title="var">a</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) : <span class="id" title="var">hz</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| 0%<span class="id" title="var">nat</span> =&gt; <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) + <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span> )<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">carry</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> -&gt; <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> (<span class="id" title="var">a</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span> ).<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isapropcarryequiv</span> ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">isaprop</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> = <span class="id" title="var">carry</span> <span class="id" title="var">b</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">fps</span> <span class="id" title="var">hz</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">carryequiv0</span> : <span class="id" title="var">hrel</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> =&gt; <span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> ( <span class="id" title="var">isapropcarryequiv</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> ).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">carryequiviseqrel</span> : <span class="id" title="var">iseqrel</span> <span class="id" title="var">carryequiv0</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">carryandremainder</span> ( <span class="id" title="var">a</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) = <span class="id" title="var">carry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermoditerated</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">carryequiv</span> : <span class="id" title="var">eqrel</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">eqrelpair</span> <span class="id" title="var">_</span> <span class="id" title="var">carryequiviseqrel</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">precarryandcarry_pointwise</span> ( <span class="id" title="var">a</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">precarry</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> ) <span class="id" title="var">n</span> = ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> ) <span class="id" title="var">n</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">idpath</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">precarry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> <span class="id" title="var">precarry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span> <span class="id" title="tactic">at</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzqrandremainderq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzplusr0</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">precarryandcarry</span> ( <span class="id" title="var">a</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">precarry</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> ) = <span class="id" title="var">carry</span> <span class="id" title="var">a</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">funextfun</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">precarryandcarry_pointwise</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrandcarryeq</span> ( <span class="id" title="var">a</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span> = <span class="id" title="var">m</span> * 0 + <span class="id" title="var">carry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultx0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusl0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrandcarryineq</span> ( <span class="id" title="var">a</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzleh</span> 0 ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) <br/>
&nbsp;&nbsp;<span class="id" title="var">hzlth</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">nattohz</span> ( <span class="id" title="var">hzabsval</span> <span class="id" title="var">m</span> ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">divalgorithm</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ) ) ).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">pr1</span> ( <span class="id" title="var">divalgorithm</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ) ) ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrandcarryq</span> ( <span class="id" title="var">a</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) :<br/>
&nbsp;&nbsp;0 = <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrtestq</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) 0 ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzqrandcarryeq</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzqrandcarryineq</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzqrandcarryr</span> ( <span class="id" title="var">a</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span> = <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrtestr</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) 0 ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzqrandcarryeq</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">hzqrandcarryineq</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">doublecarry</span> ( <span class="id" title="var">a</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ):<br/>
&nbsp;&nbsp;<span class="id" title="var">carry</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> ) = <span class="id" title="var">carry</span> <span class="id" title="var">a</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">carry</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> ) <span class="id" title="var">n</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hzremaindermoditerated</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">precarry</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">n0</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">n0</span>)) <span class="id" title="var">n</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">precarry</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> ) <span class="id" title="var">n</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">precarryandcarry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzqrandcarryq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusr0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermoditerated</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">funextfun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">carryandcarryequiv</span> ( <span class="id" title="var">a</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">carryequiv</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> ) <span class="id" title="var">a</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">doublecarry</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">quotientprecarryplus</span> ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> ( <span class="id" title="var">a</span> + <span class="id" title="var">b</span> ) <span class="id" title="var">n</span> ) =<br/>
&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) +<br/>
&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">b</span> <span class="id" title="var">n</span> ) +<br/>
&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> + <span class="id" title="var">carry</span> <span class="id" title="var">b</span> ) <span class="id" title="var">n</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> + <span class="id" title="var">b</span> 0%<span class="id" title="var">nat</span> ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">b</span> 0%<span class="id" title="var">nat</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">b</span> 0%<span class="id" title="var">nat</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzquotientmodandplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">change</span> ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) + <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> (<span class="id" title="var">a</span> + <span class="id" title="var">b</span>) <span class="id" title="var">n</span> ) ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">a</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">b</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">carry</span> <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> (<span class="id" title="var">carry</span> <span class="id" title="var">a</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">b</span>) <span class="id" title="var">n</span>)) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringassoc1</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) ( <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">ringassoc1</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringcomm1</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- 3! ( <span class="id" title="var">ringassoc1</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) <span class="id" title="var">_</span> <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) + <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">pa</span> := <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringassoc1</span> <span class="id" title="var">hz</span> <span class="id" title="var">pa</span> <span class="id" title="var">_</span> ( <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringcomm1</span> <span class="id" title="var">hz</span> <span class="id" title="var">_</span> ( <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) + <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">b</span> <span class="id" title="var">n</span> ) ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">precarry</span> <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">pb</span> := <span class="id" title="var">precarry</span> <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">ab</span> := <span class="id" title="var">precarry</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> + <span class="id" title="var">carry</span> <span class="id" title="var">b</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringassoc1</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">ab</span> <span class="id" title="var">n</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzquotientmodandplus</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span> <span class="id" title="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzqrandremainderq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusl0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzquotientmodandplus</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span> <span class="id" title="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzqrandremainderq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusl0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringassoc1</span> <span class="id" title="var">hz</span> <span class="id" title="var">pa</span> <span class="id" title="var">pb</span> <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzquotientmodandplus</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">pa</span> <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">pb</span> + <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">ab</span> <span class="id" title="var">n</span>)) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pb</span> + <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">ab</span> <span class="id" title="var">n</span>))%<span class="id" title="var">hz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzquotientmodandplus</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">pb</span> ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">ab</span> <span class="id" title="var">n</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- 2! ( <span class="id" title="var">ringassoc1</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">pa</span> ) <span class="id" title="var">_</span> <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- 2! ( <span class="id" title="var">ringassoc1</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">pa</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">pb</span> ) <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2! ( <span class="id" title="var">ringassoc1</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">pa</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">pb</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">ab</span> <span class="id" title="var">n</span>)) ) <span class="id" title="var">_</span> <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">maponpaths</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">hz</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">pa</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">pb</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">ab</span> <span class="id" title="var">n</span>)) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span> <span class="id" title="tactic">at</span> 1 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2! <span class="id" title="var">hzremaindermoditerated</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) <span class="id" title="keyword">with</span> <span class="id" title="var">pb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) <span class="id" title="keyword">with</span> <span class="id" title="var">pa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">maponpaths</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">hz</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">pb</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">ab</span> <span class="id" title="var">n</span>)))%<span class="id" title="var">hz</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">maponpaths</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">hz</span> =&gt; <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">pa</span> + <span class="id" title="var">x</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzremaindermodandplus</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermoditerated</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzremaindermodandplus</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">carryandplus</span> ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">carry</span> ( <span class="id" title="var">a</span> + <span class="id" title="var">b</span> ) = <span class="id" title="var">carry</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> + <span class="id" title="var">carry</span> <span class="id" title="var">b</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">carry</span> ( <span class="id" title="var">a</span> + <span class="id" title="var">b</span> ) <span class="id" title="var">n</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> + <span class="id" title="var">carry</span> <span class="id" title="var">b</span> ) <span class="id" title="var">n</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">change</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> + <span class="id" title="var">b</span> 0%<span class="id" title="var">nat</span> ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">b</span> 0%<span class="id" title="var">nat</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermodandplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">change</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> ( <span class="id" title="var">a</span> + <span class="id" title="var">b</span> ) <span class="id" title="var">n</span> ) ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">b</span> <span class="id" title="var">n</span> ) ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">b</span> ) <span class="id" title="var">n</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">quotientprecarryplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzremaindermodandplus</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">a</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span>)) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">b</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">b</span> <span class="id" title="var">n</span>)) ) <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">a</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span>)) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">b</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">b</span> <span class="id" title="var">n</span>))) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">a</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span>))%<span class="id" title="tactic">ring</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">b</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">b</span> <span class="id" title="var">n</span>))%<span class="id" title="tactic">ring</span>)%<span class="id" title="var">hz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">hzremaindermodandplus</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">a</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span>)) (<span class="id" title="var">b</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">b</span> <span class="id" title="var">n</span>)) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzremaindermodandplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( ((<span class="id" title="var">a</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span>))%<span class="id" title="tactic">ring</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">b</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">b</span> <span class="id" title="var">n</span>))%<span class="id" title="tactic">ring</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> (<span class="id" title="var">carry</span> <span class="id" title="var">a</span> + <span class="id" title="var">carry</span> <span class="id" title="var">b</span>)%<span class="id" title="tactic">ring</span> <span class="id" title="var">n</span>))%<span class="id" title="var">hz</span> ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">a</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span>))%<span class="id" title="tactic">ring</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">b</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">b</span> <span class="id" title="var">n</span>))%<span class="id" title="tactic">ring</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> (<span class="id" title="var">carry</span> <span class="id" title="var">a</span> + <span class="id" title="var">carry</span> <span class="id" title="var">b</span>)%<span class="id" title="tactic">ring</span> <span class="id" title="var">n</span>))%<span class="id" title="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">ringassoc1</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) + <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">b</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">b</span> <span class="id" title="var">n</span>)) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringassoc1</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringcomm1</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- 3! ( <span class="id" title="var">ringassoc1</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">funextfun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">quotientprecarry</span> ( <span class="id" title="var">a</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt; <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> ).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">quotientandtimesrearrangel</span> ( <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">x</span> * <span class="id" title="var">y</span> ) =<br/>
&nbsp;&nbsp;( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> ) * <span class="id" title="var">y</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> ) * <span class="id" title="var">y</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzquotientmodandtimes</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">y</span> * <span class="id" title="var">m</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">y</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">y</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> * <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">y</span>))%<span class="id" title="var">hz</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">y</span> * <span class="id" title="var">m</span> +<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">y</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> +<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">y</span> +<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> * <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">y</span>))%<span class="id" title="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringcomm2</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">y</span> ) ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringassoc2</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">ringldistr</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringcomm2</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">y</span> ) <span class="id" title="var">m</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">m</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">y</span> + <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">y</span>)%<span class="id" title="tactic">ring</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">m</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">y</span> + <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">y</span>)%<span class="id" title="var">hz</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzdivequationmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">y</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> * <span class="id" title="var">y</span>)%<span class="id" title="tactic">ring</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> * <span class="id" title="var">y</span>)%<span class="id" title="var">hz</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzquotientmodandtimes</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> ) <span class="id" title="var">y</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermoditerated</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzqrandremainderq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultx0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2! <span class="id" title="var">hzmult0x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusl0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringassoc1</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> * <span class="id" title="var">y</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">y</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">y</span>))%<span class="id" title="var">hz</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> * <span class="id" title="var">y</span> +<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">y</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">x</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">y</span>)))%<span class="id" title="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
here used to be shown the lemma <span class="inlinecode"><span class="id" title="var">natsummationplusshift</span></span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">precarryandtimesl</span> ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) <span class="id" title="var">n</span> ) =<br/>
&nbsp;&nbsp;( <span class="id" title="var">quotientprecarry</span> <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) <span class="id" title="var">n</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span>  * <span class="id" title="var">b</span> ) <span class="id" title="var">n</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">precarry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) 0%<span class="id" title="var">nat</span> ) <span class="id" title="keyword">with</span> ( <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> * <span class="id" title="var">b</span> 0%<span class="id" title="var">nat</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( ( <span class="id" title="var">quotientprecarry</span> <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) 0%<span class="id" title="var">nat</span> ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> ) * <span class="id" title="var">b</span> 0%<span class="id" title="var">nat</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">quotientandtimesrearrangel</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) 0%<span class="id" title="var">nat</span> ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> ) * <span class="id" title="var">b</span> 0%<span class="id" title="var">nat</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">change</span> ( <span class="id" title="var">precarry</span> ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;( ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">ringassoc1</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( ( ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">quotientprecarry</span> <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) <span class="id" title="var">n</span> ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( @<span class="id" title="var">op2</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> ) <span class="id" title="var">b</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">change</span> ( ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> ( <span class="id" title="var">natsummation0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt; <span class="id" title="var">a</span> <span class="id" title="var">x</span> * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) <span class="id" title="var">x</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( ( <span class="id" title="var">quotientprecarry</span> <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) <span class="id" title="var">n</span> ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">natsummation0</span> <span class="id" title="var">n</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">quotientprecarry</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">natsummationplusshift</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( ( @<span class="id" title="var">op2</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> ) <span class="id" title="var">b</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">natsummation0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> ) <span class="id" title="var">x</span> * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) <span class="id" title="var">x</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">natsummationshift0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">precarry</span> <span class="id" title="tactic">at</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">ringcomm1</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> * <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">maponpaths</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">hz</span> =&gt; <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> * <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) + <span class="id" title="var">x</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natsummationpathsupperfixed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">quotientprecarry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringrdistr</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzquotientmodandplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( @<span class="id" title="var">op2</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> ) <span class="id" title="var">b</span> ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">fpstimes</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> ) <span class="id" title="var">b</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzquotientandfpstimesl</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> ) <span class="id" title="var">b</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( @<span class="id" title="var">op2</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> ) <span class="id" title="var">b</span> ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">fpstimes</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> ) <span class="id" title="var">b</span> ) <span class="id" title="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">fpstimes</span> <span class="id" title="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span> <span class="id" title="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">n0</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">t'</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">m0</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">b</span> (<span class="id" title="var">n0</span> - <span class="id" title="var">m0</span>)%<span class="id" title="var">nat</span> <span class="id" title="tactic">in</span> <span class="id" title="var">natsummation0</span> <span class="id" title="var">n0</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span>) * <span class="id" title="var">t'</span> <span class="id" title="var">x</span>)%<span class="id" title="tactic">ring</span>)) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( ( <span class="id" title="var">quotientprecarry</span> <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">natsummation0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ( <span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">i</span> ) * <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> - <span class="id" title="var">i</span> )%<span class="id" title="var">nat</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2! <span class="id" title="var">hzplusassoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">maponpaths</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">v</span> =&gt; <span class="id" title="var">natsummation0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ( <span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">i</span> ) * <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> - <span class="id" title="var">i</span> )%<span class="id" title="var">nat</span> ) + <span class="id" title="var">v</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">precarry</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;( ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ((<span class="id" title="var">carry</span> <span class="id" title="var">a</span> * <span class="id" title="var">b</span>) (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> (<span class="id" title="var">carry</span> <span class="id" title="var">a</span> * <span class="id" title="var">b</span>) <span class="id" title="var">n</span>)) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">carry</span> <span class="id" title="var">a</span> * <span class="id" title="var">b</span>)%<span class="id" title="tactic">ring</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> (<span class="id" title="var">carry</span> <span class="id" title="var">a</span> * <span class="id" title="var">b</span>) <span class="id" title="var">n</span>)%<span class="id" title="tactic">ring</span>)%<span class="id" title="var">hz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzquotientmodandplus</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) <span class="id" title="var">n</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">natsummation0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ( <span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">i</span> ) * <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span>  - <span class="id" title="var">i</span> )%<span class="id" title="var">nat</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusassoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">maponpaths</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">v</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">natsummation0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ( <span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">i</span> ) * <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> - <span class="id" title="var">i</span> )%<span class="id" title="var">nat</span> ) ) ) + <span class="id" title="var">v</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">maponpaths</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">v</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">precarry</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> * <span class="id" title="var">b</span> )%<span class="id" title="tactic">ring</span> <span class="id" title="var">n</span> ) ) + <span class="id" title="var">v</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">maponpaths</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">v</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">v</span> + <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> * <span class="id" title="var">b</span> )%<span class="id" title="tactic">ring</span> <span class="id" title="var">n</span> ) ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">fpstimes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrandnatsummation0r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzqrandnatsummation0r</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">i</span> ) * <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> - <span class="id" title="var">i</span> )%<span class="id" title="var">nat</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natsummationpathsupperfixed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">j</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">j</span>) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) <span class="id" title="var">j</span>)) ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">j</span>) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">b</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span> - <span class="id" title="var">j</span>)%<span class="id" title="var">nat</span>)%<span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzremaindermodandtimes</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">j</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) <span class="id" title="var">j</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermoditerated</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzremaindermodandtimes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">carryandtimesl</span> ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">carry</span> ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) = <span class="id" title="var">carry</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">carry</span> ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) <span class="id" title="var">n</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) <span class="id" title="var">n</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span> <span class="id" title="tactic">at</span> 1 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">precarry</span> ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) 0%<span class="id" title="var">nat</span> ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> * <span class="id" title="var">b</span> 0%<span class="id" title="var">nat</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">precarry</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) 0%<span class="id" title="var">nat</span> ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> * <span class="id" title="var">b</span> 0%<span class="id" title="var">nat</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">a</span> 0) * <span class="id" title="var">b</span> 0%<span class="id" title="var">nat</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">a</span> 0) * <span class="id" title="var">b</span> 0%<span class="id" title="var">nat</span> )%<span class="id" title="var">hz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzremaindermodandtimes</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> ) ) ( <span class="id" title="var">b</span> 0%<span class="id" title="var">nat</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermoditerated</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzremaindermodandtimes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> ) <span class="id" title="keyword">with</span> ( <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span> <span class="id" title="tactic">at</span> 1 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">precarry</span> ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) + <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) <span class="id" title="var">n</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">precarryandtimesl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">ringassoc1</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermodandplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) + ( <span class="id" title="var">quotientprecarry</span> <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) <span class="id" title="var">n</span> ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">change</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( ( <span class="id" title="var">natsummation0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ( <span class="id" title="keyword">fun</span> <span class="id" title="var">u</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> <span class="id" title="var">u</span> * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) <span class="id" title="var">u</span> ) ) ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">natsummation0</span> <span class="id" title="var">n</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">u</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">quotientprecarry</span> <span class="id" title="var">a</span> ) <span class="id" title="var">u</span> * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> <span class="id" title="var">n</span> <span class="id" title="var">u</span> ) ) ) ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">natsummation0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ( <span class="id" title="keyword">fun</span> <span class="id" title="var">u</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> ) <span class="id" title="var">u</span> * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) <span class="id" title="var">u</span> ) ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">natsummationplusshift</span> <span class="id" title="var">n</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">natsummationshift0</span> <span class="id" title="var">n</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">u</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">a</span> <span class="id" title="var">u</span> * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) <span class="id" title="var">u</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">natsummation0</span> <span class="id" title="var">n</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">x</span> ) * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">x</span> ) ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">quotientprecarry</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span> ) ) ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">natsummation0</span> <span class="id" title="var">n</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">x</span> ) * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">x</span> ) ) ) ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrandnatsummation0r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzqrandnatsummation0r</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">x</span> ) * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">x</span> ) ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">maponpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natsummationpathsupperfixed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">j</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">quotientprecarry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">intermediate_path</span> (<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ((<span class="id" title="var">a</span> (<span class="id" title="var">S</span> <span class="id" title="var">j</span>) * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> <span class="id" title="var">n</span> <span class="id" title="var">j</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">j</span>) * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> <span class="id" title="var">n</span> <span class="id" title="var">j</span>) )%<span class="id" title="var">hz</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">idpath</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzrdistr</span> ( <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">j</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">j</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> <span class="id" title="var">n</span> <span class="id" title="var">j</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermodandtimes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">a</span> (<span class="id" title="var">S</span> <span class="id" title="var">j</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">j</span>)) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> <span class="id" title="var">n</span> <span class="id" title="var">j</span>))) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">carry</span> <span class="id" title="var">a</span> (<span class="id" title="var">S</span> <span class="id" title="var">j</span>) * <span class="id" title="var">b</span>(<span class="id" title="var">sub</span> <span class="id" title="var">n</span> <span class="id" title="var">j</span>)) )%<span class="id" title="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzremaindermoditerated</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">a</span> (<span class="id" title="var">S</span> <span class="id" title="var">j</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">a</span> <span class="id" title="var">j</span>)) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzremaindermodandtimes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermodandplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzremaindermodandplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span> <span class="id" title="tactic">at</span> 3.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzremaindermodandplus</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> ) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) 0%<span class="id" title="var">nat</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermodandtimes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermoditerated</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzremaindermodandtimes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> ) <span class="id" title="keyword">with</span> ( <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzremaindermodandplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzpluscomm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzremaindermodandplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">funextfun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">carryandtimesr</span> ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">carry</span> ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) = <span class="id" title="var">carry</span> ( <span class="id" title="var">a</span> * <span class="id" title="var">carry</span> <span class="id" title="var">b</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( @<span class="id" title="var">ringcomm2</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">carryandtimesl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( @<span class="id" title="var">ringcomm2</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">carryandtimes</span> ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">carry</span> ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) = <span class="id" title="var">carry</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">a</span> * <span class="id" title="var">carry</span> <span class="id" title="var">b</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">carryandtimesl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">carryandtimesr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ringcarryequiv</span> : @<span class="id" title="var">ringeqrel</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">carryequiv</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">carryandplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">carryandplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">carryandplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">carryandplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">carryandtimes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">carryandtimes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">carryandtimes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">carryandtimes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">carry</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab705"></a><h2 class="section">Some preparation for parts III/IV that does not depend on a prime number</h2>
 Those used to appear where needed below, those points have been marked by comments. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">commringquotprandop1</span> { <span class="id" title="var">A</span> : <span class="id" title="var">commring</span> } ( <span class="id" title="var">R</span> : @<span class="id" title="var">ringeqrel</span> <span class="id" title="var">A</span> ) ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">A</span> ) :<br/>
&nbsp;&nbsp;@<span class="id" title="var">op1</span> ( <span class="id" title="var">commringquot</span> <span class="id" title="var">R</span> ) ( <span class="id" title="var">setquotpr</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">R</span> ) <span class="id" title="var">a</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">setquotpr</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">R</span> ) <span class="id" title="var">b</span> ) =<br/>
&nbsp;&nbsp;<span class="id" title="var">setquotpr</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">R</span> ) ( <span class="id" title="var">a</span> + <span class="id" title="var">b</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( @<span class="id" title="var">op1</span> ( <span class="id" title="var">commringquot</span> <span class="id" title="var">R</span> ) ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;( <span class="id" title="var">setquotfun2</span> <span class="id" title="var">R</span> <span class="id" title="var">R</span> ( @<span class="id" title="var">op1</span> <span class="id" title="var">A</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">pr1</span> ( <span class="id" title="var">iscomp2binoptransrel</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">R</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">eqreltrans</span> <span class="id" title="var">_</span> ) ( <span class="id" title="var">pr2</span> <span class="id" title="var">R</span> ) ) ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">setquotfun2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">setquotuniv2comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">commringquotprandop2</span> { <span class="id" title="var">A</span> : <span class="id" title="var">commring</span> } ( <span class="id" title="var">R</span> : @<span class="id" title="var">ringeqrel</span> <span class="id" title="var">A</span> ) ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">A</span> ) :<br/>
&nbsp;&nbsp;@<span class="id" title="var">op2</span> ( <span class="id" title="var">commringquot</span> <span class="id" title="var">R</span> ) ( <span class="id" title="var">setquotpr</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">R</span> ) <span class="id" title="var">a</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">setquotpr</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">R</span> ) <span class="id" title="var">b</span> ) =<br/>
&nbsp;&nbsp;<span class="id" title="var">setquotpr</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">R</span> ) ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( @<span class="id" title="var">op2</span> ( <span class="id" title="var">commringquot</span> <span class="id" title="var">R</span> ) ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;( <span class="id" title="var">setquotfun2</span> <span class="id" title="var">R</span> <span class="id" title="var">R</span> ( @<span class="id" title="var">op2</span> <span class="id" title="var">A</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">pr2</span> ( <span class="id" title="var">iscomp2binoptransrel</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">R</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">eqreltrans</span> <span class="id" title="var">_</span> ) ( <span class="id" title="var">pr2</span> <span class="id" title="var">R</span> ) ) ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">setquotfun2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">setquotuniv2comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzfpstimesnonzero</span> ( <span class="id" title="var">a</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">k</span> : <span class="id" title="var">nat</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="keyword">is</span> : <span class="id" title="var">neq</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">a</span> <span class="id" title="var">k</span> ) 0%<span class="id" title="var">hz</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">natlth</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span> -&gt; <span class="id" title="var">a</span> <span class="id" title="var">m</span> = 0%<span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">k'</span> : <span class="id" title="var">nat</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">is'</span> : <span class="id" title="var">neq</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">b</span> <span class="id" title="var">k'</span> ) 0%<span class="id" title="var">hz</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">natlth</span> <span class="id" title="var">m</span> <span class="id" title="var">k'</span> -&gt; <span class="id" title="var">b</span> <span class="id" title="var">m</span> = 0%<span class="id" title="var">hz</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) ( <span class="id" title="var">k</span> + <span class="id" title="var">k'</span> )%<span class="id" title="var">nat</span> = <span class="id" title="var">a</span> <span class="id" title="var">k</span> * <span class="id" title="var">b</span> <span class="id" title="var">k'</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">natplusr0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">natsummation0</span> <span class="id" title="var">k</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> <span class="id" title="var">x</span> * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) <span class="id" title="var">x</span> ) ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) * <span class="id" title="var">b</span> 0%<span class="id" title="var">nat</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">natsummation0</span> <span class="id" title="var">k</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> <span class="id" title="var">x</span> * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) <span class="id" title="var">x</span> ) ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">natsummation0</span> <span class="id" title="var">k</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt; 0%<span class="id" title="var">hz</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">natsummationpathsupperfixed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">natlth</span> <span class="id" title="var">m</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">i0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> ( <span class="id" title="var">natlehlthtrans</span> <span class="id" title="var">_</span> <span class="id" title="var">k</span> <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> <span class="id" title="var">natlthnsn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">pr2</span> <span class="id" title="keyword">is</span> <span class="id" title="var">m</span> <span class="id" title="var">i0</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmult0x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">natsummationae0bottom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusl0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">minusnn0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">intros</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">natplusnsm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">natsummation0</span> ( <span class="id" title="var">k</span> + <span class="id" title="var">k'</span> )%<span class="id" title="var">nat</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> <span class="id" title="var">x</span> * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> + <span class="id" title="var">k'</span> ) <span class="id" title="var">x</span> ) ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> + <span class="id" title="var">k'</span> )%<span class="id" title="var">nat</span> * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> + <span class="id" title="var">k'</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> + <span class="id" title="var">k'</span> ) ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> <span class="id" title="var">k</span> * <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k'</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">b'</span> := <span class="id" title="var">fpsshift</span> <span class="id" title="var">b</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">minusnn0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">pr2</span> <span class="id" title="var">is'</span> 0%<span class="id" title="var">nat</span> ( <span class="id" title="var">natlehlthtrans</span> 0 <span class="id" title="var">k'</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k'</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">natleh0n</span> <span class="id" title="var">k'</span> ) ( <span class="id" title="var">natlthnsn</span> <span class="id" title="var">k'</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultx0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusr0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">natsummation0</span> ( <span class="id" title="var">k</span> + <span class="id" title="var">k'</span> )%<span class="id" title="var">nat</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> <span class="id" title="var">x</span> * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> + <span class="id" title="var">k'</span> ) <span class="id" title="var">x</span> ) ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">fpstimes</span> <span class="id" title="var">hz</span> <span class="id" title="var">a</span> <span class="id" title="var">b'</span> ( <span class="id" title="var">k</span> + <span class="id" title="var">k'</span> )%<span class="id" title="var">nat</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">natsummationpathsupperfixed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">m</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> + <span class="id" title="var">k'</span> )%<span class="id" title="var">nat</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">S</span> ( <span class="id" title="var">k</span> + <span class="id" title="var">k'</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">pathssminus</span> ( <span class="id" title="var">k</span> + <span class="id" title="var">k'</span> )%<span class="id" title="var">nat</span> <span class="id" title="var">m</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">natlehlthtrans</span> <span class="id" title="var">_</span> ( <span class="id" title="var">k</span> + <span class="id" title="var">k'</span> )%<span class="id" title="var">nat</span> <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">natlthnsn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">IHk'</span> <span class="id" title="var">b'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">is'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">m</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">b'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">fpsshift</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">is'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzfpstimeswhenzero</span> ( <span class="id" title="var">a</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">m</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="keyword">is</span> : ( <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">natlth</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span> -&gt; <span class="id" title="var">a</span> <span class="id" title="var">m</span> = 0%<span class="id" title="var">hz</span> ) ) :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">k'</span> : <span class="id" title="var">nat</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">is'</span> : ( <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">natlth</span> <span class="id" title="var">m</span> <span class="id" title="var">k'</span> -&gt; <span class="id" title="var">b</span> <span class="id" title="var">m</span> = 0%<span class="id" title="var">hz</span> ) ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">natlth</span> <span class="id" title="var">m</span> ( <span class="id" title="var">k</span> + <span class="id" title="var">k'</span> )%<span class="id" title="var">nat</span> -&gt; ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) <span class="id" title="var">m</span> = 0%<span class="id" title="var">hz</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">k</span> <span class="id" title="keyword">is</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="keyword">is</span> <span class="id" title="var">b</span> <span class="id" title="var">k'</span> <span class="id" title="var">is'</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> * <span class="id" title="var">b</span> 0%<span class="id" title="var">nat</span> = 0%<span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">is'</span> 0%<span class="id" title="var">nat</span> <span class="id" title="var">j</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultx0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assert</span> ( <span class="id" title="var">natlth</span> 0 ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">natlehlthtrans</span> <span class="id" title="var">_</span> <span class="id" title="var">k</span> <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">natleh0n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">natlthnsn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="keyword">is</span> 0%<span class="id" title="var">nat</span> <span class="id" title="var">i</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmult0x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="keyword">is</span> <span class="id" title="var">b</span> <span class="id" title="var">k'</span> <span class="id" title="var">is'</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">natsummation0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">m</span> ) ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> <span class="id" title="var">x</span> * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">m</span> ) <span class="id" title="var">x</span> ) ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">natsummation0</span> <span class="id" title="var">m</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> <span class="id" title="var">x</span> * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">m</span> ) <span class="id" title="var">x</span> ) ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">m</span> ) * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">m</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">m</span> ) ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">m</span> ) * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">m</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">m</span> ) ) = 0%<span class="id" title="var">hz</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">negnatgth0n</span> ( <span class="id" title="var">S</span> <span class="id" title="var">m</span> ) <span class="id" title="var">j</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <span class="id" title="var">minusnn0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">is'</span> 0%<span class="id" title="var">nat</span> ( <span class="id" title="var">natlehlthtrans</span> 0%<span class="id" title="var">nat</span> <span class="id" title="var">k'</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k'</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">natleh0n</span> <span class="id" title="var">k'</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">natlthnsn</span> <span class="id" title="var">k'</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultx0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <span class="id" title="var">natplusr0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="keyword">is</span> ( <span class="id" title="var">S</span> <span class="id" title="var">m</span> ) <span class="id" title="var">j</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmult0x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <span class="id" title="var">minusnn0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">is'</span> 0%<span class="id" title="var">nat</span> ( <span class="id" title="var">natlehlthtrans</span> 0%<span class="id" title="var">nat</span> <span class="id" title="var">k'</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k'</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">natleh0n</span> <span class="id" title="var">k'</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">natlthnsn</span> <span class="id" title="var">k'</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultx0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusr0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">b'</span> := <span class="id" title="var">fpsshift</span> <span class="id" title="var">b</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">natsummation0</span> <span class="id" title="var">m</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> <span class="id" title="var">x</span> * <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">m</span> ) <span class="id" title="var">x</span> ) ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">natsummation0</span> <span class="id" title="var">m</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> <span class="id" title="var">x</span> * <span class="id" title="var">b'</span> ( <span class="id" title="var">sub</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> ) ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">natsummationpathsupperfixed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">b'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">fpsshift</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">pathssminus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">natlehlthtrans</span> <span class="id" title="var">_</span> <span class="id" title="var">m</span> <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">natlthnsn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( ( <span class="id" title="var">a</span> * <span class="id" title="var">b'</span> ) <span class="id" title="var">m</span> = 0%<span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">natlth</span> <span class="id" title="var">m</span> ( <span class="id" title="var">k</span> + <span class="id" title="var">k'</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">one</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">istransnatlth</span> <span class="id" title="var">_</span> ( <span class="id" title="var">S</span> <span class="id" title="var">m</span> ) <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">natlthnsn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assert</span> ( <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">natlth</span> <span class="id" title="var">m</span> 0%<span class="id" title="var">nat</span> -&gt; <span class="id" title="var">b'</span> <span class="id" title="var">m</span> = 0%<span class="id" title="var">hz</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">two</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">m0</span> <span class="id" title="var">j0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">negnatgth0n</span> <span class="id" title="var">m0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">IHm</span> <span class="id" title="var">k</span> <span class="id" title="keyword">is</span> <span class="id" title="var">b'</span> 0%<span class="id" title="var">nat</span> <span class="id" title="var">two</span> <span class="id" title="var">one</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assert</span> ( <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">natlth</span> <span class="id" title="var">m</span> <span class="id" title="var">k'</span> -&gt; <span class="id" title="var">b'</span> <span class="id" title="var">m</span> = 0%<span class="id" title="var">hz</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">two</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">m0</span> <span class="id" title="var">j0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">m0</span> ) = 0%<span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">is'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">natlth</span> <span class="id" title="var">m</span> ( <span class="id" title="var">k</span> + <span class="id" title="var">k'</span> )%<span class="id" title="var">nat</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">three</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">natplusnsm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">IHm</span> <span class="id" title="var">k</span> <span class="id" title="keyword">is</span> <span class="id" title="var">b'</span> <span class="id" title="var">k'</span> <span class="id" title="var">two</span> <span class="id" title="var">three</span> ).<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab706"></a><h2 class="section">Definition of p-adic integers</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">p</span> : <span class="id" title="var">hz</span>.<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="keyword">is</span> : <span class="id" title="var">isaprime</span> <span class="id" title="var">p</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">commringofpadicints</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">commringquot</span> ( <span class="id" title="var">ringcarryequiv</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) ).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">padicplus</span> := @<span class="id" title="var">op1</span> <span class="id" title="var">commringofpadicints</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">padictimes</span> := @<span class="id" title="var">op2</span> <span class="id" title="var">commringofpadicints</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab707"></a><h1 class="section">III. The apartness relation on p-adic integers</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">padicapart0</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">hrel</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) := <span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp; <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">neq</span> <span class="id" title="var">_</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">a</span> <span class="id" title="var">n</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">b</span> <span class="id" title="var">n</span> ).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">padicapartiscomprel</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">iscomprelrel</span> ( <span class="id" title="var">carryequiv</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) ) <span class="id" title="var">padicapart0</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">a'</span> <span class="id" title="var">b</span> <span class="id" title="var">b'</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hPropUnivalence</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">k</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">u</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">n</span> <span class="id" title="var">u</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">total2tohexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">i</span> , &lt;- <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">k</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">u</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">n</span> <span class="id" title="var">u</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">total2tohexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">i</span>, <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">padicapart1</span> : <span class="id" title="var">hrel</span> <span class="id" title="var">commringofpadicints</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">quotrel</span> <span class="id" title="var">padicapartiscomprel</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isirreflpadicapart0</span> : <span class="id" title="var">isirrefl</span> <span class="id" title="var">padicapart0</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> <span class="id" title="var">hfalse</span> <span class="id" title="keyword">as</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">u</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">n</span> <span class="id" title="var">u</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">x</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">issymmpadicapart0</span> : <span class="id" title="var">issymm</span> <span class="id" title="var">padicapart0</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">u</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">n</span> <span class="id" title="var">u</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">total2tohexists</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">neq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iscotranspadicapart0</span> : <span class="id" title="var">iscotrans</span> <span class="id" title="var">padicapart0</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">u</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">n</span> <span class="id" title="var">u</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">isdeceqhz</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> <span class="id" title="var">n</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> <span class="id" title="var">n</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> | <span class="id" title="var">r</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Q</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">neq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">l</span>, <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Q</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">padicapart</span> : <span class="id" title="var">apart</span> <span class="id" title="var">commringofpadicints</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">padicapart1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">padicapart1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">isirreflquotrel</span> <span class="id" title="var">padicapartiscomprel</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isirreflpadicapart0</span> ).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">issymmquotrel</span> <span class="id" title="var">padicapartiscomprel</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">issymmpadicapart0</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">iscotransquotrel</span> <span class="id" title="var">padicapartiscomprel</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iscotranspadicapart0</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">precarryandzero</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) 0 = @<span class="id" title="var">ringunel1</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) 0 <span class="id" title="var">n</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id" title="var">ringunel1</span> (<span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) <span class="id" title="var">n</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">precarry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( @<span class="id" title="var">ringunel1</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) 0%<span class="id" title="var">nat</span> ) <span class="id" title="keyword">with</span> 0%<span class="id" title="var">hz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">change</span> ( ( ( @<span class="id" title="var">ringunel1</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( @<span class="id" title="var">ringunel1</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ) <span class="id" title="var">n</span> ) ) ) = 0%<span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( @<span class="id" title="var">ringunel1</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) <span class="id" title="var">n</span> ) <span class="id" title="keyword">with</span> 0%<span class="id" title="var">hz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( @<span class="id" title="var">ringunel1</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) <span class="id" title="keyword">with</span> 0%<span class="id" title="var">hz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrand0q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusl0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">funextfun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">carryandzero</span> : <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) 0 = 0.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">precarryandzero</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, (<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( @<span class="id" title="var">ringunel1</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) <span class="id" title="var">n</span>)) <span class="id" title="var">n</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id" title="var">ringunel1</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) <span class="id" title="var">n</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrand0r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( @<span class="id" title="var">ringunel1</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span>)  <span class="id" title="var">n</span> ) <span class="id" title="keyword">with</span> 0%<span class="id" title="var">hz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">funextfun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">precarryandone</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) 1 =<br/>
&nbsp;&nbsp;@<span class="id" title="var">ringunel2</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) 1 <span class="id" title="var">n</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id" title="var">ringunel2</span> (<span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) <span class="id" title="var">n</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">precarry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">change</span> ( @<span class="id" title="var">ringunel2</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) 0%<span class="id" title="var">nat</span> ) <span class="id" title="keyword">with</span> 1%<span class="id" title="var">hz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrand1q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusr0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">change</span> ( @<span class="id" title="var">ringunel2</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) <span class="id" title="keyword">with</span> 0%<span class="id" title="var">hz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrand0q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusr0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">funextfun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">carryandone</span> : <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) 1 = 1.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">precarryandone</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, (<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( @<span class="id" title="var">ringunel2</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) <span class="id" title="var">n</span>)) <span class="id" title="var">n</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id" title="var">ringunel2</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) <span class="id" title="var">n</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">change</span> ( @<span class="id" title="var">ringunel2</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) 0%<span class="id" title="var">nat</span> ) <span class="id" title="keyword">with</span> 1%<span class="id" title="var">hz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrand1r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">change</span> ( @<span class="id" title="var">ringunel2</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) <span class="id" title="keyword">with</span> 0%<span class="id" title="var">hz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrand0r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">funextfun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">padicapartcomputation</span> ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">pr1</span> <span class="id" title="var">padicapart</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">setquotpr</span> ( <span class="id" title="var">carryequiv</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) ) <span class="id" title="var">a</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">setquotpr</span> ( <span class="id" title="var">carryequiv</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) ) <span class="id" title="var">b</span> ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">padicapart0</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hPropUnivalence</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">u</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">padicapartandplusprecarryl</span> ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> )<br/>
&nbsp;&nbsp;( <span class="id" title="var">x</span> : <span class="id" title="var">neq</span> <span class="id" title="var">_</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ) <span class="id" title="var">n</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( ( <span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">c</span> ) ) <span class="id" title="var">n</span> ) ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">padicapart0</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">P</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">neq</span> <span class="id" title="var">hz</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) (<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">a</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">b</span>) <span class="id" title="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">precarry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) (<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">a</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">c</span>) <span class="id" title="var">x</span>) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">isdecnatprop</span> <span class="id" title="var">P</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">isdec</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">isdeceqhz</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">a</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">b</span>) <span class="id" title="var">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">precarry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">a</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">c</span>) <span class="id" title="var">m</span>) ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> | <span class="id" title="var">r</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">P</span> <span class="id" title="tactic">in</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">neq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">leexists</span> := <span class="id" title="var">leastelementprinciple</span> <span class="id" title="var">n</span> <span class="id" title="var">P</span> <span class="id" title="var">isdec</span> <span class="id" title="var">x</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">leexists</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k</span> <span class="id" title="var">k'</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k'</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k'</span> <span class="id" title="var">k''</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">total2tohexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> 0%<span class="id" title="var">nat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">P</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">neq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span>. &nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">b</span> 0%<span class="id" title="var">nat</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">c</span> 0%<span class="id" title="var">nat</span>) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">total2tohexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">k''</span> <span class="id" title="var">k</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">natlthnsn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intro</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">P</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">neq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span>. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ) <span class="id" title="var">k</span> ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">c</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">c</span> ) <span class="id" title="var">k</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">padicapartandplusprecarryr</span> ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> )<br/>
&nbsp;&nbsp;( <span class="id" title="var">x</span> : <span class="id" title="var">neq</span> <span class="id" title="var">_</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> ) <span class="id" title="var">n</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( ( <span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">c</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> ) ) <span class="id" title="var">n</span> ) ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">padicapart0</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2! ( <span class="id" title="var">ringcomm1</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> ) ) <span class="id" title="tactic">in</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">padicapartandplusprecarryl</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span> ).<br/>
</div>

<br/>
</div>

<div class="doc">
here used to be shown the lemmas <span class="inlinecode"><span class="id" title="var">commringquotprandop1</span></span> and
    <span class="inlinecode"><span class="id" title="var">commringquotprandop2</span></span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">setquotprandpadicplus</span> ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;@<span class="id" title="var">op1</span> <span class="id" title="var">commringofpadicints</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">setquotpr</span> ( <span class="id" title="var">carryequiv</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) ) <span class="id" title="var">a</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">setquotpr</span> ( <span class="id" title="var">carryequiv</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) ) <span class="id" title="var">b</span> ) =<br/>
&nbsp;&nbsp;<span class="id" title="var">setquotpr</span> ( <span class="id" title="var">carryequiv</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) ) ( <span class="id" title="var">a</span> + <span class="id" title="var">b</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">commringquotprandop1</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">setquotprandpadictimes</span> ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;@<span class="id" title="var">op2</span> <span class="id" title="var">commringofpadicints</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">setquotpr</span> ( <span class="id" title="var">carryequiv</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) ) <span class="id" title="var">a</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">setquotpr</span> ( <span class="id" title="var">carryequiv</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) ) <span class="id" title="var">b</span> ) =<br/>
&nbsp;<span class="id" title="var">setquotpr</span> ( <span class="id" title="var">carryequiv</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) ) ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">commringquotprandop2</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">padicplusisbinopapart0</span> ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> )<br/>
&nbsp;&nbsp;( <span class="id" title="var">u</span> : <span class="id" title="var">padicapart0</span> ( <span class="id" title="var">a</span> + <span class="id" title="var">b</span> ) ( <span class="id" title="var">a</span> + <span class="id" title="var">c</span> ) ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">padicapart0</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">u</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">n</span> <span class="id" title="var">n'</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">P</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt; <span class="id" title="var">neq</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) ( <span class="id" title="var">a</span> + <span class="id" title="var">b</span>) <span class="id" title="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) ( <span class="id" title="var">a</span> + <span class="id" title="var">c</span>) <span class="id" title="var">x</span>) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">isdecnatprop</span> <span class="id" title="var">P</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">isdec</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">isdeceqhz</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) ( <span class="id" title="var">a</span> + <span class="id" title="var">b</span>) <span class="id" title="var">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) ( <span class="id" title="var">a</span> + <span class="id" title="var">c</span>) <span class="id" title="var">m</span>) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> | <span class="id" title="var">r</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">P</span> <span class="id" title="tactic">in</span> <span class="id" title="var">j</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">neq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">j</span>. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">le</span> := <span class="id" title="var">leastelementprinciple</span> <span class="id" title="var">n</span> <span class="id" title="var">P</span> <span class="id" title="var">isdec</span> <span class="id" title="var">n'</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">le</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k</span> <span class="id" title="var">k'</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k'</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k'</span> <span class="id" title="var">k''</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">total2tohexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> 0%<span class="id" title="var">nat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">P</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">neq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span>. &nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">precarry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( ( <span class="id" title="var">a</span> + <span class="id" title="var">b</span> ) 0%<span class="id" title="var">nat</span> ) <span class="id" title="keyword">with</span> ( <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> + <span class="id" title="var">b</span> 0%<span class="id" title="var">nat</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( ( <span class="id" title="var">a</span> + <span class="id" title="var">c</span> ) 0%<span class="id" title="var">nat</span> ) <span class="id" title="keyword">with</span> ( <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> + <span class="id" title="var">c</span> 0%<span class="id" title="var">nat</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">precarry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzremaindermodandplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">hzremaindermodandplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> ( <span class="id" title="var">isdeceqhz</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">c</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> | <span class="id" title="var">r</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">padicapartandplusprecarryl</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">k</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">P</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">neq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">carryandplus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span> <span class="id" title="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ) <span class="id" title="var">k</span> ) ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) ( <span class="id" title="var">a</span> + <span class="id" title="var">c</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">carryandplus</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> <span class="id" title="var">c</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span> <span class="id" title="tactic">at</span> 5.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">c</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">c</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">c</span> ) <span class="id" title="var">k</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">total2tohexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">padicplusisbinopapartl</span> : <span class="id" title="var">isbinopapartl</span> <span class="id" title="var">padicapart</span> <span class="id" title="var">padicplus</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">isbinopapartl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">x''</span> : <span class="id" title="var">commringofpadicints</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isaprop</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">padicapart</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">padicplus</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">padicplus</span> <span class="id" title="var">x</span> <span class="id" title="var">x''</span> ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">pr1</span> <span class="id" title="var">padicapart</span> <span class="id" title="var">x'</span> <span class="id" title="var">x''</span> ) ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">int</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">padicapart</span> ).<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">setquotuniv3prop</span> <span class="id" title="var">_</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">x''</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> ( <span class="id" title="var">int</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">x''</span> ) ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">padicapart</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">padicplus</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">ringcarryequiv</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>)) <span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">setquotpr</span> (<span class="id" title="var">ringcarryequiv</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>)) <span class="id" title="var">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">padicplus</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">ringcarryequiv</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>)) <span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">setquotpr</span> (<span class="id" title="var">ringcarryequiv</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>)) <span class="id" title="var">c</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr1</span> <span class="id" title="var">padicapart</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">setquotpr</span> (<span class="id" title="var">ringcarryequiv</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>)) <span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">setquotpr</span> (<span class="id" title="var">ringcarryequiv</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>)) <span class="id" title="var">c</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">padicplus</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2! <span class="id" title="var">setquotprandpadicplus</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2! <span class="id" title="var">padicapartcomputation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">padicplusisbinopapart0</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">padicplusisbinopapartr</span> : <span class="id" title="var">isbinopapartr</span> <span class="id" title="var">padicapart</span> <span class="id" title="var">padicplus</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">isbinopapartr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">padicplus</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( @<span class="id" title="var">ringcomm1</span> <span class="id" title="var">commringofpadicints</span> <span class="id" title="var">b</span> <span class="id" title="var">a</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( @<span class="id" title="var">ringcomm1</span> <span class="id" title="var">commringofpadicints</span> <span class="id" title="var">c</span> <span class="id" title="var">a</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">padicplusisbinopapartl</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">padicapartandtimesprecarryl</span> ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> )<br/>
&nbsp;&nbsp;( <span class="id" title="var">x</span> : <span class="id" title="var">neq</span> <span class="id" title="var">_</span> ( <span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ) <span class="id" title="var">n</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( ( <span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">c</span> ) ) <span class="id" title="var">n</span> ) ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">padicapart0</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">P</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">neq</span> <span class="id" title="var">hz</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">a</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">b</span>) <span class="id" title="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">precarry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">a</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">c</span>) <span class="id" title="var">x</span>) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">isdecnatprop</span> <span class="id" title="var">P</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">isdec</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">isdeceqhz</span> (<span class="id" title="var">precarry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">a</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">b</span>) <span class="id" title="var">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">precarry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">a</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">c</span>) <span class="id" title="var">m</span>) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> | <span class="id" title="var">r</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">P</span> <span class="id" title="tactic">in</span> <span class="id" title="var">j</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">neq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">leexists</span> := <span class="id" title="var">leastelementprinciple</span> <span class="id" title="var">n</span> <span class="id" title="var">P</span> <span class="id" title="var">isdec</span> <span class="id" title="var">x</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">leexists</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k</span> <span class="id" title="var">k'</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k'</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k'</span> <span class="id" title="var">k''</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">total2tohexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> 0%<span class="id" title="var">nat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">P</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">neq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span>(<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">b</span> 0%<span class="id" title="var">nat</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">c</span> 0%<span class="id" title="var">nat</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">set</span> ( <span class="id" title="var">Q</span> := ( <span class="id" title="keyword">fun</span> <span class="id" title="var">o</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hProppair</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> <span class="id" title="var">o</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">c</span> <span class="id" title="var">o</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">isasethz</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">isdecnatprop</span> <span class="id" title="var">Q</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">isdec'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">o</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">isdeceqhz</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> <span class="id" title="var">o</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">c</span> <span class="id" title="var">o</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> | <span class="id" title="var">r</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">ii1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">ii2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">isdecisbndqdec</span> <span class="id" title="var">Q</span> <span class="id" title="var">isdec'</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> | <span class="id" title="var">r</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">k''</span> <span class="id" title="var">k</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natlthnsn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">P</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">neq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( ( <span class="id" title="var">natsummation0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> <span class="id" title="var">x</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) <span class="id" title="var">x</span> ) ) ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ) <span class="id" title="var">k</span> ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(( <span class="id" title="var">natsummation0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> <span class="id" title="var">x</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">c</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) <span class="id" title="var">x</span> ) ) ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">c</span> ) <span class="id" title="var">k</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">natsummation0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) (<span class="id" title="keyword">fun</span> <span class="id" title="var">x0</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">a</span> <span class="id" title="var">x0</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) <span class="id" title="var">x0</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">natsummation0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) (<span class="id" title="keyword">fun</span> <span class="id" title="var">x0</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">a</span> <span class="id" title="var">x0</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">c</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) <span class="id" title="var">x0</span>)) ) <span class="id" title="keyword">as</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">natsummationpathsupperfixed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">m</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">l</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) <span class="id" title="var">m</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">minusleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">o</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">o</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">o</span> <span class="id" title="var">o'</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">total2tohexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">o</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">o'</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">padictimesisbinopapart0</span> ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> )<br/>
&nbsp;&nbsp;( <span class="id" title="var">u</span> : <span class="id" title="var">padicapart0</span> ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) ( <span class="id" title="var">a</span> * <span class="id" title="var">c</span> ) ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">padicapart0</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">u</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">n</span> <span class="id" title="var">n'</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">total2tohexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> 0%<span class="id" title="var">nat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">neq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">n'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">n'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">carryandtimes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">carryandtimes</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> <span class="id" title="var">c</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> 0%<span class="id" title="var">nat</span> ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">c</span> 0%<span class="id" title="var">nat</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">set</span> ( <span class="id" title="var">Q</span> := ( <span class="id" title="keyword">fun</span> <span class="id" title="var">o</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hProppair</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> <span class="id" title="var">o</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">c</span> <span class="id" title="var">o</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">isasethz</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">isdecnatprop</span> <span class="id" title="var">Q</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">isdec'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">o</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">isdeceqhz</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> <span class="id" title="var">o</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">c</span> <span class="id" title="var">o</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> | <span class="id" title="var">r</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">ii1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">ii2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">isdecisbndqdec</span> <span class="id" title="var">Q</span> <span class="id" title="var">isdec'</span>( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ) <span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> | <span class="id" title="var">r</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">padicapartandtimesprecarryl</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">n</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">neq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">n'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">n'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">carryandtimes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">carryandtimes</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> <span class="id" title="var">c</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">natsummation0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> <span class="id" title="var">x</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) <span class="id" title="var">x</span> ) ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ) <span class="id" title="var">n</span> ) ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">natsummation0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> <span class="id" title="var">x</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">c</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) <span class="id" title="var">x</span> ) ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">c</span> ) <span class="id" title="var">n</span> ) ) ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">natsummation0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) (<span class="id" title="keyword">fun</span> <span class="id" title="var">x0</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">a</span> <span class="id" title="var">x0</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) <span class="id" title="var">x0</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">natsummation0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) (<span class="id" title="keyword">fun</span> <span class="id" title="var">x0</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">a</span> <span class="id" title="var">x0</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">c</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) <span class="id" title="var">x0</span>)) ) <span class="id" title="keyword">as</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">natsummationpathsupperfixed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">m</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">l</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">n</span> ) <span class="id" title="var">m</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">minusleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k</span> <span class="id" title="var">k'</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">total2tohexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">k'</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">padictimesisbinopapartl</span> : <span class="id" title="var">isbinopapartl</span> <span class="id" title="var">padicapart</span> <span class="id" title="var">padictimes</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">isbinopapartl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">x''</span> : <span class="id" title="var">commringofpadicints</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isaprop</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">padicapart</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">padictimes</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">padictimes</span> <span class="id" title="var">x</span> <span class="id" title="var">x''</span> ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">pr1</span> <span class="id" title="var">padicapart</span> <span class="id" title="var">x'</span> <span class="id" title="var">x''</span> ) ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">int</span>.<br/>
&nbsp;&nbsp;{  <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">padicapart</span> ).<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">setquotuniv3prop</span> <span class="id" title="var">_</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">x''</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> ( <span class="id" title="var">int</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">x''</span> ) ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">padicapart</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">padictimes</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">carryequiv</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>)) <span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">setquotpr</span> (<span class="id" title="var">carryequiv</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>)) <span class="id" title="var">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">padictimes</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">carryequiv</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>)) <span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">setquotpr</span> (<span class="id" title="var">carryequiv</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>)) <span class="id" title="var">c</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr1</span> <span class="id" title="var">padicapart</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">carryequiv</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>)) <span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">setquotpr</span> (<span class="id" title="var">carryequiv</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>)) <span class="id" title="var">c</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">padictimes</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2! <span class="id" title="var">setquotprandpadictimes</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2! <span class="id" title="var">padicapartcomputation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">padictimesisbinopapart0</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">j</span> ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">padictimesisbinopapartr</span> : <span class="id" title="var">isbinopapartr</span> <span class="id" title="var">padicapart</span> <span class="id" title="var">padictimes</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">isbinopapartr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">padictimes</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( @<span class="id" title="var">ringcomm2</span> <span class="id" title="var">commringofpadicints</span> <span class="id" title="var">b</span> <span class="id" title="var">a</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( @<span class="id" title="var">ringcomm2</span> <span class="id" title="var">commringofpadicints</span> <span class="id" title="var">c</span> <span class="id" title="var">a</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">padictimesisbinopapartl</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">acommringofpadicints</span> : <span class="id" title="var">acommring</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">commringofpadicints</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">padicapart</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">padicplusisbinopapartl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">padicplusisbinopapartr</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">padictimesisbinopapartl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">padictimesisbinopapartr</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab708"></a><h1 class="section">IV. The apartness domain of p-adic integers and the Heyting field of p-adic numbers</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">precarryandzeromultl</span> ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> )<br/>
&nbsp;&nbsp;( <span class="id" title="var">x</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">natlth</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> <span class="id" title="var">m</span> = 0%<span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">natlth</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">fpstimes</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ) ) <span class="id" title="var">m</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">hz</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">m</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">fpstimes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">x</span> 0%<span class="id" title="var">nat</span> <span class="id" title="var">y</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmult0x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">change</span> ( <span class="id" title="var">natsummation0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">m</span> ) ( <span class="id" title="keyword">fun</span> <span class="id" title="var">z</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> <span class="id" title="var">z</span> ) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">m</span> ) <span class="id" title="var">z</span> ) ) ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">fpstimes</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ) ) <span class="id" title="var">m</span> ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">natlth</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">istransnatlth</span> <span class="id" title="var">_</span> ( <span class="id" title="var">S</span> <span class="id" title="var">m</span> ) <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natlthnsn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">IHm</span> <span class="id" title="var">u</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrand0q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusr0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">natsummation0</span> (<span class="id" title="var">S</span> <span class="id" title="var">m</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">z</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">a</span> <span class="id" title="var">z</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">b</span> ( <span class="id" title="var">sub</span> ( <span class="id" title="var">S</span> <span class="id" title="var">m</span> ) <span class="id" title="var">z</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">natsummation0</span> ( <span class="id" title="var">S</span> <span class="id" title="var">m</span> ) ( <span class="id" title="keyword">fun</span> <span class="id" title="var">z</span> : <span class="id" title="var">nat</span> =&gt; 0%<span class="id" title="var">hz</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">natsummationpathsupperfixed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">natlth</span> <span class="id" title="var">k</span> <span class="id" title="var">n</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">uu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> ( <span class="id" title="var">natlehlthtrans</span> <span class="id" title="var">_</span> ( <span class="id" title="var">S</span> <span class="id" title="var">m</span> ) <span class="id" title="var">_</span> ); <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">x</span> <span class="id" title="var">k</span> <span class="id" title="var">uu</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmult0x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">natsummationae0bottom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">precarryandzeromultr</span> ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> )<br/>
&nbsp;&nbsp;( <span class="id" title="var">x</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">natlth</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> <span class="id" title="var">m</span> = 0%<span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">natlth</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">fpstimes</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ) ) <span class="id" title="var">m</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">hz</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">m</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">fpstimes</span> <span class="id" title="var">hz</span> (<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">b</span>)) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;( (<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">a</span>) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">carry</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">b</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( @<span class="id" title="var">ringcomm2</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">precarryandzeromultl</span> <span class="id" title="var">b</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> <span class="id" title="var">y</span> ).<br/>
</div>

<br/>
</div>

<div class="doc">
here used to be shown the lemmas <span class="inlinecode"><span class="id" title="var">hzfpstimesnonzero</span></span> and
    <span class="inlinecode"><span class="id" title="var">hzfpstimeswhenzero</span></span>, now before part III 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">precarryandzeromult</span> ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ( <span class="id" title="var">k</span> <span class="id" title="var">k'</span> : <span class="id" title="var">nat</span> )<br/>
&nbsp;&nbsp;( <span class="id" title="var">x</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">natlth</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> <span class="id" title="var">m</span> = 0%<span class="id" title="var">hz</span> )<br/>
&nbsp;&nbsp;( <span class="id" title="var">x'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">natlth</span> <span class="id" title="var">m</span> <span class="id" title="var">k'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> <span class="id" title="var">m</span> = 0%<span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">natlth</span> <span class="id" title="var">m</span> ( <span class="id" title="var">k</span> + <span class="id" title="var">k'</span> )%<span class="id" title="var">nat</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">fpstimes</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ) ) <span class="id" title="var">m</span> =<br/>
&nbsp;&nbsp;0%<span class="id" title="var">hz</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzfpstimeswhenzero</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> ) 0%<span class="id" title="var">nat</span> <span class="id" title="var">k</span> <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ) <span class="id" title="var">k'</span> <span class="id" title="var">x'</span> <span class="id" title="var">i</span> ).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">change</span> ( ( ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> ) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ) ) ( <span class="id" title="var">S</span> <span class="id" title="var">m</span> ) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">fpstimes</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ) ) <span class="id" title="var">m</span> ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">hzfpstimeswhenzero</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">m</span> ) <span class="id" title="var">k</span> <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ) <span class="id" title="var">k'</span> <span class="id" title="var">x'</span> <span class="id" title="var">i</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusl0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">natlth</span> <span class="id" title="var">m</span> ( <span class="id" title="var">k</span> + <span class="id" title="var">k'</span> )%<span class="id" title="var">nat</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">one</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> ( <span class="id" title="var">istransnatlth</span> <span class="id" title="var">_</span> ( <span class="id" title="var">S</span> <span class="id" title="var">m</span> ) <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">natlthnsn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">IHm</span> <span class="id" title="var">one</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrand0q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">primedivorcoprime</span> ( <span class="id" title="var">a</span> : <span class="id" title="var">hz</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzdiv</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span>  <span class="id" title="var">gcd</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) = 1.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> ( <span class="id" title="var">pr2</span> <span class="id" title="keyword">is</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">gcd</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">pr1</span> ( <span class="id" title="var">gcdiscommondiv</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) ) ) )).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">t0</span> | <span class="id" title="var">t1</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">t1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ( <span class="id" title="var">pr2</span> ( <span class="id" title="var">gcdiscommondiv</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) ) ).<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">primeandtimes</span> ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">hz</span> ) ( <span class="id" title="var">x</span> : <span class="id" title="var">hzdiv</span> <span class="id" title="var">p</span> ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzdiv</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span>  <span class="id" title="var">hzdiv</span> <span class="id" title="var">p</span> <span class="id" title="var">b</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> ( <span class="id" title="var">primedivorcoprime</span> <span class="id" title="var">a</span> )).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">j</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">j</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">j0</span> | <span class="id" title="var">j1</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">u</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k</span> <span class="id" title="var">u</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">cd</span> := <span class="id" title="var">bezoutstrong</span> <span class="id" title="var">a</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">cd</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">cd</span> <span class="id" title="var">f</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">cd</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">c</span> <span class="id" title="var">d</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">j1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">b</span> = ( <span class="id" title="var">b</span> * <span class="id" title="var">c</span> + <span class="id" title="var">d</span> * <span class="id" title="var">k</span> ) * <span class="id" title="var">p</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">assert</span> ( <span class="id" title="var">b</span> = <span class="id" title="var">b</span> * 1 ) <span class="id" title="keyword">as</span> <span class="id" title="var">g0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultr1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">g0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringrdistr</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">b</span> * 1 * <span class="id" title="var">c</span> ) ( <span class="id" title="var">d</span> * <span class="id" title="var">k</span> ) <span class="id" title="var">p</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">b</span> * ( <span class="id" title="var">c</span> * <span class="id" title="var">p</span> + <span class="id" title="var">d</span> * <span class="id" title="var">a</span> ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">b</span> * 1 * <span class="id" title="var">c</span> * <span class="id" title="var">p</span> + <span class="id" title="var">d</span> * <span class="id" title="var">k</span> * <span class="id" title="var">p</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">ringldistr</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">c</span> * <span class="id" title="var">p</span> ) ( <span class="id" title="var">d</span> * <span class="id" title="var">a</span> ) <span class="id" title="var">b</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzmultr1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2! ( @<span class="id" title="var">ringassoc2</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( @<span class="id" title="var">ringcomm2</span> <span class="id" title="var">hz</span> <span class="id" title="var">k</span> <span class="id" title="var">p</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">p</span> * <span class="id" title="var">k</span> )%<span class="id" title="var">hz</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">p</span> * <span class="id" title="var">k</span> )%<span class="id" title="tactic">ring</span> <span class="id" title="tactic">in</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">u</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( @<span class="id" title="var">ringcomm2</span> <span class="id" title="var">hz</span> <span class="id" title="var">b</span> ( <span class="id" title="var">d</span> * <span class="id" title="var">a</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( @<span class="id" title="var">ringassoc2</span> <span class="id" title="var">hz</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Q</span> <span class="id" title="var">uu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">uu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">b</span> * <span class="id" title="var">c</span> + <span class="id" title="var">d</span> * <span class="id" title="var">k</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( @<span class="id" title="var">ringcomm2</span> <span class="id" title="var">hz</span> <span class="id" title="var">_</span> <span class="id" title="var">p</span> ) <span class="id" title="tactic">in</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hzremaindermodprimeandtimes</span> ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">hz</span> )<br/>
&nbsp;&nbsp;( <span class="id" title="var">x</span> : <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) = 0 ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> = 0 <br/>
&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> = 0.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">hzdiv</span> <span class="id" title="var">p</span> ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">i'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">i'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- ( <span class="id" title="var">hzplusr0</span> (<span class="id" title="var">p</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) (<span class="id" title="var">a</span> * <span class="id" title="var">b</span>)%<span class="id" title="tactic">ring</span>) )%<span class="id" title="var">hz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">a</span> * <span class="id" title="var">b</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) (<span class="id" title="var">a</span> * <span class="id" title="var">b</span>)%<span class="id" title="tactic">ring</span> + 0)%<span class="id" title="tactic">ring</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">p</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) (<span class="id" title="var">a</span> * <span class="id" title="var">b</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">a</span> * <span class="id" title="var">b</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span> * <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) (<span class="id" title="var">a</span> * <span class="id" title="var">b</span>)%<span class="id" title="tactic">ring</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>) <span class="id" title="var">a</span> * <span class="id" title="var">b</span> )%<span class="id" title="tactic">ring</span> )%<span class="id" title="var">hz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzdivequationmod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) ( <span class="id" title="var">a</span> * <span class="id" title="var">b</span> ) ).<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> ( <span class="id" title="var">primeandtimes</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">i</span> )).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">t0</span> | <span class="id" title="var">t1</span> ].<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">t0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k</span> <span class="id" title="var">k'</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Q</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ii1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrtestr</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> <span class="id" title="var">k</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusr0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">isreflhzleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalgth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">istranshzlth</span> <span class="id" title="var">_</span> 1 <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthnsn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> <span class="id" title="keyword">is</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">istranshzlth</span> <span class="id" title="var">_</span> 1 <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthnsn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> <span class="id" title="keyword">is</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">t1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k</span> <span class="id" title="var">k'</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Q</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ii2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">hzqrtestr</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> <span class="id" title="var">k</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusr0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hzdiv0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">isreflhzleh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzabsvalgth0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">istranshzlth</span> <span class="id" title="var">_</span> 1 <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthnsn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> <span class="id" title="keyword">is</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> ( <span class="id" title="var">istranshzlth</span> <span class="id" title="var">_</span> 1 <span class="id" title="var">_</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> <span class="id" title="var">hzlthnsn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="tactic">apply</span> <span class="id" title="keyword">is</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">padiczero</span> := @<span class="id" title="var">ringunel1</span> <span class="id" title="var">commringofpadicints</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">padicone</span> := @<span class="id" title="var">ringunel2</span> <span class="id" title="var">commringofpadicints</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">padiczerocomputation</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">padiczero</span> =<br/>
&nbsp;&nbsp;<span class="id" title="var">setquotpr</span> ( <span class="id" title="var">carryequiv</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( @<span class="id" title="var">ringunel1</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">padiconecomputation</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">padicone</span> =<br/>
&nbsp;&nbsp;<span class="id" title="var">setquotpr</span> ( <span class="id" title="var">carryequiv</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( @<span class="id" title="var">ringunel2</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idpath</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">padicintsareintdom</span> ( <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">acommringofpadicints</span> ) :<br/>
&nbsp;&nbsp;<span class="id" title="var">a</span> # 0 -&gt; <span class="id" title="var">b</span> # 0 -&gt; <span class="id" title="var">a</span> * <span class="id" title="var">b</span> # 0.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">commringofpadicints</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isaprop</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">padicapart</span> <span class="id" title="var">a</span> <span class="id" title="var">padiczero</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr1</span> <span class="id" title="var">padicapart</span> <span class="id" title="var">b</span> <span class="id" title="var">padiczero</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr1</span> <span class="id" title="var">padicapart</span> ( <span class="id" title="var">padictimes</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">padiczero</span> ) ) <span class="id" title="keyword">as</span> <span class="id" title="var">int</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">padicapart</span> ).<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">setquotuniv2prop</span> <span class="id" title="var">_</span> ( <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hProppair</span> <span class="id" title="var">_</span> ( <span class="id" title="var">int</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> ) ) ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">padicapart</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">setquotpr</span> (<span class="id" title="var">carryequiv</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>)) <span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">padiczero</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr1</span> <span class="id" title="var">padicapart</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">setquotpr</span> (<span class="id" title="var">carryequiv</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>)) <span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">padiczero</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr1</span> <span class="id" title="var">padicapart</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">padictimes</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">setquotpr</span> (<span class="id" title="var">carryequiv</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>)) <span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">setquotpr</span> (<span class="id" title="var">carryequiv</span> <span class="id" title="var">p</span> (<span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span>)) <span class="id" title="var">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">padiczero</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">padictimes</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">padiczerocomputation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">setquotprandpadictimes</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 3! <span class="id" title="var">padicapartcomputation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">i</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">i0</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">i0</span> <span class="id" title="var">i1</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">j</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">j0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">j0</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">j0</span> <span class="id" title="var">j1</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">carryandzero</span> <span class="id" title="tactic">in</span> <span class="id" title="var">i1</span>, <span class="id" title="var">j1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( ( @<span class="id" title="var">ringunel1</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ) <span class="id" title="var">i0</span> ) <span class="id" title="keyword">with</span> 0%<span class="id" title="var">hz</span> <span class="id" title="tactic">in</span> <span class="id" title="var">i1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( ( @<span class="id" title="var">ringunel1</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ) <span class="id" title="var">j0</span> ) <span class="id" title="keyword">with</span> 0%<span class="id" title="var">hz</span> <span class="id" title="tactic">in</span> <span class="id" title="var">j1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">P</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">neq</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> <span class="id" title="var">x</span> ) 0 ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">P'</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">nat</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">neq</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> <span class="id" title="var">x</span> ) 0 ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">isdecnatprop</span> <span class="id" title="var">P</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">isdec1</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">isdeceqhz</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> <span class="id" title="var">m</span> ) 0%<span class="id" title="var">hz</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> | <span class="id" title="var">r</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">P</span> <span class="id" title="tactic">in</span> <span class="id" title="var">v</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">neq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">isdecnatprop</span> <span class="id" title="var">P'</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">isdec2</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">isdeceqhz</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> <span class="id" title="var">m</span> ) 0%<span class="id" title="var">hz</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> | <span class="id" title="var">r</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">P'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">v</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">neq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ii1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">le1</span> := <span class="id" title="var">leastelementprinciple</span> <span class="id" title="var">i0</span> <span class="id" title="var">P</span> <span class="id" title="var">isdec1</span> <span class="id" title="var">i1</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">le2</span> := <span class="id" title="var">leastelementprinciple</span> <span class="id" title="var">j0</span> <span class="id" title="var">P'</span> <span class="id" title="var">isdec2</span> <span class="id" title="var">j1</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">le1</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">k</span> <span class="id" title="var">k'</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">le2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">o</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">o</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">o</span> <span class="id" title="var">o'</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">total2tohexists</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">k</span> + <span class="id" title="var">o</span> )%<span class="id" title="var">nat</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">natlth</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> <span class="id" title="var">m</span> = 0%<span class="id" title="var">hz</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">one</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">m</span> <span class="id" title="var">m0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">isdeceqhz</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> <span class="id" title="var">m</span> ) 0%<span class="id" title="var">hz</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [ <span class="id" title="var">left0</span> | <span class="id" title="var">right0</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( ( <span class="id" title="var">pr2</span> <span class="id" title="var">k'</span> ) <span class="id" title="var">m</span> <span class="id" title="var">m0</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">natlth</span> <span class="id" title="var">m</span> <span class="id" title="var">o</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> <span class="id" title="var">m</span> = 0%<span class="id" title="var">hz</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">two</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">m</span> <span class="id" title="var">m0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ( <span class="id" title="var">isdeceqhz</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> <span class="id" title="var">m</span> ) 0%<span class="id" title="var">hz</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [ <span class="id" title="var">left0</span> | <span class="id" title="var">right0</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">fromempty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( ( <span class="id" title="var">pr2</span> <span class="id" title="var">o'</span> ) <span class="id" title="var">m</span> <span class="id" title="var">m0</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">neq</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> <span class="id" title="var">k</span> ) 0%<span class="id" title="var">hz</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">natlth</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> <span class="id" title="var">m</span> ) = 0%<span class="id" title="var">hz</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">three</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">neq</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> <span class="id" title="var">o</span> ) 0%<span class="id" title="var">hz</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">natlth</span> <span class="id" title="var">m</span> <span class="id" title="var">o</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> <span class="id" title="var">m</span> ) = 0%<span class="id" title="var">hz</span> ) <span class="id" title="keyword">as</span> <span class="id" title="var">four</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">o'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">f</span> := <span class="id" title="var">hzfpstimesnonzero</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> ) <span class="id" title="var">k</span> <span class="id" title="var">three</span> <span class="id" title="var">o</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ) <span class="id" title="var">four</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">carryandzero</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( ( @<span class="id" title="var">ringunel1</span> ( <span class="id" title="var">fpscommring</span> <span class="id" title="var">hz</span> ) ) ( <span class="id" title="var">k</span> + <span class="id" title="var">o</span> )%<span class="id" title="var">nat</span> ) <span class="id" title="keyword">with</span> 0%<span class="id" title="var">hz</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">carryandtimes</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">o</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">carryandtimes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> * <span class="id" title="var">b</span> 0%<span class="id" title="var">nat</span> ) = 0%<span class="id" title="var">hz</span> ) <span class="id" title="tactic">in</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> <span class="id" title="var">hfalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> ( <span class="id" title="var">hzremaindermodprimeandtimes</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> ) ( <span class="id" title="var">b</span> 0%<span class="id" title="var">nat</span> ) <span class="id" title="var">v</span> )).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">t0</span> | <span class="id" title="var">t1</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">unfold</span> <span class="id" title="var">P</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">neq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">k'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">t0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">unfold</span> <span class="id" title="var">P'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">o'</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">neq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">o'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">o'</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">t1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span> <span class="id" title="tactic">at</span> 1 <span class="id" title="tactic">in</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( 0 + <span class="id" title="var">S</span> <span class="id" title="var">o</span> )%<span class="id" title="var">nat</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">S</span> <span class="id" title="var">o</span> ) <span class="id" title="tactic">in</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">o</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ) <span class="id" title="var">o</span> ) ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">hz</span> ) <span class="id" title="tactic">in</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( 0 + <span class="id" title="var">S</span> <span class="id" title="var">o</span> )%<span class="id" title="var">nat</span> <span class="id" title="keyword">with</span> ( <span class="id" title="var">S</span> <span class="id" title="var">o</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span> <span class="id" title="tactic">in</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">fpstimes</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ) ) <span class="id" title="tactic">in</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">precarryandzeromult</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> 0%<span class="id" title="var">nat</span> ( <span class="id" title="var">S</span> <span class="id" title="var">o</span> ) ) <span class="id" title="tactic">in</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrand0q</span> <span class="id" title="tactic">in</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusr0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> <span class="id" title="var">hfalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">set</span> (<span class="id" title="var">aux</span> :=  <span class="id" title="var">hzremaindermodprimeandtimes</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> 0%<span class="id" title="var">nat</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">o</span> ) ) <span class="id" title="var">v</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">aux</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> | <span class="id" title="var">r</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">unfold</span> <span class="id" title="var">P</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">neq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrandcarryr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">unfold</span> <span class="id" title="var">P'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">o'</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">neq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">o'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">o'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrandcarryr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">one</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">two</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">natlthnsn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span> <span class="id" title="tactic">at</span> 1 <span class="id" title="tactic">in</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">hzremaindermod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ) ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> + <span class="id" title="var">o</span> )%<span class="id" title="var">nat</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hzquotientmod</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">precarry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ) ( <span class="id" title="var">k</span> + <span class="id" title="var">o</span> )%<span class="id" title="var">nat</span> ) ) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">hz</span> ) <span class="id" title="tactic">in</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span> <span class="id" title="tactic">in</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">fpstimes</span> <span class="id" title="var">hz</span> ( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> ) ) <span class="id" title="tactic">in</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ( <span class="id" title="var">precarryandzeromult</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) <span class="id" title="var">o</span> ) <span class="id" title="tactic">in</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrand0q</span> <span class="id" title="tactic">in</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzplusr0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> <span class="id" title="var">hfalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">set</span> (<span class="id" title="var">aux</span> := <span class="id" title="var">hzremaindermodprimeandtimes</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">a</span> ( <span class="id" title="var">S</span> <span class="id" title="var">k</span> ) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="var">carry</span> <span class="id" title="var">p</span> ( <span class="id" title="var">isaprimetoneq0</span> <span class="id" title="keyword">is</span> ) <span class="id" title="var">b</span> (<span class="id" title="var">o</span> ) ) <span class="id" title="var">v</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">use</span> (<span class="id" title="var">hinhuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">aux</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span> <span class="id" title="keyword">as</span> [ <span class="id" title="var">l</span> | <span class="id" title="var">r</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">unfold</span> <span class="id" title="var">P</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">neq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">k'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrandcarryr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">unfold</span> <span class="id" title="var">P'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">o'</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">neq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">o'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">o'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrandcarryr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">one</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">two</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">natlthnsn</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">padicintegers</span> : <span class="id" title="var">aintdom</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> <span class="id" title="var">acommringofpadicints</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">change</span> ( <span class="id" title="var">pr1</span> <span class="id" title="var">padicapart</span> <span class="id" title="var">padicone</span> <span class="id" title="var">padiczero</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">padiczerocomputation</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">padiconecomputation</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">padicapartcomputation</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">total2tohexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> <span class="id" title="keyword">with</span> 0%<span class="id" title="var">nat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">carry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">precarry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrand1r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">hzqrand0r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isnonzerorighz</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">padicintsareintdom</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">padics</span> : <span class="id" title="var">afld</span> := <span class="id" title="var">afldfrac</span> <span class="id" title="var">padicintegers</span>.<br/>

<br/>
<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">ring_scope</span>.<br/>
</div>

<div class="doc">
END OF FILE
</div>
<div class="code">
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>