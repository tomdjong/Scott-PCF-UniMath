<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
	<script src="http://code.jquery.com/jquery-1.11.0.min.js" type="text/javascript"></script>
	<script src="./proofs-toggle.js" type="text/javascript"></script>
	<style>
		div.proofcomment {
			font-style: italic;
		}
	</style>
	<title>Documentation</title>
</head>
<body>
<div id="page">
<div id="main">
<h1 class="libtitle">Library UniMath.Ktheory.AbelianGroup</h1>

<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab1791"></a><h1 class="section">abelian groups</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.Algebra.Monoids</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.Algebra.Groups</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.CategoryTheory.Core.Categories</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.CategoryTheory.Core.Isos</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.CategoryTheory.Core.Functors</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.CategoryTheory.Core.NaturalTransformations</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.CategoryTheory.Core.Univalence</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.NumberSystems.Integers</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">UniMath.Ktheory.Tactics</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">UniMath.Ktheory.Utilities</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">UniMath.Ktheory.Representation</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">UniMath.Ktheory.Precategories</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="var">UniMath.Ktheory.Group</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">cat</span>.<br/>

<br/>
<span class="id" title="keyword">Delimit</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">abgr</span> <span class="id" title="keyword">with</span> <span class="id" title="var">abgr</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">abgr</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">Hom_abgr</span> := <span class="id" title="var">monoidfun</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;0" := (<span class="id" title="var">unel</span> <span class="id" title="var">_</span>) : <span class="id" title="var">abgr</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;x + y" := ( <span class="id" title="var">op</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> ) : <span class="id" title="var">abgr</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;g ∘ f" := (<span class="id" title="var">monoidfuncomp</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>) (<span class="id" title="var">only</span> <span class="id" title="var">parsing</span>) : <span class="id" title="var">abgr</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">zeroAbgr</span> : <span class="id" title="var">abgr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">Group.zero</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">Group.zero</span>). <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Z</span> : <span class="id" title="var">abgr</span> := <span class="id" title="var">hzaddabgr</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">commax</span> (<span class="id" title="var">G</span>:<span class="id" title="var">abgr</span>) := <span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">G</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unitproperty</span> {<span class="id" title="var">G</span> <span class="id" title="var">H</span>:<span class="id" title="var">abgr</span>} (<span class="id" title="var">p</span>:<span class="id" title="var">Hom_abgr</span> <span class="id" title="var">G</span> <span class="id" title="var">H</span>) : <span class="id" title="var">p</span> (<span class="id" title="var">unel</span> <span class="id" title="var">G</span>) = <span class="id" title="var">unel</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">p</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">addproperty</span> {<span class="id" title="var">G</span> <span class="id" title="var">H</span>:<span class="id" title="var">abgr</span>} (<span class="id" title="var">p</span>:<span class="id" title="var">Hom_abgr</span> <span class="id" title="var">G</span> <span class="id" title="var">H</span>) (<span class="id" title="var">g</span> <span class="id" title="var">g'</span>:<span class="id" title="var">G</span>) : <span class="id" title="var">p</span>(<span class="id" title="var">g</span> + <span class="id" title="var">g'</span>) = <span class="id" title="var">p</span> <span class="id" title="var">g</span> + <span class="id" title="var">p</span> <span class="id" title="var">g'</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">p</span>) <span class="id" title="var">g</span> <span class="id" title="var">g'</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab1792"></a><h1 class="section">abelian groups by generators and relations</h1>


<div class="paragraph"> </div>

      This code is derived from the code in the module <span class="inlinecode"><span class="id" title="var">Monoid.Presentation</span></span>.
      Reduce the duplication later, if possible. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">Presentation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <span class="id" title="var">word</span> <span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">word_unit</span> : <span class="id" title="var">word</span> <span class="id" title="var">X</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">word_gen</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">word</span> <span class="id" title="var">X</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">word_inv</span> : <span class="id" title="var">word</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">word</span> <span class="id" title="var">X</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">word_op</span> : <span class="id" title="var">word</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">word</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">word</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">word_unit</span> {<span class="id" title="var">X</span>}.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">word_gen</span> {<span class="id" title="var">X</span>} <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">word_inv</span> {<span class="id" title="var">X</span>} <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">word_op</span> {<span class="id" title="var">X</span>} <span class="id" title="var">v</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <span class="id" title="var">reln</span> <span class="id" title="var">X</span> := <span class="id" title="var">make_reln</span> { <span class="id" title="var">lhs</span> : <span class="id" title="var">word</span> <span class="id" title="var">X</span>; <span class="id" title="var">rhs</span> : <span class="id" title="var">word</span> <span class="id" title="var">X</span> }.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">lhs</span> {<span class="id" title="var">X</span>} <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">rhs</span> {<span class="id" title="var">X</span>} <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">make_reln</span> {<span class="id" title="var">X</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <span class="id" title="var">MarkedPreAbelianGroup</span> <span class="id" title="var">X</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">make_preAbelianGroup</span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">elem</span> :&gt; <span class="id" title="keyword">Type</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">op0</span> : <span class="id" title="var">elem</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">op1</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">elem</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">op_inv</span> : <span class="id" title="var">elem</span> -&gt; <span class="id" title="var">elem</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">op2</span> : <span class="id" title="var">elem</span> -&gt; <span class="id" title="var">elem</span> -&gt; <span class="id" title="var">elem</span> }.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">elem</span> {<span class="id" title="var">X</span>} <span class="id" title="var">M</span> : <span class="id" title="tactic">rename</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">op0</span> {<span class="id" title="var">X</span> <span class="id" title="var">M</span>} : <span class="id" title="tactic">rename</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">op1</span> {<span class="id" title="var">X</span> <span class="id" title="var">M</span>} <span class="id" title="var">x</span> : <span class="id" title="tactic">rename</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">op_inv</span> {<span class="id" title="var">X</span> <span class="id" title="var">M</span>} <span class="id" title="var">x</span> : <span class="id" title="tactic">rename</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">op2</span> {<span class="id" title="var">X</span> <span class="id" title="var">M</span>} <span class="id" title="var">v</span> <span class="id" title="var">w</span> : <span class="id" title="tactic">rename</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">wordop</span> <span class="id" title="var">X</span> := <span class="id" title="var">make_preAbelianGroup</span> <span class="id" title="var">X</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>) <span class="id" title="var">word_unit</span> <span class="id" title="var">word_gen</span> <span class="id" title="var">word_inv</span> <span class="id" title="var">word_op</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">evalword</span> {<span class="id" title="var">X</span>} (<span class="id" title="var">Y</span>:<span class="id" title="var">MarkedPreAbelianGroup</span> <span class="id" title="var">X</span>) (<span class="id" title="var">w</span>:<span class="id" title="var">word</span> <span class="id" title="var">X</span>) : <span class="id" title="var">elem</span> <span class="id" title="var">Y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">w</span>; <span class="id" title="tactic">intros</span> [|<span class="id" title="var">x</span>|<span class="id" title="var">w</span>|<span class="id" title="var">v</span> <span class="id" title="var">w</span>]. { <span class="id" title="tactic">exact</span> <span class="id" title="var">op0</span>. } { <span class="id" title="tactic">exact</span> (<span class="id" title="var">op1</span> <span class="id" title="var">x</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">op_inv</span> (<span class="id" title="var">evalword</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">w</span>)). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">op2</span> (<span class="id" title="var">evalword</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">v</span>) (<span class="id" title="var">evalword</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">w</span>)). } <span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">MarkedPreAbelianGroup_to_hrel</span> {<span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">M</span>:<span class="id" title="var">MarkedPreAbelianGroup</span> <span class="id" title="var">X</span>) (<span class="id" title="keyword">is</span>:<span class="id" title="var">isaset</span> (<span class="id" title="var">elem</span> <span class="id" title="var">M</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">λ</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>, (<span class="id" title="var">evalword</span> <span class="id" title="var">M</span> <span class="id" title="var">v</span> = <span class="id" title="var">evalword</span> <span class="id" title="var">M</span> <span class="id" title="var">w</span>) ,, <span class="id" title="keyword">is</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
</div>

<div class="doc">
eta expansion principle for words 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">reassemble</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">v</span>:<span class="id" title="var">wordop</span> <span class="id" title="var">X</span>) : <span class="id" title="var">evalword</span> (<span class="id" title="var">wordop</span> <span class="id" title="var">X</span>) <span class="id" title="var">v</span> = <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="var">revert</span> <span class="id" title="var">v</span>; <span class="id" title="tactic">intros</span> [|<span class="id" title="var">x</span>|<span class="id" title="var">w</span>|<span class="id" title="var">v</span> <span class="id" title="var">w</span>]. { <span class="id" title="tactic">reflexivity</span>. } { <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">ap</span> <span class="id" title="var">word_inv</span> (<span class="id" title="var">reassemble</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>)). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">aptwice</span> <span class="id" title="var">word_op</span> (<span class="id" title="var">reassemble</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">R</span> <span class="id" title="var">v</span>) (<span class="id" title="var">reassemble</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>)). } </div>

<br/>
</div>

<div class="doc">
<a name="lab1793"></a><h2 class="section">adequate relations over R</h2>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <span class="id" title="var">AdequateRelation</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">hrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">make_AdequateRelation</span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">base</span>: ∏ <span class="id" title="var">i</span>, <span class="id" title="var">r</span> (<span class="id" title="var">lhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>)) (<span class="id" title="var">rhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">reflex</span> : ∏ <span class="id" title="var">w</span>, <span class="id" title="var">r</span> <span class="id" title="var">w</span> <span class="id" title="var">w</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">symm</span> : ∏ <span class="id" title="var">v</span> <span class="id" title="var">w</span>, <span class="id" title="var">r</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> -&gt; <span class="id" title="var">r</span> <span class="id" title="var">w</span> <span class="id" title="var">v</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">trans</span> : ∏ <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>, <span class="id" title="var">r</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> -&gt; <span class="id" title="var">r</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> -&gt; <span class="id" title="var">r</span> <span class="id" title="var">u</span> <span class="id" title="var">w</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">left_compat</span> : ∏ <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>, <span class="id" title="var">r</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> -&gt; <span class="id" title="var">r</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span>) (<span class="id" title="var">word_op</span> <span class="id" title="var">u</span> <span class="id" title="var">w</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">right_compat</span>: ∏ <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>, <span class="id" title="var">r</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> -&gt; <span class="id" title="var">r</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">u</span> <span class="id" title="var">w</span>) (<span class="id" title="var">word_op</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">left_unit</span> : ∏ <span class="id" title="var">w</span>, <span class="id" title="var">r</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">word_unit</span> <span class="id" title="var">w</span>) <span class="id" title="var">w</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">right_unit</span> : ∏ <span class="id" title="var">w</span>, <span class="id" title="var">r</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">w</span> <span class="id" title="var">word_unit</span>) <span class="id" title="var">w</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">assoc</span> : ∏ <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>, <span class="id" title="var">r</span> (<span class="id" title="var">word_op</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span>) <span class="id" title="var">w</span>) (<span class="id" title="var">word_op</span> <span class="id" title="var">u</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inverse_compat</span> : ∏ <span class="id" title="var">v</span> <span class="id" title="var">w</span>, <span class="id" title="var">r</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> -&gt; <span class="id" title="var">r</span> (<span class="id" title="var">word_inv</span> <span class="id" title="var">v</span>) (<span class="id" title="var">word_inv</span> <span class="id" title="var">w</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">left_inverse</span> : ∏ <span class="id" title="var">w</span>, <span class="id" title="var">r</span> (<span class="id" title="var">word_op</span> (<span class="id" title="var">word_inv</span> <span class="id" title="var">w</span>) <span class="id" title="var">w</span>) <span class="id" title="var">word_unit</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">right_inverse</span>: ∏ <span class="id" title="var">w</span>, <span class="id" title="var">r</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">w</span> (<span class="id" title="var">word_inv</span> <span class="id" title="var">w</span>)) <span class="id" title="var">word_unit</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">comm</span> : ∏ <span class="id" title="var">v</span> <span class="id" title="var">w</span>, <span class="id" title="var">r</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>) (<span class="id" title="var">word_op</span> <span class="id" title="var">w</span> <span class="id" title="var">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">make_AdequateRelation</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">base</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">adequacy_to_eqrel</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">hrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">AdequateRelation</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> -&gt; <span class="id" title="var">eqrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">abstract</span> ( <span class="id" title="tactic">split</span>; [ <span class="id" title="tactic">split</span>; [ <span class="id" title="tactic">exact</span> (<span class="id" title="var">trans</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>) | <span class="id" title="tactic">exact</span> (<span class="id" title="var">reflex</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>) ] |<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">symm</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>)]). </div>

<br/>
</div>

<div class="doc">
<a name="lab1794"></a><h2 class="section">the smallest adequate relation over R</h2>

         It is defined as the intersection of all the adequate relations.
         Later we'll have to deal with the "resizing" to resolve issues
         withe universes. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">smallestAdequateRelation0</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">hrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (∏ <span class="id" title="var">r</span>: <span class="id" title="var">hrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>), <span class="id" title="var">AdequateRelation</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> -&gt; <span class="id" title="var">r</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">abstract</span> (<span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">r</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">impred_prop</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">adequacy</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">AdequateRelation</span> <span class="id" title="var">R</span> (<span class="id" title="var">smallestAdequateRelation0</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">refine</span> (<span class="id" title="var">make_AdequateRelation</span> <span class="id" title="var">R</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">base</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">ra</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">reflex</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">exact</span> <span class="id" title="var">ra</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? ? <span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">symm</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">exact</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">λ</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">trans</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> (<span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>) (<span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>)). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? ? ? <span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">left_compat</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">exact</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? ? ? <span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">right_compat</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">exact</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">left_unit</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">exact</span> <span class="id" title="var">ra</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">right_unit</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">exact</span> <span class="id" title="var">ra</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">λ</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">assoc</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">λ</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> <span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">inverse_compat</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> (<span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>)). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">λ</span> <span class="id" title="var">w</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">left_inverse</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">w</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">λ</span> <span class="id" title="var">w</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">right_inverse</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">w</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">λ</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">comm</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>). }<br/>
</div>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">smallestAdequateRelation</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">eqrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">adequacy_to_eqrel</span> <span class="id" title="var">R</span> <span class="id" title="var">_</span> (<span class="id" title="var">adequacy</span> <span class="id" title="var">R</span>)). <span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab1795"></a><h3 class="section">the underlying set of the abelian group with generators X and relations R</h3>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universalMarkedPreAbelianGroup0</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">hSet</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">setquotinset</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">op_inv_compatibility</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iscomprelrelfun</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">word_inv</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> <span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">inverse_compat</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> (<span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>)). </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">op2_compatibility</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">QuotientSet.iscomprelrelfun2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">word_op</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">y</span> <span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">right_compat</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">y</span> (<span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>)). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">y'</span> <span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">exact</span> ( <span class="id" title="var">left_compat</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">y'</span> (<span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>)). } </div>

<br/>
</div>

<div class="doc">
<a name="lab1796"></a><h3 class="section">the multiplication on on it</h3>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">univ_inverse</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">universalMarkedPreAbelianGroup0</span> <span class="id" title="var">R</span> -&gt; <span class="id" title="var">universalMarkedPreAbelianGroup0</span> <span class="id" title="var">R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">setquotfun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">word_inv</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">op_inv_compatibility</span>. <span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">univ_binop</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">binop</span> (<span class="id" title="var">universalMarkedPreAbelianGroup0</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">refine</span> (<span class="id" title="var">QuotientSet.setquotfun2</span> <span class="id" title="var">word_op</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">op2_compatibility</span>. <span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">univ_setwithbinop</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">setwithbinop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">setwithbinoppair</span> (<span class="id" title="var">universalMarkedPreAbelianGroup0</span> <span class="id" title="var">R</span>) (<span class="id" title="var">univ_binop</span> <span class="id" title="var">R</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab1797"></a><h3 class="section">the universal pre-Abelian group</h3>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universalMarkedPreAbelianGroup</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">MarkedPreAbelianGroup</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">refine</span> (<span class="id" title="var">make_preAbelianGroup</span> <span class="id" title="var">X</span> (<span class="id" title="var">universalMarkedPreAbelianGroup0</span> <span class="id" title="var">R</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">setquotpr</span> <span class="id" title="var">_</span> <span class="id" title="var">word_unit</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">setquotpr</span> <span class="id" title="var">_</span> (<span class="id" title="var">word_gen</span> <span class="id" title="var">x</span>)). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">univ_inverse</span> <span class="id" title="var">_</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">univ_binop</span> <span class="id" title="var">_</span>). } <span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab1798"></a><h3 class="section">identities for the universal preabelian group</h3>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lift</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">issurjective</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>)).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">issurjsetquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>)). </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">is_left_unit_univ_binop</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">w</span>:<span class="id" title="var">universalMarkedPreAbelianGroup0</span> <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">univ_binop</span> <span class="id" title="var">_</span>) (<span class="id" title="var">setquotpr</span> <span class="id" title="var">_</span> <span class="id" title="var">word_unit</span>) <span class="id" title="var">w</span>) = <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">apply</span> <span class="id" title="var">isaprop_goal</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">ig</span>.  { <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">w'</span> []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">iscompsetquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">left_unit</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">w'</span>)). </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">is_right_unit_univ_binop</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">w</span>:<span class="id" title="var">universalMarkedPreAbelianGroup0</span> <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">univ_binop</span> <span class="id" title="var">_</span>) <span class="id" title="var">w</span> (<span class="id" title="var">setquotpr</span> <span class="id" title="var">_</span> <span class="id" title="var">word_unit</span>)) = <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="var">isaprop_goal</span> <span class="id" title="var">ig</span>. { <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">w'</span> []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">iscompsetquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">right_unit</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">w'</span>)). </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isassoc_univ_binop</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">isassoc</span>(<span class="id" title="var">univ_binop</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">set</span> (<span class="id" title="var">e</span> := <span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">intros</span> <span class="id" title="var">u'</span> <span class="id" title="var">v'</span> <span class="id" title="var">w'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isaprop_goal</span> <span class="id" title="var">ig</span>. { <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">u'</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">u</span> <span class="id" title="var">i</span>]; <span class="id" title="tactic">destruct</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">v'</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">v</span> <span class="id" title="var">j</span>]; <span class="id" title="tactic">destruct</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">w'</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">w</span> []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">iscompsetquotpr</span> <span class="id" title="var">e</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">λ</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">assoc</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>)). </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">is_left_inverse_univ_binop</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;∏ <span class="id" title="var">w</span>:<span class="id" title="var">setquot</span> (<span class="id" title="var">smallestAdequateRelation0</span> <span class="id" title="var">R</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">univ_binop</span> <span class="id" title="var">R</span> (<span class="id" title="var">univ_inverse</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>) <span class="id" title="var">w</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">word_unit</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="var">isaprop_goal</span> <span class="id" title="var">ig</span>. { <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">v</span> []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">iscompsetquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">left_inverse</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">v</span>)). </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">is_right_inverse_univ_binop</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;∏ <span class="id" title="var">w</span>:<span class="id" title="var">setquot</span> (<span class="id" title="var">smallestAdequateRelation0</span> <span class="id" title="var">R</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">univ_binop</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span> (<span class="id" title="var">univ_inverse</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">word_unit</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="var">isaprop_goal</span> <span class="id" title="var">ig</span>. { <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">v</span> []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">iscompsetquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">right_inverse</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">v</span>)). </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iscomm_univ_binop</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">iscomm</span>(<span class="id" title="var">univ_binop</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">set</span> (<span class="id" title="var">e</span> := <span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">intros</span> <span class="id" title="var">v'</span> <span class="id" title="var">w'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isaprop_goal</span> <span class="id" title="var">ig</span>. { <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">v'</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">v</span> <span class="id" title="var">j</span>]; <span class="id" title="tactic">destruct</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">w'</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">w</span> []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">iscompsetquotpr</span> <span class="id" title="var">e</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">λ</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">comm</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>)). </div>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">reassemble_pr</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">v</span>:<span class="id" title="var">word</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">evalword</span> (<span class="id" title="var">universalMarkedPreAbelianGroup</span> <span class="id" title="var">R</span>) <span class="id" title="var">v</span> = <span class="id" title="var">setquotpr</span> <span class="id" title="var">_</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="var">revert</span> <span class="id" title="var">v</span>; <span class="id" title="tactic">intros</span> [|<span class="id" title="var">x</span>|<span class="id" title="var">w</span>|<span class="id" title="var">v</span> <span class="id" title="var">w</span>]. { <span class="id" title="tactic">reflexivity</span>. } { <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">q</span> := ! <span class="id" title="var">reassemble_pr</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">q</span>. <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">p</span> := ! <span class="id" title="var">reassemble_pr</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">R</span> <span class="id" title="var">v</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">q</span> := ! <span class="id" title="var">reassemble_pr</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. } </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">pr_eval_compat</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">w</span>:<span class="id" title="var">word</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">evalword</span> (<span class="id" title="var">wordop</span> <span class="id" title="var">X</span>) <span class="id" title="var">w</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">evalword</span> (<span class="id" title="var">universalMarkedPreAbelianGroup</span> <span class="id" title="var">R</span>) <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">x</span>|<span class="id" title="var">w</span>|<span class="id" title="var">v</span> <span class="id" title="var">w</span>]. { <span class="id" title="tactic">reflexivity</span>. } { <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">ap</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>)) (<span class="id" title="var">reassemble</span> <span class="id" title="var">R</span> (<span class="id" title="var">word_inv</span> <span class="id" title="var">w</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ !<span class="id" title="var">reassemble_pr</span> <span class="id" title="var">R</span> (<span class="id" title="var">word_inv</span> <span class="id" title="var">w</span>)). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">assert</span> (<span class="id" title="var">p</span> := !<span class="id" title="var">reassemble</span> <span class="id" title="var">R</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>)). <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (!<span class="id" title="var">reassemble_pr</span> <span class="id" title="var">R</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>)). } </div>

<br/>
</div>

<div class="doc">
<a name="lab1799"></a><h3 class="section">abelian groups over X modulo R</h3>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">toMarkedPreAbelianGroup</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">M</span>:<span class="id" title="var">abgr</span>) (<span class="id" title="var">el</span>:<span class="id" title="var">X</span>-&gt;<span class="id" title="var">M</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">MarkedPreAbelianGroup</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exact</span> {| <span class="id" title="var">elem</span> := <span class="id" title="var">M</span>; <span class="id" title="var">op0</span> := <span class="id" title="var">unel</span> <span class="id" title="var">_</span>; <span class="id" title="var">op1</span> := <span class="id" title="var">el</span>; <span class="id" title="var">op_inv</span> := <span class="id" title="var">grinv</span> <span class="id" title="var">_</span>; <span class="id" title="var">op2</span> := <span class="id" title="var">op</span> |}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <span class="id" title="var">MarkedAbelianGroup</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">make_MarkedAbelianGroup</span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">m_base</span> :&gt; <span class="id" title="var">abgr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">m_mark</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">m_base</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">m_reln</span> : ∏ <span class="id" title="var">i</span>, <span class="id" title="var">evalword</span> (<span class="id" title="var">toMarkedPreAbelianGroup</span> <span class="id" title="var">R</span> <span class="id" title="var">m_base</span> <span class="id" title="var">m_mark</span>) (<span class="id" title="var">lhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">evalword</span> (<span class="id" title="var">toMarkedPreAbelianGroup</span> <span class="id" title="var">R</span> <span class="id" title="var">m_base</span> <span class="id" title="var">m_mark</span>) (<span class="id" title="var">rhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>)) }.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">make_MarkedAbelianGroup</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} <span class="id" title="var">R</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">m_base</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span> <span class="id" title="var">R</span>} <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">m_mark</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span> <span class="id" title="var">R</span>} <span class="id" title="var">_</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">toMarkedPreAbelianGroup'</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} (<span class="id" title="var">M</span>:<span class="id" title="var">MarkedAbelianGroup</span> <span class="id" title="var">R</span>) : <span class="id" title="var">MarkedPreAbelianGroup</span> <span class="id" title="var">X</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">toMarkedPreAbelianGroup</span> <span class="id" title="var">R</span> (<span class="id" title="var">m_base</span> <span class="id" title="var">M</span>) (<span class="id" title="var">m_mark</span> <span class="id" title="var">M</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">evalwordMM</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} (<span class="id" title="var">M</span>:<span class="id" title="var">MarkedAbelianGroup</span> <span class="id" title="var">R</span>) : <span class="id" title="var">word</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">M</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">evalword</span> (<span class="id" title="var">toMarkedPreAbelianGroup'</span> <span class="id" title="var">M</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">MarkedAbelianGroup_to_hrel</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} (<span class="id" title="var">M</span>:<span class="id" title="var">MarkedAbelianGroup</span> <span class="id" title="var">R</span>) : <span class="id" title="var">hrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">λ</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> , <span class="id" title="var">eqset</span> (<span class="id" title="var">evalwordMM</span> <span class="id" title="var">M</span> <span class="id" title="var">v</span>) (<span class="id" title="var">evalwordMM</span> <span class="id" title="var">M</span> <span class="id" title="var">w</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">abelian_group_adequacy</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">M</span>:<span class="id" title="var">MarkedAbelianGroup</span> <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">AdequateRelation</span> <span class="id" title="var">R</span> (<span class="id" title="var">MarkedAbelianGroup_to_hrel</span> <span class="id" title="var">M</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">refine</span> (<span class="id" title="var">make_AdequateRelation</span> <span class="id" title="var">R</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, <span class="id" title="var">m_reln</span> <span class="id" title="var">R</span> <span class="id" title="var">M</span> <span class="id" title="var">i</span>). } { <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? ?. <span class="id" title="tactic">exact</span> <span class="id" title="var">pathsinv0</span>. } { <span class="id" title="tactic">intros</span> ? ? ?. <span class="id" title="tactic">exact</span> <span class="id" title="var">pathscomp0</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? ? ? <span class="id" title="var">p</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">evalwordMM</span>,<span class="id" title="var">evalword</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? ? ? <span class="id" title="var">p</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">evalwordMM</span>,<span class="id" title="var">evalword</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">lunax</span>. } { <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">runax</span>. } { <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">assocax</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? ? <span class="id" title="var">p</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">evalwordMM</span>,<span class="id" title="var">evalword</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">grlinvax</span>. } { <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">grrinvax</span>. } { <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">commax</span>. }<br/>
</div>
&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <span class="id" title="var">MarkedAbelianGroupMap</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} (<span class="id" title="var">M</span> <span class="id" title="var">N</span>:<span class="id" title="var">MarkedAbelianGroup</span> <span class="id" title="var">R</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">make_MarkedAbelianGroupMap</span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">map_base</span> :&gt; <span class="id" title="var">Hom_abgr</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">map_mark</span> : ∏ <span class="id" title="var">x</span>, <span class="id" title="var">map_base</span> (<span class="id" title="var">m_mark</span> <span class="id" title="var">M</span> <span class="id" title="var">x</span>) = <span class="id" title="var">m_mark</span> <span class="id" title="var">N</span> <span class="id" title="var">x</span> }.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">map_base</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span> <span class="id" title="var">R</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>} <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">map_mark</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span> <span class="id" title="var">R</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>} <span class="id" title="var">m</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MarkedAbelianGroupMapEquality</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} {<span class="id" title="var">M</span> <span class="id" title="var">N</span>:<span class="id" title="var">MarkedAbelianGroup</span> <span class="id" title="var">R</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">MarkedAbelianGroupMap</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>) : <span class="id" title="var">map_base</span> <span class="id" title="var">f</span> = <span class="id" title="var">map_base</span> <span class="id" title="var">g</span> -&gt; <span class="id" title="var">f</span> = <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">f</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">f</span> <span class="id" title="var">ft</span>], <span class="id" title="var">g</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">g</span> <span class="id" title="var">gt</span>]; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">j</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span>(<span class="id" title="var">k</span> : <span class="id" title="var">ft</span> = <span class="id" title="var">gt</span>). { <span class="id" title="tactic">apply</span> <span class="id" title="var">funextsec</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. } <span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. </div>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">MarkedAbelianGroupMap_compat</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">M</span> <span class="id" title="var">N</span>:<span class="id" title="var">MarkedAbelianGroup</span> <span class="id" title="var">R</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">MarkedAbelianGroupMap</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>) (<span class="id" title="var">w</span>:<span class="id" title="var">word</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">map_base</span> <span class="id" title="var">f</span> (<span class="id" title="var">evalwordMM</span> <span class="id" title="var">M</span> <span class="id" title="var">w</span>) = <span class="id" title="var">evalwordMM</span> <span class="id" title="var">N</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">x</span>|<span class="id" title="var">w</span>|<span class="id" title="var">v</span> <span class="id" title="var">w</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">Monoid.unitproperty</span> <span class="id" title="var">f</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">map_mark</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">monoidfuninvtoinv</span> <span class="id" title="var">f</span> (<span class="id" title="var">evalwordMM</span> <span class="id" title="var">M</span> <span class="id" title="var">w</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">ap</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">N</span>) (<span class="id" title="var">MarkedAbelianGroupMap_compat</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> <span class="id" title="var">w</span>)). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">Monoid.multproperty</span> <span class="id" title="var">f</span> (<span class="id" title="var">evalwordMM</span> <span class="id" title="var">M</span> <span class="id" title="var">v</span>) (<span class="id" title="var">evalwordMM</span> <span class="id" title="var">M</span> <span class="id" title="var">w</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">aptwice</span> (<span class="id" title="var">λ</span> <span class="id" title="var">r</span> <span class="id" title="var">s</span>, <span class="id" title="var">r</span> + <span class="id" title="var">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">MarkedAbelianGroupMap_compat</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> <span class="id" title="var">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">MarkedAbelianGroupMap_compat</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> <span class="id" title="var">w</span>)). } </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MarkedAbelianGroupMap_compat2</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">M</span> <span class="id" title="var">N</span>:<span class="id" title="var">MarkedAbelianGroup</span> <span class="id" title="var">R</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">MarkedAbelianGroupMap</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>) (<span class="id" title="var">w</span>:<span class="id" title="var">word</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">map_base</span> <span class="id" title="var">f</span> (<span class="id" title="var">evalwordMM</span> <span class="id" title="var">M</span> <span class="id" title="var">w</span>) = <span class="id" title="var">map_base</span> <span class="id" title="var">g</span> (<span class="id" title="var">evalwordMM</span> <span class="id" title="var">M</span> <span class="id" title="var">w</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">MarkedAbelianGroupMap_compat</span> <span class="id" title="var">f</span> <span class="id" title="var">w</span> @ !<span class="id" title="var">MarkedAbelianGroupMap_compat</span> <span class="id" title="var">g</span> <span class="id" title="var">w</span>). </div>

<br/>
</div>

<div class="doc">
<a name="lab1800"></a><h3 class="section">the universal marked abelian group over X modulo R</h3>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universalMarkedAbelianGroup0</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">abgr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exists</span> (<span class="id" title="var">univ_setwithbinop</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span>,,<span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">isassoc_univ_binop</span> <span class="id" title="var">R</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exists</span> (<span class="id" title="var">setquotpr</span> <span class="id" title="var">_</span> <span class="id" title="var">word_unit</span>). <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">is_left_unit_univ_binop</span> <span class="id" title="var">R</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">is_right_unit_univ_binop</span> <span class="id" title="var">R</span>). } } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span>,,<span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">univ_inverse</span> <span class="id" title="var">R</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">is_left_inverse_univ_binop</span> <span class="id" title="var">R</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">is_right_inverse_univ_binop</span> <span class="id" title="var">R</span>). } } } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">iscomm_univ_binop</span> <span class="id" title="var">R</span>). } }<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universalMarkedAbelianGroup1</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">MarkedPreAbelianGroup</span> <span class="id" title="var">X</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">toMarkedPreAbelianGroup</span> <span class="id" title="var">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">universalMarkedAbelianGroup0</span> <span class="id" title="var">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, <span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">word_gen</span> <span class="id" title="var">x</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">universalMarkedAbelianGroup2</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">w</span>:<span class="id" title="var">word</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">w</span> = <span class="id" title="var">evalword</span> (<span class="id" title="var">universalMarkedAbelianGroup1</span> <span class="id" title="var">R</span>) <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (! (<span class="id" title="var">ap</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>)) (<span class="id" title="var">reassemble</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">pr_eval_compat</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>). </div>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universalMarkedAbelianGroup3</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">i</span>:<span class="id" title="var">I</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">evalword</span> (<span class="id" title="var">universalMarkedAbelianGroup1</span> <span class="id" title="var">R</span>) (<span class="id" title="var">lhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">evalword</span> (<span class="id" title="var">universalMarkedAbelianGroup1</span> <span class="id" title="var">R</span>) (<span class="id" title="var">rhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>)).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (! <span class="id" title="var">universalMarkedAbelianGroup2</span> <span class="id" title="var">R</span> (<span class="id" title="var">lhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">iscompsetquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">λ</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">base</span> <span class="id" title="var">ra</span> <span class="id" title="var">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">universalMarkedAbelianGroup2</span> <span class="id" title="var">R</span> (<span class="id" title="var">rhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>))). </div>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universalMarkedAbelianGroup</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">MarkedAbelianGroup</span> <span class="id" title="var">R</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">make_MarkedAbelianGroup</span> <span class="id" title="var">R</span> (<span class="id" title="var">universalMarkedAbelianGroup0</span> <span class="id" title="var">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">word_gen</span> <span class="id" title="var">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">universalMarkedAbelianGroup3</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">agreement_on_gens0</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} {<span class="id" title="var">M</span>:<span class="id" title="var">abgr</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">Hom_abgr</span> (<span class="id" title="var">universalMarkedAbelianGroup</span> <span class="id" title="var">R</span>) <span class="id" title="var">M</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span>:∏ <span class="id" title="var">i</span>, <span class="id" title="var">f</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">word_gen</span> <span class="id" title="var">i</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">g</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">word_gen</span> <span class="id" title="var">i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">w</span>:<span class="id" title="var">word</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr1</span> <span class="id" title="var">f</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">w</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr1</span> <span class="id" title="var">g</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">w</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">x</span>|<span class="id" title="var">w</span>|<span class="id" title="var">v</span> <span class="id" title="var">w</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">intermediate_path</span> (<span class="id" title="var">unel</span> <span class="id" title="var">M</span>). <span class="id" title="tactic">exact</span> (<span class="id" title="var">unitproperty</span> <span class="id" title="var">f</span>). <span class="id" title="tactic">exact</span> (!<span class="id" title="var">unitproperty</span> <span class="id" title="var">g</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">p</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">monoidfuninvtoinv</span> <span class="id" title="var">f</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">w</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">_</span> @ ! <span class="id" title="var">monoidfuninvtoinv</span> <span class="id" title="var">g</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">w</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">ap</span> (<span class="id" title="var">grinv</span> <span class="id" title="var">M</span>)). <span class="id" title="tactic">apply</span> <span class="id" title="var">agreement_on_gens0</span>. <span class="id" title="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Monoid.multproperty</span> <span class="id" title="var">f</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">w</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">_</span> @ !<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Monoid.multproperty</span> <span class="id" title="var">g</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">w</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">aptwice</span> (<span class="id" title="var">λ</span> <span class="id" title="var">r</span> <span class="id" title="var">s</span>, <span class="id" title="var">r</span> + <span class="id" title="var">s</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">agreement_on_gens0</span>. <span class="id" title="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">agreement_on_gens0</span>. <span class="id" title="tactic">assumption</span>. } } </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">agreement_on_gens</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} {<span class="id" title="var">M</span>:<span class="id" title="var">abgr</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">Hom_abgr</span> (<span class="id" title="var">universalMarkedAbelianGroup</span> <span class="id" title="var">R</span>) <span class="id" title="var">M</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(∏ <span class="id" title="var">i</span>, <span class="id" title="var">f</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">word_gen</span> <span class="id" title="var">i</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">g</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">word_gen</span> <span class="id" title="var">i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id" title="var">f</span> = <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Monoid.funEquality</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">funextsec</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">t</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">surjectionisepitosets</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">issurjsetquotpr</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. } { <span class="id" title="tactic">apply</span> <span class="id" title="var">agreement_on_gens0</span>. <span class="id" title="tactic">assumption</span>. } <span class="id" title="keyword">Qed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universality0</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} (<span class="id" title="var">M</span>:<span class="id" title="var">MarkedAbelianGroup</span> <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">universalMarkedAbelianGroup0</span> <span class="id" title="var">R</span> -&gt; <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">setquotuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">evalwordMM</span> <span class="id" title="var">M</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">λ</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">r</span>, <span class="id" title="var">r</span> (<span class="id" title="var">MarkedAbelianGroup_to_hrel</span> <span class="id" title="var">M</span>) (<span class="id" title="var">abelian_group_adequacy</span> <span class="id" title="var">R</span> <span class="id" title="var">M</span>)).<br/>
</div>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universality1</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">M</span>:<span class="id" title="var">MarkedAbelianGroup</span> <span class="id" title="var">R</span>) (<span class="id" title="var">v</span> <span class="id" title="var">w</span>:<span class="id" title="var">universalMarkedAbelianGroup0</span> <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">universality0</span> <span class="id" title="var">M</span> (<span class="id" title="var">v</span> + <span class="id" title="var">w</span>) = <span class="id" title="var">universality0</span> <span class="id" title="var">M</span> <span class="id" title="var">v</span> + <span class="id" title="var">universality0</span> <span class="id" title="var">M</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="var">isaprop_goal</span> <span class="id" title="var">ig</span>. { <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">v</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">v'</span> <span class="id" title="var">j</span>]; <span class="id" title="tactic">destruct</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">w'</span> []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. </div>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universality2</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} (<span class="id" title="var">M</span>:<span class="id" title="var">MarkedAbelianGroup</span> <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">monoidfun</span> (<span class="id" title="var">universalMarkedAbelianGroup</span> <span class="id" title="var">R</span>) <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">universality0</span> <span class="id" title="var">M</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>. { <span class="id" title="tactic">intros</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">universality1</span>. } { <span class="id" title="tactic">reflexivity</span>. } </div>

<br/>
</div>

<div class="doc">
<a name="lab1801"></a><h1 class="section">universality of the universal marked abelian group</h1>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local</span> <span class="id" title="var">Arguments</span> <span class="id" title="var">pr1monoidfun</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span>} <span class="id" title="var">f</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">iscontrMarkedAbelianGroupMap</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} (<span class="id" title="var">M</span>:<span class="id" title="var">MarkedAbelianGroup</span> <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iscontr</span> (<span class="id" title="var">MarkedAbelianGroupMap</span> (<span class="id" title="var">universalMarkedAbelianGroup</span> <span class="id" title="var">R</span>) <span class="id" title="var">M</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">g</span> := <span class="id" title="var">make_MarkedAbelianGroupMap</span> <span class="id" title="var">X</span> <span class="id" title="var">I</span> <span class="id" title="var">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">universalMarkedAbelianGroup</span> <span class="id" title="var">R</span>) <span class="id" title="var">M</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">universality2</span> <span class="id" title="var">M</span>) (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">idpath</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">g</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">f</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">MarkedAbelianGroupMapEquality</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Monoid.funEquality</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">funextsec</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isaprop_goal</span> <span class="id" title="var">ig</span>. { <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">v</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">w</span> []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ((<span class="id" title="var">ap</span> <span class="id" title="var">f</span> (<span class="id" title="var">universalMarkedAbelianGroup2</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">MarkedAbelianGroupMap_compat2</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">w</span> @ !(<span class="id" title="var">ap</span> <span class="id" title="var">g</span> (<span class="id" title="var">universalMarkedAbelianGroup2</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>))).<br/>
</div>
<span class="id" title="keyword">End</span> <span class="id" title="var">Presentation</span>.<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">Free</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Import</span> <span class="id" title="var">Presentation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">make</span> (<span class="id" title="var">X</span>:<span class="id" title="keyword">Type</span>) := @<span class="id" title="var">universalMarkedAbelianGroup</span> <span class="id" title="var">X</span> <span class="id" title="var">empty</span> <span class="id" title="var">fromempty</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Free</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ZZ</span> := <span class="id" title="var">Free.make</span> <span class="id" title="var">unit</span>.<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">Product</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">make</span> {<span class="id" title="var">I</span>} (<span class="id" title="var">G</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">abgr</span>) : <span class="id" title="var">abgr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">Group.Product.make</span> <span class="id" title="var">G</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">Group.Product.make</span> <span class="id" title="var">G</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">funextsec</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">commax</span>. <span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Proj</span> {<span class="id" title="var">I</span>} (<span class="id" title="var">G</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">abgr</span>) (<span class="id" title="var">i</span>:<span class="id" title="var">I</span>) : <span class="id" title="var">Hom_abgr</span> (<span class="id" title="var">make</span> <span class="id" title="var">G</span>) (<span class="id" title="var">G</span> <span class="id" title="var">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">I</span> <span class="id" title="var">G</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> @<span class="id" title="var">Group.Product.Proj</span>. <span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Map</span> {<span class="id" title="var">I</span>} (<span class="id" title="var">G</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">abgr</span>) (<span class="id" title="var">T</span>:<span class="id" title="var">abgr</span>) (<span class="id" title="var">g</span>: ∏ <span class="id" title="var">i</span>, <span class="id" title="var">Hom_abgr</span> <span class="id" title="var">T</span> (<span class="id" title="var">G</span> <span class="id" title="var">i</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hom_abgr</span> <span class="id" title="var">T</span> (<span class="id" title="var">make</span> <span class="id" title="var">G</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">I</span> <span class="id" title="var">G</span> <span class="id" title="var">T</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> @<span class="id" title="var">Group.Product.Fun</span>. <span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Eqn</span> {<span class="id" title="var">I</span>} (<span class="id" title="var">G</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">abgr</span>) (<span class="id" title="var">T</span>:<span class="id" title="var">abgr</span>) (<span class="id" title="var">g</span>: ∏ <span class="id" title="var">i</span>, <span class="id" title="var">Hom_abgr</span> <span class="id" title="var">T</span> (<span class="id" title="var">G</span> <span class="id" title="var">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: ∏ <span class="id" title="var">i</span>, <span class="id" title="var">Proj</span> <span class="id" title="var">G</span> <span class="id" title="var">i</span> ∘ <span class="id" title="var">Map</span> <span class="id" title="var">G</span> <span class="id" title="var">T</span> <span class="id" title="var">g</span> = <span class="id" title="var">g</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">I</span> <span class="id" title="var">G</span> <span class="id" title="var">T</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> @<span class="id" title="var">Group.Product.Eqn</span>. <span class="id" title="keyword">Qed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">UniqueMap</span> {<span class="id" title="var">I</span>} (<span class="id" title="var">G</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">abgr</span>) (<span class="id" title="var">T</span>:<span class="id" title="var">abgr</span>) (<span class="id" title="var">h</span> <span class="id" title="var">h'</span> : <span class="id" title="var">Hom_abgr</span> <span class="id" title="var">T</span> (<span class="id" title="var">make</span> <span class="id" title="var">G</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(∏ <span class="id" title="var">i</span>, <span class="id" title="var">Proj</span> <span class="id" title="var">G</span> <span class="id" title="var">i</span> ∘ <span class="id" title="var">h</span> = <span class="id" title="var">Proj</span> <span class="id" title="var">G</span> <span class="id" title="var">i</span> ∘ <span class="id" title="var">h'</span>) -&gt; <span class="id" title="var">h</span> = <span class="id" title="var">h'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Monoid.funEquality</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">funextsec</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">funextsec</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">eqtohomot</span> (<span class="id" title="var">ap</span> <span class="id" title="var">pr1</span> (<span class="id" title="var">e</span> <span class="id" title="var">i</span>)) <span class="id" title="var">t</span>). <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Product</span>.<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">Sum</span>. &nbsp;&nbsp;<span class="id" title="keyword">Import</span> <span class="id" title="var">Presentation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">X</span> {<span class="id" title="var">I</span>} (<span class="id" title="var">G</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">abgr</span>) := <span class="id" title="var">total2</span> <span class="id" title="var">G</span>. &nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <span class="id" title="var">J</span> {<span class="id" title="var">I</span>} (<span class="id" title="var">G</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">abgr</span>) : <span class="id" title="keyword">Type</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">J_zero</span> : <span class="id" title="var">I</span> -&gt; <span class="id" title="var">J</span> <span class="id" title="var">G</span>                 <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">J_sum</span> : (∑ <span class="id" title="var">i</span>, <span class="id" title="var">G</span> <span class="id" title="var">i</span> × <span class="id" title="var">G</span> <span class="id" title="var">i</span>) -&gt; <span class="id" title="var">J</span> <span class="id" title="var">G</span>. &nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">R</span> {<span class="id" title="var">I</span>} (<span class="id" title="var">G</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">abgr</span>) : <span class="id" title="var">J</span> <span class="id" title="var">G</span> -&gt; <span class="id" title="var">reln</span> (<span class="id" title="var">X</span> <span class="id" title="var">G</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">i</span>|[<span class="id" title="var">i</span> [<span class="id" title="var">g</span> <span class="id" title="var">h</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">make_reln</span> (<span class="id" title="var">word_gen</span> (<span class="id" title="var">i</span>,,0)) (<span class="id" title="var">word_unit</span>)). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">make_reln</span> (<span class="id" title="var">word_gen</span> (<span class="id" title="var">i</span>,,<span class="id" title="var">g</span>+<span class="id" title="var">h</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">word_op</span> (<span class="id" title="var">word_gen</span> (<span class="id" title="var">i</span>,,<span class="id" title="var">g</span>)) (<span class="id" title="var">word_gen</span> (<span class="id" title="var">i</span>,,<span class="id" title="var">h</span>)))). } <span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">make</span> {<span class="id" title="var">I</span>} (<span class="id" title="var">G</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">abgr</span>) : <span class="id" title="var">abgr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">Presentation.universalMarkedAbelianGroup</span> (<span class="id" title="var">R</span> <span class="id" title="var">G</span>)). <span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Incl</span> {<span class="id" title="var">I</span>} (<span class="id" title="var">G</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">abgr</span>) (<span class="id" title="var">i</span>:<span class="id" title="var">I</span>) : <span class="id" title="var">Hom_abgr</span> (<span class="id" title="var">G</span> <span class="id" title="var">i</span>) (<span class="id" title="var">make</span> <span class="id" title="var">G</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span>,,<span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">g</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">setquotpr</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">word_gen</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">i</span>,,<span class="id" title="var">g</span>). } { <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">iscompsetquotpr</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">base</span> (<span class="id" title="var">adequacy</span> <span class="id" title="var">_</span>) (<span class="id" title="var">J_sum</span> <span class="id" title="var">_</span> (<span class="id" title="var">i</span>,,(<span class="id" title="var">g</span>,,<span class="id" title="var">h</span>)))). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">iscompsetquotpr</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">base</span> (<span class="id" title="var">adequacy</span> <span class="id" title="var">_</span>) (<span class="id" title="var">J_zero</span> <span class="id" title="var">_</span> <span class="id" title="var">i</span>)). } } <span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Map0</span> {<span class="id" title="var">I</span>} {<span class="id" title="var">G</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">abgr</span>} {<span class="id" title="var">T</span>:<span class="id" title="var">abgr</span>} (<span class="id" title="var">f</span>: ∏ <span class="id" title="var">i</span>, <span class="id" title="var">Hom_abgr</span> (<span class="id" title="var">G</span> <span class="id" title="var">i</span>) <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">MarkedAbelianGroup</span> (<span class="id" title="var">R</span> <span class="id" title="var">G</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">make_MarkedAbelianGroup</span> (<span class="id" title="var">R</span> <span class="id" title="var">G</span>) <span class="id" title="var">T</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> [<span class="id" title="var">i</span> <span class="id" title="var">g</span>]. <span class="id" title="tactic">exact</span> (<span class="id" title="var">f</span> <span class="id" title="var">i</span> <span class="id" title="var">g</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> [<span class="id" title="var">i</span>|[<span class="id" title="var">i</span> [<span class="id" title="var">g</span> <span class="id" title="var">h</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">unitproperty</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">addproperty</span>. } } <span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Map</span> {<span class="id" title="var">I</span>} (<span class="id" title="var">G</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">abgr</span>) (<span class="id" title="var">T</span>:<span class="id" title="var">abgr</span>) (<span class="id" title="var">f</span>: ∏ <span class="id" title="var">i</span>, <span class="id" title="var">Hom_abgr</span> (<span class="id" title="var">G</span> <span class="id" title="var">i</span>) <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Hom_abgr</span> (<span class="id" title="var">make</span> <span class="id" title="var">G</span>) <span class="id" title="var">T</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">thePoint</span> (<span class="id" title="var">iscontrMarkedAbelianGroupMap</span> (<span class="id" title="var">Map0</span> <span class="id" title="var">f</span>))). <span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Eqn</span> {<span class="id" title="var">I</span>} (<span class="id" title="var">G</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">abgr</span>) (<span class="id" title="var">T</span>:<span class="id" title="var">abgr</span>) (<span class="id" title="var">f</span>: ∏ <span class="id" title="var">i</span>, <span class="id" title="var">Hom_abgr</span> (<span class="id" title="var">G</span> <span class="id" title="var">i</span>) <span class="id" title="var">T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: ∏ <span class="id" title="var">i</span>, <span class="id" title="var">Map</span> <span class="id" title="var">G</span> <span class="id" title="var">T</span> <span class="id" title="var">f</span> ∘ <span class="id" title="var">Incl</span> <span class="id" title="var">G</span> <span class="id" title="var">i</span> = <span class="id" title="var">f</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Monoid.funEquality</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">UniqueMap</span> {<span class="id" title="var">I</span>} (<span class="id" title="var">G</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">abgr</span>) (<span class="id" title="var">T</span>:<span class="id" title="var">abgr</span>) (<span class="id" title="var">h</span> <span class="id" title="var">h'</span> : <span class="id" title="var">Hom_abgr</span> (<span class="id" title="var">make</span> <span class="id" title="var">G</span>) <span class="id" title="var">T</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(∏ <span class="id" title="var">i</span>, <span class="id" title="var">h</span> ∘ <span class="id" title="var">Incl</span> <span class="id" title="var">G</span> <span class="id" title="var">i</span> = <span class="id" title="var">h'</span> ∘ <span class="id" title="var">Incl</span> <span class="id" title="var">G</span> <span class="id" title="var">i</span>) -&gt; <span class="id" title="var">h</span> = <span class="id" title="var">h'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">agreement_on_gens</span> <span class="id" title="var">h</span> <span class="id" title="var">h'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> [<span class="id" title="var">i</span> <span class="id" title="var">g</span>]. <span class="id" title="tactic">exact</span> (<span class="id" title="var">ap</span> (<span class="id" title="var">evalat</span> <span class="id" title="var">g</span>) (<span class="id" title="var">ap</span> <span class="id" title="var">pr1</span> (<span class="id" title="var">e</span> <span class="id" title="var">i</span>))). }<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Sum</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">power</span> (<span class="id" title="var">I</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">X</span>:<span class="id" title="var">abgr</span>) : <span class="id" title="var">abgr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">Product.make</span> (<span class="id" title="var">λ</span> <span class="id" title="var">_</span>:<span class="id" title="var">I</span>, <span class="id" title="var">Z</span>)). <span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab1802"></a><h2 class="section">the category of abelian groups</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">Category</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Ob</span> := <span class="id" title="var">abgr</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Identity</span> <span class="id" title="keyword">Coercion</span> <span class="id" title="var">Ob_to_abgr</span> : <span class="id" title="var">Ob</span> &gt;-&gt; <span class="id" title="var">abgr</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Mor</span> : <span class="id" title="var">Ob</span> -&gt; <span class="id" title="var">Ob</span> -&gt; <span class="id" title="var">hSet</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">G</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">monoidfun</span> <span class="id" title="var">G</span> <span class="id" title="var">H</span>). <span class="id" title="tactic">exact</span> (<span class="id" title="var">isasetmonoidfun</span> <span class="id" title="var">G</span> <span class="id" title="var">H</span>). <span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">ObMor</span> : <span class="id" title="var">precategory_ob_mor</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">exists</span> <span class="id" title="var">Ob</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">monoidfun</span>. </div>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Data</span> : <span class="id" title="var">precategory_data</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">ObMor</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">G</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">idfun</span> (<span class="id" title="var">G</span> : <span class="id" title="var">abgr</span>)). <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">monoidfuncomp</span>. <span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">MorEquality</span> <span class="id" title="var">G</span> <span class="id" title="var">H</span> (<span class="id" title="var">p</span> <span class="id" title="var">q</span> : <span class="id" title="var">Mor</span> <span class="id" title="var">G</span> <span class="id" title="var">H</span>) : <span class="id" title="var">pr1</span> <span class="id" title="var">p</span> = <span class="id" title="var">pr1</span> <span class="id" title="var">q</span> -&gt; <span class="id" title="var">p</span> = <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Monoid.funEquality</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Precat</span> : <span class="id" title="var">category</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span>,,<span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exists</span> <span class="id" title="var">Data</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">MorEquality</span>. <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">MorEquality</span>. <span class="id" title="tactic">reflexivity</span>. } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">MorEquality</span>. <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">MorEquality</span>. <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">F</span> <span class="id" title="var">G</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">setproperty</span> (<span class="id" title="var">Mor</span> <span class="id" title="var">F</span> <span class="id" title="var">G</span>)). }<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab1803"></a><h3 class="section">products in the category of abelian groups</h3>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Module</span> <span class="id" title="var">Product</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">make</span> {<span class="id" title="var">I</span>} (<span class="id" title="var">X</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">ob</span> <span class="id" title="var">Precat</span>) : <span class="id" title="var">Product</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">unshelve</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">makeRepresentation</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">Product.make</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">Product.Proj</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">T</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">Product.Map</span> <span class="id" title="var">X</span> <span class="id" title="var">T</span> <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">funextsec</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">i</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">Product.Eqn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">f</span> <span class="id" title="var">f'</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Product.UniqueMap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">eqtohomot</span> <span class="id" title="var">e</span> <span class="id" title="var">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">Product</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab1804"></a><h3 class="section">sums (coproducts) in the category of abelian groups</h3>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Module</span> <span class="id" title="var">Sum</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">make</span> {<span class="id" title="var">I</span>} (<span class="id" title="var">X</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">ob</span> <span class="id" title="var">Precat</span>) : <span class="id" title="var">Sum</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">unshelve</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">makeRepresentation</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">Sum.make</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">Sum.Incl</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">T</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">Sum.Map</span> <span class="id" title="var">X</span> <span class="id" title="var">T</span> <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">funextsec</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">i</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">Sum.Eqn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">f</span> <span class="id" title="var">f'</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Sum.UniqueMap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">eqtohomot</span> <span class="id" title="var">e</span> <span class="id" title="var">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">Sum</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab1805"></a><h3 class="section">finite direct sums in the category of abelian groups</h3>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Module</span> <span class="id" title="var">DirectSum</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">DirectSum</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Category</span>.<br/>

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>