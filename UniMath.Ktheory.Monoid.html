<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
	<script src="https://code./jquery.com/jquery-1.11.0.min.js" type="text/javascript"></script>
	<script src="./proofs-toggle.js" type="text/javascript"></script>
	<style>
		div.proofcomment {
			font-style: italic;
		}
	</style>
	<title>Documentation</title>
</head>
<body>
<div id="page">
<div id="main">
<h1 class="libtitle">Library UniMath.Ktheory.Monoid</h1>

<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.MoreFoundations.DecidablePropositions</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.Combinatorics.StandardFiniteSets</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.Algebra.Monoids</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.CategoryTheory.total2_paths</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.Ktheory.Utilities</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="var">UniMath.Ktheory.Magma</span> <span class="id" title="var">UniMath.Ktheory.QuotientSet</span>.<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Notation</span> <span class="id" title="var">Hom</span> := <span class="id" title="var">monoidfun</span> (<span class="id" title="var">only</span> <span class="id" title="var">parsing</span>).<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Notation</span> "x * y" := ( <span class="id" title="var">op</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> ).<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Notation</span> "g ∘ f" := (<span class="id" title="var">monoidfuncomp</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>) (<span class="id" title="var">only</span> <span class="id" title="var">parsing</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">funEquality</span> <span class="id" title="var">G</span> <span class="id" title="var">H</span> (<span class="id" title="var">p</span> <span class="id" title="var">q</span> : <span class="id" title="var">Hom</span> <span class="id" title="var">G</span> <span class="id" title="var">H</span>) : <span class="id" title="var">pr1</span> <span class="id" title="var">p</span> = <span class="id" title="var">pr1</span> <span class="id" title="var">q</span> -&gt; <span class="id" title="var">p</span> = <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>; <span class="id" title="tactic">intros</span> [<span class="id" title="var">p</span> <span class="id" title="var">i</span>] [<span class="id" title="var">q</span> <span class="id" title="var">j</span>] <span class="id" title="var">v</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">v</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">isapropismonoidfun</span> <span class="id" title="var">p</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>)). <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unitproperty</span> {<span class="id" title="var">G</span> <span class="id" title="var">H</span>} (<span class="id" title="var">p</span>:<span class="id" title="var">Hom</span> <span class="id" title="var">G</span> <span class="id" title="var">H</span>) : <span class="id" title="var">p</span> (<span class="id" title="var">unel</span> <span class="id" title="var">G</span>) = <span class="id" title="var">unel</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">p</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">multproperty</span> {<span class="id" title="var">G</span> <span class="id" title="var">H</span>} (<span class="id" title="var">p</span>:<span class="id" title="var">Hom</span> <span class="id" title="var">G</span> <span class="id" title="var">H</span>) (<span class="id" title="var">g</span> <span class="id" title="var">g'</span>:<span class="id" title="var">G</span>) : <span class="id" title="var">p</span>(<span class="id" title="var">g</span> * <span class="id" title="var">g'</span>) = <span class="id" title="var">p</span> <span class="id" title="var">g</span> * <span class="id" title="var">p</span> <span class="id" title="var">g'</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">pr1</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">p</span>) <span class="id" title="var">g</span> <span class="id" title="var">g'</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">zero</span> : <span class="id" title="var">monoid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">Magma.zero</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">tt</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">intros</span> []. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">intros</span> []. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">zero_map</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span>:<span class="id" title="var">monoid</span>) : <span class="id" title="var">Hom</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">λ</span> <span class="id" title="var">_</span>, <span class="id" title="var">unel</span> <span class="id" title="var">B</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">split</span>. - <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">lunax</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>. } <span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">zero_is_initial</span> (<span class="id" title="var">A</span>:<span class="id" title="var">monoid</span>) : <span class="id" title="var">iscontr</span> (<span class="id" title="var">Hom</span> <span class="id" title="var">zero</span> <span class="id" title="var">A</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">zero_map</span> <span class="id" title="var">zero</span> <span class="id" title="var">A</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">f</span> <span class="id" title="var">e</span>]. <span class="id" title="tactic">apply</span> <span class="id" title="var">funEquality</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">funextsec</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">pr2</span> <span class="id" title="var">e</span>). </div>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">zero_is_final</span> (<span class="id" title="var">A</span>:<span class="id" title="var">monoid</span>) : <span class="id" title="var">iscontr</span> (<span class="id" title="var">Hom</span> <span class="id" title="var">A</span> <span class="id" title="var">zero</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">zero_map</span> <span class="id" title="var">A</span> <span class="id" title="var">zero</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">f</span> <span class="id" title="var">e</span>]. <span class="id" title="tactic">apply</span> <span class="id" title="var">funEquality</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">funextsec</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">induction</span> (<span class="id" title="var">f</span> <span class="id" title="var">a</span>). <span class="id" title="tactic">reflexivity</span>. </div>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="var">UniMath.Combinatorics.FiniteSequences</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">Presentation'</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.Combinatorics.FiniteSequences</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">word</span> <span class="id" title="var">X</span> := <span class="id" title="var">Sequence</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">word_length</span> {<span class="id" title="var">X</span>} : <span class="id" title="var">word</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">nat</span> := <span class="id" title="var">length</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">word_unit</span> {<span class="id" title="var">X</span>} : <span class="id" title="var">word</span> <span class="id" title="var">X</span> := <span class="id" title="var">nil</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">word_gen</span> {<span class="id" title="var">X</span>} (<span class="id" title="var">x</span>:<span class="id" title="var">X</span>) : <span class="id" title="var">word</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exact</span> (1,,<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, <span class="id" title="var">x</span>). </div>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">word_op</span> {<span class="id" title="var">X</span>}: <span class="id" title="var">word</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">word</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">word</span> <span class="id" title="var">X</span> := <span class="id" title="var">concatenate</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">word_left_unit</span> {<span class="id" title="var">X</span>} (<span class="id" title="var">w</span>:<span class="id" title="var">word</span> <span class="id" title="var">X</span>) : <span class="id" title="var">word_op</span> <span class="id" title="var">word_unit</span> <span class="id" title="var">w</span> = <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Abort</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">word_right_unit</span> {<span class="id" title="var">X</span>} (<span class="id" title="var">w</span>:<span class="id" title="var">word</span> <span class="id" title="var">X</span>) : <span class="id" title="var">word_op</span> <span class="id" title="var">w</span> <span class="id" title="var">word_unit</span> = <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Abort</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">word_assoc</span> {<span class="id" title="var">X</span>} (<span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>:<span class="id" title="var">word</span> <span class="id" title="var">X</span>) : (<span class="id" title="var">word_op</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span>) <span class="id" title="var">w</span>) = (<span class="id" title="var">word_op</span> <span class="id" title="var">u</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Abort</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">reln</span> <span class="id" title="var">X</span> := <span class="id" title="var">word</span> <span class="id" title="var">X</span> × <span class="id" title="var">word</span> <span class="id" title="var">X</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">lhs</span> {<span class="id" title="var">X</span>} : <span class="id" title="var">reln</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">word</span> <span class="id" title="var">X</span> := <span class="id" title="var">pr1</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">rhs</span> {<span class="id" title="var">X</span>} : <span class="id" title="var">reln</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">word</span> <span class="id" title="var">X</span> := <span class="id" title="var">pr2</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">make_reln</span> {<span class="id" title="var">X</span>} : <span class="id" title="var">word</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">word</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">reln</span> <span class="id" title="var">X</span> := <span class="id" title="var">λ</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>, <span class="id" title="var">v</span>,,<span class="id" title="var">w</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">isAdequateRelation</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">eqrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (∏ <span class="id" title="var">i</span>, <span class="id" title="var">r</span> (<span class="id" title="var">lhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>)) (<span class="id" title="var">rhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>))) ×<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (∏ <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>, <span class="id" title="var">r</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> -&gt; <span class="id" title="var">r</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span>) (<span class="id" title="var">word_op</span> <span class="id" title="var">u</span> <span class="id" title="var">w</span>)) ×<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (∏ <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>, <span class="id" title="var">r</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> -&gt; <span class="id" title="var">r</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">u</span> <span class="id" title="var">w</span>) (<span class="id" title="var">word_op</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">base</span>         {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} {<span class="id" title="var">r</span>} (<span class="id" title="var">ad</span> : <span class="id" title="var">isAdequateRelation</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span>) := <span class="id" title="var">pr1</span> <span class="id" title="var">ad</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">left_compat</span>  {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} {<span class="id" title="var">r</span>} (<span class="id" title="var">ad</span> : <span class="id" title="var">isAdequateRelation</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span>) := <span class="id" title="var">pr1</span>(<span class="id" title="var">pr2</span> <span class="id" title="var">ad</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">right_compat</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} {<span class="id" title="var">r</span>} (<span class="id" title="var">ad</span> : <span class="id" title="var">isAdequateRelation</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span>) := <span class="id" title="var">pr2</span>(<span class="id" title="var">pr2</span> <span class="id" title="var">ad</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">AdequateRelation</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) := ∑ <span class="id" title="var">r</span>, <span class="id" title="var">isAdequateRelation</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">toeqrel</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">AdequateRelation</span> <span class="id" title="var">R</span> -&gt; <span class="id" title="var">eqrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>) := <span class="id" title="var">pr1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Coercion</span> <span class="id" title="var">toeqrel</span> : <span class="id" title="var">AdequateRelation</span> &gt;-&gt; <span class="id" title="var">eqrel</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">smallestAdequateRelation</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">AdequateRelation</span> <span class="id" title="var">R</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span>,,<span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span>,,<span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (∏ <span class="id" title="var">r</span>, <span class="id" title="var">isAdequateRelation</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> -&gt; <span class="id" title="var">r</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">r</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">impred_prop</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span>,,<span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span>,,<span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> <span class="id" title="var">uv</span> <span class="id" title="var">vw</span> <span class="id" title="var">r</span> <span class="id" title="var">ad</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">uv</span>, <span class="id" title="var">vw</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">eqreltrans</span> <span class="id" title="var">r</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">uv</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">ad</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">vw</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">ad</span>. }}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">w</span> <span class="id" title="var">r</span> <span class="id" title="var">ad</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">eqrelrefl</span>. } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> <span class="id" title="var">vw</span> <span class="id" title="var">r</span> <span class="id" title="var">ad</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">eqrelsymm</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">vw</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">ad</span>. }}}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span>,,<span class="id" title="var">_</span>); <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">r</span> <span class="id" title="var">ad</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">base</span> <span class="id" title="var">ad</span> <span class="id" title="var">i</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span>,,<span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> <span class="id" title="var">min</span> <span class="id" title="var">r</span> <span class="id" title="var">ad</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">left_compat</span>  <span class="id" title="var">ad</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">min</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">ad</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> <span class="id" title="var">min</span> <span class="id" title="var">r</span> <span class="id" title="var">ad</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">right_compat</span> <span class="id" title="var">ad</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">min</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">ad</span>. }}}<br/>
</div>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">univ_set</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">hSet</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">setquotinset</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">univ_unit</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) := <span class="id" title="var">setquotpr</span> <span class="id" title="var">_</span> <span class="id" title="var">word_unit</span> : <span class="id" title="var">univ_set</span> <span class="id" title="var">R</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">univ_binop</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">binop</span> (<span class="id" title="var">univ_set</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">setquotfun2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">word_op</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">r</span> <span class="id" title="var">ad</span>]; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">v</span> <span class="id" title="var">v'</span> <span class="id" title="var">w</span> <span class="id" title="var">w'</span> <span class="id" title="var">vv'</span> <span class="id" title="var">ww'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">eqreltrans</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">v</span> <span class="id" title="var">w'</span>) <span class="id" title="var">_</span> (<span class="id" title="var">left_compat</span> <span class="id" title="var">ad</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ww'</span>) (<span class="id" title="var">right_compat</span> <span class="id" title="var">ad</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">vv'</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">univ_setwithbinop</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) := <span class="id" title="var">setwithbinoppair</span> (<span class="id" title="var">univ_set</span> <span class="id" title="var">R</span>) (<span class="id" title="var">univ_binop</span> <span class="id" title="var">R</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eqreleq</span> {<span class="id" title="var">X</span>} (<span class="id" title="var">r</span> : <span class="id" title="var">eqrel</span> <span class="id" title="var">X</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">X</span>) : <span class="id" title="var">x</span>=<span class="id" title="var">y</span> -&gt; <span class="id" title="var">r</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">eqrelrefl</span>.<br/>
</div>

<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">univ_binop_islunit</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">islunit</span> (<span class="id" title="var">univ_binop</span> <span class="id" title="var">R</span>) (<span class="id" title="var">univ_unit</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Abort</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">univ_binop_isrunit</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">isrunit</span> (<span class="id" title="var">univ_binop</span> <span class="id" title="var">R</span>) (<span class="id" title="var">univ_unit</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Abort</span>.<br/>

<br/>

<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Presentation'</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab1760"></a><h1 class="section">monoids by generators and relations</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">Presentation</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab1761"></a><h2 class="section">premonoids over X</h2>

         A pre-monoid over X modulo an adequate relation over R will be a
         monoid M equipped with a map X -&gt; M that respects the relations R. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <span class="id" title="var">word</span> <span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">word_unit</span> : <span class="id" title="var">word</span> <span class="id" title="var">X</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">word_gen</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">word</span> <span class="id" title="var">X</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">word_op</span> : <span class="id" title="var">word</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">word</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">word</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">word_unit</span> {<span class="id" title="var">X</span>}.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">word_gen</span> {<span class="id" title="var">X</span>} <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">word_op</span> {<span class="id" title="var">X</span>} <span class="id" title="var">v</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <span class="id" title="var">reln</span> <span class="id" title="var">X</span> := <span class="id" title="var">make_reln</span> { <span class="id" title="var">lhs</span> : <span class="id" title="var">word</span> <span class="id" title="var">X</span>; <span class="id" title="var">rhs</span> : <span class="id" title="var">word</span> <span class="id" title="var">X</span> }.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">lhs</span> {<span class="id" title="var">X</span>} <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">rhs</span> {<span class="id" title="var">X</span>} <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">make_reln</span> {<span class="id" title="var">X</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <span class="id" title="var">MarkedPreMonoid</span> <span class="id" title="var">X</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">make_preMonoid</span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">elem</span> :&gt; <span class="id" title="keyword">Type</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">op0</span> : <span class="id" title="var">elem</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">op1</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">elem</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">op2</span> : <span class="id" title="var">elem</span> -&gt; <span class="id" title="var">elem</span> -&gt; <span class="id" title="var">elem</span> }.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">elem</span> {<span class="id" title="var">X</span>} <span class="id" title="var">M</span> : <span class="id" title="tactic">rename</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">op0</span> {<span class="id" title="var">X</span> <span class="id" title="var">M</span>} : <span class="id" title="tactic">rename</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">op1</span> {<span class="id" title="var">X</span> <span class="id" title="var">M</span>} <span class="id" title="var">x</span> : <span class="id" title="tactic">rename</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">op2</span> {<span class="id" title="var">X</span> <span class="id" title="var">M</span>} <span class="id" title="var">v</span> <span class="id" title="var">w</span> : <span class="id" title="tactic">rename</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">wordop</span> <span class="id" title="var">X</span> := <span class="id" title="var">make_preMonoid</span> <span class="id" title="var">X</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>) <span class="id" title="var">word_unit</span> <span class="id" title="var">word_gen</span> <span class="id" title="var">word_op</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">evalword</span> {<span class="id" title="var">X</span>} (<span class="id" title="var">Y</span>:<span class="id" title="var">MarkedPreMonoid</span> <span class="id" title="var">X</span>) (<span class="id" title="var">w</span>:<span class="id" title="var">word</span> <span class="id" title="var">X</span>) : <span class="id" title="var">elem</span> <span class="id" title="var">Y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">w</span>; <span class="id" title="tactic">intros</span> [|<span class="id" title="var">x</span>|<span class="id" title="var">v</span> <span class="id" title="var">w</span>]. { <span class="id" title="tactic">exact</span> <span class="id" title="var">op0</span>. } { <span class="id" title="tactic">exact</span> (<span class="id" title="var">op1</span> <span class="id" title="var">x</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">op2</span> (<span class="id" title="var">evalword</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">v</span>) (<span class="id" title="var">evalword</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">w</span>)). } <span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">MarkedPreMonoid_to_hrel</span> {<span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">M</span>:<span class="id" title="var">MarkedPreMonoid</span> <span class="id" title="var">X</span>) (<span class="id" title="keyword">is</span>:<span class="id" title="var">isaset</span> (<span class="id" title="var">elem</span> <span class="id" title="var">M</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">λ</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>, (<span class="id" title="var">evalword</span> <span class="id" title="var">M</span> <span class="id" title="var">v</span> = <span class="id" title="var">evalword</span> <span class="id" title="var">M</span> <span class="id" title="var">w</span>) ,, <span class="id" title="keyword">is</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
</div>

<div class="doc">
eta expansion principle for words 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">reassemble</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">v</span>:<span class="id" title="var">wordop</span> <span class="id" title="var">X</span>) : <span class="id" title="var">evalword</span> (<span class="id" title="var">wordop</span> <span class="id" title="var">X</span>) <span class="id" title="var">v</span> = <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="var">revert</span> <span class="id" title="var">v</span>; <span class="id" title="tactic">intros</span> [|<span class="id" title="var">x</span>|<span class="id" title="var">v</span> <span class="id" title="var">w</span>]. { <span class="id" title="tactic">reflexivity</span>. } { <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">aptwice</span> <span class="id" title="var">word_op</span> (<span class="id" title="var">reassemble</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">R</span> <span class="id" title="var">v</span>) (<span class="id" title="var">reassemble</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>)). } </div>

<br/>
</div>

<div class="doc">
<a name="lab1762"></a><h2 class="section">adequate relations over R</h2>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <span class="id" title="var">AdequateRelation</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">hrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">make_AdequateRelation</span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">base</span>: ∏ <span class="id" title="var">i</span>, <span class="id" title="var">r</span> (<span class="id" title="var">lhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>)) (<span class="id" title="var">rhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">reflex</span> : ∏ <span class="id" title="var">w</span>, <span class="id" title="var">r</span> <span class="id" title="var">w</span> <span class="id" title="var">w</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">symm</span> : ∏ <span class="id" title="var">v</span> <span class="id" title="var">w</span>, <span class="id" title="var">r</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> -&gt; <span class="id" title="var">r</span> <span class="id" title="var">w</span> <span class="id" title="var">v</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">trans</span> : ∏ <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>, <span class="id" title="var">r</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> -&gt; <span class="id" title="var">r</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> -&gt; <span class="id" title="var">r</span> <span class="id" title="var">u</span> <span class="id" title="var">w</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">left_compat</span> : ∏ <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>, <span class="id" title="var">r</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> -&gt; <span class="id" title="var">r</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span>) (<span class="id" title="var">word_op</span> <span class="id" title="var">u</span> <span class="id" title="var">w</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">right_compat</span>: ∏ <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>, <span class="id" title="var">r</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> -&gt; <span class="id" title="var">r</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">u</span> <span class="id" title="var">w</span>) (<span class="id" title="var">word_op</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">left_unit</span> : ∏ <span class="id" title="var">w</span>, <span class="id" title="var">r</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">word_unit</span> <span class="id" title="var">w</span>) <span class="id" title="var">w</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">right_unit</span> : ∏ <span class="id" title="var">w</span>, <span class="id" title="var">r</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">w</span> <span class="id" title="var">word_unit</span>) <span class="id" title="var">w</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">assoc</span> : ∏ <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>, <span class="id" title="var">r</span> (<span class="id" title="var">word_op</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span>) <span class="id" title="var">w</span>) (<span class="id" title="var">word_op</span> <span class="id" title="var">u</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">make_AdequateRelation</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">base</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">adequacy_to_eqrel</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">hrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">AdequateRelation</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> -&gt; <span class="id" title="var">eqrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">abstract</span> ( <span class="id" title="tactic">split</span>; [ <span class="id" title="tactic">split</span>; [ <span class="id" title="tactic">exact</span> (<span class="id" title="var">trans</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>) | <span class="id" title="tactic">exact</span> (<span class="id" title="var">reflex</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>) ] |<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">symm</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>)]). </div>

<br/>
</div>

<div class="doc">
<a name="lab1763"></a><h2 class="section">the smallest adequate relation over R</h2>

         It is defined as the intersection of all the adequate relations.
         Later we'll have to deal with the "resizing" to resolve issues
         with universes. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">smallestAdequateRelation0</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">hrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (∏ <span class="id" title="var">r</span>: <span class="id" title="var">hrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>), <span class="id" title="var">AdequateRelation</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> -&gt; <span class="id" title="var">r</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">abstract</span> (<span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">r</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">impred_prop</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">adequacy</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">AdequateRelation</span> <span class="id" title="var">R</span> (<span class="id" title="var">smallestAdequateRelation0</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">make_AdequateRelation</span> <span class="id" title="var">R</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">base</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">ra</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">reflex</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">exact</span> <span class="id" title="var">ra</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? ? <span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">symm</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">exact</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">λ</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">trans</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> (<span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>) (<span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>)). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? ? ? <span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">left_compat</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">exact</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? ? ? <span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">right_compat</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">exact</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">left_unit</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">exact</span> <span class="id" title="var">ra</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">right_unit</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">exact</span> <span class="id" title="var">ra</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">λ</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">assoc</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>). }<br/>
</div>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">smallestAdequateRelation</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">eqrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">adequacy_to_eqrel</span> <span class="id" title="var">R</span> <span class="id" title="var">_</span> (<span class="id" title="var">adequacy</span> <span class="id" title="var">R</span>)). <span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab1764"></a><h3 class="section">the underlying set of the abelian group with generators X and relations R</h3>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universalMarkedPreMonoid0</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">hSet</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">setquotinset</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">op2_compatibility</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">QuotientSet.iscomprelrelfun2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">word_op</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">y</span> <span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">right_compat</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">y</span> (<span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>)). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">y'</span> <span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">exact</span> ( <span class="id" title="var">left_compat</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">y'</span> (<span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>)). } </div>

<br/>
</div>

<div class="doc">
<a name="lab1765"></a><h3 class="section">the multiplication on on it</h3>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">univ_binop</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">binop</span> (<span class="id" title="var">universalMarkedPreMonoid0</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">QuotientSet.setquotfun2</span> <span class="id" title="var">word_op</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">op2_compatibility</span>. <span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">univ_setwithbinop</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">setwithbinop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">setwithbinoppair</span> (<span class="id" title="var">universalMarkedPreMonoid0</span> <span class="id" title="var">R</span>) (<span class="id" title="var">univ_binop</span> <span class="id" title="var">R</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab1766"></a><h3 class="section">the universal pre-monoid</h3>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universalMarkedPreMonoid</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">MarkedPreMonoid</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">make_preMonoid</span> <span class="id" title="var">X</span> (<span class="id" title="var">universalMarkedPreMonoid0</span> <span class="id" title="var">R</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">setquotpr</span> <span class="id" title="var">_</span> <span class="id" title="var">word_unit</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">setquotpr</span> <span class="id" title="var">_</span> (<span class="id" title="var">word_gen</span> <span class="id" title="var">x</span>)). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">univ_binop</span> <span class="id" title="var">_</span>). } <span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab1767"></a><h3 class="section">identities for the universal preabelian group</h3>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lift</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">issurjective</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>)).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">issurjsetquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>)). </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">is_left_unit_univ_binop</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">w</span>:<span class="id" title="var">universalMarkedPreMonoid0</span> <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">univ_binop</span> <span class="id" title="var">_</span>) (<span class="id" title="var">setquotpr</span> <span class="id" title="var">_</span> <span class="id" title="var">word_unit</span>) <span class="id" title="var">w</span>) = <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="var">isaprop_goal</span> <span class="id" title="var">ig</span>. { <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">w'</span> []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">iscompsetquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">left_unit</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">w'</span>)). </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">is_right_unit_univ_binop</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">w</span>:<span class="id" title="var">universalMarkedPreMonoid0</span> <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">univ_binop</span> <span class="id" title="var">_</span>) <span class="id" title="var">w</span> (<span class="id" title="var">setquotpr</span> <span class="id" title="var">_</span> <span class="id" title="var">word_unit</span>)) = <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="var">isaprop_goal</span> <span class="id" title="var">ig</span>. { <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">w'</span> []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">iscompsetquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">right_unit</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">w'</span>)). </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isassoc_univ_binop</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">isassoc</span>(<span class="id" title="var">univ_binop</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">set</span> (<span class="id" title="var">e</span> := <span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">intros</span> <span class="id" title="var">u'</span> <span class="id" title="var">v'</span> <span class="id" title="var">w'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isaprop_goal</span> <span class="id" title="var">ig</span>. { <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">u'</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">u</span> <span class="id" title="var">i</span>]; <span class="id" title="tactic">destruct</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">v'</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">v</span> <span class="id" title="var">j</span>]; <span class="id" title="tactic">destruct</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">w'</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">w</span> []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">iscompsetquotpr</span> <span class="id" title="var">e</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">λ</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">assoc</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>)). </div>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">reassemble_pr</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">v</span>:<span class="id" title="var">word</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">evalword</span> (<span class="id" title="var">universalMarkedPreMonoid</span> <span class="id" title="var">R</span>) <span class="id" title="var">v</span> = <span class="id" title="var">setquotpr</span> <span class="id" title="var">_</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="var">revert</span> <span class="id" title="var">v</span>; <span class="id" title="tactic">intros</span> [|<span class="id" title="var">x</span>|<span class="id" title="var">v</span> <span class="id" title="var">w</span>]. { <span class="id" title="tactic">reflexivity</span>. } { <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">p</span> := ! <span class="id" title="var">reassemble_pr</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">R</span> <span class="id" title="var">v</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">q</span> := ! <span class="id" title="var">reassemble_pr</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. } </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">pr_eval_compat</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">w</span>:<span class="id" title="var">word</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">evalword</span> (<span class="id" title="var">wordop</span> <span class="id" title="var">X</span>) <span class="id" title="var">w</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">evalword</span> (<span class="id" title="var">universalMarkedPreMonoid</span> <span class="id" title="var">R</span>) <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">x</span>|<span class="id" title="var">v</span> <span class="id" title="var">w</span>]. { <span class="id" title="tactic">reflexivity</span>. } { <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">assert</span> (<span class="id" title="var">p</span> := !<span class="id" title="var">reassemble</span> <span class="id" title="var">R</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>)). <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (!<span class="id" title="var">reassemble_pr</span> <span class="id" title="var">R</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>)). } </div>

<br/>
</div>

<div class="doc">
<a name="lab1768"></a><h3 class="section">abelian groups over X modulo R</h3>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">toMarkedPreMonoid</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">M</span>:<span class="id" title="var">monoid</span>) (<span class="id" title="var">el</span>:<span class="id" title="var">X</span>-&gt;<span class="id" title="var">M</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">MarkedPreMonoid</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exact</span> {| <span class="id" title="var">elem</span> := <span class="id" title="var">M</span>; <span class="id" title="var">op0</span> := <span class="id" title="var">unel</span> <span class="id" title="var">_</span>; <span class="id" title="var">op1</span> := <span class="id" title="var">el</span>; <span class="id" title="var">op2</span> := <span class="id" title="var">op</span> |}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <span class="id" title="var">MarkedMonoid</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">make_MarkedMonoid</span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">m_base</span> :&gt; <span class="id" title="var">monoid</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">m_mark</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">m_base</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">m_reln</span> : ∏ <span class="id" title="var">i</span>, <span class="id" title="var">evalword</span> (<span class="id" title="var">toMarkedPreMonoid</span> <span class="id" title="var">R</span> <span class="id" title="var">m_base</span> <span class="id" title="var">m_mark</span>) (<span class="id" title="var">lhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">evalword</span> (<span class="id" title="var">toMarkedPreMonoid</span> <span class="id" title="var">R</span> <span class="id" title="var">m_base</span> <span class="id" title="var">m_mark</span>) (<span class="id" title="var">rhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>)) }.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">make_MarkedMonoid</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} <span class="id" title="var">R</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">m_base</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span> <span class="id" title="var">R</span>} <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">m_mark</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span> <span class="id" title="var">R</span>} <span class="id" title="var">_</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">toMarkedPreMonoid'</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} (<span class="id" title="var">M</span>:<span class="id" title="var">MarkedMonoid</span> <span class="id" title="var">R</span>) : <span class="id" title="var">MarkedPreMonoid</span> <span class="id" title="var">X</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">toMarkedPreMonoid</span> <span class="id" title="var">R</span> (<span class="id" title="var">m_base</span> <span class="id" title="var">M</span>) (<span class="id" title="var">m_mark</span> <span class="id" title="var">M</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">evalwordMM</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} (<span class="id" title="var">M</span>:<span class="id" title="var">MarkedMonoid</span> <span class="id" title="var">R</span>) : <span class="id" title="var">word</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">M</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">evalword</span> (<span class="id" title="var">toMarkedPreMonoid'</span> <span class="id" title="var">M</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">MarkedMonoid_to_hrel</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} (<span class="id" title="var">M</span>:<span class="id" title="var">MarkedMonoid</span> <span class="id" title="var">R</span>) : <span class="id" title="var">hrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">λ</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> , <span class="id" title="var">eqset</span> (<span class="id" title="var">evalwordMM</span> <span class="id" title="var">M</span> <span class="id" title="var">v</span>) (<span class="id" title="var">evalwordMM</span> <span class="id" title="var">M</span> <span class="id" title="var">w</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">abelian_group_adequacy</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">M</span>:<span class="id" title="var">MarkedMonoid</span> <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">AdequateRelation</span> <span class="id" title="var">R</span> (<span class="id" title="var">MarkedMonoid_to_hrel</span> <span class="id" title="var">M</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">make_AdequateRelation</span> <span class="id" title="var">R</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, <span class="id" title="var">m_reln</span> <span class="id" title="var">R</span> <span class="id" title="var">M</span> <span class="id" title="var">i</span>). } { <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? ?. <span class="id" title="tactic">exact</span> <span class="id" title="var">pathsinv0</span>. } { <span class="id" title="tactic">intros</span> ? ? ?. <span class="id" title="tactic">exact</span> <span class="id" title="var">pathscomp0</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? ? ? <span class="id" title="var">p</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">evalwordMM</span>,<span class="id" title="var">evalword</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? ? ? <span class="id" title="var">p</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">evalwordMM</span>,<span class="id" title="var">evalword</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">lunax</span>. } { <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">runax</span>. } { <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">assocax</span>. }<br/>
</div>
&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <span class="id" title="var">MarkedMonoidMap</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} (<span class="id" title="var">M</span> <span class="id" title="var">N</span>:<span class="id" title="var">MarkedMonoid</span> <span class="id" title="var">R</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">make_MarkedMonoidMap</span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">map_base</span> :&gt; <span class="id" title="var">Hom</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">map_mark</span> : ∏ <span class="id" title="var">x</span>, <span class="id" title="var">map_base</span> (<span class="id" title="var">m_mark</span> <span class="id" title="var">M</span> <span class="id" title="var">x</span>) = <span class="id" title="var">m_mark</span> <span class="id" title="var">N</span> <span class="id" title="var">x</span> }.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">map_base</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span> <span class="id" title="var">R</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>} <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">map_mark</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span> <span class="id" title="var">R</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>} <span class="id" title="var">m</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MarkedMonoidMapEquality</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} {<span class="id" title="var">M</span> <span class="id" title="var">N</span>:<span class="id" title="var">MarkedMonoid</span> <span class="id" title="var">R</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">MarkedMonoidMap</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>) : <span class="id" title="var">map_base</span> <span class="id" title="var">f</span> = <span class="id" title="var">map_base</span> <span class="id" title="var">g</span> -&gt; <span class="id" title="var">f</span> = <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">f</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">f</span> <span class="id" title="var">ft</span>], <span class="id" title="var">g</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">g</span> <span class="id" title="var">gt</span>]; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">j</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span>(<span class="id" title="var">k</span> : <span class="id" title="var">ft</span> = <span class="id" title="var">gt</span>). { <span class="id" title="tactic">apply</span> <span class="id" title="var">funextsec</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. } <span class="id" title="tactic">destruct</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. </div>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">MarkedMonoidMap_compat</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">M</span> <span class="id" title="var">N</span>:<span class="id" title="var">MarkedMonoid</span> <span class="id" title="var">R</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">MarkedMonoidMap</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>) (<span class="id" title="var">w</span>:<span class="id" title="var">word</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">map_base</span> <span class="id" title="var">f</span> (<span class="id" title="var">evalwordMM</span> <span class="id" title="var">M</span> <span class="id" title="var">w</span>) = <span class="id" title="var">evalwordMM</span> <span class="id" title="var">N</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">x</span>|<span class="id" title="var">v</span> <span class="id" title="var">w</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">unitproperty</span> <span class="id" title="var">f</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">map_mark</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">multproperty</span> <span class="id" title="var">f</span> (<span class="id" title="var">evalwordMM</span> <span class="id" title="var">M</span> <span class="id" title="var">v</span>) (<span class="id" title="var">evalwordMM</span> <span class="id" title="var">M</span> <span class="id" title="var">w</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">aptwice</span> (<span class="id" title="var">λ</span> <span class="id" title="var">r</span> <span class="id" title="var">s</span>, <span class="id" title="var">r</span> * <span class="id" title="var">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">MarkedMonoidMap_compat</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> <span class="id" title="var">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">MarkedMonoidMap_compat</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> <span class="id" title="var">w</span>)). } </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MarkedMonoidMap_compat2</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">M</span> <span class="id" title="var">N</span>:<span class="id" title="var">MarkedMonoid</span> <span class="id" title="var">R</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">MarkedMonoidMap</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>) (<span class="id" title="var">w</span>:<span class="id" title="var">word</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">map_base</span> <span class="id" title="var">f</span> (<span class="id" title="var">evalwordMM</span> <span class="id" title="var">M</span> <span class="id" title="var">w</span>) = <span class="id" title="var">map_base</span> <span class="id" title="var">g</span> (<span class="id" title="var">evalwordMM</span> <span class="id" title="var">M</span> <span class="id" title="var">w</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">MarkedMonoidMap_compat</span> <span class="id" title="var">f</span> <span class="id" title="var">w</span> @ !<span class="id" title="var">MarkedMonoidMap_compat</span> <span class="id" title="var">g</span> <span class="id" title="var">w</span>). </div>

<br/>
</div>

<div class="doc">
<a name="lab1769"></a><h3 class="section">the universal marked abelian group over X modulo R</h3>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universalMarkedMonoid0</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">monoid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exists</span> (<span class="id" title="var">univ_setwithbinop</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">isassoc_univ_binop</span> <span class="id" title="var">R</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exists</span> (<span class="id" title="var">setquotpr</span> <span class="id" title="var">_</span> <span class="id" title="var">word_unit</span>). <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">is_left_unit_univ_binop</span> <span class="id" title="var">R</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">is_right_unit_univ_binop</span> <span class="id" title="var">R</span>). } } } }<br/>
<span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universalMarkedMonoid1</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">MarkedPreMonoid</span> <span class="id" title="var">X</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">toMarkedPreMonoid</span> <span class="id" title="var">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">universalMarkedMonoid0</span> <span class="id" title="var">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, <span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">word_gen</span> <span class="id" title="var">x</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">universalMarkedMonoid2</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">w</span>:<span class="id" title="var">word</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">w</span> = <span class="id" title="var">evalword</span> (<span class="id" title="var">universalMarkedMonoid1</span> <span class="id" title="var">R</span>) <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (! (<span class="id" title="var">ap</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>)) (<span class="id" title="var">reassemble</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">pr_eval_compat</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>). </div>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universalMarkedMonoid3</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">i</span>:<span class="id" title="var">I</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">evalword</span> (<span class="id" title="var">universalMarkedMonoid1</span> <span class="id" title="var">R</span>) (<span class="id" title="var">lhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">evalword</span> (<span class="id" title="var">universalMarkedMonoid1</span> <span class="id" title="var">R</span>) (<span class="id" title="var">rhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>)).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (! <span class="id" title="var">universalMarkedMonoid2</span> <span class="id" title="var">R</span> (<span class="id" title="var">lhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">iscompsetquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">λ</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">base</span> <span class="id" title="var">ra</span> <span class="id" title="var">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">universalMarkedMonoid2</span> <span class="id" title="var">R</span> (<span class="id" title="var">rhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>))). </div>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universalMarkedMonoid</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">MarkedMonoid</span> <span class="id" title="var">R</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">make_MarkedMonoid</span> <span class="id" title="var">R</span> (<span class="id" title="var">universalMarkedMonoid0</span> <span class="id" title="var">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">word_gen</span> <span class="id" title="var">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">universalMarkedMonoid3</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">agreement_on_gens0</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} {<span class="id" title="var">M</span>:<span class="id" title="var">monoid</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">Hom</span> (<span class="id" title="var">universalMarkedMonoid</span> <span class="id" title="var">R</span>) <span class="id" title="var">M</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span>:∏ <span class="id" title="var">i</span>, <span class="id" title="var">f</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">word_gen</span> <span class="id" title="var">i</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">g</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">word_gen</span> <span class="id" title="var">i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">w</span>:<span class="id" title="var">word</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr1</span> <span class="id" title="var">f</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">w</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr1</span> <span class="id" title="var">g</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">w</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">x</span>|<span class="id" title="var">v</span> <span class="id" title="var">w</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">intermediate_path</span> (<span class="id" title="var">unel</span> <span class="id" title="var">M</span>). <span class="id" title="tactic">exact</span> (<span class="id" title="var">unitproperty</span> <span class="id" title="var">f</span>). <span class="id" title="tactic">exact</span> (!<span class="id" title="var">unitproperty</span> <span class="id" title="var">g</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">p</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">multproperty</span> <span class="id" title="var">f</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">w</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">_</span> @ !<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">multproperty</span> <span class="id" title="var">g</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">w</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">aptwice</span> (<span class="id" title="var">λ</span> <span class="id" title="var">r</span> <span class="id" title="var">s</span>, <span class="id" title="var">r</span> * <span class="id" title="var">s</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">agreement_on_gens0</span>. <span class="id" title="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">agreement_on_gens0</span>. <span class="id" title="tactic">assumption</span>. } } </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">agreement_on_gens</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} {<span class="id" title="var">M</span>:<span class="id" title="var">monoid</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">Hom</span> (<span class="id" title="var">universalMarkedMonoid</span> <span class="id" title="var">R</span>) <span class="id" title="var">M</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(∏ <span class="id" title="var">i</span>, <span class="id" title="var">f</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">word_gen</span> <span class="id" title="var">i</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">g</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">word_gen</span> <span class="id" title="var">i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id" title="var">f</span> = <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">funEquality</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">funextsec</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">t</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">surjectionisepitosets</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">issurjsetquotpr</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. } { <span class="id" title="tactic">apply</span> <span class="id" title="var">agreement_on_gens0</span>. <span class="id" title="tactic">assumption</span>. } <span class="id" title="keyword">Qed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universality0</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} (<span class="id" title="var">M</span>:<span class="id" title="var">MarkedMonoid</span> <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">universalMarkedMonoid0</span> <span class="id" title="var">R</span> -&gt; <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">setquotuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">evalwordMM</span> <span class="id" title="var">M</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">λ</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">r</span>, <span class="id" title="var">r</span> (<span class="id" title="var">MarkedMonoid_to_hrel</span> <span class="id" title="var">M</span>) (<span class="id" title="var">abelian_group_adequacy</span> <span class="id" title="var">R</span> <span class="id" title="var">M</span>)).<br/>
</div>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universality1</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">M</span>:<span class="id" title="var">MarkedMonoid</span> <span class="id" title="var">R</span>) (<span class="id" title="var">v</span> <span class="id" title="var">w</span>:<span class="id" title="var">universalMarkedMonoid0</span> <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">universality0</span> <span class="id" title="var">M</span> (<span class="id" title="var">v</span> * <span class="id" title="var">w</span>) = <span class="id" title="var">universality0</span> <span class="id" title="var">M</span> <span class="id" title="var">v</span> * <span class="id" title="var">universality0</span> <span class="id" title="var">M</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="var">isaprop_goal</span> <span class="id" title="var">ig</span>. { <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">v</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">v'</span> <span class="id" title="var">j</span>]; <span class="id" title="tactic">destruct</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">w'</span> []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. </div>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universality2</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} (<span class="id" title="var">M</span>:<span class="id" title="var">MarkedMonoid</span> <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">monoidfun</span> (<span class="id" title="var">universalMarkedMonoid</span> <span class="id" title="var">R</span>) <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">universality0</span> <span class="id" title="var">M</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>. { <span class="id" title="tactic">intros</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">universality1</span>. } { <span class="id" title="tactic">reflexivity</span>. } </div>

<br/>
</div>

<div class="doc">
<a name="lab1770"></a><h1 class="section">universality of the universal marked abelian group</h1>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local</span> <span class="id" title="var">Arguments</span> <span class="id" title="var">pr1monoidfun</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span>} <span class="id" title="var">f</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">iscontrMarkedMonoidMap</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} (<span class="id" title="var">M</span>:<span class="id" title="var">MarkedMonoid</span> <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iscontr</span> (<span class="id" title="var">MarkedMonoidMap</span> (<span class="id" title="var">universalMarkedMonoid</span> <span class="id" title="var">R</span>) <span class="id" title="var">M</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">g</span> := <span class="id" title="var">make_MarkedMonoidMap</span> <span class="id" title="var">X</span> <span class="id" title="var">I</span> <span class="id" title="var">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">universalMarkedMonoid</span> <span class="id" title="var">R</span>) <span class="id" title="var">M</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">universality2</span> <span class="id" title="var">M</span>) (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">idpath</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">g</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">f</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">MarkedMonoidMapEquality</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">funEquality</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">funextsec</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isaprop_goal</span> <span class="id" title="var">ig</span>. { <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">v</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">w</span> []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ((<span class="id" title="var">ap</span> <span class="id" title="var">f</span> (<span class="id" title="var">universalMarkedMonoid2</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">MarkedMonoidMap_compat2</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">w</span> @ !(<span class="id" title="var">ap</span> <span class="id" title="var">g</span> (<span class="id" title="var">universalMarkedMonoid2</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>))).<br/>
</div>
<span class="id" title="keyword">End</span> <span class="id" title="var">Presentation</span>.<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">Free</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Import</span> <span class="id" title="var">Presentation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">make</span> (<span class="id" title="var">X</span>:<span class="id" title="keyword">Type</span>) := @<span class="id" title="var">universalMarkedMonoid</span> <span class="id" title="var">X</span> <span class="id" title="var">empty</span> <span class="id" title="var">fromempty</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Free</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">NN</span> := <span class="id" title="var">Free.make</span> <span class="id" title="var">unit</span>.<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">Product</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">make</span> {<span class="id" title="var">I</span>} (<span class="id" title="var">X</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">monoid</span>) : <span class="id" title="var">monoid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">Magma.Product.make</span> <span class="id" title="var">X</span>). <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">funextsec</span>; <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">assocax</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, <span class="id" title="var">unel</span> (<span class="id" title="var">X</span> <span class="id" title="var">i</span>)). <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">funextsec</span>; <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">lunax</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">funextsec</span>; <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">runax</span>. <span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Proj</span> {<span class="id" title="var">I</span>} (<span class="id" title="var">X</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">monoid</span>) (<span class="id" title="var">i</span>:<span class="id" title="var">I</span>) : <span class="id" title="var">Hom</span> (<span class="id" title="var">make</span> <span class="id" title="var">X</span>) (<span class="id" title="var">X</span> <span class="id" title="var">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">Magma.Product.Proj</span> <span class="id" title="var">X</span> <span class="id" title="var">i</span>)). <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">Magma.Product.Proj</span> <span class="id" title="var">X</span> <span class="id" title="var">i</span>)). <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Fun</span> {<span class="id" title="var">I</span>} (<span class="id" title="var">X</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">monoid</span>) (<span class="id" title="var">T</span>:<span class="id" title="var">monoid</span>) (<span class="id" title="var">g</span>: ∏ <span class="id" title="var">i</span>, <span class="id" title="var">Hom</span> <span class="id" title="var">T</span> (<span class="id" title="var">X</span> <span class="id" title="var">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">Hom</span> <span class="id" title="var">T</span> (<span class="id" title="var">make</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">Magma.Product.Fun</span> <span class="id" title="var">X</span> <span class="id" title="var">T</span> <span class="id" title="var">g</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">Magma.Product.Fun</span> <span class="id" title="var">X</span> <span class="id" title="var">T</span> <span class="id" title="var">g</span>)). <span class="id" title="tactic">apply</span> <span class="id" title="var">funextsec</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">g</span> <span class="id" title="var">i</span>))). <span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Eqn</span> {<span class="id" title="var">I</span>} (<span class="id" title="var">X</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">monoid</span>) (<span class="id" title="var">T</span>:<span class="id" title="var">monoid</span>) (<span class="id" title="var">g</span>: ∏ <span class="id" title="var">i</span>, <span class="id" title="var">Hom</span> <span class="id" title="var">T</span> (<span class="id" title="var">X</span> <span class="id" title="var">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: ∏ <span class="id" title="var">i</span>, <span class="id" title="var">Proj</span> <span class="id" title="var">X</span> <span class="id" title="var">i</span> ∘ <span class="id" title="var">Fun</span> <span class="id" title="var">X</span> <span class="id" title="var">T</span> <span class="id" title="var">g</span> = <span class="id" title="var">g</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">funEquality</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">issurjective_projection</span> {<span class="id" title="var">I</span>} (<span class="id" title="var">X</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">monoid</span>) (<span class="id" title="var">i</span>:<span class="id" title="var">I</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isdeceq</span> <span class="id" title="var">I</span> -&gt; <span class="id" title="var">issurjective</span> (<span class="id" title="var">Proj</span> <span class="id" title="var">X</span> <span class="id" title="var">i</span>).<br/>

<br/>
</div>

<div class="doc">
Reminder: by <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartB.html#isasetifdeceq"><span class="id" title="lemma">isasetifdeceq</span></a></span>, I is a set, too.
      We should strengthen this lemma by assuming <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartB.html#isaset"><span class="id" title="definition">isaset</span></a></span> <span class="inlinecode"><a class="idref" href="UniMath.MoreFoundations.Subtypes.html#I"><span class="id" title="variable">I</span></a></span> instead of
      <span class="inlinecode"><a class="idref" href="UniMath.Foundations.PartB.html#isdeceq"><span class="id" title="definition">isdeceq</span></a></span> <span class="inlinecode"><a class="idref" href="UniMath.MoreFoundations.Subtypes.html#I"><span class="id" title="variable">I</span></a></span>. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span> <span class="id" title="var">decide_equality</span> <span class="id" title="var">xi</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hinhpr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span>,,<span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">j</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">decide_equality</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">p</span>|<span class="id" title="var">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">transportf</span> <span class="id" title="var">X</span> <span class="id" title="var">p</span> <span class="id" title="var">xi</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">unel</span> (<span class="id" title="var">X</span> <span class="id" title="var">j</span>)). } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">decide_equality</span> <span class="id" title="var">i</span> <span class="id" title="var">i</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">q</span>|<span class="id" title="var">r</span>]; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">assert</span> (<span class="id" title="var">e</span> : <span class="id" title="var">idpath</span> <span class="id" title="var">i</span> = <span class="id" title="var">q</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">isasetifdeceq</span>. <span class="id" title="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> (<span class="id" title="var">r</span> (<span class="id" title="var">idpath</span> <span class="id" title="var">i</span>)). } </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">issurjective_projection'</span> {<span class="id" title="var">I</span>} (<span class="id" title="var">X</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">monoid</span>) (<span class="id" title="var">i</span>:<span class="id" title="var">I</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">LEM</span> -&gt; <span class="id" title="var">isaset</span> <span class="id" title="var">I</span> -&gt; <span class="id" title="var">issurjective</span> (<span class="id" title="var">Proj</span> <span class="id" title="var">X</span> <span class="id" title="var">i</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span> <span class="id" title="var">lem</span> <span class="id" title="keyword">is</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">issurjective_projection</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">LEM_for_sets</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">assumption</span>. </div>
<span class="id" title="keyword">End</span> <span class="id" title="var">Product</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="https://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>