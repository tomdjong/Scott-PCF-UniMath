<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
	<script src="http://code.jquery.com/jquery-1.11.0.min.js" type="text/javascript"></script>
	<script src="./proofs-toggle.js" type="text/javascript"></script>
	<style>
		div.proofcomment {
			font-style: italic;
		}
	</style>
	<title>Documentation</title>
</head>
<body>
<div id="page">
<div id="main">
<h1 class="libtitle">Library UniMath.Ktheory.AbelianMonoid</h1>

<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.Foundations.Preamble</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.Algebra.Monoids</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.Algebra.Groups</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.Combinatorics.FiniteSets</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">UniMath.NumberSystems.NaturalNumbersAlgebra</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">UniMath.Ktheory.Utilities</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="var">UniMath.Ktheory.QuotientSet</span> <span class="id" title="var">UniMath.Ktheory.Monoid</span>.<br/>
<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">multmonoid_scope</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">addmonoid_scope</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">UniMath.Algebra.Monoids.AddNotation</span>.<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Notation</span> <span class="id" title="var">Hom</span> := <span class="id" title="var">monoidfun</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dni_first</span> <span class="id" title="var">n</span> : <span class="id" title="var">stn</span> <span class="id" title="var">n</span> -&gt; <span class="id" title="var">stn</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) := @<span class="id" title="var">dni</span> <span class="id" title="var">n</span> <span class="id" title="var">firstelement</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dni_last</span>  <span class="id" title="var">n</span> : <span class="id" title="var">stn</span> <span class="id" title="var">n</span> -&gt; <span class="id" title="var">stn</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) := @<span class="id" title="var">dni</span> <span class="id" title="var">n</span> <span class="id" title="var">lastelement</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">finiteOperation0</span> (<span class="id" title="var">X</span>:<span class="id" title="var">abmonoid</span>) <span class="id" title="var">n</span> (<span class="id" title="var">x</span>:<span class="id" title="var">stn</span> <span class="id" title="var">n</span>-&gt;<span class="id" title="var">X</span>) : <span class="id" title="var">X</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> &nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">x'</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">unel</span> <span class="id" title="var">_</span>). } { <span class="id" title="tactic">exact</span> ((<span class="id" title="var">x'</span> (<span class="id" title="var">funcomp</span> (<span class="id" title="var">dni_last</span> <span class="id" title="var">n</span>) <span class="id" title="var">x</span>)) + <span class="id" title="var">x</span> <span class="id" title="var">lastelement</span>). } </div>
<span class="id" title="keyword">Goal</span> ∏ (<span class="id" title="var">X</span>:<span class="id" title="var">abmonoid</span>) <span class="id" title="var">n</span> (<span class="id" title="var">x</span>:<span class="id" title="var">stn</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)-&gt;<span class="id" title="var">X</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">finiteOperation0</span> <span class="id" title="var">X</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;= <span class="id" title="var">finiteOperation0</span> <span class="id" title="var">X</span> <span class="id" title="var">n</span> (<span class="id" title="var">funcomp</span> (<span class="id" title="var">dni_last</span> <span class="id" title="var">n</span>) <span class="id" title="var">x</span>) + <span class="id" title="var">x</span> <span class="id" title="var">lastelement</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">reflexivity</span>. </div>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">same_n</span> {<span class="id" title="var">I</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">nelstruct</span> <span class="id" title="var">m</span> <span class="id" title="var">I</span>) (<span class="id" title="var">g</span>:<span class="id" title="var">nelstruct</span> <span class="id" title="var">n</span> <span class="id" title="var">I</span>) : <span class="id" title="var">m</span> = <span class="id" title="var">n</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">weqtoeqstn</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">weqcomp</span> <span class="id" title="var">f</span> (<span class="id" title="var">invweq</span> <span class="id" title="var">g</span>)). </div>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fun_assoc</span> {<span class="id" title="var">W</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">Z</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">W</span>-&gt;<span class="id" title="var">X</span>) (<span class="id" title="var">g</span>:<span class="id" title="var">X</span>-&gt;<span class="id" title="var">Y</span>) (<span class="id" title="var">h</span>:<span class="id" title="var">Y</span>-&gt;<span class="id" title="var">Z</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">funcomp</span> (<span class="id" title="var">funcomp</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>) <span class="id" title="var">h</span> = <span class="id" title="var">funcomp</span> <span class="id" title="var">f</span> (<span class="id" title="var">funcomp</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">reflexivity</span>. </div>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nelstructoncomplmap</span>  {<span class="id" title="var">X</span>:<span class="id" title="var">UU</span>} {<span class="id" title="var">n</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">x</span>:<span class="id" title="var">X</span>) (<span class="id" title="var">sx</span>:<span class="id" title="var">nelstruct</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr1compl</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span> ∘ <span class="id" title="var">pr1</span> (<span class="id" title="var">nelstructoncompl</span> <span class="id" title="var">x</span> <span class="id" title="var">sx</span>)<br/>
&nbsp;&nbsp;= <span class="id" title="var">pr1weq</span> <span class="id" title="var">sx</span> ∘ <span class="id" title="var">dni</span> (<span class="id" title="var">invmap</span> <span class="id" title="var">sx</span> <span class="id" title="var">x</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nelstructoncomplmap'</span>  {<span class="id" title="var">I</span>:<span class="id" title="var">UU</span>} {<span class="id" title="var">n</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">i</span>:<span class="id" title="var">stn</span>(<span class="id" title="var">S</span> <span class="id" title="var">n</span>)) (<span class="id" title="var">sx</span>:<span class="id" title="var">nelstruct</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) <span class="id" title="var">I</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr1compl</span> <span class="id" title="var">I</span> (<span class="id" title="var">pr1weq</span> <span class="id" title="var">sx</span> <span class="id" title="var">i</span>) ∘ <span class="id" title="var">pr1</span> (<span class="id" title="var">nelstructoncompl</span> (<span class="id" title="var">pr1weq</span> <span class="id" title="var">sx</span> <span class="id" title="var">i</span>) <span class="id" title="var">sx</span>)<br/>
&nbsp;&nbsp;= <span class="id" title="var">pr1weq</span> <span class="id" title="var">sx</span> ∘ <span class="id" title="var">dni</span> (<span class="id" title="var">invmap</span> <span class="id" title="var">sx</span> (<span class="id" title="var">pr1weq</span> <span class="id" title="var">sx</span> <span class="id" title="var">i</span>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nelstructoncomplmap''</span>  {<span class="id" title="var">I</span>:<span class="id" title="var">UU</span>} {<span class="id" title="var">n</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">i</span>:<span class="id" title="var">stn</span>(<span class="id" title="var">S</span> <span class="id" title="var">n</span>)) (<span class="id" title="var">sx</span>:<span class="id" title="var">nelstruct</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) <span class="id" title="var">I</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr1compl</span> <span class="id" title="var">I</span> (<span class="id" title="var">pr1weq</span> <span class="id" title="var">sx</span> <span class="id" title="var">i</span>) ∘ <span class="id" title="var">pr1</span> (<span class="id" title="var">nelstructoncompl</span> (<span class="id" title="var">pr1weq</span> <span class="id" title="var">sx</span> <span class="id" title="var">i</span>) <span class="id" title="var">sx</span>)<br/>
&nbsp;&nbsp;= <span class="id" title="var">pr1weq</span> <span class="id" title="var">sx</span> ∘ <span class="id" title="var">dni</span> <span class="id" title="var">i</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">intermediate_path</span> (<span class="id" title="var">pr1weq</span> <span class="id" title="var">sx</span> ∘ <span class="id" title="var">dni</span> (<span class="id" title="var">invmap</span> <span class="id" title="var">sx</span> (<span class="id" title="var">pr1weq</span> <span class="id" title="var">sx</span> <span class="id" title="var">i</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nelstructoncomplmap'''</span>  {<span class="id" title="var">I</span>:<span class="id" title="var">UU</span>} {<span class="id" title="var">n</span>} (<span class="id" title="var">sx</span>:<span class="id" title="var">nelstruct</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) <span class="id" title="var">I</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr1compl</span> <span class="id" title="var">I</span> (<span class="id" title="var">pr1weq</span> <span class="id" title="var">sx</span> <span class="id" title="var">lastelement</span>) ∘ <span class="id" title="var">pr1</span> (<span class="id" title="var">nelstructoncompl</span> (<span class="id" title="var">pr1weq</span> <span class="id" title="var">sx</span> <span class="id" title="var">lastelement</span>) <span class="id" title="var">sx</span>)<br/>
&nbsp;&nbsp;= <span class="id" title="var">pr1weq</span> <span class="id" title="var">sx</span> ∘ <span class="id" title="var">dni_last</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isdeceq_refl</span> {<span class="id" title="var">X</span>} (<span class="id" title="var">dec</span>:<span class="id" title="var">isdeceq</span> <span class="id" title="var">X</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">X</span>) : <span class="id" title="var">dec</span> <span class="id" title="var">x</span> <span class="id" title="var">x</span> = <span class="id" title="var">ii1</span> (<span class="id" title="var">idpath</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">dec</span> <span class="id" title="var">x</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">eq</span>|<span class="id" title="var">ne</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">assert</span>( <span class="id" title="var">c</span> : <span class="id" title="var">eq</span> = <span class="id" title="var">idpath</span> <span class="id" title="var">x</span> ). { <span class="id" title="tactic">apply</span> <span class="id" title="var">isasetifdeceq</span>. <span class="id" title="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">induction</span> (<span class="id" title="var">ne</span> (<span class="id" title="var">idpath</span> <span class="id" title="var">x</span>)). }<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isdeceq_neq</span> {<span class="id" title="var">X</span>} (<span class="id" title="var">dec</span>:<span class="id" title="var">isdeceq</span> <span class="id" title="var">X</span>) (<span class="id" title="var">i</span> <span class="id" title="var">j</span>:<span class="id" title="var">X</span>) (<span class="id" title="var">ne</span> : <span class="id" title="var">i</span> != <span class="id" title="var">j</span>) : <span class="id" title="var">dec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> = <span class="id" title="var">ii2</span> <span class="id" title="var">ne</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">dec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">ieqj</span> | <span class="id" title="var">inej</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">induction</span> (<span class="id" title="var">ne</span> <span class="id" title="var">ieqj</span>). }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">assert</span> ( <span class="id" title="var">H</span> : <span class="id" title="var">inej</span> = <span class="id" title="var">ne</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">funextfun</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">induction</span> (<span class="id" title="var">ne</span> <span class="id" title="var">x</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. }<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">transposition0</span> {<span class="id" title="var">X</span>} (<span class="id" title="var">dec</span>: <span class="id" title="var">isdeceq</span> <span class="id" title="var">X</span>) (<span class="id" title="var">i</span> <span class="id" title="var">j</span>:<span class="id" title="var">X</span>) : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">dec</span> <span class="id" title="var">k</span> <span class="id" title="var">i</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> <span class="id" title="var">j</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">induction</span> (<span class="id" title="var">dec</span> <span class="id" title="var">k</span> <span class="id" title="var">j</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> <span class="id" title="var">i</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> <span class="id" title="var">k</span>. }}<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">transposition1</span> {<span class="id" title="var">X</span>} (<span class="id" title="var">dec</span>: <span class="id" title="var">isdeceq</span> <span class="id" title="var">X</span>) (<span class="id" title="var">i</span> <span class="id" title="var">j</span>:<span class="id" title="var">X</span>) : <span class="id" title="var">transposition0</span> <span class="id" title="var">dec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">i</span> = <span class="id" title="var">j</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">transposition0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (!<span class="id" title="var">isdeceq_refl</span> <span class="id" title="var">dec</span> <span class="id" title="var">i</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">transposition2</span> {<span class="id" title="var">X</span>} (<span class="id" title="var">dec</span>: <span class="id" title="var">isdeceq</span> <span class="id" title="var">X</span>) (<span class="id" title="var">i</span> <span class="id" title="var">j</span>:<span class="id" title="var">X</span>) : <span class="id" title="var">transposition0</span> <span class="id" title="var">dec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">j</span> = <span class="id" title="var">i</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">transposition0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">dec</span> <span class="id" title="var">j</span> <span class="id" title="var">i</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">jeqi</span>|<span class="id" title="var">jnei</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">jeqi</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (!<span class="id" title="var">isdeceq_refl</span> <span class="id" title="var">dec</span> <span class="id" title="var">j</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (!<span class="id" title="var">isdeceq_refl</span> <span class="id" title="var">dec</span> <span class="id" title="var">j</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">transpositionk</span> {<span class="id" title="var">X</span>} (<span class="id" title="var">dec</span>: <span class="id" title="var">isdeceq</span> <span class="id" title="var">X</span>) (<span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">k</span> : <span class="id" title="var">X</span>) : <span class="id" title="var">k</span> != <span class="id" title="var">i</span> -&gt; <span class="id" title="var">k</span> != <span class="id" title="var">j</span> -&gt; <span class="id" title="var">transposition0</span> <span class="id" title="var">dec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">k</span> = <span class="id" title="var">k</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">knei</span> <span class="id" title="var">knej</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">transposition0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">dec</span> <span class="id" title="var">k</span> <span class="id" title="var">i</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">ki</span>|<span class="id" title="var">ki'</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> (<span class="id" title="var">knei</span> <span class="id" title="var">ki</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">dec</span> <span class="id" title="var">k</span> <span class="id" title="var">j</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">kj</span>|<span class="id" title="var">kj'</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">induction</span> (<span class="id" title="var">knej</span> <span class="id" title="var">kj</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">reflexivity</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">transposition_squared</span> {<span class="id" title="var">X</span>} (<span class="id" title="var">dec</span>: <span class="id" title="var">isdeceq</span> <span class="id" title="var">X</span>) (<span class="id" title="var">i</span> <span class="id" title="var">j</span>:<span class="id" title="var">X</span>) : <span class="id" title="var">transposition0</span> <span class="id" title="var">dec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> ∘ <span class="id" title="var">transposition0</span> <span class="id" title="var">dec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> ~ <span class="id" title="var">idfun</span> <span class="id" title="var">X</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">homot</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">funcomp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">dec</span> <span class="id" title="var">k</span> <span class="id" title="var">i</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">keqi</span> | <span class="id" title="var">knei</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">induction</span> (!<span class="id" title="var">keqi</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (!<span class="id" title="var">transposition1</span> <span class="id" title="var">dec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (!<span class="id" title="var">transposition2</span> <span class="id" title="var">dec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">induction</span> (<span class="id" title="var">dec</span> <span class="id" title="var">k</span> <span class="id" title="var">j</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">keqj</span> | <span class="id" title="var">knej</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">induction</span> (!<span class="id" title="var">keqj</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (!<span class="id" title="var">transposition2</span> <span class="id" title="var">dec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (!<span class="id" title="var">transposition1</span> <span class="id" title="var">dec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (!<span class="id" title="var">transpositionk</span> <span class="id" title="var">dec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">k</span> <span class="id" title="var">knei</span> <span class="id" title="var">knej</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (!<span class="id" title="var">transpositionk</span> <span class="id" title="var">dec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">k</span> <span class="id" title="var">knei</span> <span class="id" title="var">knej</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. }<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">transposition_weq</span> {<span class="id" title="var">X</span>} (<span class="id" title="var">dec</span>: <span class="id" title="var">isdeceq</span> <span class="id" title="var">X</span>) (<span class="id" title="var">i</span> <span class="id" title="var">j</span>:<span class="id" title="var">X</span>) : <span class="id" title="var">isweq</span> (<span class="id" title="var">transposition0</span> <span class="id" title="var">dec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isweq_iso</span> <span class="id" title="var">_</span> (<span class="id" title="var">transposition0</span> <span class="id" title="var">dec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>)).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">transposition_squared</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">transposition_squared</span>. }<br/>
</div>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">transposition</span> {<span class="id" title="var">X</span>} (<span class="id" title="var">dec</span>: <span class="id" title="var">isdeceq</span> <span class="id" title="var">X</span>) (<span class="id" title="var">i</span> <span class="id" title="var">j</span>:<span class="id" title="var">X</span>) : <span class="id" title="var">X</span> ≃ <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">transposition0</span> <span class="id" title="var">dec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">transposition_weq</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">transposition_stn</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">i</span> <span class="id" title="var">j</span>:<span class="id" title="var">stn</span> <span class="id" title="var">n</span>) : (<span class="id" title="var">stn</span> <span class="id" title="var">n</span>) ≃ (<span class="id" title="var">stn</span> <span class="id" title="var">n</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">transposition</span> <span class="id" title="var">_</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isdeceqstn</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isdeceq_nelstruct</span> {<span class="id" title="var">n</span>} {<span class="id" title="var">I</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">nelstruct</span> <span class="id" title="var">n</span> <span class="id" title="var">I</span>) : <span class="id" title="var">isdeceq</span> <span class="id" title="var">I</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isdeceqweqf</span> <span class="id" title="var">f</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isdeceqstn</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">nat</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">rotate_left_stn_0</span> <span class="id" title="var">n</span> (<span class="id" title="var">i</span>:<span class="id" title="var">nat</span>) : <span class="id" title="var">stn</span> <span class="id" title="var">n</span> -&gt; <span class="id" title="var">stn</span> <span class="id" title="var">n</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> <span class="id" title="var">j</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">exists</span> (<span class="id" title="var">natrem</span> (<span class="id" title="var">i</span> + <span class="id" title="var">j</span>) (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">lthnatrem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natneqsx0</span>. }<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">natnzero</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">m</span>&lt;<span class="id" title="var">n</span> -&gt; <span class="id" title="var">n</span> ≠ 0.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">issymm_natneq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">natlthtoneq</span> 0 <span class="id" title="var">n</span> (<span class="id" title="var">natlehlthtrans</span> 0 <span class="id" title="var">m</span> <span class="id" title="var">n</span> (<span class="id" title="var">natleh0n</span> <span class="id" title="var">m</span>) <span class="id" title="var">l</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">natdivremunique'</span> (<span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>:<span class="id" title="var">nat</span>) : <span class="id" title="var">j</span>+<span class="id" title="var">i</span>*<span class="id" title="var">m</span>=<span class="id" title="var">n</span> -&gt; <span class="id" title="var">j</span>&lt;<span class="id" title="var">m</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">natdiv</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> = <span class="id" title="var">i</span>) × (<span class="id" title="var">natrem</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> = <span class="id" title="var">j</span>).<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">natdivremunique</span> <span class="id" title="var">m</span> (<span class="id" title="var">natdiv</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>) (<span class="id" title="var">natrem</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>) <span class="id" title="var">i</span> <span class="id" title="var">j</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">lthnatrem</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">natnzero</span> <span class="id" title="var">j</span> <span class="id" title="var">m</span> <span class="id" title="var">l</span>). }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">natdivremrule</span>; <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">natnzero</span> <span class="id" title="var">j</span> <span class="id" title="var">m</span> <span class="id" title="var">l</span>). }<br/>
</div>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">natdivunique</span> (<span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>:<span class="id" title="var">nat</span>) : <span class="id" title="var">j</span>+<span class="id" title="var">i</span>*<span class="id" title="var">m</span>=<span class="id" title="var">n</span> -&gt; <span class="id" title="var">j</span>&lt;<span class="id" title="var">m</span> -&gt; <span class="id" title="var">n</span> / <span class="id" title="var">m</span> = <span class="id" title="var">i</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">natdivremunique'</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">e</span> <span class="id" title="var">l</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">natremunique</span> (<span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>:<span class="id" title="var">nat</span>) : <span class="id" title="var">j</span>+<span class="id" title="var">i</span>*<span class="id" title="var">m</span>=<span class="id" title="var">n</span> -&gt; <span class="id" title="var">j</span>&lt;<span class="id" title="var">m</span> -&gt; <span class="id" title="var">n</span> /+ <span class="id" title="var">m</span> = <span class="id" title="var">j</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">pr2</span> (<span class="id" title="var">natdivremunique'</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">e</span> <span class="id" title="var">l</span>)).<br/>
</div>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">natremunique'</span> (<span class="id" title="var">m</span> <span class="id" title="var">j</span>:<span class="id" title="var">nat</span>) : <span class="id" title="var">j</span>&lt;<span class="id" title="var">m</span> -&gt; <span class="id" title="var">natrem</span> <span class="id" title="var">j</span> <span class="id" title="var">m</span> = <span class="id" title="var">j</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">natremunique</span> <span class="id" title="var">j</span> <span class="id" title="var">m</span> 0 <span class="id" title="var">j</span> <span class="id" title="var">_</span> <span class="id" title="var">l</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">natplusr0</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">natremplusden</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : (<span class="id" title="var">m</span>+<span class="id" title="var">n</span>) /+ <span class="id" title="var">m</span> = <span class="id" title="var">n</span> /+ <span class="id" title="var">m</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<span class="id" title="var">nat_eq_or_neq</span> <span class="id" title="var">m</span> 0) <span class="id" title="keyword">as</span> [<span class="id" title="var">b</span>|<span class="id" title="var">b</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">induction</span> (!<span class="id" title="var">b</span>). <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">set</span> (<span class="id" title="var">j</span> := <span class="id" title="var">natrem</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">i</span> := <span class="id" title="var">natdiv</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">natremunique</span> (<span class="id" title="var">m</span>+<span class="id" title="var">n</span>) <span class="id" title="var">m</span> (<span class="id" title="var">S</span> <span class="id" title="var">i</span>) <span class="id" title="var">j</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">set</span> (<span class="id" title="var">r</span> := <span class="id" title="var">natdivremrule</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">r</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">r</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">natrem</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>) <span class="id" title="keyword">with</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">natdiv</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>) <span class="id" title="keyword">with</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">natpluscomm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">natplusassoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">natpluscomm</span> (<span class="id" title="var">i</span>*<span class="id" title="var">m</span>) (<span class="id" title="var">m</span>+<span class="id" title="var">j</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">natplusassoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">lthnatrem</span>. <span class="id" title="tactic">assumption</span>. }}<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">natremplus</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">m</span> : <span class="id" title="var">m</span> ≠ 0 -&gt; (<span class="id" title="var">i</span> + <span class="id" title="var">j</span> /+ <span class="id" title="var">m</span>) /+ <span class="id" title="var">m</span> = (<span class="id" title="var">i</span>+<span class="id" title="var">j</span>) /+ <span class="id" title="var">m</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">ne</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pathsinv0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">p</span> := <span class="id" title="var">natdiv</span> (<span class="id" title="var">i</span>+<span class="id" title="var">natrem</span> <span class="id" title="var">j</span> <span class="id" title="var">m</span>) <span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">q</span> := <span class="id" title="var">natrem</span> (<span class="id" title="var">i</span>+<span class="id" title="var">natrem</span> <span class="id" title="var">j</span> <span class="id" title="var">m</span>) <span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">natremunique</span> (<span class="id" title="var">i</span>+<span class="id" title="var">j</span>) <span class="id" title="var">m</span> (<span class="id" title="var">p</span> + <span class="id" title="var">natdiv</span> <span class="id" title="var">j</span> <span class="id" title="var">m</span>) <span class="id" title="var">q</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">t</span> := <span class="id" title="var">natdivremrule</span> <span class="id" title="var">j</span> <span class="id" title="var">m</span> <span class="id" title="var">ne</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">admit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">lthnatrem</span>. <span class="id" title="tactic">assumption</span>. }<br/>
<span class="id" title="keyword">Abort</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">addmonoid_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">rotate_left_stn_1</span> <span class="id" title="var">n</span> : <span class="id" title="var">rotate_left_stn_0</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span> ~ <span class="id" title="var">idfun</span> (<span class="id" title="var">stn</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">induction</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">i</span> <span class="id" title="var">I</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">an_inclusion_is_injective</span> <span class="id" title="var">_</span> (<span class="id" title="var">isinclstntonat</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">intermediate_path</span> (<span class="id" title="var">natrem</span> <span class="id" title="var">i</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> (<span class="id" title="var">natremplusden</span> <span class="id" title="var">i</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">natremunique'</span>. <span class="id" title="tactic">assumption</span>. } } }<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">rotate_left_stn_2</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">rotate_left_stn_0</span> <span class="id" title="var">n</span> (<span class="id" title="var">i</span>+<span class="id" title="var">j</span>) ~ <span class="id" title="var">rotate_left_stn_0</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span> ∘ <span class="id" title="var">rotate_left_stn_0</span> <span class="id" title="var">n</span> <span class="id" title="var">j</span>.<br/>
<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">induction</span> <span class="id" title="var">k</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">k</span> <span class="id" title="var">K</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">an_inclusion_is_injective</span> <span class="id" title="var">_</span> (<span class="id" title="var">isinclstntonat</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">decidable_type</span> (<span class="id" title="var">X</span>:<span class="id" title="var">UU</span>) := <span class="id" title="var">X</span> ⨿ ¬<span class="id" title="var">X</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">uniqueness0</span> (<span class="id" title="var">X</span>:<span class="id" title="var">abmonoid</span>) <span class="id" title="var">n</span> : ∏ <span class="id" title="var">I</span> (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">nelstruct</span> <span class="id" title="var">n</span> <span class="id" title="var">I</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">X</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">finiteOperation0</span> <span class="id" title="var">X</span> <span class="id" title="var">n</span> (<span class="id" title="var">funcomp</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">f</span>) <span class="id" title="var">x</span>)<br/>
&nbsp;&nbsp;= <span class="id" title="var">finiteOperation0</span> <span class="id" title="var">X</span> <span class="id" title="var">n</span> (<span class="id" title="var">funcomp</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">g</span>) <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? ?. <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IH</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">dec</span> : <span class="id" title="var">decidable_type</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">f</span> <span class="id" title="var">lastelement</span> = <span class="id" title="var">pr1</span> <span class="id" title="var">g</span> <span class="id" title="var">lastelement</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> (<span class="id" title="var">isdeceqweqf</span> <span class="id" title="var">f</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">isdeceqstn</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">dec</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">e</span>|<span class="id" title="var">b</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> (<span class="id" title="var">aptwice</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">x</span> + <span class="id" title="var">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> &lt;- 2 ! <span class="id" title="var">fun_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">f'</span> := <span class="id" title="var">nelstructoncompl</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">f</span> <span class="id" title="var">lastelement</span>) <span class="id" title="var">f</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">g'</span> := <span class="id" title="var">nelstructoncompl</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">g</span> <span class="id" title="var">lastelement</span>) <span class="id" title="var">g</span>).<br/>

<br/>
<span class="id" title="keyword">Abort</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">finiteOperation1</span> (<span class="id" title="var">X</span>:<span class="id" title="var">abmonoid</span>) <span class="id" title="var">I</span> : <span class="id" title="var">finstruct</span> <span class="id" title="var">I</span> -&gt; (<span class="id" title="var">I</span>-&gt;<span class="id" title="var">X</span>) -&gt; <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">n</span> <span class="id" title="var">f</span>] <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">finiteOperation0</span> <span class="id" title="var">X</span> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">x</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">f</span> <span class="id" title="var">i</span>)).<br/>
</div>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">finiteOperation</span> {<span class="id" title="var">I</span>} (<span class="id" title="keyword">is</span>:<span class="id" title="var">isfinite</span> <span class="id" title="var">I</span>) (<span class="id" title="var">X</span>:<span class="id" title="var">abmonoid</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">X</span>) : <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">generalize</span> <span class="id" title="keyword">is</span>; <span class="id" title="tactic">clear</span> <span class="id" title="keyword">is</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">squash_to_set</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">fs</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">finiteOperation1</span> <span class="id" title="var">X</span> <span class="id" title="var">I</span> <span class="id" title="var">fs</span> <span class="id" title="var">x</span>). }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> [<span class="id" title="var">m</span> <span class="id" title="var">f</span>] [<span class="id" title="var">n</span> <span class="id" title="var">g</span>]. <span class="id" title="tactic">assert</span> (<span class="id" title="var">e</span> := <span class="id" title="var">same_n</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>). <span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">uniqueness0</span>. &nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">admit</span>.<br/>
&nbsp;&nbsp;}<br/>
<span class="id" title="keyword">Abort</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab1771"></a><h1 class="section">abelian monoids by generators and relations</h1>

</div>
<div class="code">
<span class="id" title="keyword">Module</span> <span class="id" title="var">Presentation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <span class="id" title="var">word</span> <span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">word_unit</span> : <span class="id" title="var">word</span> <span class="id" title="var">X</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">word_gen</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">word</span> <span class="id" title="var">X</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">word_op</span> : <span class="id" title="var">word</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">word</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">word</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">word_unit</span> {<span class="id" title="var">X</span>}.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">word_gen</span> {<span class="id" title="var">X</span>} <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">word_op</span> {<span class="id" title="var">X</span>} <span class="id" title="var">v</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <span class="id" title="var">reln</span> <span class="id" title="var">X</span> := <span class="id" title="var">make_reln</span> { <span class="id" title="var">lhs</span> : <span class="id" title="var">word</span> <span class="id" title="var">X</span>; <span class="id" title="var">rhs</span> : <span class="id" title="var">word</span> <span class="id" title="var">X</span> }.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">lhs</span> {<span class="id" title="var">X</span>} <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">rhs</span> {<span class="id" title="var">X</span>} <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">make_reln</span> {<span class="id" title="var">X</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <span class="id" title="var">MarkedPreAbelianMonoid</span> <span class="id" title="var">X</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">make_preAbelianMonoid</span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">elem</span> :&gt; <span class="id" title="keyword">Type</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">op0</span> : <span class="id" title="var">elem</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">op1</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">elem</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">op2</span> : <span class="id" title="var">elem</span> -&gt; <span class="id" title="var">elem</span> -&gt; <span class="id" title="var">elem</span> }.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">elem</span> {<span class="id" title="var">X</span>} <span class="id" title="var">M</span> : <span class="id" title="tactic">rename</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">op0</span> {<span class="id" title="var">X</span> <span class="id" title="var">M</span>} : <span class="id" title="tactic">rename</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">op1</span> {<span class="id" title="var">X</span> <span class="id" title="var">M</span>} <span class="id" title="var">x</span> : <span class="id" title="tactic">rename</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">op2</span> {<span class="id" title="var">X</span> <span class="id" title="var">M</span>} <span class="id" title="var">v</span> <span class="id" title="var">w</span> : <span class="id" title="tactic">rename</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">wordop</span> <span class="id" title="var">X</span> := <span class="id" title="var">make_preAbelianMonoid</span> <span class="id" title="var">X</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>) <span class="id" title="var">word_unit</span> <span class="id" title="var">word_gen</span> <span class="id" title="var">word_op</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">evalword</span> {<span class="id" title="var">X</span>} (<span class="id" title="var">Y</span>:<span class="id" title="var">MarkedPreAbelianMonoid</span> <span class="id" title="var">X</span>) (<span class="id" title="var">w</span>:<span class="id" title="var">word</span> <span class="id" title="var">X</span>) : <span class="id" title="var">elem</span> <span class="id" title="var">Y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">w</span>; <span class="id" title="tactic">intros</span> [|<span class="id" title="var">x</span>|<span class="id" title="var">v</span> <span class="id" title="var">w</span>]. { <span class="id" title="tactic">exact</span> <span class="id" title="var">op0</span>. } { <span class="id" title="tactic">exact</span> (<span class="id" title="var">op1</span> <span class="id" title="var">x</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">op2</span> (<span class="id" title="var">evalword</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">v</span>) (<span class="id" title="var">evalword</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">w</span>)). } <span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">MarkedPreAbelianMonoid_to_hrel</span> {<span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">M</span>:<span class="id" title="var">MarkedPreAbelianMonoid</span> <span class="id" title="var">X</span>) (<span class="id" title="keyword">is</span>:<span class="id" title="var">isaset</span> (<span class="id" title="var">elem</span> <span class="id" title="var">M</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">λ</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>, (<span class="id" title="var">evalword</span> <span class="id" title="var">M</span> <span class="id" title="var">v</span> = <span class="id" title="var">evalword</span> <span class="id" title="var">M</span> <span class="id" title="var">w</span>) ,, <span class="id" title="keyword">is</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
</div>

<div class="doc">
eta expansion principle for words 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">reassemble</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">v</span>:<span class="id" title="var">wordop</span> <span class="id" title="var">X</span>) : <span class="id" title="var">evalword</span> (<span class="id" title="var">wordop</span> <span class="id" title="var">X</span>) <span class="id" title="var">v</span> = <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="var">revert</span> <span class="id" title="var">v</span>; <span class="id" title="tactic">intros</span> [|<span class="id" title="var">x</span>|<span class="id" title="var">v</span> <span class="id" title="var">w</span>]. { <span class="id" title="tactic">reflexivity</span>. } { <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">aptwice</span> <span class="id" title="var">word_op</span> (<span class="id" title="var">reassemble</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">R</span> <span class="id" title="var">v</span>) (<span class="id" title="var">reassemble</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>)). } </div>

<br/>
</div>

<div class="doc">
<a name="lab1772"></a><h2 class="section">adequate relations over R</h2>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <span class="id" title="var">AdequateRelation</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">hrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">make_AdequateRelation</span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">base</span>: ∏ <span class="id" title="var">i</span>, <span class="id" title="var">r</span> (<span class="id" title="var">lhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>)) (<span class="id" title="var">rhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">reflex</span> : ∏ <span class="id" title="var">w</span>, <span class="id" title="var">r</span> <span class="id" title="var">w</span> <span class="id" title="var">w</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">symm</span> : ∏ <span class="id" title="var">v</span> <span class="id" title="var">w</span>, <span class="id" title="var">r</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> -&gt; <span class="id" title="var">r</span> <span class="id" title="var">w</span> <span class="id" title="var">v</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">trans</span> : ∏ <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>, <span class="id" title="var">r</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> -&gt; <span class="id" title="var">r</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> -&gt; <span class="id" title="var">r</span> <span class="id" title="var">u</span> <span class="id" title="var">w</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">left_compat</span> : ∏ <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>, <span class="id" title="var">r</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> -&gt; <span class="id" title="var">r</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span>) (<span class="id" title="var">word_op</span> <span class="id" title="var">u</span> <span class="id" title="var">w</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">right_compat</span>: ∏ <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>, <span class="id" title="var">r</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> -&gt; <span class="id" title="var">r</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">u</span> <span class="id" title="var">w</span>) (<span class="id" title="var">word_op</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">left_unit</span> : ∏ <span class="id" title="var">w</span>, <span class="id" title="var">r</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">word_unit</span> <span class="id" title="var">w</span>) <span class="id" title="var">w</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">right_unit</span> : ∏ <span class="id" title="var">w</span>, <span class="id" title="var">r</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">w</span> <span class="id" title="var">word_unit</span>) <span class="id" title="var">w</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">assoc</span> : ∏ <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>, <span class="id" title="var">r</span> (<span class="id" title="var">word_op</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span>) <span class="id" title="var">w</span>) (<span class="id" title="var">word_op</span> <span class="id" title="var">u</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">comm</span> : ∏ <span class="id" title="var">v</span> <span class="id" title="var">w</span>, <span class="id" title="var">r</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>) (<span class="id" title="var">word_op</span> <span class="id" title="var">w</span> <span class="id" title="var">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">make_AdequateRelation</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">base</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">adequacy_to_eqrel</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">hrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">AdequateRelation</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> -&gt; <span class="id" title="var">eqrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">abstract</span> ( <span class="id" title="tactic">split</span>; [ <span class="id" title="tactic">split</span>; [ <span class="id" title="tactic">exact</span> (<span class="id" title="var">trans</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>) | <span class="id" title="tactic">exact</span> (<span class="id" title="var">reflex</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>) ] |<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">symm</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>)]). </div>

<br/>
</div>

<div class="doc">
<a name="lab1773"></a><h2 class="section">the smallest adequate relation over R</h2>

         It is defined as the intersection of all the adequate relations.
         Later we'll have to deal with the "resizing" to resolve issues
         withe universes. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">smallestAdequateRelation0</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">hrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (∏ <span class="id" title="var">r</span>: <span class="id" title="var">hrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>), <span class="id" title="var">AdequateRelation</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> -&gt; <span class="id" title="var">r</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">abstract</span> (<span class="id" title="tactic">apply</span> <span class="id" title="var">impred</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">r</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">impred_prop</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">adequacy</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">AdequateRelation</span> <span class="id" title="var">R</span> (<span class="id" title="var">smallestAdequateRelation0</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">make_AdequateRelation</span> <span class="id" title="var">R</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">base</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">ra</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">reflex</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">exact</span> <span class="id" title="var">ra</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? ? <span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">symm</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">exact</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">λ</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">trans</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> (<span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>) (<span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>)). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? ? ? <span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">left_compat</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">exact</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? ? ? <span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">right_compat</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">exact</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">left_unit</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">exact</span> <span class="id" title="var">ra</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">right_unit</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">exact</span> <span class="id" title="var">ra</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">λ</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">assoc</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">λ</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">comm</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>). }<br/>
</div>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">smallestAdequateRelation</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">eqrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">adequacy_to_eqrel</span> <span class="id" title="var">R</span> <span class="id" title="var">_</span> (<span class="id" title="var">adequacy</span> <span class="id" title="var">R</span>)). <span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab1774"></a><h3 class="section">the underlying set of the abelian group with generators X and relations R</h3>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universalMarkedPreAbelianMonoid0</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">hSet</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">setquotinset</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">op2_compatibility</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">QuotientSet.iscomprelrelfun2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">word_op</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">y</span> <span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">right_compat</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">y</span> (<span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>)). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">y'</span> <span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">exact</span> ( <span class="id" title="var">left_compat</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">y'</span> (<span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>)). } </div>

<br/>
</div>

<div class="doc">
<a name="lab1775"></a><h3 class="section">the multiplication on on it</h3>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">univ_binop</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">binop</span> (<span class="id" title="var">universalMarkedPreAbelianMonoid0</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">QuotientSet.setquotfun2</span> <span class="id" title="var">word_op</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">op2_compatibility</span>. <span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">univ_setwithbinop</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">setwithbinop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">setwithbinoppair</span> (<span class="id" title="var">universalMarkedPreAbelianMonoid0</span> <span class="id" title="var">R</span>) (<span class="id" title="var">univ_binop</span> <span class="id" title="var">R</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab1776"></a><h3 class="section">the universal pre-Abelian group</h3>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universalMarkedPreAbelianMonoid</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">MarkedPreAbelianMonoid</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">make_preAbelianMonoid</span> <span class="id" title="var">X</span> (<span class="id" title="var">universalMarkedPreAbelianMonoid0</span> <span class="id" title="var">R</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">setquotpr</span> <span class="id" title="var">_</span> <span class="id" title="var">word_unit</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">setquotpr</span> <span class="id" title="var">_</span> (<span class="id" title="var">word_gen</span> <span class="id" title="var">x</span>)). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">univ_binop</span> <span class="id" title="var">_</span>). } <span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab1777"></a><h3 class="section">identities for the universal preabelian group</h3>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lift</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">issurjective</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>)).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">issurjsetquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>)). </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">is_left_unit_univ_binop</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">w</span>:<span class="id" title="var">universalMarkedPreAbelianMonoid0</span> <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">univ_binop</span> <span class="id" title="var">_</span>) (<span class="id" title="var">setquotpr</span> <span class="id" title="var">_</span> <span class="id" title="var">word_unit</span>) <span class="id" title="var">w</span>) = <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="var">isaprop_goal</span> <span class="id" title="var">ig</span>. { <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">w'</span> []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">iscompsetquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">left_unit</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">w'</span>)). </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">is_right_unit_univ_binop</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">w</span>:<span class="id" title="var">universalMarkedPreAbelianMonoid0</span> <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">univ_binop</span> <span class="id" title="var">_</span>) <span class="id" title="var">w</span> (<span class="id" title="var">setquotpr</span> <span class="id" title="var">_</span> <span class="id" title="var">word_unit</span>)) = <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="var">isaprop_goal</span> <span class="id" title="var">ig</span>. { <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">w'</span> []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">iscompsetquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">right_unit</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">w'</span>)). </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isassoc_univ_binop</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">isassoc</span>(<span class="id" title="var">univ_binop</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">set</span> (<span class="id" title="var">e</span> := <span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">intros</span> <span class="id" title="var">u'</span> <span class="id" title="var">v'</span> <span class="id" title="var">w'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isaprop_goal</span> <span class="id" title="var">ig</span>. { <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">u'</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">u</span> <span class="id" title="var">i</span>]; <span class="id" title="tactic">induction</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">v'</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">v</span> <span class="id" title="var">j</span>]; <span class="id" title="tactic">induction</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">w'</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">w</span> []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">iscompsetquotpr</span> <span class="id" title="var">e</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">λ</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">assoc</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>)). </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iscomm_univ_binop</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">iscomm</span>(<span class="id" title="var">univ_binop</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">set</span> (<span class="id" title="var">e</span> := <span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">intros</span> <span class="id" title="var">v'</span> <span class="id" title="var">w'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isaprop_goal</span> <span class="id" title="var">ig</span>. { <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">v'</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">v</span> <span class="id" title="var">j</span>]; <span class="id" title="tactic">induction</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">w'</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">w</span> []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">iscompsetquotpr</span> <span class="id" title="var">e</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">λ</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">comm</span> <span class="id" title="var">R</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>)). </div>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">reassemble_pr</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">v</span>:<span class="id" title="var">word</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">evalword</span> (<span class="id" title="var">universalMarkedPreAbelianMonoid</span> <span class="id" title="var">R</span>) <span class="id" title="var">v</span> = <span class="id" title="var">setquotpr</span> <span class="id" title="var">_</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="var">revert</span> <span class="id" title="var">v</span>; <span class="id" title="tactic">intros</span> [|<span class="id" title="var">x</span>|<span class="id" title="var">v</span> <span class="id" title="var">w</span>]. { <span class="id" title="tactic">reflexivity</span>. } { <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">p</span> := ! <span class="id" title="var">reassemble_pr</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">R</span> <span class="id" title="var">v</span>). <span class="id" title="tactic">induction</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">q</span> := ! <span class="id" title="var">reassemble_pr</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>). <span class="id" title="tactic">induction</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. } </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">pr_eval_compat</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">w</span>:<span class="id" title="var">word</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">evalword</span> (<span class="id" title="var">wordop</span> <span class="id" title="var">X</span>) <span class="id" title="var">w</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">evalword</span> (<span class="id" title="var">universalMarkedPreAbelianMonoid</span> <span class="id" title="var">R</span>) <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">x</span>|<span class="id" title="var">v</span> <span class="id" title="var">w</span>]. { <span class="id" title="tactic">reflexivity</span>. } { <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">assert</span> (<span class="id" title="var">p</span> := !<span class="id" title="var">reassemble</span> <span class="id" title="var">R</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>)). <span class="id" title="tactic">induction</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (!<span class="id" title="var">reassemble_pr</span> <span class="id" title="var">R</span> (<span class="id" title="var">word_op</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>)). } </div>

<br/>
</div>

<div class="doc">
<a name="lab1778"></a><h3 class="section">abelian groups over X modulo R</h3>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">toMarkedPreAbelianMonoid</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">M</span>:<span class="id" title="var">abmonoid</span>) (<span class="id" title="var">el</span>:<span class="id" title="var">X</span>-&gt;<span class="id" title="var">M</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">MarkedPreAbelianMonoid</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exact</span> {| <span class="id" title="var">elem</span> := <span class="id" title="var">M</span>; <span class="id" title="var">op0</span> := <span class="id" title="var">unel</span> <span class="id" title="var">_</span>; <span class="id" title="var">op1</span> := <span class="id" title="var">el</span>; <span class="id" title="var">op2</span> := <span class="id" title="var">op</span> |}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <span class="id" title="var">MarkedAbelianMonoid</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">make_MarkedAbelianMonoid</span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">m_base</span> :&gt; <span class="id" title="var">abmonoid</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">m_mark</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">m_base</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">m_reln</span> : ∏ <span class="id" title="var">i</span>, <span class="id" title="var">evalword</span> (<span class="id" title="var">toMarkedPreAbelianMonoid</span> <span class="id" title="var">R</span> <span class="id" title="var">m_base</span> <span class="id" title="var">m_mark</span>) (<span class="id" title="var">lhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">evalword</span> (<span class="id" title="var">toMarkedPreAbelianMonoid</span> <span class="id" title="var">R</span> <span class="id" title="var">m_base</span> <span class="id" title="var">m_mark</span>) (<span class="id" title="var">rhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>)) }.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">make_MarkedAbelianMonoid</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} <span class="id" title="var">R</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">m_base</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span> <span class="id" title="var">R</span>} <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">m_mark</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span> <span class="id" title="var">R</span>} <span class="id" title="var">_</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">m_reln</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span> <span class="id" title="var">R</span>} <span class="id" title="var">_</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">relations</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} (<span class="id" title="var">M</span>:<span class="id" title="var">MarkedAbelianMonoid</span> <span class="id" title="var">R</span>) := <span class="id" title="var">R</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">toMarkedPreAbelianMonoid'</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} (<span class="id" title="var">M</span>:<span class="id" title="var">MarkedAbelianMonoid</span> <span class="id" title="var">R</span>) : <span class="id" title="var">MarkedPreAbelianMonoid</span> <span class="id" title="var">X</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">toMarkedPreAbelianMonoid</span> <span class="id" title="var">R</span> (<span class="id" title="var">m_base</span> <span class="id" title="var">M</span>) (<span class="id" title="var">m_mark</span> <span class="id" title="var">M</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">evalwordMM</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} (<span class="id" title="var">M</span>:<span class="id" title="var">MarkedAbelianMonoid</span> <span class="id" title="var">R</span>) : <span class="id" title="var">word</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">M</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">evalword</span> (<span class="id" title="var">toMarkedPreAbelianMonoid'</span> <span class="id" title="var">M</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">MarkedAbelianMonoid_to_hrel</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} (<span class="id" title="var">M</span>:<span class="id" title="var">MarkedAbelianMonoid</span> <span class="id" title="var">R</span>) : <span class="id" title="var">hrel</span> (<span class="id" title="var">word</span> <span class="id" title="var">X</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">λ</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> , <span class="id" title="var">eqset</span> (<span class="id" title="var">evalwordMM</span> <span class="id" title="var">M</span> <span class="id" title="var">v</span>) (<span class="id" title="var">evalwordMM</span> <span class="id" title="var">M</span> <span class="id" title="var">w</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">abelian_group_adequacy</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">M</span>:<span class="id" title="var">MarkedAbelianMonoid</span> <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">AdequateRelation</span> <span class="id" title="var">R</span> (<span class="id" title="var">MarkedAbelianMonoid_to_hrel</span> <span class="id" title="var">M</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">make_AdequateRelation</span> <span class="id" title="var">R</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">λ</span> <span class="id" title="var">i</span>, <span class="id" title="var">m_reln</span> <span class="id" title="var">M</span> <span class="id" title="var">i</span>). } { <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? ?. <span class="id" title="tactic">exact</span> <span class="id" title="var">pathsinv0</span>. } { <span class="id" title="tactic">intros</span> ? ? ?. <span class="id" title="tactic">exact</span> <span class="id" title="var">pathscomp0</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? ? ? <span class="id" title="var">p</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">evalwordMM</span>,<span class="id" title="var">evalword</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">induction</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? ? ? <span class="id" title="var">p</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">evalwordMM</span>,<span class="id" title="var">evalword</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">induction</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">lunax</span>. } { <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">runax</span>. } { <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">assocax</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">commax</span>. }<br/>
</div>
&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <span class="id" title="var">MarkedAbelianMonoidMap</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} (<span class="id" title="var">M</span> <span class="id" title="var">N</span>:<span class="id" title="var">MarkedAbelianMonoid</span> <span class="id" title="var">R</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">make_MarkedAbelianMonoidMap</span> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">map_base</span> :&gt; <span class="id" title="var">Hom</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">map_mark</span> : ∏ <span class="id" title="var">x</span>, <span class="id" title="var">map_base</span> (<span class="id" title="var">m_mark</span> <span class="id" title="var">M</span> <span class="id" title="var">x</span>) = <span class="id" title="var">m_mark</span> <span class="id" title="var">N</span> <span class="id" title="var">x</span> }.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">map_base</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span> <span class="id" title="var">R</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>} <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">map_mark</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span> <span class="id" title="var">R</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>} <span class="id" title="var">m</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MarkedAbelianMonoidMapEquality</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} {<span class="id" title="var">M</span> <span class="id" title="var">N</span>:<span class="id" title="var">MarkedAbelianMonoid</span> <span class="id" title="var">R</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">MarkedAbelianMonoidMap</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>) : <span class="id" title="var">map_base</span> <span class="id" title="var">f</span> = <span class="id" title="var">map_base</span> <span class="id" title="var">g</span> -&gt; <span class="id" title="var">f</span> = <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">f</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">f</span> <span class="id" title="var">ft</span>], <span class="id" title="var">g</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">g</span> <span class="id" title="var">gt</span>]; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">j</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span>(<span class="id" title="var">k</span> : <span class="id" title="var">ft</span> = <span class="id" title="var">gt</span>). { <span class="id" title="tactic">apply</span> <span class="id" title="var">funextsec</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. } <span class="id" title="tactic">induction</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. </div>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">MarkedAbelianMonoidMap_compat</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">M</span> <span class="id" title="var">N</span>:<span class="id" title="var">MarkedAbelianMonoid</span> <span class="id" title="var">R</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">MarkedAbelianMonoidMap</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>) (<span class="id" title="var">w</span>:<span class="id" title="var">word</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">map_base</span> <span class="id" title="var">f</span> (<span class="id" title="var">evalwordMM</span> <span class="id" title="var">M</span> <span class="id" title="var">w</span>) = <span class="id" title="var">evalwordMM</span> <span class="id" title="var">N</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">x</span>|<span class="id" title="var">v</span> <span class="id" title="var">w</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">Monoid.unitproperty</span> <span class="id" title="var">f</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">map_mark</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">Monoid.multproperty</span> <span class="id" title="var">f</span> (<span class="id" title="var">evalwordMM</span> <span class="id" title="var">M</span> <span class="id" title="var">v</span>) (<span class="id" title="var">evalwordMM</span> <span class="id" title="var">M</span> <span class="id" title="var">w</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">aptwice</span> (<span class="id" title="var">λ</span> <span class="id" title="var">r</span> <span class="id" title="var">s</span>, <span class="id" title="var">r</span> + <span class="id" title="var">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">MarkedAbelianMonoidMap_compat</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> <span class="id" title="var">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">MarkedAbelianMonoidMap_compat</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> <span class="id" title="var">w</span>)). } </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MarkedAbelianMonoidMap_compat2</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">M</span> <span class="id" title="var">N</span>:<span class="id" title="var">MarkedAbelianMonoid</span> <span class="id" title="var">R</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">MarkedAbelianMonoidMap</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>) (<span class="id" title="var">w</span>:<span class="id" title="var">word</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">map_base</span> <span class="id" title="var">f</span> (<span class="id" title="var">evalwordMM</span> <span class="id" title="var">M</span> <span class="id" title="var">w</span>) = <span class="id" title="var">map_base</span> <span class="id" title="var">g</span> (<span class="id" title="var">evalwordMM</span> <span class="id" title="var">M</span> <span class="id" title="var">w</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">MarkedAbelianMonoidMap_compat</span> <span class="id" title="var">f</span> <span class="id" title="var">w</span> @ !<span class="id" title="var">MarkedAbelianMonoidMap_compat</span> <span class="id" title="var">g</span> <span class="id" title="var">w</span>). </div>

<br/>
</div>

<div class="doc">
<a name="lab1779"></a><h3 class="section">the universal marked abelian group over X modulo R</h3>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universalMarkedAbelianMonoid0</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">abmonoid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exists</span> (<span class="id" title="var">univ_setwithbinop</span> <span class="id" title="var">R</span>). <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exists</span> (<span class="id" title="var">isassoc_univ_binop</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">setquotpr</span> <span class="id" title="var">_</span> <span class="id" title="var">word_unit</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">is_left_unit_univ_binop</span> <span class="id" title="var">R</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">is_right_unit_univ_binop</span> <span class="id" title="var">R</span>). } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">iscomm_univ_binop</span> <span class="id" title="var">R</span>). } <span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universalMarkedAbelianMonoid1</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">MarkedPreAbelianMonoid</span> <span class="id" title="var">X</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">toMarkedPreAbelianMonoid</span> <span class="id" title="var">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">universalMarkedAbelianMonoid0</span> <span class="id" title="var">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span>, <span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">word_gen</span> <span class="id" title="var">x</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">universalMarkedAbelianMonoid2</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">w</span>:<span class="id" title="var">word</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">w</span> = <span class="id" title="var">evalword</span> (<span class="id" title="var">universalMarkedAbelianMonoid1</span> <span class="id" title="var">R</span>) <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (! (<span class="id" title="var">ap</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>)) (<span class="id" title="var">reassemble</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">pr_eval_compat</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>). </div>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universalMarkedAbelianMonoid3</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) (<span class="id" title="var">i</span>:<span class="id" title="var">I</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">evalword</span> (<span class="id" title="var">universalMarkedAbelianMonoid1</span> <span class="id" title="var">R</span>) (<span class="id" title="var">lhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">evalword</span> (<span class="id" title="var">universalMarkedAbelianMonoid1</span> <span class="id" title="var">R</span>) (<span class="id" title="var">rhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>)).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (! <span class="id" title="var">universalMarkedAbelianMonoid2</span> <span class="id" title="var">R</span> (<span class="id" title="var">lhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">iscompsetquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">λ</span> <span class="id" title="var">r</span> <span class="id" title="var">ra</span>, <span class="id" title="var">base</span> <span class="id" title="var">ra</span> <span class="id" title="var">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">universalMarkedAbelianMonoid2</span> <span class="id" title="var">R</span> (<span class="id" title="var">rhs</span> (<span class="id" title="var">R</span> <span class="id" title="var">i</span>))). </div>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universalMarkedAbelianMonoid</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>) : <span class="id" title="var">MarkedAbelianMonoid</span> <span class="id" title="var">R</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">make_MarkedAbelianMonoid</span> <span class="id" title="var">R</span> (<span class="id" title="var">universalMarkedAbelianMonoid0</span> <span class="id" title="var">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">word_gen</span> <span class="id" title="var">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">universalMarkedAbelianMonoid3</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">agreement_on_gens0</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} {<span class="id" title="var">M</span>:<span class="id" title="var">abmonoid</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">Hom</span> (<span class="id" title="var">universalMarkedAbelianMonoid</span> <span class="id" title="var">R</span>) <span class="id" title="var">M</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span>:∏ <span class="id" title="var">i</span>, <span class="id" title="var">f</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">word_gen</span> <span class="id" title="var">i</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">g</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">word_gen</span> <span class="id" title="var">i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">w</span>:<span class="id" title="var">word</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr1</span> <span class="id" title="var">f</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">w</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr1</span> <span class="id" title="var">g</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">w</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">x</span>|<span class="id" title="var">v</span> <span class="id" title="var">w</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">intermediate_path</span> (<span class="id" title="var">unel</span> <span class="id" title="var">M</span>). <span class="id" title="tactic">exact</span> (<span class="id" title="var">Monoid.unitproperty</span> <span class="id" title="var">f</span>). <span class="id" title="tactic">exact</span> (!<span class="id" title="var">Monoid.unitproperty</span> <span class="id" title="var">g</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">p</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Monoid.multproperty</span> <span class="id" title="var">f</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">w</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">_</span> @ !<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Monoid.multproperty</span> <span class="id" title="var">g</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) <span class="id" title="var">w</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">aptwice</span> (<span class="id" title="var">λ</span> <span class="id" title="var">r</span> <span class="id" title="var">s</span>, <span class="id" title="var">r</span> + <span class="id" title="var">s</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">agreement_on_gens0</span>. <span class="id" title="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">agreement_on_gens0</span>. <span class="id" title="tactic">assumption</span>. } } </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">agreement_on_gens</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} {<span class="id" title="var">M</span>:<span class="id" title="var">abmonoid</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">Hom</span> (<span class="id" title="var">universalMarkedAbelianMonoid</span> <span class="id" title="var">R</span>) <span class="id" title="var">M</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(∏ <span class="id" title="var">i</span>, <span class="id" title="var">f</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">word_gen</span> <span class="id" title="var">i</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">g</span> (<span class="id" title="var">setquotpr</span> (<span class="id" title="var">smallestAdequateRelation</span> <span class="id" title="var">R</span>) (<span class="id" title="var">word_gen</span> <span class="id" title="var">i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id" title="var">f</span> = <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Monoid.funEquality</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">funextsec</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">t</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">surjectionisepitosets</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">issurjsetquotpr</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. } { <span class="id" title="tactic">apply</span> <span class="id" title="var">agreement_on_gens0</span>. <span class="id" title="tactic">assumption</span>. } <span class="id" title="keyword">Qed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universality0</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} (<span class="id" title="var">M</span>:<span class="id" title="var">MarkedAbelianMonoid</span> <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">universalMarkedAbelianMonoid0</span> <span class="id" title="var">R</span> -&gt; <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">setquotuniv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">evalwordMM</span> <span class="id" title="var">M</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">λ</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">r</span>, <span class="id" title="var">r</span> (<span class="id" title="var">MarkedAbelianMonoid_to_hrel</span> <span class="id" title="var">M</span>) (<span class="id" title="var">abelian_group_adequacy</span> <span class="id" title="var">R</span> <span class="id" title="var">M</span>)).<br/>
</div>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universality1</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} (<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">M</span>:<span class="id" title="var">MarkedAbelianMonoid</span> <span class="id" title="var">R</span>) (<span class="id" title="var">v</span> <span class="id" title="var">w</span>:<span class="id" title="var">universalMarkedAbelianMonoid0</span> <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">universality0</span> <span class="id" title="var">M</span> (<span class="id" title="var">v</span> + <span class="id" title="var">w</span>) = <span class="id" title="var">universality0</span> <span class="id" title="var">M</span> <span class="id" title="var">v</span> + <span class="id" title="var">universality0</span> <span class="id" title="var">M</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="var">isaprop_goal</span> <span class="id" title="var">ig</span>. { <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">v</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">v'</span> <span class="id" title="var">j</span>]; <span class="id" title="tactic">induction</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">w'</span> []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. </div>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">universality2</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} (<span class="id" title="var">M</span>:<span class="id" title="var">MarkedAbelianMonoid</span> <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">monoidfun</span> (<span class="id" title="var">universalMarkedAbelianMonoid</span> <span class="id" title="var">R</span>) <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">universality0</span> <span class="id" title="var">M</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>. { <span class="id" title="tactic">intros</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">universality1</span>. } { <span class="id" title="tactic">reflexivity</span>. } </div>

<br/>
</div>

<div class="doc">
<a name="lab1780"></a><h1 class="section">universality of the universal marked abelian group</h1>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local</span> <span class="id" title="var">Arguments</span> <span class="id" title="var">pr1monoidfun</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span>} <span class="id" title="var">f</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">iscontrMarkedAbelianMonoidMap</span> {<span class="id" title="var">X</span> <span class="id" title="var">I</span>} {<span class="id" title="var">R</span>:<span class="id" title="var">I</span>-&gt;<span class="id" title="var">reln</span> <span class="id" title="var">X</span>} (<span class="id" title="var">M</span>:<span class="id" title="var">MarkedAbelianMonoid</span> <span class="id" title="var">R</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iscontr</span> (<span class="id" title="var">MarkedAbelianMonoidMap</span> (<span class="id" title="var">universalMarkedAbelianMonoid</span> <span class="id" title="var">R</span>) <span class="id" title="var">M</span>).<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">g</span> := <span class="id" title="var">make_MarkedAbelianMonoidMap</span> <span class="id" title="var">X</span> <span class="id" title="var">I</span> <span class="id" title="var">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">universalMarkedAbelianMonoid</span> <span class="id" title="var">R</span>) <span class="id" title="var">M</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">universality2</span> <span class="id" title="var">M</span>) (<span class="id" title="var">λ</span> <span class="id" title="var">x</span>, <span class="id" title="var">idpath</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">g</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">f</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">MarkedAbelianMonoidMapEquality</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Monoid.funEquality</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">funextsec</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isaprop_goal</span> <span class="id" title="var">ig</span>. { <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">v</span>) <span class="id" title="var">ig</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">w</span> []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ((<span class="id" title="var">ap</span> <span class="id" title="var">f</span> (<span class="id" title="var">universalMarkedAbelianMonoid2</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">MarkedAbelianMonoidMap_compat2</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">w</span> @ !(<span class="id" title="var">ap</span> <span class="id" title="var">g</span> (<span class="id" title="var">universalMarkedAbelianMonoid2</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>))).<br/>
</div>
<span class="id" title="keyword">End</span> <span class="id" title="var">Presentation</span>.<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">Free</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Import</span> <span class="id" title="var">Presentation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">make</span> (<span class="id" title="var">X</span>:<span class="id" title="keyword">Type</span>) := @<span class="id" title="var">universalMarkedAbelianMonoid</span> <span class="id" title="var">X</span> <span class="id" title="var">empty</span> <span class="id" title="var">fromempty</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Free</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">NN</span> := <span class="id" title="var">Free.make</span> <span class="id" title="var">unit</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">NN_agreement</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Import</span> <span class="id" title="var">Presentation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">mult</span> {<span class="id" title="var">X</span>:<span class="id" title="var">abmonoid</span>} (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">X</span>) : <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IHn</span>]. <span class="id" title="tactic">exact</span> (<span class="id" title="var">unel</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">exact</span> (<span class="id" title="var">x</span> + <span class="id" title="var">IHn</span>). <span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Notation</span> "n * x" := ( <span class="id" title="var">mult</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mult_one</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) : <span class="id" title="var">n</span> * (1 : <span class="id" title="var">nataddabmonoid</span>) = <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IHn</span>]. { <span class="id" title="tactic">reflexivity</span>. } { <span class="id" title="tactic">exact</span> (<span class="id" title="var">ap</span> <span class="id" title="var">S</span> <span class="id" title="var">IHn</span>). } </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mult_fun</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span>:<span class="id" title="var">abmonoid</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Hom</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">X</span>) : <span class="id" title="var">f</span>(<span class="id" title="var">n</span>*<span class="id" title="var">x</span>) = <span class="id" title="var">n</span>*<span class="id" title="var">f</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IHn</span>]. { <span class="id" title="tactic">exact</span> (<span class="id" title="var">Monoid.unitproperty</span> <span class="id" title="var">f</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">Monoid.multproperty</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> (<span class="id" title="var">n</span>*<span class="id" title="var">x</span>) @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHn</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">IHn</span>. <span class="id" title="tactic">reflexivity</span>. } } </div>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">uniq_fun</span> {<span class="id" title="var">X</span>:<span class="id" title="var">abmonoid</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">Hom</span> <span class="id" title="var">nataddabmonoid</span> <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span> 1 = <span class="id" title="var">g</span> 1 -&gt; <span class="id" title="var">homot</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof"> <span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IHn</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">Monoid.unitproperty</span> <span class="id" title="var">f</span> @ !<span class="id" title="var">Monoid.unitproperty</span> <span class="id" title="var">g</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exact</span> (<span class="id" title="var">Monoid.multproperty</span> <span class="id" title="var">f</span> 1 <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">aptwice</span> (<span class="id" title="var">λ</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">x</span>+<span class="id" title="var">y</span>) <span class="id" title="var">e</span> <span class="id" title="var">IHn</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ !<span class="id" title="var">Monoid.multproperty</span> <span class="id" title="var">g</span> 1 <span class="id" title="var">n</span>). } </div>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">weq_NN_nataddabmonoid</span> : <span class="id" title="var">NN</span> ≃ <span class="id" title="var">nataddabmonoid</span>.<br/>
&nbsp;&nbsp;<a class="proof" href="#">Show proof.</a><br/><div class="proof">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">R</span> := <span class="id" title="var">Presentation.relations</span> <span class="id" title="var">NN</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">one</span> := <span class="id" title="var">Presentation.m_mark</span> <span class="id" title="var">NN</span> <span class="id" title="var">tt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">markednat</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">make_MarkedAbelianMonoid</span> <span class="id" title="var">R</span> <span class="id" title="var">nataddabmonoid</span> (<span class="id" title="var">λ</span> <span class="id" title="var">_</span>, 1) <span class="id" title="var">fromemptysec</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">map_base</span> (<span class="id" title="var">thePoint</span> (<span class="id" title="var">iscontrMarkedAbelianMonoidMap</span> <span class="id" title="var">markednat</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">isweq_iso</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">m</span>. { <span class="id" title="tactic">exact</span> (<span class="id" title="var">m</span> * <span class="id" title="var">one</span>). } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">squash_to_prop</span> (<span class="id" title="var">lift</span> <span class="id" title="var">R</span> <span class="id" title="var">w</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">setproperty</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> [<span class="id" title="var">v</span> <span class="id" title="var">v'</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">v'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">v'</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">multmonoid_scope</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">addmonoid_scope</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">multmonoid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">addmonoid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">admit</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">admit</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">admit</span>. } } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">admit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Abort</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">NN_agreement</span>.<br/>

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>